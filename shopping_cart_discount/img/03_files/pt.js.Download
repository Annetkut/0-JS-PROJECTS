!function(){"use strict";var o=document,s=window;"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(null!=o)for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},writable:!0,configurable:!0});function i(e,t){this.siteDomain=e,this.consent=t,this.setParams=function(e){this.params=e},this.track=function(){var e;-1===["de","fr","ru"].indexOf(this.siteDomain.toLowerCase())&&("viewcontent"!==(e=new String(this.params.ev).toLowerCase())&&"pageview"!==e&&"addtocart"!==e&&"purchase"!==e||(e=this.buildUrl(this.params,t),this.enqueueUrl(e),l.log("called method `track` with params below",null,this.params)))},this.enqueueUrl=function(e){n.push(e),this.sendUrls()},this.sendUrls=function(){var e,t,i,o;a||(a=!0,(e=n.shift())?(t=new Image(1,1),i=new Image(1,1),o=e.replace("/rt/","/tr/"),i.onload=i.onerror=function(){a=!1,this.sendUrls()}.bind(this),i.src=o,-1===e.toLowerCase().indexOf("3fb68ddf1eabf7f9421b3fbf837a8fd2")&&0!==this.consent&&(t.src=e)):a=!1)},this.buildUrl=function(e,t){var i,o=[],n=0!==t?-1!==this.getDomain().indexOf("it")?"https://stileo.it":"https://www."+this.getDomain():"https://glamipixel.com/"+this.siteDomain;for(i in n+="/rt/?",e)e.hasOwnProperty(i)&&o.push(i+"="+encodeURIComponent(e[i]));t=o.join("&").length;return o.push("l="+t),o.push("v=1"),n+o.join("&")},this.getDomain=function(){var e=s.location.href.match(/([0-9]+)\.devklarka\.[a-z]{2,}/);if(e)return parseInt(e[1],10)+".devklarka."+this.siteDomain.toLowerCase();switch(this.siteDomain.toLowerCase()){case"br":return"glami.com.br";case"tr":return"glami.com.tr";default:return"glami."+this.siteDomain.toLowerCase()}}}var n=[],a=!1,r=function(e){for(var t=e+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){for(var n=i[o];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}return null},c=function(e,t,i,o,n){var s,a="";i&&((s=new Date).setTime(s.getTime()+60*i*1e3),a=s.toUTCString()),document.cookie=[e,"=",encodeURIComponent(t),a&&"; expires="+a,n&&"; path="+n,o&&"; domain="+o].join("")},l={initDebugFromUrlParameter:function(){var e=new URL(location.href).searchParams.get("glamiDebug");null!==e&&this.setDebug(1===parseInt(e))},setDebug:function(e){window.localStorage.setItem("glamiPixelDebug",e?"1":"0")},isDebug:function(){return void 0!==window.localStorage.getItem("glamiPixelDebug")&&1===parseInt(window.localStorage.getItem("glamiPixelDebug"))},log:function(e,t,i){!1!==this.isDebug()&&(console.log("%cGLAMI Pixel:%c"+e,"background-color: black; padding: 5px; font-weight: bold","font-weight: normal"),null!=t&&console.log(t),null!=i&&console.table(i))}},h=function(e){var t={siteDomain:e,hash:null},i=window.location.search.match(/gci=([a-z.]{3,}[a-z0-9]{40})/i),e=null;if(i&&i[1]&&(e=i[1]),null===e)return t;i=e.split("."),e=i.pop();return 40!==e.length?t:{siteDomain:i.join("."),hash:e}},g=function(e){var t={siteDomain:e,hash:null},e=window.location.search.match(/gclid=([^&#]+)/i);return e&&e[1]&&(t.hash=e[1]),t},u={sessionCookieLifetime:43200,sessionCookieName:"gp_s",exitIdCookieName:"gp_e",userComesFromGlamiCookieName:"gp_g",config:{},paramsHashHistory:[],consent:-1,consentIndexName:"consent",storage:{},getBeacon:function(e,t){return new i(e,t)},setDebug:function(e,t){l.setDebug(1===parseInt(t))},create:function(e,t,i,o){l.initDebugFromUrlParameter();var n={},n=null!==e&&"object"==typeof e?e:null!==t&&"object"==typeof t?(n.apiKey=e,Object.assign(n,t)):null!==i&&"object"==typeof i?(n.apiKey=e,n.siteDomain=t,Object.assign(n,i)):(n.apiKey=e,n.siteDomain=t,n.trackerName=i,Object.assign(n,o)),t=(n=Object.assign({apiKey:null,siteDomain:null,trackerName:null},n)).trackerName||u.DEFAULT_TRACKER_NAME,i=n.source||u.DEFAULT_SOURCE_NAME,o=this.getCookieDomain(n.cookieDomain||"auto");this.config[t]={},this.config[t].apiKey=n.apiKey,this.config[t].siteDomain=(n.siteDomain||"cz").toLowerCase(),this.config[t].source=i,this.config[t].domain=o,this.consent=-1,Object.prototype.hasOwnProperty.call(n,this.consentIndexName)&&(this.consent=parseInt(n[this.consentIndexName])),l.log("called method `create` for tracker `"+t+"` with config below",null,this.config),l.log("detected consent: "+this.consent),this.reloadWithOptionsChange(t)},track:function(e,t,i){var o,n,s,a,r={ev:t,consent:this.consent};for(a in i)if(i.hasOwnProperty(a)){var c=i[a];if(void 0!==c)if(a!==this.consentIndexName){if(c.constructor===Array){for(o=0,n=c.length;o<n;o++)c[o]=new String(c[o]).replace(/,/g,"\\,");s=c.join(",")}else s=c+"";r["cd["+a+"]"]=s.substr(0,1e3)}else this.consent=1===parseInt(c)?1:0,r.consent=this.consent}var l=this.getExitClickId();l&&(r["cd[gci]"]=l);t=this.getGpG(this.config[e].siteDomain);t&&(r["cd[gp_g]"]=t);l=Object.assign(this.getDefaultParams(e),r),t=this.getParamsHash(l);this.eventAlreadySent(t)||((e=this.getBeacon(this.config[e].siteDomain,this.consent)).setParams(l),e.track(),this.paramsHashHistory.push(t))},set:function(e,t){if(void 0!==t)for(var i in void 0===this.config[e]&&(e=this.autodetectTrackerName(e)),l.log("called method `set` for tracker `"+e+"` with args below:",null,t),t){var o;t.hasOwnProperty(i)&&(o=t[i],this.config[e][i]=o,"consent"===i&&(this.consent=parseInt(o),this.reloadWithOptionsChange(e)))}},reloadWithOptionsChange:function(e){this.createDefaultCookies(e);var t=this.config[e].siteDomain;this.storeExitClickId({gciObject:h(t),gclidObject:g(t)},e)},getDefaultParams:function(e){var t={};t.k=this.config[e].apiKey,o.referrer&&(t.r=o.referrer),t.sid=this.getSessionId(e),t.u=s.location.href,t.pt=document.title,t.w=s.screen&&s.screen.availWidth?s.screen.availWidth:"",t.h=s.screen&&s.screen.availHeight?s.screen.availHeight:"";var i=Math.round((new Date).getTime()/1e3);return t.ts=i,t["cd[source]"]=this.config[e].source,t},push:function(){var e=Array.prototype.slice.call(arguments),t=e.slice(0,1).toString(),i=e.slice(1),o=u.DEFAULT_TRACKER_NAME;if(-1!==t.indexOf(".")&&(t=(e=t.split(".",2))[1],o=e[0]),this.hasOwnProperty(t))switch(t){case"create":this[t].apply(this,i),l.log("called method `"+t+"` with args below:",i);break;case"setDebug":case"track":case"set":this[t].apply(this,[o].concat(i)),l.log("called method `"+t+"` with args below:",i);break;default:console.error('Calling non-standard method "'+t+"'.")}else console.error('Calling non-standard method "'+t+"'.")},getSessionId:function(e){var t=this.getCookieValue(this.sessionCookieName);return t&&t.match(/^[0-9]+\.[0-9]+$/)||(t=this.generateSessionId()),this.setCookieValue(this.sessionCookieName,t,this.sessionCookieLifetime,this.config[e].domain,"/"),t},generateSessionId:function(){var e=Math.round(+new Date/1e3);return Math.round(Math.random()*e)+"."+e},storeExitClickId:function(e,t){var i=(new Date).valueOf(),o=(this.getCookieValue(this.exitIdCookieName)||"").match(/([^;]+)?;(.*)?\.([0-9]+)/),n={gci:"",gclid:""};this.storeUserComesFromGlamiCookie(t,e.gciObject),(e.gciObject.hash||e.gclidObject.hash)&&(e.timestamp=i,e=e,o&&(n.gci=o[1],n.gclid=o[2],n.timestamp=o[3],!e.gciObject.hash&&n.gci&&(e.gciObject.hash=n.gci),!e.gclidObject.hash&&n.gclid&&(e.gclidObject.hash=n.gclid),n.timestamp&&(e.timestamp=n.timestamp)),(e.gclidObject.hash||e.gciObject.hash)&&(e=(null===e.gciObject.hash?"":e.gciObject.hash)+";"+(null===e.gclidObject.hash?"":e.gclidObject.hash)+"."+e.timestamp,this.setCookieValue(this.exitIdCookieName,e,this.sessionCookieLifetime,this.config[t].domain,"/"),l.log("storing cookie `"+this.exitIdCookieName+"` new value: "+e)))},storeUserComesFromGlamiCookie:function(e,t){var i=this.getGpgObjectFromCookie();void 0===i[t.siteDomain]&&(i[t.siteDomain]=0),null!==t.hash&&(i[t.siteDomain]=1);var o=[];Object.keys(i).forEach(function(e){o.push(e+":"+i[e])});t=o.join(";");l.log("Cookie gp_g: detected value: "+t),t!==r(this.userComesFromGlamiCookieName)?(c(this.userComesFromGlamiCookieName,t,null,this.config[e].domain,"/"),l.log("Cookie gp_g: new value stored")):l.log("Cookie gp_g: value already stored")},getExitClickId:function(){var e=this.getCookieValue(this.exitIdCookieName);return e||!1},getGpgObjectFromCookie:function(){var e=this.getCookieValue(this.userComesFromGlamiCookieName);if(null===e)return[];var t=[];return e.split(";").forEach(function(e){e=e.split(":");2===e.length&&(t[e[0]]=e[1])}),t},getGpG:function(e){var t=this.getGpgObjectFromCookie();return void 0===t[e]?0:t[e]},getParamsHash:function(e){var t,i,o=[];for(t in delete(e=Object.assign({},e)).ts,delete e.sid,e)e.hasOwnProperty(t)&&(i=e[t],o.push(t+":"+i));return o.join()},eventAlreadySent:function(e){for(var t=0,i=this.paramsHashHistory.length;t<i;t++)if(this.paramsHashHistory[t]===e)return!0;return!1},getCookieDomain:function(e){var t="";if("auto"===e){var i=(t=document.domain||location.hostname).split(".");2<i.length&&"www"===i[0]&&(t=i.slice(1).join("."))}else{if(null===e.match(/^\.?([a-z0-9]+\.)*[a-z0-9][a-z0-9-]*\.[a-z]{2,6}$/i))throw new Error("Invalid domain "+e+".");t=0===e.indexOf(".")?e.substr(1):e}return t},getCookieValue:function(e){return 0===this.consent?Object.prototype.hasOwnProperty.call(this.storage,e)?this.storage[e]:null:r(e)},setCookieValue:function(e,t,i,o,n){0!==this.consent?c(e,t,i,o,n):this.storage[e]=t},createDefaultCookies:function(e){var t=r(this.exitIdCookieName);l.log("detected `"+this.exitIdCookieName+"` value: "+t),null===t&&c(this.exitIdCookieName,"0",this.sessionCookieLifetime,this.config[e].domain,"/")},autodetectTrackerName:function(e){if(void 0!==this.config[e])return e;if(1===Object.keys(this.config).length)return Object.keys(this.config)[0];throw new Error('Unknown tracker name "'+e+'".')}};u.DEFAULT_TRACKER_NAME="def",u.DEFAULT_SOURCE_NAME="js",function(){var e=s.GlamiTrackerObject||"glami",t=s[e];if(t&&t.q&&t.q.constructor===Array)for(var i=t.q,o=0,n=i.length;o<n;o++)u.push.apply(u,i[o]);s[e]=u.push.bind(u)}()}();