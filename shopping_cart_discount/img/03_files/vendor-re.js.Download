(function defineMustache(global, factory) {
  if (typeof exports === 'object' && exports) {
    factory(exports);
  } else if (typeof define === 'function' && define.amd) {
    define(['exports'], factory);
  } else {
    global.Mustache = {};
    factory(Mustache);
  }
})(this, function mustacheFactory(mustache) {
  var objectToString = Object.prototype.toString;
  var isArray =
    Array.isArray ||
    function isArrayPolyfill(object) {
      return objectToString.call(object) === '[object Array]';
    };
  function isFunction(object) {
    return typeof object === 'function';
  }
  function escapeRegExp(string) {
    return string.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g, '\\$&');
  }
  function hasProperty(obj, propName) {
    return obj != null && typeof obj === 'object' && propName in obj;
  }
  var regExpTest = RegExp.prototype.test;
  function testRegExp(re, string) {
    return regExpTest.call(re, string);
  }
  var nonSpaceRe = /\S/;
  function isWhitespace(string) {
    return !testRegExp(nonSpaceRe, string);
  }
  var entityMap = { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;', '/': '&#x2F;' };
  function escapeHtml(string) {
    return String(string).replace(/[&<>"'\/]/g, function fromEntityMap(s) {
      return entityMap[s];
    });
  }
  var whiteRe = /\s*/;
  var spaceRe = /\s+/;
  var equalsRe = /\s*=/;
  var curlyRe = /\s*\}/;
  var tagRe = /#|\^|\/|>|\{|&|=|!/;
  function parseTemplate(template, tags) {
    if (!template) return [];
    var sections = [];
    var tokens = [];
    var spaces = [];
    var hasTag = false;
    var nonSpace = false;
    function stripSpace() {
      if (hasTag && !nonSpace) {
        while (spaces.length) delete tokens[spaces.pop()];
      } else {
        spaces = [];
      }
      hasTag = false;
      nonSpace = false;
    }
    var openingTagRe, closingTagRe, closingCurlyRe;
    function compileTags(tagsToCompile) {
      if (typeof tagsToCompile === 'string') tagsToCompile = tagsToCompile.split(spaceRe, 2);
      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2) throw new Error('Invalid tags: ' + tagsToCompile);
      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\s*');
      closingTagRe = new RegExp('\\s*' + escapeRegExp(tagsToCompile[1]));
      closingCurlyRe = new RegExp('\\s*' + escapeRegExp('}' + tagsToCompile[1]));
    }
    compileTags(tags || mustache.tags);
    var scanner = new Scanner(template);
    var start, type, value, chr, token, openSection;
    while (!scanner.eos()) {
      start = scanner.pos;
      value = scanner.scanUntil(openingTagRe);
      if (value) {
        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {
          chr = value.charAt(i);
          if (isWhitespace(chr)) {
            spaces.push(tokens.length);
          } else {
            nonSpace = true;
          }
          tokens.push(['text', chr, start, start + 1]);
          start += 1;
          if (chr === '\n') stripSpace();
        }
      }
      if (!scanner.scan(openingTagRe)) break;
      hasTag = true;
      type = scanner.scan(tagRe) || 'name';
      scanner.scan(whiteRe);
      if (type === '=') {
        value = scanner.scanUntil(equalsRe);
        scanner.scan(equalsRe);
        scanner.scanUntil(closingTagRe);
      } else if (type === '{') {
        value = scanner.scanUntil(closingCurlyRe);
        scanner.scan(curlyRe);
        scanner.scanUntil(closingTagRe);
        type = '&';
      } else {
        value = scanner.scanUntil(closingTagRe);
      }
      if (!scanner.scan(closingTagRe)) throw new Error('Unclosed tag at ' + scanner.pos);
      token = [type, value, start, scanner.pos];
      tokens.push(token);
      if (type === '#' || type === '^') {
        sections.push(token);
      } else if (type === '/') {
        openSection = sections.pop();
        if (!openSection) throw new Error('Unopened section "' + value + '" at ' + start);
        if (openSection[1] !== value) throw new Error('Unclosed section "' + openSection[1] + '" at ' + start);
      } else if (type === 'name' || type === '{' || type === '&') {
        nonSpace = true;
      } else if (type === '=') {
        compileTags(value);
      }
    }
    openSection = sections.pop();
    if (openSection) throw new Error('Unclosed section "' + openSection[1] + '" at ' + scanner.pos);
    return nestTokens(squashTokens(tokens));
  }
  function squashTokens(tokens) {
    var squashedTokens = [];
    var token, lastToken;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];
      if (token) {
        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {
          lastToken[1] += token[1];
          lastToken[3] = token[3];
        } else {
          squashedTokens.push(token);
          lastToken = token;
        }
      }
    }
    return squashedTokens;
  }
  function nestTokens(tokens) {
    var nestedTokens = [];
    var collector = nestedTokens;
    var sections = [];
    var token, section;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      token = tokens[i];
      switch (token[0]) {
        case '#':
        case '^':
          collector.push(token);
          sections.push(token);
          collector = token[4] = [];
          break;
        case '/':
          section = sections.pop();
          section[5] = token[2];
          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;
          break;
        default:
          collector.push(token);
      }
    }
    return nestedTokens;
  }
  function Scanner(string) {
    this.string = string;
    this.tail = string;
    this.pos = 0;
  }
  Scanner.prototype.eos = function eos() {
    return this.tail === '';
  };
  Scanner.prototype.scan = function scan(re) {
    var match = this.tail.match(re);
    if (!match || match.index !== 0) return '';
    var string = match[0];
    this.tail = this.tail.substring(string.length);
    this.pos += string.length;
    return string;
  };
  Scanner.prototype.scanUntil = function scanUntil(re) {
    var index = this.tail.search(re),
      match;
    switch (index) {
      case -1:
        match = this.tail;
        this.tail = '';
        break;
      case 0:
        match = '';
        break;
      default:
        match = this.tail.substring(0, index);
        this.tail = this.tail.substring(index);
    }
    this.pos += match.length;
    return match;
  };
  function Context(view, parentContext) {
    this.view = view;
    this.cache = { '.': this.view };
    this.parent = parentContext;
  }
  Context.prototype.push = function push(view) {
    return new Context(view, this);
  };
  Context.prototype.lookup = function lookup(name) {
    var cache = this.cache;
    var value;
    if (cache.hasOwnProperty(name)) {
      value = cache[name];
    } else {
      var context = this,
        names,
        index,
        lookupHit = false;
      while (context) {
        if (name.indexOf('.') > 0) {
          value = context.view;
          names = name.split('.');
          index = 0;
          while (value != null && index < names.length) {
            if (index === names.length - 1) lookupHit = hasProperty(value, names[index]);
            value = value[names[index++]];
          }
        } else {
          value = context.view[name];
          lookupHit = hasProperty(context.view, name);
        }
        if (lookupHit) break;
        context = context.parent;
      }
      cache[name] = value;
    }
    if (isFunction(value)) value = value.call(this.view);
    return value;
  };
  function Writer() {
    this.cache = {};
  }
  Writer.prototype.clearCache = function clearCache() {
    this.cache = {};
  };
  Writer.prototype.parse = function parse(template, tags) {
    var cache = this.cache;
    var tokens = cache[template];
    if (tokens == null) tokens = cache[template] = parseTemplate(template, tags);
    return tokens;
  };
  Writer.prototype.render = function render(template, view, partials) {
    var tokens = this.parse(template);
    var context = view instanceof Context ? view : new Context(view);
    return this.renderTokens(tokens, context, partials, template);
  };
  Writer.prototype.renderTokens = function renderTokens(tokens, context, partials, originalTemplate) {
    var buffer = '';
    var token, symbol, value;
    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {
      value = undefined;
      token = tokens[i];
      symbol = token[0];
      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);
      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);
      else if (symbol === '>') value = this.renderPartial(token, context, partials, originalTemplate);
      else if (symbol === '&') value = this.unescapedValue(token, context);
      else if (symbol === 'name') value = this.escapedValue(token, context);
      else if (symbol === 'text') value = this.rawValue(token);
      if (value !== undefined) buffer += value;
    }
    return buffer;
  };
  Writer.prototype.renderSection = function renderSection(token, context, partials, originalTemplate) {
    var self = this;
    var buffer = '';
    var value = context.lookup(token[1]);
    function subRender(template) {
      return self.render(template, context, partials);
    }
    if (!value) return;
    if (isArray(value)) {
      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {
        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);
      }
    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {
      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);
    } else if (isFunction(value)) {
      if (typeof originalTemplate !== 'string')
        throw new Error('Cannot use higher-order sections without the original template');
      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);
      if (value != null) buffer += value;
    } else {
      buffer += this.renderTokens(token[4], context, partials, originalTemplate);
    }
    return buffer;
  };
  Writer.prototype.renderInverted = function renderInverted(token, context, partials, originalTemplate) {
    var value = context.lookup(token[1]);
    if (!value || (isArray(value) && value.length === 0))
      return this.renderTokens(token[4], context, partials, originalTemplate);
  };
  Writer.prototype.renderPartial = function renderPartial(token, context, partials) {
    if (!partials) return;
    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];
    if (value != null) return this.renderTokens(this.parse(value), context, partials, value);
  };
  Writer.prototype.unescapedValue = function unescapedValue(token, context) {
    var value = context.lookup(token[1]);
    if (value != null) return value;
  };
  Writer.prototype.escapedValue = function escapedValue(token, context) {
    var value = context.lookup(token[1]);
    if (value != null) return mustache.escape(value);
  };
  Writer.prototype.rawValue = function rawValue(token) {
    return token[1];
  };
  mustache.name = 'mustache.js';
  mustache.version = '2.1.2';
  mustache.tags = ['{{', '}}'];
  var defaultWriter = new Writer();
  mustache.clearCache = function clearCache() {
    return defaultWriter.clearCache();
  };
  mustache.parse = function parse(template, tags) {
    return defaultWriter.parse(template, tags);
  };
  mustache.render = function render(template, view, partials) {
    return defaultWriter.render(template, view, partials);
  };
  mustache.to_html = function to_html(template, view, partials, send) {
    var result = mustache.render(template, view, partials);
    if (isFunction(send)) {
      send(result);
    } else {
      return result;
    }
  };
  mustache.escape = escapeHtml;
  mustache.Scanner = Scanner;
  mustache.Context = Context;
  mustache.Writer = Writer;
});

/*
CSS Browser Selector v0.4.0 (Nov 02, 2010)
Rafael Lima (http://rafael.adm.br)
http://rafael.adm.br/css_browser_selector
License: http://creativecommons.org/licenses/by/2.5/
Contributors: http://rafael.adm.br/css_browser_selector#contributors
*/
function css_browser_selector(u) {
  var ua = u.toLowerCase(),
    is = function(t) {
      return ua.indexOf(t) > -1;
    },
    g = 'gecko',
    w = 'webkit',
    s = 'safari',
    o = 'opera',
    m = 'mobile',
    h = document.documentElement,
    b = [
      !/opera|webtv/i.test(ua) && /msie\s(\d)/.test(ua)
        ? 'ie ie' + RegExp.$1
        : is('firefox/2')
        ? g + ' ff2'
        : is('firefox/3.5')
        ? g + ' ff3 ff3_5'
        : is('firefox/3.6')
        ? g + ' ff3 ff3_6'
        : is('firefox/3')
        ? g + ' ff3'
        : is('gecko/')
        ? g
        : is('opera')
        ? o +
          (/version\/(\d+)/.test(ua) ? ' ' + o + RegExp.$1 : /opera(\s|\/)(\d+)/.test(ua) ? ' ' + o + RegExp.$2 : '')
        : is('konqueror')
        ? 'konqueror'
        : is('blackberry')
        ? m + ' blackberry'
        : is('android')
        ? m + ' android'
        : is('chrome')
        ? w + ' chrome'
        : is('iron')
        ? w + ' iron'
        : is('applewebkit/')
        ? w + ' ' + s + (/version\/(\d+)/.test(ua) ? ' ' + s + RegExp.$1 : '')
        : is('mozilla/')
        ? g
        : '',
      is('j2me')
        ? m + ' j2me'
        : is('iphone')
        ? m + ' iphone'
        : is('ipod')
        ? m + ' ipod'
        : is('ipad')
        ? m + ' ipad'
        : is('mac')
        ? 'mac'
        : is('darwin')
        ? 'mac'
        : is('webtv')
        ? 'webtv'
        : is('win')
        ? 'win' + (is('windows nt 6.0') ? ' vista' : '')
        : is('freebsd')
        ? 'freebsd'
        : is('x11') || is('linux')
        ? 'linux'
        : '',
      'js',
    ];
  c = b.join(' ');
  h.className += ' ' + c;
  return c;
}
css_browser_selector(navigator.userAgent);

/*! lazysizes - v4.0.1 */
!(function(a, b) {
  var c = b(a, a.document);
  (a.lazySizes = c), 'object' == typeof module && module.exports && (module.exports = c);
})(window, function(a, b) {
  'use strict';
  if (b.getElementsByClassName) {
    var c,
      d,
      e = b.documentElement,
      f = a.Date,
      g = a.HTMLPictureElement,
      h = 'addEventListener',
      i = 'getAttribute',
      j = a[h],
      k = a.setTimeout,
      l = a.requestAnimationFrame || k,
      m = a.requestIdleCallback,
      n = /^picture$/i,
      o = ['load', 'error', 'lazyincluded', '_lazyloaded'],
      p = {},
      q = Array.prototype.forEach,
      r = function(a, b) {
        return p[b] || (p[b] = new RegExp('(\\s|^)' + b + '(\\s|$)')), p[b].test(a[i]('class') || '') && p[b];
      },
      s = function(a, b) {
        r(a, b) || a.setAttribute('class', (a[i]('class') || '').trim() + ' ' + b);
      },
      t = function(a, b) {
        var c;
        (c = r(a, b)) && a.setAttribute('class', (a[i]('class') || '').replace(c, ' '));
      },
      u = function(a, b, c) {
        var d = c ? h : 'removeEventListener';
        c && u(a, b),
          o.forEach(function(c) {
            a[d](c, b);
          });
      },
      v = function(a, d, e, f, g) {
        var h = b.createEvent('CustomEvent');
        return e || (e = {}), (e.instance = c), h.initCustomEvent(d, !f, !g, e), a.dispatchEvent(h), h;
      },
      w = function(b, c) {
        var e;
        !g && (e = a.picturefill || d.pf) ? e({ reevaluate: !0, elements: [b] }) : c && c.src && (b.src = c.src);
      },
      x = function(a, b) {
        return (getComputedStyle(a, null) || {})[b];
      },
      y = function(a, b, c) {
        for (c = c || a.offsetWidth; c < d.minSize && b && !a._lazysizesWidth; )
          (c = b.offsetWidth), (b = b.parentNode);
        return c;
      },
      z = (function() {
        var a,
          c,
          d = [],
          e = [],
          f = d,
          g = function() {
            var b = f;
            for (f = d.length ? e : d, a = !0, c = !1; b.length; ) b.shift()();
            a = !1;
          },
          h = function(d, e) {
            a && !e ? d.apply(this, arguments) : (f.push(d), c || ((c = !0), (b.hidden ? k : l)(g)));
          };
        return (h._lsFlush = g), h;
      })(),
      A = function(a, b) {
        return b
          ? function() {
              z(a);
            }
          : function() {
              var b = this,
                c = arguments;
              z(function() {
                a.apply(b, c);
              });
            };
      },
      B = function(a) {
        var b,
          c = 0,
          e = 125,
          g = d.ricTimeout,
          h = function() {
            (b = !1), (c = f.now()), a();
          },
          i =
            m && d.ricTimeout
              ? function() {
                  m(h, { timeout: g }), g !== d.ricTimeout && (g = d.ricTimeout);
                }
              : A(function() {
                  k(h);
                }, !0);
        return function(a) {
          var d;
          (a = a === !0) && (g = 33),
            b || ((b = !0), (d = e - (f.now() - c)), 0 > d && (d = 0), a || (9 > d && m) ? i() : k(i, d));
        };
      },
      C = function(a) {
        var b,
          c,
          d = 99,
          e = function() {
            (b = null), a();
          },
          g = function() {
            var a = f.now() - c;
            d > a ? k(g, d - a) : (m || e)(e);
          };
        return function() {
          (c = f.now()), b || (b = k(g, d));
        };
      };
    !(function() {
      var b,
        c = {
          lazyClass: 'lazyload',
          loadedClass: 'lazyloaded',
          loadingClass: 'lazyloading',
          preloadClass: 'lazypreload',
          errorClass: 'lazyerror',
          autosizesClass: 'lazyautosizes',
          srcAttr: 'data-src',
          srcsetAttr: 'data-srcset',
          sizesAttr: 'data-sizes',
          minSize: 40,
          customMedia: {},
          init: !0,
          expFactor: 1.5,
          hFac: 0.8,
          loadMode: 2,
          loadHidden: !0,
          ricTimeout: 300,
        };
      d = a.lazySizesConfig || a.lazysizesConfig || {};
      for (b in c) b in d || (d[b] = c[b]);
      (a.lazySizesConfig = d),
        k(function() {
          d.init && F();
        });
    })();
    var D = (function() {
        var g,
          l,
          m,
          o,
          p,
          y,
          D,
          F,
          G,
          H,
          I,
          J,
          K,
          L,
          M = /^img$/i,
          N = /^iframe$/i,
          O = 'onscroll' in a && !/glebot/.test(navigator.userAgent),
          P = 0,
          Q = 0,
          R = 0,
          S = -1,
          T = function(a) {
            R--, a && a.target && u(a.target, T), (!a || 0 > R || !a.target) && (R = 0);
          },
          U = function(a, c) {
            var d,
              f = a,
              g = 'hidden' == x(b.body, 'visibility') || 'hidden' != x(a, 'visibility');
            for (F -= c, I += c, G -= c, H += c; g && (f = f.offsetParent) && f != b.body && f != e; )
              (g = (x(f, 'opacity') || 1) > 0),
                g &&
                  'visible' != x(f, 'overflow') &&
                  ((d = f.getBoundingClientRect()),
                  (g = H > d.left && G < d.right && I > d.top - 1 && F < d.bottom + 1));
            return g;
          },
          V = function() {
            var a,
              f,
              h,
              j,
              k,
              m,
              n,
              p,
              q,
              r = c.elements;
            if ((o = d.loadMode) && 8 > R && (a = r.length)) {
              (f = 0),
                S++,
                null == K &&
                  ('expand' in d || (d.expand = e.clientHeight > 500 && e.clientWidth > 500 ? 500 : 370),
                  (J = d.expand),
                  (K = J * d.expFactor)),
                K > Q && 1 > R && S > 2 && o > 2 && !b.hidden
                  ? ((Q = K), (S = 0))
                  : (Q = o > 1 && S > 1 && 6 > R ? J : P);
              for (; a > f; f++)
                if (r[f] && !r[f]._lazyRace)
                  if (O)
                    if (
                      (((p = r[f][i]('data-expand')) && (m = 1 * p)) || (m = Q),
                      q !== m && ((y = innerWidth + m * L), (D = innerHeight + m), (n = -1 * m), (q = m)),
                      (h = r[f].getBoundingClientRect()),
                      (I = h.bottom) >= n &&
                        (F = h.top) <= D &&
                        (H = h.right) >= n * L &&
                        (G = h.left) <= y &&
                        (I || H || G || F) &&
                        (d.loadHidden || 'hidden' != x(r[f], 'visibility')) &&
                        ((l && 3 > R && !p && (3 > o || 4 > S)) || U(r[f], m)))
                    ) {
                      if ((ba(r[f]), (k = !0), R > 9)) break;
                    } else
                      !k &&
                        l &&
                        !j &&
                        4 > R &&
                        4 > S &&
                        o > 2 &&
                        (g[0] || d.preloadAfterLoad) &&
                        (g[0] || (!p && (I || H || G || F || 'auto' != r[f][i](d.sizesAttr)))) &&
                        (j = g[0] || r[f]);
                  else ba(r[f]);
              j && !k && ba(j);
            }
          },
          W = B(V),
          X = function(a) {
            s(a.target, d.loadedClass), t(a.target, d.loadingClass), u(a.target, Z), v(a.target, 'lazyloaded');
          },
          Y = A(X),
          Z = function(a) {
            Y({ target: a.target });
          },
          $ = function(a, b) {
            try {
              a.contentWindow.location.replace(b);
            } catch (c) {
              a.src = b;
            }
          },
          _ = function(a) {
            var b,
              c = a[i](d.srcsetAttr);
            (b = d.customMedia[a[i]('data-media') || a[i]('media')]) && a.setAttribute('media', b),
              c && a.setAttribute('srcset', c);
          },
          aa = A(function(a, b, c, e, f) {
            var g, h, j, l, o, p;
            (o = v(a, 'lazybeforeunveil', b)).defaultPrevented ||
              (e && (c ? s(a, d.autosizesClass) : a.setAttribute('sizes', e)),
              (h = a[i](d.srcsetAttr)),
              (g = a[i](d.srcAttr)),
              f && ((j = a.parentNode), (l = j && n.test(j.nodeName || ''))),
              (p = b.firesLoad || ('src' in a && (h || g || l))),
              (o = { target: a }),
              p && (u(a, T, !0), clearTimeout(m), (m = k(T, 2500)), s(a, d.loadingClass), u(a, Z, !0)),
              l && q.call(j.getElementsByTagName('source'), _),
              h ? a.setAttribute('srcset', h) : g && !l && (N.test(a.nodeName) ? $(a, g) : (a.src = g)),
              f && (h || l) && w(a, { src: g })),
              a._lazyRace && delete a._lazyRace,
              t(a, d.lazyClass),
              z(function() {
                (!p || (a.complete && a.naturalWidth > 1)) && (p ? T(o) : R--, X(o));
              }, !0);
          }),
          ba = function(a) {
            var b,
              c = M.test(a.nodeName),
              e = c && (a[i](d.sizesAttr) || a[i]('sizes')),
              f = 'auto' == e;
            ((!f && l) ||
              !c ||
              (!a[i]('src') && !a.srcset) ||
              a.complete ||
              r(a, d.errorClass) ||
              !r(a, d.lazyClass)) &&
              ((b = v(a, 'lazyunveilread').detail),
              f && E.updateElem(a, !0, a.offsetWidth),
              (a._lazyRace = !0),
              R++,
              aa(a, b, f, e, c));
          },
          ca = function() {
            if (!l) {
              if (f.now() - p < 999) return void k(ca, 999);
              var a = C(function() {
                (d.loadMode = 3), W();
              });
              (l = !0),
                (d.loadMode = 3),
                W(),
                j(
                  'scroll',
                  function() {
                    3 == d.loadMode && (d.loadMode = 2), a();
                  },
                  !0
                );
            }
          };
        return {
          _: function() {
            (p = f.now()),
              (c.elements = b.getElementsByClassName(d.lazyClass)),
              (g = b.getElementsByClassName(d.lazyClass + ' ' + d.preloadClass)),
              (L = d.hFac),
              j('scroll', W, !0),
              j('resize', W, !0),
              a.MutationObserver
                ? new MutationObserver(W).observe(e, { childList: !0, subtree: !0, attributes: !0 })
                : (e[h]('DOMNodeInserted', W, !0), e[h]('DOMAttrModified', W, !0), setInterval(W, 999)),
              j('hashchange', W, !0),
              ['focus', 'mouseover', 'click', 'load', 'transitionend', 'animationend', 'webkitAnimationEnd'].forEach(
                function(a) {
                  b[h](a, W, !0);
                }
              ),
              /d$|^c/.test(b.readyState) ? ca() : (j('load', ca), b[h]('DOMContentLoaded', W), k(ca, 2e4)),
              c.elements.length ? (V(), z._lsFlush()) : W();
          },
          checkElems: W,
          unveil: ba,
        };
      })(),
      E = (function() {
        var a,
          c = A(function(a, b, c, d) {
            var e, f, g;
            if (((a._lazysizesWidth = d), (d += 'px'), a.setAttribute('sizes', d), n.test(b.nodeName || '')))
              for (e = b.getElementsByTagName('source'), f = 0, g = e.length; g > f; f++) e[f].setAttribute('sizes', d);
            c.detail.dataAttr || w(a, c.detail);
          }),
          e = function(a, b, d) {
            var e,
              f = a.parentNode;
            f &&
              ((d = y(a, f, d)),
              (e = v(a, 'lazybeforesizes', { width: d, dataAttr: !!b })),
              e.defaultPrevented || ((d = e.detail.width), d && d !== a._lazysizesWidth && c(a, f, e, d)));
          },
          f = function() {
            var b,
              c = a.length;
            if (c) for (b = 0; c > b; b++) e(a[b]);
          },
          g = C(f);
        return {
          _: function() {
            (a = b.getElementsByClassName(d.autosizesClass)), j('resize', g);
          },
          checkElems: g,
          updateElem: e,
        };
      })(),
      F = function() {
        F.i || ((F.i = !0), E._(), D._());
      };
    return (c = { cfg: d, autoSizer: E, loader: D, init: F, uP: w, aC: s, rC: t, hC: r, fire: v, gW: y, rAF: z });
  }
});

//fgnass.github.com/spin.js#v2.0.1
!(function(a, b) {
  'object' == typeof exports
    ? (module.exports = b())
    : 'function' == typeof define && define.amd
    ? define(b)
    : (a.Spinner = b());
})(this, function() {
  'use strict';
  function a(a, b) {
    var c,
      d = document.createElement(a || 'div');
    for (c in b) d[c] = b[c];
    return d;
  }
  function b(a) {
    for (var b = 1, c = arguments.length; c > b; b++) a.appendChild(arguments[b]);
    return a;
  }
  function c(a, b, c, d) {
    var e = ['opacity', b, ~~(100 * a), c, d].join('-'),
      f = 0.01 + (c / d) * 100,
      g = Math.max(1 - ((1 - a) / b) * (100 - f), a),
      h = j.substring(0, j.indexOf('Animation')).toLowerCase(),
      i = (h && '-' + h + '-') || '';
    return (
      l[e] ||
        (m.insertRule(
          '@' +
            i +
            'keyframes ' +
            e +
            '{0%{opacity:' +
            g +
            '}' +
            f +
            '%{opacity:' +
            a +
            '}' +
            (f + 0.01) +
            '%{opacity:1}' +
            ((f + b) % 100) +
            '%{opacity:' +
            a +
            '}100%{opacity:' +
            g +
            '}}',
          m.cssRules.length
        ),
        (l[e] = 1)),
      e
    );
  }
  function d(a, b) {
    var c,
      d,
      e = a.style;
    for (b = b.charAt(0).toUpperCase() + b.slice(1), d = 0; d < k.length; d++)
      if (((c = k[d] + b), void 0 !== e[c])) return c;
    return void 0 !== e[b] ? b : void 0;
  }
  function e(a, b) {
    for (var c in b) a.style[d(a, c) || c] = b[c];
    return a;
  }
  function f(a) {
    for (var b = 1; b < arguments.length; b++) {
      var c = arguments[b];
      for (var d in c) void 0 === a[d] && (a[d] = c[d]);
    }
    return a;
  }
  function g(a, b) {
    return 'string' == typeof a ? a : a[b % a.length];
  }
  function h(a) {
    this.opts = f(a || {}, h.defaults, n);
  }
  function i() {
    function c(b, c) {
      return a('<' + b + ' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">', c);
    }
    m.addRule('.spin-vml', 'behavior:url(#default#VML)'),
      (h.prototype.lines = function(a, d) {
        function f() {
          return e(c('group', { coordsize: k + ' ' + k, coordorigin: -j + ' ' + -j }), { width: k, height: k });
        }
        function h(a, h, i) {
          b(
            m,
            b(
              e(f(), { rotation: (360 / d.lines) * a + 'deg', left: ~~h }),
              b(
                e(c('roundrect', { arcsize: d.corners }), {
                  width: j,
                  height: d.width,
                  left: d.radius,
                  top: -d.width >> 1,
                  filter: i,
                }),
                c('fill', { color: g(d.color, a), opacity: d.opacity }),
                c('stroke', { opacity: 0 })
              )
            )
          );
        }
        var i,
          j = d.length + d.width,
          k = 2 * j,
          l = 2 * -(d.width + d.length) + 'px',
          m = e(f(), { position: 'absolute', top: l, left: l });
        if (d.shadow)
          for (i = 1; i <= d.lines; i++)
            h(i, -2, 'progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)');
        for (i = 1; i <= d.lines; i++) h(i);
        return b(a, m);
      }),
      (h.prototype.opacity = function(a, b, c, d) {
        var e = a.firstChild;
        (d = (d.shadow && d.lines) || 0),
          e &&
            b + d < e.childNodes.length &&
            ((e = e.childNodes[b + d]), (e = e && e.firstChild), (e = e && e.firstChild), e && (e.opacity = c));
      });
  }
  var j,
    k = ['webkit', 'Moz', 'ms', 'O'],
    l = {},
    m = (function() {
      var c = a('style', { type: 'text/css' });
      return b(document.getElementsByTagName('head')[0], c), c.sheet || c.styleSheet;
    })(),
    n = {
      lines: 12,
      length: 7,
      width: 5,
      radius: 10,
      rotate: 0,
      corners: 1,
      color: '#000',
      direction: 1,
      speed: 1,
      trail: 100,
      opacity: 0.25,
      fps: 20,
      zIndex: 2e9,
      className: 'spinner',
      top: '50%',
      left: '50%',
      position: 'absolute',
    };
  (h.defaults = {}),
    f(h.prototype, {
      spin: function(b) {
        this.stop();
        {
          var c = this,
            d = c.opts,
            f = (c.el = e(a(0, { className: d.className }), { position: d.position, width: 0, zIndex: d.zIndex }));
          d.radius + d.length + d.width;
        }
        if (
          (e(f, { left: d.left, top: d.top }),
          b && b.insertBefore(f, b.firstChild || null),
          f.setAttribute('role', 'progressbar'),
          c.lines(f, c.opts),
          !j)
        ) {
          var g,
            h = 0,
            i = ((d.lines - 1) * (1 - d.direction)) / 2,
            k = d.fps,
            l = k / d.speed,
            m = (1 - d.opacity) / ((l * d.trail) / 100),
            n = l / d.lines;
          !(function o() {
            h++;
            for (var a = 0; a < d.lines; a++)
              (g = Math.max(1 - ((h + (d.lines - a) * n) % l) * m, d.opacity)), c.opacity(f, a * d.direction + i, g, d);
            c.timeout = c.el && setTimeout(o, ~~(1e3 / k));
          })();
        }
        return c;
      },
      stop: function() {
        var a = this.el;
        return a && (clearTimeout(this.timeout), a.parentNode && a.parentNode.removeChild(a), (this.el = void 0)), this;
      },
      lines: function(d, f) {
        function h(b, c) {
          return e(a(), {
            position: 'absolute',
            width: f.length + f.width + 'px',
            height: f.width + 'px',
            background: b,
            boxShadow: c,
            transformOrigin: 'left',
            transform: 'rotate(' + ~~((360 / f.lines) * k + f.rotate) + 'deg) translate(' + f.radius + 'px,0)',
            borderRadius: ((f.corners * f.width) >> 1) + 'px',
          });
        }
        for (var i, k = 0, l = ((f.lines - 1) * (1 - f.direction)) / 2; k < f.lines; k++)
          (i = e(a(), {
            position: 'absolute',
            top: 1 + ~(f.width / 2) + 'px',
            transform: f.hwaccel ? 'translate3d(0,0,0)' : '',
            opacity: f.opacity,
            animation:
              j && c(f.opacity, f.trail, l + k * f.direction, f.lines) + ' ' + 1 / f.speed + 's linear infinite',
          })),
            f.shadow && b(i, e(h('#000', '0 0 4px #000'), { top: '2px' })),
            b(d, b(i, h(g(f.color, k), '0 0 1px rgba(0,0,0,.1)')));
        return d;
      },
      opacity: function(a, b, c) {
        b < a.childNodes.length && (a.childNodes[b].style.opacity = c);
      },
    });
  var o = e(a('group'), { behavior: 'url(#default#VML)' });
  return !d(o, 'transform') && o.adj ? i() : (j = d(o, 'animation')), h;
});

/*! jQuery v1.10.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-1.10.2.min.map
*/
(function(e, t) {
  var n,
    r,
    i = typeof t,
    o = e.location,
    a = e.document,
    s = a.documentElement,
    l = e.jQuery,
    u = e.$,
    c = {},
    p = [],
    f = '1.10.2',
    d = p.concat,
    h = p.push,
    g = p.slice,
    m = p.indexOf,
    y = c.toString,
    v = c.hasOwnProperty,
    b = f.trim,
    x = function(e, t) {
      return new x.fn.init(e, t, r);
    },
    w = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
    T = /\S+/g,
    C = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
    N = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
    k = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
    E = /^[\],:{}\s]*$/,
    S = /(?:^|:|,)(?:\s*\[)+/g,
    A = /\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,
    j = /"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,
    D = /^-ms-/,
    L = /-([\da-z])/gi,
    H = function(e, t) {
      return t.toUpperCase();
    },
    q = function(e) {
      (a.addEventListener || 'load' === e.type || 'complete' === a.readyState) && (_(), x.ready());
    },
    _ = function() {
      a.addEventListener
        ? (a.removeEventListener('DOMContentLoaded', q, !1), e.removeEventListener('load', q, !1))
        : (a.detachEvent('onreadystatechange', q), e.detachEvent('onload', q));
    };
  (x.fn = x.prototype = {
    jquery: f,
    constructor: x,
    init: function(e, n, r) {
      var i, o;
      if (!e) return this;
      if ('string' == typeof e) {
        if (
          ((i = '<' === e.charAt(0) && '>' === e.charAt(e.length - 1) && e.length >= 3 ? [null, e, null] : N.exec(e)),
          !i || (!i[1] && n))
        )
          return !n || n.jquery ? (n || r).find(e) : this.constructor(n).find(e);
        if (i[1]) {
          if (
            ((n = n instanceof x ? n[0] : n),
            x.merge(this, x.parseHTML(i[1], n && n.nodeType ? n.ownerDocument || n : a, !0)),
            k.test(i[1]) && x.isPlainObject(n))
          )
            for (i in n) x.isFunction(this[i]) ? this[i](n[i]) : this.attr(i, n[i]);
          return this;
        }
        if (((o = a.getElementById(i[2])), o && o.parentNode)) {
          if (o.id !== i[2]) return r.find(e);
          (this.length = 1), (this[0] = o);
        }
        return (this.context = a), (this.selector = e), this;
      }
      return e.nodeType
        ? ((this.context = this[0] = e), (this.length = 1), this)
        : x.isFunction(e)
        ? r.ready(e)
        : (e.selector !== t && ((this.selector = e.selector), (this.context = e.context)), x.makeArray(e, this));
    },
    selector: '',
    length: 0,
    toArray: function() {
      return g.call(this);
    },
    get: function(e) {
      return null == e ? this.toArray() : 0 > e ? this[this.length + e] : this[e];
    },
    pushStack: function(e) {
      var t = x.merge(this.constructor(), e);
      return (t.prevObject = this), (t.context = this.context), t;
    },
    each: function(e, t) {
      return x.each(this, e, t);
    },
    ready: function(e) {
      return x.ready.promise().done(e), this;
    },
    slice: function() {
      return this.pushStack(g.apply(this, arguments));
    },
    first: function() {
      return this.eq(0);
    },
    last: function() {
      return this.eq(-1);
    },
    eq: function(e) {
      var t = this.length,
        n = +e + (0 > e ? t : 0);
      return this.pushStack(n >= 0 && t > n ? [this[n]] : []);
    },
    map: function(e) {
      return this.pushStack(
        x.map(this, function(t, n) {
          return e.call(t, n, t);
        })
      );
    },
    end: function() {
      return this.prevObject || this.constructor(null);
    },
    push: h,
    sort: [].sort,
    splice: [].splice,
  }),
    (x.fn.init.prototype = x.fn),
    (x.extend = x.fn.extend = function() {
      var e,
        n,
        r,
        i,
        o,
        a,
        s = arguments[0] || {},
        l = 1,
        u = arguments.length,
        c = !1;
      for (
        'boolean' == typeof s && ((c = s), (s = arguments[1] || {}), (l = 2)),
          'object' == typeof s || x.isFunction(s) || (s = {}),
          u === l && ((s = this), --l);
        u > l;
        l++
      )
        if (null != (o = arguments[l]))
          for (i in o)
            (e = s[i]),
              (r = o[i]),
              s !== r &&
                (c && r && (x.isPlainObject(r) || (n = x.isArray(r)))
                  ? (n ? ((n = !1), (a = e && x.isArray(e) ? e : [])) : (a = e && x.isPlainObject(e) ? e : {}),
                    (s[i] = x.extend(c, a, r)))
                  : r !== t && (s[i] = r));
      return s;
    }),
    x.extend({
      expando: 'jQuery' + (f + Math.random()).replace(/\D/g, ''),
      noConflict: function(t) {
        return e.$ === x && (e.$ = u), t && e.jQuery === x && (e.jQuery = l), x;
      },
      isReady: !1,
      readyWait: 1,
      holdReady: function(e) {
        e ? x.readyWait++ : x.ready(!0);
      },
      ready: function(e) {
        if (e === !0 ? !--x.readyWait : !x.isReady) {
          if (!a.body) return setTimeout(x.ready);
          (x.isReady = !0),
            (e !== !0 && --x.readyWait > 0) ||
              (n.resolveWith(a, [x]),
              x.fn.trigger &&
                x(a)
                  .trigger('ready')
                  .off('ready'));
        }
      },
      isFunction: function(e) {
        return 'function' === x.type(e);
      },
      isArray:
        Array.isArray ||
        function(e) {
          return 'array' === x.type(e);
        },
      isWindow: function(e) {
        return null != e && e == e.window;
      },
      isNumeric: function(e) {
        return !isNaN(parseFloat(e)) && isFinite(e);
      },
      type: function(e) {
        return null == e
          ? e + ''
          : 'object' == typeof e || 'function' == typeof e
          ? c[y.call(e)] || 'object'
          : typeof e;
      },
      isPlainObject: function(e) {
        var n;
        if (!e || 'object' !== x.type(e) || e.nodeType || x.isWindow(e)) return !1;
        try {
          if (e.constructor && !v.call(e, 'constructor') && !v.call(e.constructor.prototype, 'isPrototypeOf'))
            return !1;
        } catch (r) {
          return !1;
        }
        if (x.support.ownLast) for (n in e) return v.call(e, n);
        for (n in e);
        return n === t || v.call(e, n);
      },
      isEmptyObject: function(e) {
        var t;
        for (t in e) return !1;
        return !0;
      },
      error: function(e) {
        throw Error(e);
      },
      parseHTML: function(e, t, n) {
        if (!e || 'string' != typeof e) return null;
        'boolean' == typeof t && ((n = t), (t = !1)), (t = t || a);
        var r = k.exec(e),
          i = !n && [];
        return r
          ? [t.createElement(r[1])]
          : ((r = x.buildFragment([e], t, i)), i && x(i).remove(), x.merge([], r.childNodes));
      },
      parseJSON: function(n) {
        return e.JSON && e.JSON.parse
          ? e.JSON.parse(n)
          : null === n
          ? n
          : 'string' == typeof n &&
            ((n = x.trim(n)),
            n &&
              E.test(
                n
                  .replace(A, '@')
                  .replace(j, ']')
                  .replace(S, '')
              ))
          ? Function('return ' + n)()
          : (x.error('Invalid JSON: ' + n), t);
      },
      parseXML: function(n) {
        var r, i;
        if (!n || 'string' != typeof n) return null;
        try {
          e.DOMParser
            ? ((i = new DOMParser()), (r = i.parseFromString(n, 'text/xml')))
            : ((r = new ActiveXObject('Microsoft.XMLDOM')), (r.async = 'false'), r.loadXML(n));
        } catch (o) {
          r = t;
        }
        return (
          (r && r.documentElement && !r.getElementsByTagName('parsererror').length) || x.error('Invalid XML: ' + n), r
        );
      },
      noop: function() {},
      globalEval: function(t) {
        t &&
          x.trim(t) &&
          (
            e.execScript ||
            function(t) {
              e.eval.call(e, t);
            }
          )(t);
      },
      camelCase: function(e) {
        return e.replace(D, 'ms-').replace(L, H);
      },
      nodeName: function(e, t) {
        return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase();
      },
      each: function(e, t, n) {
        var r,
          i = 0,
          o = e.length,
          a = M(e);
        if (n) {
          if (a) {
            for (; o > i; i++) if (((r = t.apply(e[i], n)), r === !1)) break;
          } else for (i in e) if (((r = t.apply(e[i], n)), r === !1)) break;
        } else if (a) {
          for (; o > i; i++) if (((r = t.call(e[i], i, e[i])), r === !1)) break;
        } else for (i in e) if (((r = t.call(e[i], i, e[i])), r === !1)) break;
        return e;
      },
      trim:
        b && !b.call('\ufeff\u00a0')
          ? function(e) {
              return null == e ? '' : b.call(e);
            }
          : function(e) {
              return null == e ? '' : (e + '').replace(C, '');
            },
      makeArray: function(e, t) {
        var n = t || [];
        return null != e && (M(Object(e)) ? x.merge(n, 'string' == typeof e ? [e] : e) : h.call(n, e)), n;
      },
      inArray: function(e, t, n) {
        var r;
        if (t) {
          if (m) return m.call(t, e, n);
          for (r = t.length, n = n ? (0 > n ? Math.max(0, r + n) : n) : 0; r > n; n++)
            if (n in t && t[n] === e) return n;
        }
        return -1;
      },
      merge: function(e, n) {
        var r = n.length,
          i = e.length,
          o = 0;
        if ('number' == typeof r) for (; r > o; o++) e[i++] = n[o];
        else while (n[o] !== t) e[i++] = n[o++];
        return (e.length = i), e;
      },
      grep: function(e, t, n) {
        var r,
          i = [],
          o = 0,
          a = e.length;
        for (n = !!n; a > o; o++) (r = !!t(e[o], o)), n !== r && i.push(e[o]);
        return i;
      },
      map: function(e, t, n) {
        var r,
          i = 0,
          o = e.length,
          a = M(e),
          s = [];
        if (a) for (; o > i; i++) (r = t(e[i], i, n)), null != r && (s[s.length] = r);
        else for (i in e) (r = t(e[i], i, n)), null != r && (s[s.length] = r);
        return d.apply([], s);
      },
      guid: 1,
      proxy: function(e, n) {
        var r, i, o;
        return (
          'string' == typeof n && ((o = e[n]), (n = e), (e = o)),
          x.isFunction(e)
            ? ((r = g.call(arguments, 2)),
              (i = function() {
                return e.apply(n || this, r.concat(g.call(arguments)));
              }),
              (i.guid = e.guid = e.guid || x.guid++),
              i)
            : t
        );
      },
      access: function(e, n, r, i, o, a, s) {
        var l = 0,
          u = e.length,
          c = null == r;
        if ('object' === x.type(r)) {
          o = !0;
          for (l in r) x.access(e, n, l, r[l], !0, a, s);
        } else if (
          i !== t &&
          ((o = !0),
          x.isFunction(i) || (s = !0),
          c &&
            (s
              ? (n.call(e, i), (n = null))
              : ((c = n),
                (n = function(e, t, n) {
                  return c.call(x(e), n);
                }))),
          n)
        )
          for (; u > l; l++) n(e[l], r, s ? i : i.call(e[l], l, n(e[l], r)));
        return o ? e : c ? n.call(e) : u ? n(e[0], r) : a;
      },
      now: function() {
        return new Date().getTime();
      },
      swap: function(e, t, n, r) {
        var i,
          o,
          a = {};
        for (o in t) (a[o] = e.style[o]), (e.style[o] = t[o]);
        i = n.apply(e, r || []);
        for (o in t) e.style[o] = a[o];
        return i;
      },
    }),
    (x.ready.promise = function(t) {
      if (!n)
        if (((n = x.Deferred()), 'complete' === a.readyState)) setTimeout(x.ready);
        else if (a.addEventListener) a.addEventListener('DOMContentLoaded', q, !1), e.addEventListener('load', q, !1);
        else {
          a.attachEvent('onreadystatechange', q), e.attachEvent('onload', q);
          var r = !1;
          try {
            r = null == e.frameElement && a.documentElement;
          } catch (i) {}
          r &&
            r.doScroll &&
            (function o() {
              if (!x.isReady) {
                try {
                  r.doScroll('left');
                } catch (e) {
                  return setTimeout(o, 50);
                }
                _(), x.ready();
              }
            })();
        }
      return n.promise(t);
    }),
    x.each('Boolean Number String Function Array Date RegExp Object Error'.split(' '), function(e, t) {
      c['[object ' + t + ']'] = t.toLowerCase();
    });
  function M(e) {
    var t = e.length,
      n = x.type(e);
    return x.isWindow(e)
      ? !1
      : 1 === e.nodeType && t
      ? !0
      : 'array' === n || ('function' !== n && (0 === t || ('number' == typeof t && t > 0 && t - 1 in e)));
  }
  (r = x(a)),
    (function(e, t) {
      var n,
        r,
        i,
        o,
        a,
        s,
        l,
        u,
        c,
        p,
        f,
        d,
        h,
        g,
        m,
        y,
        v,
        b = 'sizzle' + -new Date(),
        w = e.document,
        T = 0,
        C = 0,
        N = st(),
        k = st(),
        E = st(),
        S = !1,
        A = function(e, t) {
          return e === t ? ((S = !0), 0) : 0;
        },
        j = typeof t,
        D = 1 << 31,
        L = {}.hasOwnProperty,
        H = [],
        q = H.pop,
        _ = H.push,
        M = H.push,
        O = H.slice,
        F =
          H.indexOf ||
          function(e) {
            var t = 0,
              n = this.length;
            for (; n > t; t++) if (this[t] === e) return t;
            return -1;
          },
        B =
          'checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped',
        P = '[\\x20\\t\\r\\n\\f]',
        R = '(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+',
        W = R.replace('w', 'w#'),
        $ =
          '\\[' +
          P +
          '*(' +
          R +
          ')' +
          P +
          '*(?:([*^$|!~]?=)' +
          P +
          '*(?:([\'"])((?:\\\\.|[^\\\\])*?)\\3|(' +
          W +
          ')|)|)' +
          P +
          '*\\]',
        I =
          ':(' +
          R +
          ')(?:\\((([\'"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|' +
          $.replace(3, 8) +
          ')*)|.*)\\)|)',
        z = RegExp('^' + P + '+|((?:^|[^\\\\])(?:\\\\.)*)' + P + '+$', 'g'),
        X = RegExp('^' + P + '*,' + P + '*'),
        U = RegExp('^' + P + '*([>+~]|' + P + ')' + P + '*'),
        V = RegExp(P + '*[+~]'),
        Y = RegExp('=' + P + '*([^\\]\'"]*)' + P + '*\\]', 'g'),
        J = RegExp(I),
        G = RegExp('^' + W + '$'),
        Q = {
          ID: RegExp('^#(' + R + ')'),
          CLASS: RegExp('^\\.(' + R + ')'),
          TAG: RegExp('^(' + R.replace('w', 'w*') + ')'),
          ATTR: RegExp('^' + $),
          PSEUDO: RegExp('^' + I),
          CHILD: RegExp(
            '^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(' +
              P +
              '*(even|odd|(([+-]|)(\\d*)n|)' +
              P +
              '*(?:([+-]|)' +
              P +
              '*(\\d+)|))' +
              P +
              '*\\)|)',
            'i'
          ),
          bool: RegExp('^(?:' + B + ')$', 'i'),
          needsContext: RegExp(
            '^' +
              P +
              '*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(' +
              P +
              '*((?:-\\d)?\\d*)' +
              P +
              '*\\)|)(?=[^-]|$)',
            'i'
          ),
        },
        K = /^[^{]+\{\s*\[native \w/,
        Z = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
        et = /^(?:input|select|textarea|button)$/i,
        tt = /^h\d$/i,
        nt = /'|\\/g,
        rt = RegExp('\\\\([\\da-f]{1,6}' + P + '?|(' + P + ')|.)', 'ig'),
        it = function(e, t, n) {
          var r = '0x' + t - 65536;
          return r !== r || n
            ? t
            : 0 > r
            ? String.fromCharCode(r + 65536)
            : String.fromCharCode(55296 | (r >> 10), 56320 | (1023 & r));
        };
      try {
        M.apply((H = O.call(w.childNodes)), w.childNodes), H[w.childNodes.length].nodeType;
      } catch (ot) {
        M = {
          apply: H.length
            ? function(e, t) {
                _.apply(e, O.call(t));
              }
            : function(e, t) {
                var n = e.length,
                  r = 0;
                while ((e[n++] = t[r++]));
                e.length = n - 1;
              },
        };
      }
      function at(e, t, n, i) {
        var o, a, s, l, u, c, d, m, y, x;
        if (((t ? t.ownerDocument || t : w) !== f && p(t), (t = t || f), (n = n || []), !e || 'string' != typeof e))
          return n;
        if (1 !== (l = t.nodeType) && 9 !== l) return [];
        if (h && !i) {
          if ((o = Z.exec(e)))
            if ((s = o[1])) {
              if (9 === l) {
                if (((a = t.getElementById(s)), !a || !a.parentNode)) return n;
                if (a.id === s) return n.push(a), n;
              } else if (t.ownerDocument && (a = t.ownerDocument.getElementById(s)) && v(t, a) && a.id === s)
                return n.push(a), n;
            } else {
              if (o[2]) return M.apply(n, t.getElementsByTagName(e)), n;
              if ((s = o[3]) && r.getElementsByClassName && t.getElementsByClassName)
                return M.apply(n, t.getElementsByClassName(s)), n;
            }
          if (r.qsa && (!g || !g.test(e))) {
            if (((m = d = b), (y = t), (x = 9 === l && e), 1 === l && 'object' !== t.nodeName.toLowerCase())) {
              (c = mt(e)),
                (d = t.getAttribute('id')) ? (m = d.replace(nt, '\\$&')) : t.setAttribute('id', m),
                (m = "[id='" + m + "'] "),
                (u = c.length);
              while (u--) c[u] = m + yt(c[u]);
              (y = (V.test(e) && t.parentNode) || t), (x = c.join(','));
            }
            if (x)
              try {
                return M.apply(n, y.querySelectorAll(x)), n;
              } catch (T) {
              } finally {
                d || t.removeAttribute('id');
              }
          }
        }
        return kt(e.replace(z, '$1'), t, n, i);
      }
      function st() {
        var e = [];
        function t(n, r) {
          return e.push((n += ' ')) > o.cacheLength && delete t[e.shift()], (t[n] = r);
        }
        return t;
      }
      function lt(e) {
        return (e[b] = !0), e;
      }
      function ut(e) {
        var t = f.createElement('div');
        try {
          return !!e(t);
        } catch (n) {
          return !1;
        } finally {
          t.parentNode && t.parentNode.removeChild(t), (t = null);
        }
      }
      function ct(e, t) {
        var n = e.split('|'),
          r = e.length;
        while (r--) o.attrHandle[n[r]] = t;
      }
      function pt(e, t) {
        var n = t && e,
          r = n && 1 === e.nodeType && 1 === t.nodeType && (~t.sourceIndex || D) - (~e.sourceIndex || D);
        if (r) return r;
        if (n) while ((n = n.nextSibling)) if (n === t) return -1;
        return e ? 1 : -1;
      }
      function ft(e) {
        return function(t) {
          var n = t.nodeName.toLowerCase();
          return 'input' === n && t.type === e;
        };
      }
      function dt(e) {
        return function(t) {
          var n = t.nodeName.toLowerCase();
          return ('input' === n || 'button' === n) && t.type === e;
        };
      }
      function ht(e) {
        return lt(function(t) {
          return (
            (t = +t),
            lt(function(n, r) {
              var i,
                o = e([], n.length, t),
                a = o.length;
              while (a--) n[(i = o[a])] && (n[i] = !(r[i] = n[i]));
            })
          );
        });
      }
      (s = at.isXML = function(e) {
        var t = e && (e.ownerDocument || e).documentElement;
        return t ? 'HTML' !== t.nodeName : !1;
      }),
        (r = at.support = {}),
        (p = at.setDocument = function(e) {
          var n = e ? e.ownerDocument || e : w,
            i = n.defaultView;
          return n !== f && 9 === n.nodeType && n.documentElement
            ? ((f = n),
              (d = n.documentElement),
              (h = !s(n)),
              i &&
                i.attachEvent &&
                i !== i.top &&
                i.attachEvent('onbeforeunload', function() {
                  p();
                }),
              (r.attributes = ut(function(e) {
                return (e.className = 'i'), !e.getAttribute('className');
              })),
              (r.getElementsByTagName = ut(function(e) {
                return e.appendChild(n.createComment('')), !e.getElementsByTagName('*').length;
              })),
              (r.getElementsByClassName = ut(function(e) {
                return (
                  (e.innerHTML = "<div class='a'></div><div class='a i'></div>"),
                  (e.firstChild.className = 'i'),
                  2 === e.getElementsByClassName('i').length
                );
              })),
              (r.getById = ut(function(e) {
                return (d.appendChild(e).id = b), !n.getElementsByName || !n.getElementsByName(b).length;
              })),
              r.getById
                ? ((o.find.ID = function(e, t) {
                    if (typeof t.getElementById !== j && h) {
                      var n = t.getElementById(e);
                      return n && n.parentNode ? [n] : [];
                    }
                  }),
                  (o.filter.ID = function(e) {
                    var t = e.replace(rt, it);
                    return function(e) {
                      return e.getAttribute('id') === t;
                    };
                  }))
                : (delete o.find.ID,
                  (o.filter.ID = function(e) {
                    var t = e.replace(rt, it);
                    return function(e) {
                      var n = typeof e.getAttributeNode !== j && e.getAttributeNode('id');
                      return n && n.value === t;
                    };
                  })),
              (o.find.TAG = r.getElementsByTagName
                ? function(e, n) {
                    return typeof n.getElementsByTagName !== j ? n.getElementsByTagName(e) : t;
                  }
                : function(e, t) {
                    var n,
                      r = [],
                      i = 0,
                      o = t.getElementsByTagName(e);
                    if ('*' === e) {
                      while ((n = o[i++])) 1 === n.nodeType && r.push(n);
                      return r;
                    }
                    return o;
                  }),
              (o.find.CLASS =
                r.getElementsByClassName &&
                function(e, n) {
                  return typeof n.getElementsByClassName !== j && h ? n.getElementsByClassName(e) : t;
                }),
              (m = []),
              (g = []),
              (r.qsa = K.test(n.querySelectorAll)) &&
                (ut(function(e) {
                  (e.innerHTML = "<select><option selected=''></option></select>"),
                    e.querySelectorAll('[selected]').length || g.push('\\[' + P + '*(?:value|' + B + ')'),
                    e.querySelectorAll(':checked').length || g.push(':checked');
                }),
                ut(function(e) {
                  var t = n.createElement('input');
                  t.setAttribute('type', 'hidden'),
                    e.appendChild(t).setAttribute('t', ''),
                    e.querySelectorAll("[t^='']").length && g.push('[*^$]=' + P + '*(?:\'\'|"")'),
                    e.querySelectorAll(':enabled').length || g.push(':enabled', ':disabled'),
                    e.querySelectorAll('*,:x'),
                    g.push(',.*:');
                })),
              (r.matchesSelector = K.test(
                (y = d.webkitMatchesSelector || d.mozMatchesSelector || d.oMatchesSelector || d.msMatchesSelector)
              )) &&
                ut(function(e) {
                  (r.disconnectedMatch = y.call(e, 'div')), y.call(e, "[s!='']:x"), m.push('!=', I);
                }),
              (g = g.length && RegExp(g.join('|'))),
              (m = m.length && RegExp(m.join('|'))),
              (v =
                K.test(d.contains) || d.compareDocumentPosition
                  ? function(e, t) {
                      var n = 9 === e.nodeType ? e.documentElement : e,
                        r = t && t.parentNode;
                      return (
                        e === r ||
                        !(
                          !r ||
                          1 !== r.nodeType ||
                          !(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r))
                        )
                      );
                    }
                  : function(e, t) {
                      if (t) while ((t = t.parentNode)) if (t === e) return !0;
                      return !1;
                    }),
              (A = d.compareDocumentPosition
                ? function(e, t) {
                    if (e === t) return (S = !0), 0;
                    var i = t.compareDocumentPosition && e.compareDocumentPosition && e.compareDocumentPosition(t);
                    return i
                      ? 1 & i || (!r.sortDetached && t.compareDocumentPosition(e) === i)
                        ? e === n || v(w, e)
                          ? -1
                          : t === n || v(w, t)
                          ? 1
                          : c
                          ? F.call(c, e) - F.call(c, t)
                          : 0
                        : 4 & i
                        ? -1
                        : 1
                      : e.compareDocumentPosition
                      ? -1
                      : 1;
                  }
                : function(e, t) {
                    var r,
                      i = 0,
                      o = e.parentNode,
                      a = t.parentNode,
                      s = [e],
                      l = [t];
                    if (e === t) return (S = !0), 0;
                    if (!o || !a)
                      return e === n ? -1 : t === n ? 1 : o ? -1 : a ? 1 : c ? F.call(c, e) - F.call(c, t) : 0;
                    if (o === a) return pt(e, t);
                    r = e;
                    while ((r = r.parentNode)) s.unshift(r);
                    r = t;
                    while ((r = r.parentNode)) l.unshift(r);
                    while (s[i] === l[i]) i++;
                    return i ? pt(s[i], l[i]) : s[i] === w ? -1 : l[i] === w ? 1 : 0;
                  }),
              n)
            : f;
        }),
        (at.matches = function(e, t) {
          return at(e, null, null, t);
        }),
        (at.matchesSelector = function(e, t) {
          if (
            ((e.ownerDocument || e) !== f && p(e),
            (t = t.replace(Y, "='$1']")),
            !(!r.matchesSelector || !h || (m && m.test(t)) || (g && g.test(t))))
          )
            try {
              var n = y.call(e, t);
              if (n || r.disconnectedMatch || (e.document && 11 !== e.document.nodeType)) return n;
            } catch (i) {}
          return at(t, f, null, [e]).length > 0;
        }),
        (at.contains = function(e, t) {
          return (e.ownerDocument || e) !== f && p(e), v(e, t);
        }),
        (at.attr = function(e, n) {
          (e.ownerDocument || e) !== f && p(e);
          var i = o.attrHandle[n.toLowerCase()],
            a = i && L.call(o.attrHandle, n.toLowerCase()) ? i(e, n, !h) : t;
          return a === t
            ? r.attributes || !h
              ? e.getAttribute(n)
              : (a = e.getAttributeNode(n)) && a.specified
              ? a.value
              : null
            : a;
        }),
        (at.error = function(e) {
          throw Error('Syntax error, unrecognized expression: ' + e);
        }),
        (at.uniqueSort = function(e) {
          var t,
            n = [],
            i = 0,
            o = 0;
          if (((S = !r.detectDuplicates), (c = !r.sortStable && e.slice(0)), e.sort(A), S)) {
            while ((t = e[o++])) t === e[o] && (i = n.push(o));
            while (i--) e.splice(n[i], 1);
          }
          return e;
        }),
        (a = at.getText = function(e) {
          var t,
            n = '',
            r = 0,
            i = e.nodeType;
          if (i) {
            if (1 === i || 9 === i || 11 === i) {
              if ('string' == typeof e.textContent) return e.textContent;
              for (e = e.firstChild; e; e = e.nextSibling) n += a(e);
            } else if (3 === i || 4 === i) return e.nodeValue;
          } else for (; (t = e[r]); r++) n += a(t);
          return n;
        }),
        (o = at.selectors = {
          cacheLength: 50,
          createPseudo: lt,
          match: Q,
          attrHandle: {},
          find: {},
          relative: {
            '>': { dir: 'parentNode', first: !0 },
            ' ': { dir: 'parentNode' },
            '+': { dir: 'previousSibling', first: !0 },
            '~': { dir: 'previousSibling' },
          },
          preFilter: {
            ATTR: function(e) {
              return (
                (e[1] = e[1].replace(rt, it)),
                (e[3] = (e[4] || e[5] || '').replace(rt, it)),
                '~=' === e[2] && (e[3] = ' ' + e[3] + ' '),
                e.slice(0, 4)
              );
            },
            CHILD: function(e) {
              return (
                (e[1] = e[1].toLowerCase()),
                'nth' === e[1].slice(0, 3)
                  ? (e[3] || at.error(e[0]),
                    (e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ('even' === e[3] || 'odd' === e[3]))),
                    (e[5] = +(e[7] + e[8] || 'odd' === e[3])))
                  : e[3] && at.error(e[0]),
                e
              );
            },
            PSEUDO: function(e) {
              var n,
                r = !e[5] && e[2];
              return Q.CHILD.test(e[0])
                ? null
                : (e[3] && e[4] !== t
                    ? (e[2] = e[4])
                    : r &&
                      J.test(r) &&
                      (n = mt(r, !0)) &&
                      (n = r.indexOf(')', r.length - n) - r.length) &&
                      ((e[0] = e[0].slice(0, n)), (e[2] = r.slice(0, n))),
                  e.slice(0, 3));
            },
          },
          filter: {
            TAG: function(e) {
              var t = e.replace(rt, it).toLowerCase();
              return '*' === e
                ? function() {
                    return !0;
                  }
                : function(e) {
                    return e.nodeName && e.nodeName.toLowerCase() === t;
                  };
            },
            CLASS: function(e) {
              var t = N[e + ' '];
              return (
                t ||
                ((t = RegExp('(^|' + P + ')' + e + '(' + P + '|$)')) &&
                  N(e, function(e) {
                    return t.test(
                      ('string' == typeof e.className && e.className) ||
                        (typeof e.getAttribute !== j && e.getAttribute('class')) ||
                        ''
                    );
                  }))
              );
            },
            ATTR: function(e, t, n) {
              return function(r) {
                var i = at.attr(r, e);
                return null == i
                  ? '!=' === t
                  : t
                  ? ((i += ''),
                    '=' === t
                      ? i === n
                      : '!=' === t
                      ? i !== n
                      : '^=' === t
                      ? n && 0 === i.indexOf(n)
                      : '*=' === t
                      ? n && i.indexOf(n) > -1
                      : '$=' === t
                      ? n && i.slice(-n.length) === n
                      : '~=' === t
                      ? (' ' + i + ' ').indexOf(n) > -1
                      : '|=' === t
                      ? i === n || i.slice(0, n.length + 1) === n + '-'
                      : !1)
                  : !0;
              };
            },
            CHILD: function(e, t, n, r, i) {
              var o = 'nth' !== e.slice(0, 3),
                a = 'last' !== e.slice(-4),
                s = 'of-type' === t;
              return 1 === r && 0 === i
                ? function(e) {
                    return !!e.parentNode;
                  }
                : function(t, n, l) {
                    var u,
                      c,
                      p,
                      f,
                      d,
                      h,
                      g = o !== a ? 'nextSibling' : 'previousSibling',
                      m = t.parentNode,
                      y = s && t.nodeName.toLowerCase(),
                      v = !l && !s;
                    if (m) {
                      if (o) {
                        while (g) {
                          p = t;
                          while ((p = p[g])) if (s ? p.nodeName.toLowerCase() === y : 1 === p.nodeType) return !1;
                          h = g = 'only' === e && !h && 'nextSibling';
                        }
                        return !0;
                      }
                      if (((h = [a ? m.firstChild : m.lastChild]), a && v)) {
                        (c = m[b] || (m[b] = {})),
                          (u = c[e] || []),
                          (d = u[0] === T && u[1]),
                          (f = u[0] === T && u[2]),
                          (p = d && m.childNodes[d]);
                        while ((p = (++d && p && p[g]) || (f = d = 0) || h.pop()))
                          if (1 === p.nodeType && ++f && p === t) {
                            c[e] = [T, d, f];
                            break;
                          }
                      } else if (v && (u = (t[b] || (t[b] = {}))[e]) && u[0] === T) f = u[1];
                      else
                        while ((p = (++d && p && p[g]) || (f = d = 0) || h.pop()))
                          if (
                            (s ? p.nodeName.toLowerCase() === y : 1 === p.nodeType) &&
                            ++f &&
                            (v && ((p[b] || (p[b] = {}))[e] = [T, f]), p === t)
                          )
                            break;
                      return (f -= i), f === r || (0 === f % r && f / r >= 0);
                    }
                  };
            },
            PSEUDO: function(e, t) {
              var n,
                r = o.pseudos[e] || o.setFilters[e.toLowerCase()] || at.error('unsupported pseudo: ' + e);
              return r[b]
                ? r(t)
                : r.length > 1
                ? ((n = [e, e, '', t]),
                  o.setFilters.hasOwnProperty(e.toLowerCase())
                    ? lt(function(e, n) {
                        var i,
                          o = r(e, t),
                          a = o.length;
                        while (a--) (i = F.call(e, o[a])), (e[i] = !(n[i] = o[a]));
                      })
                    : function(e) {
                        return r(e, 0, n);
                      })
                : r;
            },
          },
          pseudos: {
            not: lt(function(e) {
              var t = [],
                n = [],
                r = l(e.replace(z, '$1'));
              return r[b]
                ? lt(function(e, t, n, i) {
                    var o,
                      a = r(e, null, i, []),
                      s = e.length;
                    while (s--) (o = a[s]) && (e[s] = !(t[s] = o));
                  })
                : function(e, i, o) {
                    return (t[0] = e), r(t, null, o, n), !n.pop();
                  };
            }),
            has: lt(function(e) {
              return function(t) {
                return at(e, t).length > 0;
              };
            }),
            contains: lt(function(e) {
              return function(t) {
                return (t.textContent || t.innerText || a(t)).indexOf(e) > -1;
              };
            }),
            lang: lt(function(e) {
              return (
                G.test(e || '') || at.error('unsupported lang: ' + e),
                (e = e.replace(rt, it).toLowerCase()),
                function(t) {
                  var n;
                  do
                    if ((n = h ? t.lang : t.getAttribute('xml:lang') || t.getAttribute('lang')))
                      return (n = n.toLowerCase()), n === e || 0 === n.indexOf(e + '-');
                  while ((t = t.parentNode) && 1 === t.nodeType);
                  return !1;
                }
              );
            }),
            target: function(t) {
              var n = e.location && e.location.hash;
              return n && n.slice(1) === t.id;
            },
            root: function(e) {
              return e === d;
            },
            focus: function(e) {
              return e === f.activeElement && (!f.hasFocus || f.hasFocus()) && !!(e.type || e.href || ~e.tabIndex);
            },
            enabled: function(e) {
              return e.disabled === !1;
            },
            disabled: function(e) {
              return e.disabled === !0;
            },
            checked: function(e) {
              var t = e.nodeName.toLowerCase();
              return ('input' === t && !!e.checked) || ('option' === t && !!e.selected);
            },
            selected: function(e) {
              return e.parentNode && e.parentNode.selectedIndex, e.selected === !0;
            },
            empty: function(e) {
              for (e = e.firstChild; e; e = e.nextSibling)
                if (e.nodeName > '@' || 3 === e.nodeType || 4 === e.nodeType) return !1;
              return !0;
            },
            parent: function(e) {
              return !o.pseudos.empty(e);
            },
            header: function(e) {
              return tt.test(e.nodeName);
            },
            input: function(e) {
              return et.test(e.nodeName);
            },
            button: function(e) {
              var t = e.nodeName.toLowerCase();
              return ('input' === t && 'button' === e.type) || 'button' === t;
            },
            text: function(e) {
              var t;
              return (
                'input' === e.nodeName.toLowerCase() &&
                'text' === e.type &&
                (null == (t = e.getAttribute('type')) || t.toLowerCase() === e.type)
              );
            },
            first: ht(function() {
              return [0];
            }),
            last: ht(function(e, t) {
              return [t - 1];
            }),
            eq: ht(function(e, t, n) {
              return [0 > n ? n + t : n];
            }),
            even: ht(function(e, t) {
              var n = 0;
              for (; t > n; n += 2) e.push(n);
              return e;
            }),
            odd: ht(function(e, t) {
              var n = 1;
              for (; t > n; n += 2) e.push(n);
              return e;
            }),
            lt: ht(function(e, t, n) {
              var r = 0 > n ? n + t : n;
              for (; --r >= 0; ) e.push(r);
              return e;
            }),
            gt: ht(function(e, t, n) {
              var r = 0 > n ? n + t : n;
              for (; t > ++r; ) e.push(r);
              return e;
            }),
          },
        }),
        (o.pseudos.nth = o.pseudos.eq);
      for (n in { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) o.pseudos[n] = ft(n);
      for (n in { submit: !0, reset: !0 }) o.pseudos[n] = dt(n);
      function gt() {}
      (gt.prototype = o.filters = o.pseudos), (o.setFilters = new gt());
      function mt(e, t) {
        var n,
          r,
          i,
          a,
          s,
          l,
          u,
          c = k[e + ' '];
        if (c) return t ? 0 : c.slice(0);
        (s = e), (l = []), (u = o.preFilter);
        while (s) {
          (!n || (r = X.exec(s))) && (r && (s = s.slice(r[0].length) || s), l.push((i = []))),
            (n = !1),
            (r = U.exec(s)) &&
              ((n = r.shift()), i.push({ value: n, type: r[0].replace(z, ' ') }), (s = s.slice(n.length)));
          for (a in o.filter)
            !(r = Q[a].exec(s)) ||
              (u[a] && !(r = u[a](r))) ||
              ((n = r.shift()), i.push({ value: n, type: a, matches: r }), (s = s.slice(n.length)));
          if (!n) break;
        }
        return t ? s.length : s ? at.error(e) : k(e, l).slice(0);
      }
      function yt(e) {
        var t = 0,
          n = e.length,
          r = '';
        for (; n > t; t++) r += e[t].value;
        return r;
      }
      function vt(e, t, n) {
        var r = t.dir,
          o = n && 'parentNode' === r,
          a = C++;
        return t.first
          ? function(t, n, i) {
              while ((t = t[r])) if (1 === t.nodeType || o) return e(t, n, i);
            }
          : function(t, n, s) {
              var l,
                u,
                c,
                p = T + ' ' + a;
              if (s) {
                while ((t = t[r])) if ((1 === t.nodeType || o) && e(t, n, s)) return !0;
              } else
                while ((t = t[r]))
                  if (1 === t.nodeType || o)
                    if (((c = t[b] || (t[b] = {})), (u = c[r]) && u[0] === p)) {
                      if ((l = u[1]) === !0 || l === i) return l === !0;
                    } else if (((u = c[r] = [p]), (u[1] = e(t, n, s) || i), u[1] === !0)) return !0;
            };
      }
      function bt(e) {
        return e.length > 1
          ? function(t, n, r) {
              var i = e.length;
              while (i--) if (!e[i](t, n, r)) return !1;
              return !0;
            }
          : e[0];
      }
      function xt(e, t, n, r, i) {
        var o,
          a = [],
          s = 0,
          l = e.length,
          u = null != t;
        for (; l > s; s++) (o = e[s]) && (!n || n(o, r, i)) && (a.push(o), u && t.push(s));
        return a;
      }
      function wt(e, t, n, r, i, o) {
        return (
          r && !r[b] && (r = wt(r)),
          i && !i[b] && (i = wt(i, o)),
          lt(function(o, a, s, l) {
            var u,
              c,
              p,
              f = [],
              d = [],
              h = a.length,
              g = o || Nt(t || '*', s.nodeType ? [s] : s, []),
              m = !e || (!o && t) ? g : xt(g, f, e, s, l),
              y = n ? (i || (o ? e : h || r) ? [] : a) : m;
            if ((n && n(m, y, s, l), r)) {
              (u = xt(y, d)), r(u, [], s, l), (c = u.length);
              while (c--) (p = u[c]) && (y[d[c]] = !(m[d[c]] = p));
            }
            if (o) {
              if (i || e) {
                if (i) {
                  (u = []), (c = y.length);
                  while (c--) (p = y[c]) && u.push((m[c] = p));
                  i(null, (y = []), u, l);
                }
                c = y.length;
                while (c--) (p = y[c]) && (u = i ? F.call(o, p) : f[c]) > -1 && (o[u] = !(a[u] = p));
              }
            } else (y = xt(y === a ? y.splice(h, y.length) : y)), i ? i(null, a, y, l) : M.apply(a, y);
          })
        );
      }
      function Tt(e) {
        var t,
          n,
          r,
          i = e.length,
          a = o.relative[e[0].type],
          s = a || o.relative[' '],
          l = a ? 1 : 0,
          c = vt(
            function(e) {
              return e === t;
            },
            s,
            !0
          ),
          p = vt(
            function(e) {
              return F.call(t, e) > -1;
            },
            s,
            !0
          ),
          f = [
            function(e, n, r) {
              return (!a && (r || n !== u)) || ((t = n).nodeType ? c(e, n, r) : p(e, n, r));
            },
          ];
        for (; i > l; l++)
          if ((n = o.relative[e[l].type])) f = [vt(bt(f), n)];
          else {
            if (((n = o.filter[e[l].type].apply(null, e[l].matches)), n[b])) {
              for (r = ++l; i > r; r++) if (o.relative[e[r].type]) break;
              return wt(
                l > 1 && bt(f),
                l > 1 && yt(e.slice(0, l - 1).concat({ value: ' ' === e[l - 2].type ? '*' : '' })).replace(z, '$1'),
                n,
                r > l && Tt(e.slice(l, r)),
                i > r && Tt((e = e.slice(r))),
                i > r && yt(e)
              );
            }
            f.push(n);
          }
        return bt(f);
      }
      function Ct(e, t) {
        var n = 0,
          r = t.length > 0,
          a = e.length > 0,
          s = function(s, l, c, p, d) {
            var h,
              g,
              m,
              y = [],
              v = 0,
              b = '0',
              x = s && [],
              w = null != d,
              C = u,
              N = s || (a && o.find.TAG('*', (d && l.parentNode) || l)),
              k = (T += null == C ? 1 : Math.random() || 0.1);
            for (w && ((u = l !== f && l), (i = n)); null != (h = N[b]); b++) {
              if (a && h) {
                g = 0;
                while ((m = e[g++]))
                  if (m(h, l, c)) {
                    p.push(h);
                    break;
                  }
                w && ((T = k), (i = ++n));
              }
              r && ((h = !m && h) && v--, s && x.push(h));
            }
            if (((v += b), r && b !== v)) {
              g = 0;
              while ((m = t[g++])) m(x, y, l, c);
              if (s) {
                if (v > 0) while (b--) x[b] || y[b] || (y[b] = q.call(p));
                y = xt(y);
              }
              M.apply(p, y), w && !s && y.length > 0 && v + t.length > 1 && at.uniqueSort(p);
            }
            return w && ((T = k), (u = C)), x;
          };
        return r ? lt(s) : s;
      }
      l = at.compile = function(e, t) {
        var n,
          r = [],
          i = [],
          o = E[e + ' '];
        if (!o) {
          t || (t = mt(e)), (n = t.length);
          while (n--) (o = Tt(t[n])), o[b] ? r.push(o) : i.push(o);
          o = E(e, Ct(i, r));
        }
        return o;
      };
      function Nt(e, t, n) {
        var r = 0,
          i = t.length;
        for (; i > r; r++) at(e, t[r], n);
        return n;
      }
      function kt(e, t, n, i) {
        var a,
          s,
          u,
          c,
          p,
          f = mt(e);
        if (!i && 1 === f.length) {
          if (
            ((s = f[0] = f[0].slice(0)),
            s.length > 2 && 'ID' === (u = s[0]).type && r.getById && 9 === t.nodeType && h && o.relative[s[1].type])
          ) {
            if (((t = (o.find.ID(u.matches[0].replace(rt, it), t) || [])[0]), !t)) return n;
            e = e.slice(s.shift().value.length);
          }
          a = Q.needsContext.test(e) ? 0 : s.length;
          while (a--) {
            if (((u = s[a]), o.relative[(c = u.type)])) break;
            if ((p = o.find[c]) && (i = p(u.matches[0].replace(rt, it), (V.test(s[0].type) && t.parentNode) || t))) {
              if ((s.splice(a, 1), (e = i.length && yt(s)), !e)) return M.apply(n, i), n;
              break;
            }
          }
        }
        return l(e, f)(i, t, !h, n, V.test(e)), n;
      }
      (r.sortStable =
        b
          .split('')
          .sort(A)
          .join('') === b),
        (r.detectDuplicates = S),
        p(),
        (r.sortDetached = ut(function(e) {
          return 1 & e.compareDocumentPosition(f.createElement('div'));
        })),
        ut(function(e) {
          return (e.innerHTML = "<a href='#'></a>"), '#' === e.firstChild.getAttribute('href');
        }) ||
          ct('type|href|height|width', function(e, n, r) {
            return r ? t : e.getAttribute(n, 'type' === n.toLowerCase() ? 1 : 2);
          }),
        (r.attributes &&
          ut(function(e) {
            return (
              (e.innerHTML = '<input/>'),
              e.firstChild.setAttribute('value', ''),
              '' === e.firstChild.getAttribute('value')
            );
          })) ||
          ct('value', function(e, n, r) {
            return r || 'input' !== e.nodeName.toLowerCase() ? t : e.defaultValue;
          }),
        ut(function(e) {
          return null == e.getAttribute('disabled');
        }) ||
          ct(B, function(e, n, r) {
            var i;
            return r ? t : (i = e.getAttributeNode(n)) && i.specified ? i.value : e[n] === !0 ? n.toLowerCase() : null;
          }),
        (x.find = at),
        (x.expr = at.selectors),
        (x.expr[':'] = x.expr.pseudos),
        (x.unique = at.uniqueSort),
        (x.text = at.getText),
        (x.isXMLDoc = at.isXML),
        (x.contains = at.contains);
    })(e);
  var O = {};
  function F(e) {
    var t = (O[e] = {});
    return (
      x.each(e.match(T) || [], function(e, n) {
        t[n] = !0;
      }),
      t
    );
  }
  (x.Callbacks = function(e) {
    e = 'string' == typeof e ? O[e] || F(e) : x.extend({}, e);
    var n,
      r,
      i,
      o,
      a,
      s,
      l = [],
      u = !e.once && [],
      c = function(t) {
        for (r = e.memory && t, i = !0, a = s || 0, s = 0, o = l.length, n = !0; l && o > a; a++)
          if (l[a].apply(t[0], t[1]) === !1 && e.stopOnFalse) {
            r = !1;
            break;
          }
        (n = !1), l && (u ? u.length && c(u.shift()) : r ? (l = []) : p.disable());
      },
      p = {
        add: function() {
          if (l) {
            var t = l.length;
            (function i(t) {
              x.each(t, function(t, n) {
                var r = x.type(n);
                'function' === r ? (e.unique && p.has(n)) || l.push(n) : n && n.length && 'string' !== r && i(n);
              });
            })(arguments),
              n ? (o = l.length) : r && ((s = t), c(r));
          }
          return this;
        },
        remove: function() {
          return (
            l &&
              x.each(arguments, function(e, t) {
                var r;
                while ((r = x.inArray(t, l, r)) > -1) l.splice(r, 1), n && (o >= r && o--, a >= r && a--);
              }),
            this
          );
        },
        has: function(e) {
          return e ? x.inArray(e, l) > -1 : !(!l || !l.length);
        },
        empty: function() {
          return (l = []), (o = 0), this;
        },
        disable: function() {
          return (l = u = r = t), this;
        },
        disabled: function() {
          return !l;
        },
        lock: function() {
          return (u = t), r || p.disable(), this;
        },
        locked: function() {
          return !u;
        },
        fireWith: function(e, t) {
          return !l || (i && !u) || ((t = t || []), (t = [e, t.slice ? t.slice() : t]), n ? u.push(t) : c(t)), this;
        },
        fire: function() {
          return p.fireWith(this, arguments), this;
        },
        fired: function() {
          return !!i;
        },
      };
    return p;
  }),
    x.extend({
      Deferred: function(e) {
        var t = [
            ['resolve', 'done', x.Callbacks('once memory'), 'resolved'],
            ['reject', 'fail', x.Callbacks('once memory'), 'rejected'],
            ['notify', 'progress', x.Callbacks('memory')],
          ],
          n = 'pending',
          r = {
            state: function() {
              return n;
            },
            always: function() {
              return i.done(arguments).fail(arguments), this;
            },
            then: function() {
              var e = arguments;
              return x
                .Deferred(function(n) {
                  x.each(t, function(t, o) {
                    var a = o[0],
                      s = x.isFunction(e[t]) && e[t];
                    i[o[1]](function() {
                      var e = s && s.apply(this, arguments);
                      e && x.isFunction(e.promise)
                        ? e
                            .promise()
                            .done(n.resolve)
                            .fail(n.reject)
                            .progress(n.notify)
                        : n[a + 'With'](this === r ? n.promise() : this, s ? [e] : arguments);
                    });
                  }),
                    (e = null);
                })
                .promise();
            },
            promise: function(e) {
              return null != e ? x.extend(e, r) : r;
            },
          },
          i = {};
        return (
          (r.pipe = r.then),
          x.each(t, function(e, o) {
            var a = o[2],
              s = o[3];
            (r[o[1]] = a.add),
              s &&
                a.add(
                  function() {
                    n = s;
                  },
                  t[1 ^ e][2].disable,
                  t[2][2].lock
                ),
              (i[o[0]] = function() {
                return i[o[0] + 'With'](this === i ? r : this, arguments), this;
              }),
              (i[o[0] + 'With'] = a.fireWith);
          }),
          r.promise(i),
          e && e.call(i, i),
          i
        );
      },
      when: function(e) {
        var t = 0,
          n = g.call(arguments),
          r = n.length,
          i = 1 !== r || (e && x.isFunction(e.promise)) ? r : 0,
          o = 1 === i ? e : x.Deferred(),
          a = function(e, t, n) {
            return function(r) {
              (t[e] = this),
                (n[e] = arguments.length > 1 ? g.call(arguments) : r),
                n === s ? o.notifyWith(t, n) : --i || o.resolveWith(t, n);
            };
          },
          s,
          l,
          u;
        if (r > 1)
          for (s = Array(r), l = Array(r), u = Array(r); r > t; t++)
            n[t] && x.isFunction(n[t].promise)
              ? n[t]
                  .promise()
                  .done(a(t, u, n))
                  .fail(o.reject)
                  .progress(a(t, l, s))
              : --i;
        return i || o.resolveWith(u, n), o.promise();
      },
    }),
    (x.support = (function(t) {
      var n,
        r,
        o,
        s,
        l,
        u,
        c,
        p,
        f,
        d = a.createElement('div');
      if (
        (d.setAttribute('className', 't'),
        (d.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>"),
        (n = d.getElementsByTagName('*') || []),
        (r = d.getElementsByTagName('a')[0]),
        !r || !r.style || !n.length)
      )
        return t;
      (s = a.createElement('select')),
        (u = s.appendChild(a.createElement('option'))),
        (o = d.getElementsByTagName('input')[0]),
        (r.style.cssText = 'top:1px;float:left;opacity:.5'),
        (t.getSetAttribute = 't' !== d.className),
        (t.leadingWhitespace = 3 === d.firstChild.nodeType),
        (t.tbody = !d.getElementsByTagName('tbody').length),
        (t.htmlSerialize = !!d.getElementsByTagName('link').length),
        (t.style = /top/.test(r.getAttribute('style'))),
        (t.hrefNormalized = '/a' === r.getAttribute('href')),
        (t.opacity = /^0.5/.test(r.style.opacity)),
        (t.cssFloat = !!r.style.cssFloat),
        (t.checkOn = !!o.value),
        (t.optSelected = u.selected),
        (t.enctype = !!a.createElement('form').enctype),
        (t.html5Clone = '<:nav></:nav>' !== a.createElement('nav').cloneNode(!0).outerHTML),
        (t.inlineBlockNeedsLayout = !1),
        (t.shrinkWrapBlocks = !1),
        (t.pixelPosition = !1),
        (t.deleteExpando = !0),
        (t.noCloneEvent = !0),
        (t.reliableMarginRight = !0),
        (t.boxSizingReliable = !0),
        (o.checked = !0),
        (t.noCloneChecked = o.cloneNode(!0).checked),
        (s.disabled = !0),
        (t.optDisabled = !u.disabled);
      try {
        delete d.test;
      } catch (h) {
        t.deleteExpando = !1;
      }
      (o = a.createElement('input')),
        o.setAttribute('value', ''),
        (t.input = '' === o.getAttribute('value')),
        (o.value = 't'),
        o.setAttribute('type', 'radio'),
        (t.radioValue = 't' === o.value),
        o.setAttribute('checked', 't'),
        o.setAttribute('name', 't'),
        (l = a.createDocumentFragment()),
        l.appendChild(o),
        (t.appendChecked = o.checked),
        (t.checkClone = l.cloneNode(!0).cloneNode(!0).lastChild.checked),
        d.attachEvent &&
          (d.attachEvent('onclick', function() {
            t.noCloneEvent = !1;
          }),
          d.cloneNode(!0).click());
      for (f in { submit: !0, change: !0, focusin: !0 })
        d.setAttribute((c = 'on' + f), 't'), (t[f + 'Bubbles'] = c in e || d.attributes[c].expando === !1);
      (d.style.backgroundClip = 'content-box'),
        (d.cloneNode(!0).style.backgroundClip = ''),
        (t.clearCloneStyle = 'content-box' === d.style.backgroundClip);
      for (f in x(t)) break;
      return (
        (t.ownLast = '0' !== f),
        x(function() {
          var n,
            r,
            o,
            s =
              'padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;',
            l = a.getElementsByTagName('body')[0];
          l &&
            ((n = a.createElement('div')),
            (n.style.cssText = 'border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px'),
            l.appendChild(n).appendChild(d),
            (d.innerHTML = '<table><tr><td></td><td>t</td></tr></table>'),
            (o = d.getElementsByTagName('td')),
            (o[0].style.cssText = 'padding:0;margin:0;border:0;display:none'),
            (p = 0 === o[0].offsetHeight),
            (o[0].style.display = ''),
            (o[1].style.display = 'none'),
            (t.reliableHiddenOffsets = p && 0 === o[0].offsetHeight),
            (d.innerHTML = ''),
            (d.style.cssText =
              'box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;'),
            x.swap(l, null != l.style.zoom ? { zoom: 1 } : {}, function() {
              t.boxSizing = 4 === d.offsetWidth;
            }),
            e.getComputedStyle &&
              ((t.pixelPosition = '1%' !== (e.getComputedStyle(d, null) || {}).top),
              (t.boxSizingReliable = '4px' === (e.getComputedStyle(d, null) || { width: '4px' }).width),
              (r = d.appendChild(a.createElement('div'))),
              (r.style.cssText = d.style.cssText = s),
              (r.style.marginRight = r.style.width = '0'),
              (d.style.width = '1px'),
              (t.reliableMarginRight = !parseFloat((e.getComputedStyle(r, null) || {}).marginRight))),
            typeof d.style.zoom !== i &&
              ((d.innerHTML = ''),
              (d.style.cssText = s + 'width:1px;padding:1px;display:inline;zoom:1'),
              (t.inlineBlockNeedsLayout = 3 === d.offsetWidth),
              (d.style.display = 'block'),
              (d.innerHTML = '<div></div>'),
              (d.firstChild.style.width = '5px'),
              (t.shrinkWrapBlocks = 3 !== d.offsetWidth),
              t.inlineBlockNeedsLayout && (l.style.zoom = 1)),
            l.removeChild(n),
            (n = d = o = r = null));
        }),
        (n = s = l = u = r = o = null),
        t
      );
    })({}));
  var B = /(?:\{[\s\S]*\}|\[[\s\S]*\])$/,
    P = /([A-Z])/g;
  function R(e, n, r, i) {
    if (x.acceptData(e)) {
      var o,
        a,
        s = x.expando,
        l = e.nodeType,
        u = l ? x.cache : e,
        c = l ? e[s] : e[s] && s;
      if ((c && u[c] && (i || u[c].data)) || r !== t || 'string' != typeof n)
        return (
          c || (c = l ? (e[s] = p.pop() || x.guid++) : s),
          u[c] || (u[c] = l ? {} : { toJSON: x.noop }),
          ('object' == typeof n || 'function' == typeof n) &&
            (i ? (u[c] = x.extend(u[c], n)) : (u[c].data = x.extend(u[c].data, n))),
          (a = u[c]),
          i || (a.data || (a.data = {}), (a = a.data)),
          r !== t && (a[x.camelCase(n)] = r),
          'string' == typeof n ? ((o = a[n]), null == o && (o = a[x.camelCase(n)])) : (o = a),
          o
        );
    }
  }
  function W(e, t, n) {
    if (x.acceptData(e)) {
      var r,
        i,
        o = e.nodeType,
        a = o ? x.cache : e,
        s = o ? e[x.expando] : x.expando;
      if (a[s]) {
        if (t && (r = n ? a[s] : a[s].data)) {
          x.isArray(t)
            ? (t = t.concat(x.map(t, x.camelCase)))
            : t in r
            ? (t = [t])
            : ((t = x.camelCase(t)), (t = t in r ? [t] : t.split(' '))),
            (i = t.length);
          while (i--) delete r[t[i]];
          if (n ? !I(r) : !x.isEmptyObject(r)) return;
        }
        (n || (delete a[s].data, I(a[s]))) &&
          (o ? x.cleanData([e], !0) : x.support.deleteExpando || a != a.window ? delete a[s] : (a[s] = null));
      }
    }
  }
  x.extend({
    cache: {},
    noData: { applet: !0, embed: !0, object: 'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000' },
    hasData: function(e) {
      return (e = e.nodeType ? x.cache[e[x.expando]] : e[x.expando]), !!e && !I(e);
    },
    data: function(e, t, n) {
      return R(e, t, n);
    },
    removeData: function(e, t) {
      return W(e, t);
    },
    _data: function(e, t, n) {
      return R(e, t, n, !0);
    },
    _removeData: function(e, t) {
      return W(e, t, !0);
    },
    acceptData: function(e) {
      if (e.nodeType && 1 !== e.nodeType && 9 !== e.nodeType) return !1;
      var t = e.nodeName && x.noData[e.nodeName.toLowerCase()];
      return !t || (t !== !0 && e.getAttribute('classid') === t);
    },
  }),
    x.fn.extend({
      data: function(e, n) {
        var r,
          i,
          o = null,
          a = 0,
          s = this[0];
        if (e === t) {
          if (this.length && ((o = x.data(s)), 1 === s.nodeType && !x._data(s, 'parsedAttrs'))) {
            for (r = s.attributes; r.length > a; a++)
              (i = r[a].name), 0 === i.indexOf('data-') && ((i = x.camelCase(i.slice(5))), $(s, i, o[i]));
            x._data(s, 'parsedAttrs', !0);
          }
          return o;
        }
        return 'object' == typeof e
          ? this.each(function() {
              x.data(this, e);
            })
          : arguments.length > 1
          ? this.each(function() {
              x.data(this, e, n);
            })
          : s
          ? $(s, e, x.data(s, e))
          : null;
      },
      removeData: function(e) {
        return this.each(function() {
          x.removeData(this, e);
        });
      },
    });
  function $(e, n, r) {
    if (r === t && 1 === e.nodeType) {
      var i = 'data-' + n.replace(P, '-$1').toLowerCase();
      if (((r = e.getAttribute(i)), 'string' == typeof r)) {
        try {
          r =
            'true' === r
              ? !0
              : 'false' === r
              ? !1
              : 'null' === r
              ? null
              : +r + '' === r
              ? +r
              : B.test(r)
              ? x.parseJSON(r)
              : r;
        } catch (o) {}
        x.data(e, n, r);
      } else r = t;
    }
    return r;
  }
  function I(e) {
    var t;
    for (t in e) if (('data' !== t || !x.isEmptyObject(e[t])) && 'toJSON' !== t) return !1;
    return !0;
  }
  x.extend({
    queue: function(e, n, r) {
      var i;
      return e
        ? ((n = (n || 'fx') + 'queue'),
          (i = x._data(e, n)),
          r && (!i || x.isArray(r) ? (i = x._data(e, n, x.makeArray(r))) : i.push(r)),
          i || [])
        : t;
    },
    dequeue: function(e, t) {
      t = t || 'fx';
      var n = x.queue(e, t),
        r = n.length,
        i = n.shift(),
        o = x._queueHooks(e, t),
        a = function() {
          x.dequeue(e, t);
        };
      'inprogress' === i && ((i = n.shift()), r--),
        i && ('fx' === t && n.unshift('inprogress'), delete o.stop, i.call(e, a, o)),
        !r && o && o.empty.fire();
    },
    _queueHooks: function(e, t) {
      var n = t + 'queueHooks';
      return (
        x._data(e, n) ||
        x._data(e, n, {
          empty: x.Callbacks('once memory').add(function() {
            x._removeData(e, t + 'queue'), x._removeData(e, n);
          }),
        })
      );
    },
  }),
    x.fn.extend({
      queue: function(e, n) {
        var r = 2;
        return (
          'string' != typeof e && ((n = e), (e = 'fx'), r--),
          r > arguments.length
            ? x.queue(this[0], e)
            : n === t
            ? this
            : this.each(function() {
                var t = x.queue(this, e, n);
                x._queueHooks(this, e), 'fx' === e && 'inprogress' !== t[0] && x.dequeue(this, e);
              })
        );
      },
      dequeue: function(e) {
        return this.each(function() {
          x.dequeue(this, e);
        });
      },
      delay: function(e, t) {
        return (
          (e = x.fx ? x.fx.speeds[e] || e : e),
          (t = t || 'fx'),
          this.queue(t, function(t, n) {
            var r = setTimeout(t, e);
            n.stop = function() {
              clearTimeout(r);
            };
          })
        );
      },
      clearQueue: function(e) {
        return this.queue(e || 'fx', []);
      },
      promise: function(e, n) {
        var r,
          i = 1,
          o = x.Deferred(),
          a = this,
          s = this.length,
          l = function() {
            --i || o.resolveWith(a, [a]);
          };
        'string' != typeof e && ((n = e), (e = t)), (e = e || 'fx');
        while (s--) (r = x._data(a[s], e + 'queueHooks')), r && r.empty && (i++, r.empty.add(l));
        return l(), o.promise(n);
      },
    });
  var z,
    X,
    U = /[\t\r\n\f]/g,
    V = /\r/g,
    Y = /^(?:input|select|textarea|button|object)$/i,
    J = /^(?:a|area)$/i,
    G = /^(?:checked|selected)$/i,
    Q = x.support.getSetAttribute,
    K = x.support.input;
  x.fn.extend({
    attr: function(e, t) {
      return x.access(this, x.attr, e, t, arguments.length > 1);
    },
    removeAttr: function(e) {
      return this.each(function() {
        x.removeAttr(this, e);
      });
    },
    prop: function(e, t) {
      return x.access(this, x.prop, e, t, arguments.length > 1);
    },
    removeProp: function(e) {
      return (
        (e = x.propFix[e] || e),
        this.each(function() {
          try {
            (this[e] = t), delete this[e];
          } catch (n) {}
        })
      );
    },
    addClass: function(e) {
      var t,
        n,
        r,
        i,
        o,
        a = 0,
        s = this.length,
        l = 'string' == typeof e && e;
      if (x.isFunction(e))
        return this.each(function(t) {
          x(this).addClass(e.call(this, t, this.className));
        });
      if (l)
        for (t = (e || '').match(T) || []; s > a; a++)
          if (
            ((n = this[a]), (r = 1 === n.nodeType && (n.className ? (' ' + n.className + ' ').replace(U, ' ') : ' ')))
          ) {
            o = 0;
            while ((i = t[o++])) 0 > r.indexOf(' ' + i + ' ') && (r += i + ' ');
            n.className = x.trim(r);
          }
      return this;
    },
    removeClass: function(e) {
      var t,
        n,
        r,
        i,
        o,
        a = 0,
        s = this.length,
        l = 0 === arguments.length || ('string' == typeof e && e);
      if (x.isFunction(e))
        return this.each(function(t) {
          x(this).removeClass(e.call(this, t, this.className));
        });
      if (l)
        for (t = (e || '').match(T) || []; s > a; a++)
          if (
            ((n = this[a]), (r = 1 === n.nodeType && (n.className ? (' ' + n.className + ' ').replace(U, ' ') : '')))
          ) {
            o = 0;
            while ((i = t[o++])) while (r.indexOf(' ' + i + ' ') >= 0) r = r.replace(' ' + i + ' ', ' ');
            n.className = e ? x.trim(r) : '';
          }
      return this;
    },
    toggleClass: function(e, t) {
      var n = typeof e;
      return 'boolean' == typeof t && 'string' === n
        ? t
          ? this.addClass(e)
          : this.removeClass(e)
        : x.isFunction(e)
        ? this.each(function(n) {
            x(this).toggleClass(e.call(this, n, this.className, t), t);
          })
        : this.each(function() {
            if ('string' === n) {
              var t,
                r = 0,
                o = x(this),
                a = e.match(T) || [];
              while ((t = a[r++])) o.hasClass(t) ? o.removeClass(t) : o.addClass(t);
            } else (n === i || 'boolean' === n) && (this.className && x._data(this, '__className__', this.className), (this.className = this.className || e === !1 ? '' : x._data(this, '__className__') || ''));
          });
    },
    hasClass: function(e) {
      var t = ' ' + e + ' ',
        n = 0,
        r = this.length;
      for (; r > n; n++)
        if (1 === this[n].nodeType && (' ' + this[n].className + ' ').replace(U, ' ').indexOf(t) >= 0) return !0;
      return !1;
    },
    val: function(e) {
      var n,
        r,
        i,
        o = this[0];
      {
        if (arguments.length)
          return (
            (i = x.isFunction(e)),
            this.each(function(n) {
              var o;
              1 === this.nodeType &&
                ((o = i ? e.call(this, n, x(this).val()) : e),
                null == o
                  ? (o = '')
                  : 'number' == typeof o
                  ? (o += '')
                  : x.isArray(o) &&
                    (o = x.map(o, function(e) {
                      return null == e ? '' : e + '';
                    })),
                (r = x.valHooks[this.type] || x.valHooks[this.nodeName.toLowerCase()]),
                (r && 'set' in r && r.set(this, o, 'value') !== t) || (this.value = o));
            })
          );
        if (o)
          return (
            (r = x.valHooks[o.type] || x.valHooks[o.nodeName.toLowerCase()]),
            r && 'get' in r && (n = r.get(o, 'value')) !== t
              ? n
              : ((n = o.value), 'string' == typeof n ? n.replace(V, '') : null == n ? '' : n)
          );
      }
    },
  }),
    x.extend({
      valHooks: {
        option: {
          get: function(e) {
            var t = x.find.attr(e, 'value');
            return null != t ? t : e.text;
          },
        },
        select: {
          get: function(e) {
            var t,
              n,
              r = e.options,
              i = e.selectedIndex,
              o = 'select-one' === e.type || 0 > i,
              a = o ? null : [],
              s = o ? i + 1 : r.length,
              l = 0 > i ? s : o ? i : 0;
            for (; s > l; l++)
              if (
                ((n = r[l]),
                !(
                  (!n.selected && l !== i) ||
                  (x.support.optDisabled ? n.disabled : null !== n.getAttribute('disabled')) ||
                  (n.parentNode.disabled && x.nodeName(n.parentNode, 'optgroup'))
                ))
              ) {
                if (((t = x(n).val()), o)) return t;
                a.push(t);
              }
            return a;
          },
          set: function(e, t) {
            var n,
              r,
              i = e.options,
              o = x.makeArray(t),
              a = i.length;
            while (a--) (r = i[a]), (r.selected = x.inArray(x(r).val(), o) >= 0) && (n = !0);
            return n || (e.selectedIndex = -1), o;
          },
        },
      },
      attr: function(e, n, r) {
        var o,
          a,
          s = e.nodeType;
        if (e && 3 !== s && 8 !== s && 2 !== s)
          return typeof e.getAttribute === i
            ? x.prop(e, n, r)
            : ((1 === s && x.isXMLDoc(e)) ||
                ((n = n.toLowerCase()), (o = x.attrHooks[n] || (x.expr.match.bool.test(n) ? X : z))),
              r === t
                ? o && 'get' in o && null !== (a = o.get(e, n))
                  ? a
                  : ((a = x.find.attr(e, n)), null == a ? t : a)
                : null !== r
                ? o && 'set' in o && (a = o.set(e, r, n)) !== t
                  ? a
                  : (e.setAttribute(n, r + ''), r)
                : (x.removeAttr(e, n), t));
      },
      removeAttr: function(e, t) {
        var n,
          r,
          i = 0,
          o = t && t.match(T);
        if (o && 1 === e.nodeType)
          while ((n = o[i++]))
            (r = x.propFix[n] || n),
              x.expr.match.bool.test(n)
                ? (K && Q) || !G.test(n)
                  ? (e[r] = !1)
                  : (e[x.camelCase('default-' + n)] = e[r] = !1)
                : x.attr(e, n, ''),
              e.removeAttribute(Q ? n : r);
      },
      attrHooks: {
        type: {
          set: function(e, t) {
            if (!x.support.radioValue && 'radio' === t && x.nodeName(e, 'input')) {
              var n = e.value;
              return e.setAttribute('type', t), n && (e.value = n), t;
            }
          },
        },
      },
      propFix: { for: 'htmlFor', class: 'className' },
      prop: function(e, n, r) {
        var i,
          o,
          a,
          s = e.nodeType;
        if (e && 3 !== s && 8 !== s && 2 !== s)
          return (
            (a = 1 !== s || !x.isXMLDoc(e)),
            a && ((n = x.propFix[n] || n), (o = x.propHooks[n])),
            r !== t
              ? o && 'set' in o && (i = o.set(e, r, n)) !== t
                ? i
                : (e[n] = r)
              : o && 'get' in o && null !== (i = o.get(e, n))
              ? i
              : e[n]
          );
      },
      propHooks: {
        tabIndex: {
          get: function(e) {
            var t = x.find.attr(e, 'tabindex');
            return t ? parseInt(t, 10) : Y.test(e.nodeName) || (J.test(e.nodeName) && e.href) ? 0 : -1;
          },
        },
      },
    }),
    (X = {
      set: function(e, t, n) {
        return (
          t === !1
            ? x.removeAttr(e, n)
            : (K && Q) || !G.test(n)
            ? e.setAttribute((!Q && x.propFix[n]) || n, n)
            : (e[x.camelCase('default-' + n)] = e[n] = !0),
          n
        );
      },
    }),
    x.each(x.expr.match.bool.source.match(/\w+/g), function(e, n) {
      var r = x.expr.attrHandle[n] || x.find.attr;
      x.expr.attrHandle[n] =
        (K && Q) || !G.test(n)
          ? function(e, n, i) {
              var o = x.expr.attrHandle[n],
                a = i ? t : (x.expr.attrHandle[n] = t) != r(e, n, i) ? n.toLowerCase() : null;
              return (x.expr.attrHandle[n] = o), a;
            }
          : function(e, n, r) {
              return r ? t : e[x.camelCase('default-' + n)] ? n.toLowerCase() : null;
            };
    }),
    (K && Q) ||
      (x.attrHooks.value = {
        set: function(e, n, r) {
          return x.nodeName(e, 'input') ? ((e.defaultValue = n), t) : z && z.set(e, n, r);
        },
      }),
    Q ||
      ((z = {
        set: function(e, n, r) {
          var i = e.getAttributeNode(r);
          return (
            i || e.setAttributeNode((i = e.ownerDocument.createAttribute(r))),
            (i.value = n += ''),
            'value' === r || n === e.getAttribute(r) ? n : t
          );
        },
      }),
      (x.expr.attrHandle.id = x.expr.attrHandle.name = x.expr.attrHandle.coords = function(e, n, r) {
        var i;
        return r ? t : (i = e.getAttributeNode(n)) && '' !== i.value ? i.value : null;
      }),
      (x.valHooks.button = {
        get: function(e, n) {
          var r = e.getAttributeNode(n);
          return r && r.specified ? r.value : t;
        },
        set: z.set,
      }),
      (x.attrHooks.contenteditable = {
        set: function(e, t, n) {
          z.set(e, '' === t ? !1 : t, n);
        },
      }),
      x.each(['width', 'height'], function(e, n) {
        x.attrHooks[n] = {
          set: function(e, r) {
            return '' === r ? (e.setAttribute(n, 'auto'), r) : t;
          },
        };
      })),
    x.support.hrefNormalized ||
      x.each(['href', 'src'], function(e, t) {
        x.propHooks[t] = {
          get: function(e) {
            return e.getAttribute(t, 4);
          },
        };
      }),
    x.support.style ||
      (x.attrHooks.style = {
        get: function(e) {
          return e.style.cssText || t;
        },
        set: function(e, t) {
          return (e.style.cssText = t + '');
        },
      }),
    x.support.optSelected ||
      (x.propHooks.selected = {
        get: function(e) {
          var t = e.parentNode;
          return t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex), null;
        },
      }),
    x.each(
      [
        'tabIndex',
        'readOnly',
        'maxLength',
        'cellSpacing',
        'cellPadding',
        'rowSpan',
        'colSpan',
        'useMap',
        'frameBorder',
        'contentEditable',
      ],
      function() {
        x.propFix[this.toLowerCase()] = this;
      }
    ),
    x.support.enctype || (x.propFix.enctype = 'encoding'),
    x.each(['radio', 'checkbox'], function() {
      (x.valHooks[this] = {
        set: function(e, n) {
          return x.isArray(n) ? (e.checked = x.inArray(x(e).val(), n) >= 0) : t;
        },
      }),
        x.support.checkOn ||
          (x.valHooks[this].get = function(e) {
            return null === e.getAttribute('value') ? 'on' : e.value;
          });
    });
  var Z = /^(?:input|select|textarea)$/i,
    et = /^key/,
    tt = /^(?:mouse|contextmenu)|click/,
    nt = /^(?:focusinfocus|focusoutblur)$/,
    rt = /^([^.]*)(?:\.(.+)|)$/;
  function it() {
    return !0;
  }
  function ot() {
    return !1;
  }
  function at() {
    try {
      return a.activeElement;
    } catch (e) {}
  }
  (x.event = {
    global: {},
    add: function(e, n, r, o, a) {
      var s,
        l,
        u,
        c,
        p,
        f,
        d,
        h,
        g,
        m,
        y,
        v = x._data(e);
      if (v) {
        r.handler && ((c = r), (r = c.handler), (a = c.selector)),
          r.guid || (r.guid = x.guid++),
          (l = v.events) || (l = v.events = {}),
          (f = v.handle) ||
            ((f = v.handle = function(e) {
              return typeof x === i || (e && x.event.triggered === e.type)
                ? t
                : x.event.dispatch.apply(f.elem, arguments);
            }),
            (f.elem = e)),
          (n = (n || '').match(T) || ['']),
          (u = n.length);
        while (u--)
          (s = rt.exec(n[u]) || []),
            (g = y = s[1]),
            (m = (s[2] || '').split('.').sort()),
            g &&
              ((p = x.event.special[g] || {}),
              (g = (a ? p.delegateType : p.bindType) || g),
              (p = x.event.special[g] || {}),
              (d = x.extend(
                {
                  type: g,
                  origType: y,
                  data: o,
                  handler: r,
                  guid: r.guid,
                  selector: a,
                  needsContext: a && x.expr.match.needsContext.test(a),
                  namespace: m.join('.'),
                },
                c
              )),
              (h = l[g]) ||
                ((h = l[g] = []),
                (h.delegateCount = 0),
                (p.setup && p.setup.call(e, o, m, f) !== !1) ||
                  (e.addEventListener ? e.addEventListener(g, f, !1) : e.attachEvent && e.attachEvent('on' + g, f))),
              p.add && (p.add.call(e, d), d.handler.guid || (d.handler.guid = r.guid)),
              a ? h.splice(h.delegateCount++, 0, d) : h.push(d),
              (x.event.global[g] = !0));
        e = null;
      }
    },
    remove: function(e, t, n, r, i) {
      var o,
        a,
        s,
        l,
        u,
        c,
        p,
        f,
        d,
        h,
        g,
        m = x.hasData(e) && x._data(e);
      if (m && (c = m.events)) {
        (t = (t || '').match(T) || ['']), (u = t.length);
        while (u--)
          if (((s = rt.exec(t[u]) || []), (d = g = s[1]), (h = (s[2] || '').split('.').sort()), d)) {
            (p = x.event.special[d] || {}),
              (d = (r ? p.delegateType : p.bindType) || d),
              (f = c[d] || []),
              (s = s[2] && RegExp('(^|\\.)' + h.join('\\.(?:.*\\.|)') + '(\\.|$)')),
              (l = o = f.length);
            while (o--)
              (a = f[o]),
                (!i && g !== a.origType) ||
                  (n && n.guid !== a.guid) ||
                  (s && !s.test(a.namespace)) ||
                  (r && r !== a.selector && ('**' !== r || !a.selector)) ||
                  (f.splice(o, 1), a.selector && f.delegateCount--, p.remove && p.remove.call(e, a));
            l &&
              !f.length &&
              ((p.teardown && p.teardown.call(e, h, m.handle) !== !1) || x.removeEvent(e, d, m.handle), delete c[d]);
          } else for (d in c) x.event.remove(e, d + t[u], n, r, !0);
        x.isEmptyObject(c) && (delete m.handle, x._removeData(e, 'events'));
      }
    },
    trigger: function(n, r, i, o) {
      var s,
        l,
        u,
        c,
        p,
        f,
        d,
        h = [i || a],
        g = v.call(n, 'type') ? n.type : n,
        m = v.call(n, 'namespace') ? n.namespace.split('.') : [];
      if (
        ((u = f = i = i || a),
        3 !== i.nodeType &&
          8 !== i.nodeType &&
          !nt.test(g + x.event.triggered) &&
          (g.indexOf('.') >= 0 && ((m = g.split('.')), (g = m.shift()), m.sort()),
          (l = 0 > g.indexOf(':') && 'on' + g),
          (n = n[x.expando] ? n : new x.Event(g, 'object' == typeof n && n)),
          (n.isTrigger = o ? 2 : 3),
          (n.namespace = m.join('.')),
          (n.namespace_re = n.namespace ? RegExp('(^|\\.)' + m.join('\\.(?:.*\\.|)') + '(\\.|$)') : null),
          (n.result = t),
          n.target || (n.target = i),
          (r = null == r ? [n] : x.makeArray(r, [n])),
          (p = x.event.special[g] || {}),
          o || !p.trigger || p.trigger.apply(i, r) !== !1))
      ) {
        if (!o && !p.noBubble && !x.isWindow(i)) {
          for (c = p.delegateType || g, nt.test(c + g) || (u = u.parentNode); u; u = u.parentNode) h.push(u), (f = u);
          f === (i.ownerDocument || a) && h.push(f.defaultView || f.parentWindow || e);
        }
        d = 0;
        while ((u = h[d++]) && !n.isPropagationStopped())
          (n.type = d > 1 ? c : p.bindType || g),
            (s = (x._data(u, 'events') || {})[n.type] && x._data(u, 'handle')),
            s && s.apply(u, r),
            (s = l && u[l]),
            s && x.acceptData(u) && s.apply && s.apply(u, r) === !1 && n.preventDefault();
        if (
          ((n.type = g),
          !o &&
            !n.isDefaultPrevented() &&
            (!p._default || p._default.apply(h.pop(), r) === !1) &&
            x.acceptData(i) &&
            l &&
            i[g] &&
            !x.isWindow(i))
        ) {
          (f = i[l]), f && (i[l] = null), (x.event.triggered = g);
          try {
            i[g]();
          } catch (y) {}
          (x.event.triggered = t), f && (i[l] = f);
        }
        return n.result;
      }
    },
    dispatch: function(e) {
      e = x.event.fix(e);
      var n,
        r,
        i,
        o,
        a,
        s = [],
        l = g.call(arguments),
        u = (x._data(this, 'events') || {})[e.type] || [],
        c = x.event.special[e.type] || {};
      if (((l[0] = e), (e.delegateTarget = this), !c.preDispatch || c.preDispatch.call(this, e) !== !1)) {
        (s = x.event.handlers.call(this, e, u)), (n = 0);
        while ((o = s[n++]) && !e.isPropagationStopped()) {
          (e.currentTarget = o.elem), (a = 0);
          while ((i = o.handlers[a++]) && !e.isImmediatePropagationStopped())
            (!e.namespace_re || e.namespace_re.test(i.namespace)) &&
              ((e.handleObj = i),
              (e.data = i.data),
              (r = ((x.event.special[i.origType] || {}).handle || i.handler).apply(o.elem, l)),
              r !== t && (e.result = r) === !1 && (e.preventDefault(), e.stopPropagation()));
        }
        return c.postDispatch && c.postDispatch.call(this, e), e.result;
      }
    },
    handlers: function(e, n) {
      var r,
        i,
        o,
        a,
        s = [],
        l = n.delegateCount,
        u = e.target;
      if (l && u.nodeType && (!e.button || 'click' !== e.type))
        for (; u != this; u = u.parentNode || this)
          if (1 === u.nodeType && (u.disabled !== !0 || 'click' !== e.type)) {
            for (o = [], a = 0; l > a; a++)
              (i = n[a]),
                (r = i.selector + ' '),
                o[r] === t && (o[r] = i.needsContext ? x(r, this).index(u) >= 0 : x.find(r, this, null, [u]).length),
                o[r] && o.push(i);
            o.length && s.push({ elem: u, handlers: o });
          }
      return n.length > l && s.push({ elem: this, handlers: n.slice(l) }), s;
    },
    fix: function(e) {
      if (e[x.expando]) return e;
      var t,
        n,
        r,
        i = e.type,
        o = e,
        s = this.fixHooks[i];
      s || (this.fixHooks[i] = s = tt.test(i) ? this.mouseHooks : et.test(i) ? this.keyHooks : {}),
        (r = s.props ? this.props.concat(s.props) : this.props),
        (e = new x.Event(o)),
        (t = r.length);
      while (t--) (n = r[t]), (e[n] = o[n]);
      return (
        e.target || (e.target = o.srcElement || a),
        3 === e.target.nodeType && (e.target = e.target.parentNode),
        (e.metaKey = !!e.metaKey),
        s.filter ? s.filter(e, o) : e
      );
    },
    props: 'altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which'.split(
      ' '
    ),
    fixHooks: {},
    keyHooks: {
      props: 'char charCode key keyCode'.split(' '),
      filter: function(e, t) {
        return null == e.which && (e.which = null != t.charCode ? t.charCode : t.keyCode), e;
      },
    },
    mouseHooks: {
      props: 'button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement'.split(
        ' '
      ),
      filter: function(e, n) {
        var r,
          i,
          o,
          s = n.button,
          l = n.fromElement;
        return (
          null == e.pageX &&
            null != n.clientX &&
            ((i = e.target.ownerDocument || a),
            (o = i.documentElement),
            (r = i.body),
            (e.pageX =
              n.clientX +
              ((o && o.scrollLeft) || (r && r.scrollLeft) || 0) -
              ((o && o.clientLeft) || (r && r.clientLeft) || 0)),
            (e.pageY =
              n.clientY +
              ((o && o.scrollTop) || (r && r.scrollTop) || 0) -
              ((o && o.clientTop) || (r && r.clientTop) || 0))),
          !e.relatedTarget && l && (e.relatedTarget = l === e.target ? n.toElement : l),
          e.which || s === t || (e.which = 1 & s ? 1 : 2 & s ? 3 : 4 & s ? 2 : 0),
          e
        );
      },
    },
    special: {
      load: { noBubble: !0 },
      focus: {
        trigger: function() {
          if (this !== at() && this.focus)
            try {
              return this.focus(), !1;
            } catch (e) {}
        },
        delegateType: 'focusin',
      },
      blur: {
        trigger: function() {
          return this === at() && this.blur ? (this.blur(), !1) : t;
        },
        delegateType: 'focusout',
      },
      click: {
        trigger: function() {
          return x.nodeName(this, 'input') && 'checkbox' === this.type && this.click ? (this.click(), !1) : t;
        },
        _default: function(e) {
          return x.nodeName(e.target, 'a');
        },
      },
      beforeunload: {
        postDispatch: function(e) {
          e.result !== t && (e.originalEvent.returnValue = e.result);
        },
      },
    },
    simulate: function(e, t, n, r) {
      var i = x.extend(new x.Event(), n, { type: e, isSimulated: !0, originalEvent: {} });
      r ? x.event.trigger(i, null, t) : x.event.dispatch.call(t, i), i.isDefaultPrevented() && n.preventDefault();
    },
  }),
    (x.removeEvent = a.removeEventListener
      ? function(e, t, n) {
          e.removeEventListener && e.removeEventListener(t, n, !1);
        }
      : function(e, t, n) {
          var r = 'on' + t;
          e.detachEvent && (typeof e[r] === i && (e[r] = null), e.detachEvent(r, n));
        }),
    (x.Event = function(e, n) {
      return this instanceof x.Event
        ? (e && e.type
            ? ((this.originalEvent = e),
              (this.type = e.type),
              (this.isDefaultPrevented =
                e.defaultPrevented || e.returnValue === !1 || (e.getPreventDefault && e.getPreventDefault()) ? it : ot))
            : (this.type = e),
          n && x.extend(this, n),
          (this.timeStamp = (e && e.timeStamp) || x.now()),
          (this[x.expando] = !0),
          t)
        : new x.Event(e, n);
    }),
    (x.Event.prototype = {
      isDefaultPrevented: ot,
      isPropagationStopped: ot,
      isImmediatePropagationStopped: ot,
      preventDefault: function() {
        var e = this.originalEvent;
        (this.isDefaultPrevented = it), e && (e.preventDefault ? e.preventDefault() : (e.returnValue = !1));
      },
      stopPropagation: function() {
        var e = this.originalEvent;
        (this.isPropagationStopped = it), e && (e.stopPropagation && e.stopPropagation(), (e.cancelBubble = !0));
      },
      stopImmediatePropagation: function() {
        (this.isImmediatePropagationStopped = it), this.stopPropagation();
      },
    }),
    x.each({ mouseenter: 'mouseover', mouseleave: 'mouseout' }, function(e, t) {
      x.event.special[e] = {
        delegateType: t,
        bindType: t,
        handle: function(e) {
          var n,
            r = this,
            i = e.relatedTarget,
            o = e.handleObj;
          return (
            (!i || (i !== r && !x.contains(r, i))) &&
              ((e.type = o.origType), (n = o.handler.apply(this, arguments)), (e.type = t)),
            n
          );
        },
      };
    }),
    x.support.submitBubbles ||
      (x.event.special.submit = {
        setup: function() {
          return x.nodeName(this, 'form')
            ? !1
            : (x.event.add(this, 'click._submit keypress._submit', function(e) {
                var n = e.target,
                  r = x.nodeName(n, 'input') || x.nodeName(n, 'button') ? n.form : t;
                r &&
                  !x._data(r, 'submitBubbles') &&
                  (x.event.add(r, 'submit._submit', function(e) {
                    e._submit_bubble = !0;
                  }),
                  x._data(r, 'submitBubbles', !0));
              }),
              t);
        },
        postDispatch: function(e) {
          e._submit_bubble &&
            (delete e._submit_bubble,
            this.parentNode && !e.isTrigger && x.event.simulate('submit', this.parentNode, e, !0));
        },
        teardown: function() {
          return x.nodeName(this, 'form') ? !1 : (x.event.remove(this, '._submit'), t);
        },
      }),
    x.support.changeBubbles ||
      (x.event.special.change = {
        setup: function() {
          return Z.test(this.nodeName)
            ? (('checkbox' === this.type || 'radio' === this.type) &&
                (x.event.add(this, 'propertychange._change', function(e) {
                  'checked' === e.originalEvent.propertyName && (this._just_changed = !0);
                }),
                x.event.add(this, 'click._change', function(e) {
                  this._just_changed && !e.isTrigger && (this._just_changed = !1),
                    x.event.simulate('change', this, e, !0);
                })),
              !1)
            : (x.event.add(this, 'beforeactivate._change', function(e) {
                var t = e.target;
                Z.test(t.nodeName) &&
                  !x._data(t, 'changeBubbles') &&
                  (x.event.add(t, 'change._change', function(e) {
                    !this.parentNode ||
                      e.isSimulated ||
                      e.isTrigger ||
                      x.event.simulate('change', this.parentNode, e, !0);
                  }),
                  x._data(t, 'changeBubbles', !0));
              }),
              t);
        },
        handle: function(e) {
          var n = e.target;
          return this !== n || e.isSimulated || e.isTrigger || ('radio' !== n.type && 'checkbox' !== n.type)
            ? e.handleObj.handler.apply(this, arguments)
            : t;
        },
        teardown: function() {
          return x.event.remove(this, '._change'), !Z.test(this.nodeName);
        },
      }),
    x.support.focusinBubbles ||
      x.each({ focus: 'focusin', blur: 'focusout' }, function(e, t) {
        var n = 0,
          r = function(e) {
            x.event.simulate(t, e.target, x.event.fix(e), !0);
          };
        x.event.special[t] = {
          setup: function() {
            0 === n++ && a.addEventListener(e, r, !0);
          },
          teardown: function() {
            0 === --n && a.removeEventListener(e, r, !0);
          },
        };
      }),
    x.fn.extend({
      on: function(e, n, r, i, o) {
        var a, s;
        if ('object' == typeof e) {
          'string' != typeof n && ((r = r || n), (n = t));
          for (a in e) this.on(a, n, r, e[a], o);
          return this;
        }
        if (
          (null == r && null == i
            ? ((i = n), (r = n = t))
            : null == i && ('string' == typeof n ? ((i = r), (r = t)) : ((i = r), (r = n), (n = t))),
          i === !1)
        )
          i = ot;
        else if (!i) return this;
        return (
          1 === o &&
            ((s = i),
            (i = function(e) {
              return x().off(e), s.apply(this, arguments);
            }),
            (i.guid = s.guid || (s.guid = x.guid++))),
          this.each(function() {
            x.event.add(this, e, i, r, n);
          })
        );
      },
      one: function(e, t, n, r) {
        return this.on(e, t, n, r, 1);
      },
      off: function(e, n, r) {
        var i, o;
        if (e && e.preventDefault && e.handleObj)
          return (
            (i = e.handleObj),
            x(e.delegateTarget).off(i.namespace ? i.origType + '.' + i.namespace : i.origType, i.selector, i.handler),
            this
          );
        if ('object' == typeof e) {
          for (o in e) this.off(o, n, e[o]);
          return this;
        }
        return (
          (n === !1 || 'function' == typeof n) && ((r = n), (n = t)),
          r === !1 && (r = ot),
          this.each(function() {
            x.event.remove(this, e, r, n);
          })
        );
      },
      trigger: function(e, t) {
        return this.each(function() {
          x.event.trigger(e, t, this);
        });
      },
      triggerHandler: function(e, n) {
        var r = this[0];
        return r ? x.event.trigger(e, n, r, !0) : t;
      },
    });
  var st = /^.[^:#\[\.,]*$/,
    lt = /^(?:parents|prev(?:Until|All))/,
    ut = x.expr.match.needsContext,
    ct = { children: !0, contents: !0, next: !0, prev: !0 };
  x.fn.extend({
    find: function(e) {
      var t,
        n = [],
        r = this,
        i = r.length;
      if ('string' != typeof e)
        return this.pushStack(
          x(e).filter(function() {
            for (t = 0; i > t; t++) if (x.contains(r[t], this)) return !0;
          })
        );
      for (t = 0; i > t; t++) x.find(e, r[t], n);
      return (
        (n = this.pushStack(i > 1 ? x.unique(n) : n)), (n.selector = this.selector ? this.selector + ' ' + e : e), n
      );
    },
    has: function(e) {
      var t,
        n = x(e, this),
        r = n.length;
      return this.filter(function() {
        for (t = 0; r > t; t++) if (x.contains(this, n[t])) return !0;
      });
    },
    not: function(e) {
      return this.pushStack(ft(this, e || [], !0));
    },
    filter: function(e) {
      return this.pushStack(ft(this, e || [], !1));
    },
    is: function(e) {
      return !!ft(this, 'string' == typeof e && ut.test(e) ? x(e) : e || [], !1).length;
    },
    closest: function(e, t) {
      var n,
        r = 0,
        i = this.length,
        o = [],
        a = ut.test(e) || 'string' != typeof e ? x(e, t || this.context) : 0;
      for (; i > r; r++)
        for (n = this[r]; n && n !== t; n = n.parentNode)
          if (11 > n.nodeType && (a ? a.index(n) > -1 : 1 === n.nodeType && x.find.matchesSelector(n, e))) {
            n = o.push(n);
            break;
          }
      return this.pushStack(o.length > 1 ? x.unique(o) : o);
    },
    index: function(e) {
      return e
        ? 'string' == typeof e
          ? x.inArray(this[0], x(e))
          : x.inArray(e.jquery ? e[0] : e, this)
        : this[0] && this[0].parentNode
        ? this.first().prevAll().length
        : -1;
    },
    add: function(e, t) {
      var n = 'string' == typeof e ? x(e, t) : x.makeArray(e && e.nodeType ? [e] : e),
        r = x.merge(this.get(), n);
      return this.pushStack(x.unique(r));
    },
    addBack: function(e) {
      return this.add(null == e ? this.prevObject : this.prevObject.filter(e));
    },
  });
  function pt(e, t) {
    do e = e[t];
    while (e && 1 !== e.nodeType);
    return e;
  }
  x.each(
    {
      parent: function(e) {
        var t = e.parentNode;
        return t && 11 !== t.nodeType ? t : null;
      },
      parents: function(e) {
        return x.dir(e, 'parentNode');
      },
      parentsUntil: function(e, t, n) {
        return x.dir(e, 'parentNode', n);
      },
      next: function(e) {
        return pt(e, 'nextSibling');
      },
      prev: function(e) {
        return pt(e, 'previousSibling');
      },
      nextAll: function(e) {
        return x.dir(e, 'nextSibling');
      },
      prevAll: function(e) {
        return x.dir(e, 'previousSibling');
      },
      nextUntil: function(e, t, n) {
        return x.dir(e, 'nextSibling', n);
      },
      prevUntil: function(e, t, n) {
        return x.dir(e, 'previousSibling', n);
      },
      siblings: function(e) {
        return x.sibling((e.parentNode || {}).firstChild, e);
      },
      children: function(e) {
        return x.sibling(e.firstChild);
      },
      contents: function(e) {
        return x.nodeName(e, 'iframe') ? e.contentDocument || e.contentWindow.document : x.merge([], e.childNodes);
      },
    },
    function(e, t) {
      x.fn[e] = function(n, r) {
        var i = x.map(this, t, n);
        return (
          'Until' !== e.slice(-5) && (r = n),
          r && 'string' == typeof r && (i = x.filter(r, i)),
          this.length > 1 && (ct[e] || (i = x.unique(i)), lt.test(e) && (i = i.reverse())),
          this.pushStack(i)
        );
      };
    }
  ),
    x.extend({
      filter: function(e, t, n) {
        var r = t[0];
        return (
          n && (e = ':not(' + e + ')'),
          1 === t.length && 1 === r.nodeType
            ? x.find.matchesSelector(r, e)
              ? [r]
              : []
            : x.find.matches(
                e,
                x.grep(t, function(e) {
                  return 1 === e.nodeType;
                })
              )
        );
      },
      dir: function(e, n, r) {
        var i = [],
          o = e[n];
        while (o && 9 !== o.nodeType && (r === t || 1 !== o.nodeType || !x(o).is(r)))
          1 === o.nodeType && i.push(o), (o = o[n]);
        return i;
      },
      sibling: function(e, t) {
        var n = [];
        for (; e; e = e.nextSibling) 1 === e.nodeType && e !== t && n.push(e);
        return n;
      },
    });
  function ft(e, t, n) {
    if (x.isFunction(t))
      return x.grep(e, function(e, r) {
        return !!t.call(e, r, e) !== n;
      });
    if (t.nodeType)
      return x.grep(e, function(e) {
        return (e === t) !== n;
      });
    if ('string' == typeof t) {
      if (st.test(t)) return x.filter(t, e, n);
      t = x.filter(t, e);
    }
    return x.grep(e, function(e) {
      return x.inArray(e, t) >= 0 !== n;
    });
  }
  function dt(e) {
    var t = ht.split('|'),
      n = e.createDocumentFragment();
    if (n.createElement) while (t.length) n.createElement(t.pop());
    return n;
  }
  var ht =
      'abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video',
    gt = / jQuery\d+="(?:null|\d+)"/g,
    mt = RegExp('<(?:' + ht + ')[\\s/>]', 'i'),
    yt = /^\s+/,
    vt = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
    bt = /<([\w:]+)/,
    xt = /<tbody/i,
    wt = /<|&#?\w+;/,
    Tt = /<(?:script|style|link)/i,
    Ct = /^(?:checkbox|radio)$/i,
    Nt = /checked\s*(?:[^=]|=\s*.checked.)/i,
    kt = /^$|\/(?:java|ecma)script/i,
    Et = /^true\/(.*)/,
    St = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
    At = {
      option: [1, "<select multiple='multiple'>", '</select>'],
      legend: [1, '<fieldset>', '</fieldset>'],
      area: [1, '<map>', '</map>'],
      param: [1, '<object>', '</object>'],
      thead: [1, '<table>', '</table>'],
      tr: [2, '<table><tbody>', '</tbody></table>'],
      col: [2, '<table><tbody></tbody><colgroup>', '</colgroup></table>'],
      td: [3, '<table><tbody><tr>', '</tr></tbody></table>'],
      _default: x.support.htmlSerialize ? [0, '', ''] : [1, 'X<div>', '</div>'],
    },
    jt = dt(a),
    Dt = jt.appendChild(a.createElement('div'));
  (At.optgroup = At.option),
    (At.tbody = At.tfoot = At.colgroup = At.caption = At.thead),
    (At.th = At.td),
    x.fn.extend({
      text: function(e) {
        return x.access(
          this,
          function(e) {
            return e === t
              ? x.text(this)
              : this.empty().append(((this[0] && this[0].ownerDocument) || a).createTextNode(e));
          },
          null,
          e,
          arguments.length
        );
      },
      append: function() {
        return this.domManip(arguments, function(e) {
          if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
            var t = Lt(this, e);
            t.appendChild(e);
          }
        });
      },
      prepend: function() {
        return this.domManip(arguments, function(e) {
          if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
            var t = Lt(this, e);
            t.insertBefore(e, t.firstChild);
          }
        });
      },
      before: function() {
        return this.domManip(arguments, function(e) {
          this.parentNode && this.parentNode.insertBefore(e, this);
        });
      },
      after: function() {
        return this.domManip(arguments, function(e) {
          this.parentNode && this.parentNode.insertBefore(e, this.nextSibling);
        });
      },
      remove: function(e, t) {
        var n,
          r = e ? x.filter(e, this) : this,
          i = 0;
        for (; null != (n = r[i]); i++)
          t || 1 !== n.nodeType || x.cleanData(Ft(n)),
            n.parentNode && (t && x.contains(n.ownerDocument, n) && _t(Ft(n, 'script')), n.parentNode.removeChild(n));
        return this;
      },
      empty: function() {
        var e,
          t = 0;
        for (; null != (e = this[t]); t++) {
          1 === e.nodeType && x.cleanData(Ft(e, !1));
          while (e.firstChild) e.removeChild(e.firstChild);
          e.options && x.nodeName(e, 'select') && (e.options.length = 0);
        }
        return this;
      },
      clone: function(e, t) {
        return (
          (e = null == e ? !1 : e),
          (t = null == t ? e : t),
          this.map(function() {
            return x.clone(this, e, t);
          })
        );
      },
      html: function(e) {
        return x.access(
          this,
          function(e) {
            var n = this[0] || {},
              r = 0,
              i = this.length;
            if (e === t) return 1 === n.nodeType ? n.innerHTML.replace(gt, '') : t;
            if (
              !(
                'string' != typeof e ||
                Tt.test(e) ||
                (!x.support.htmlSerialize && mt.test(e)) ||
                (!x.support.leadingWhitespace && yt.test(e)) ||
                At[(bt.exec(e) || ['', ''])[1].toLowerCase()]
              )
            ) {
              e = e.replace(vt, '<$1></$2>');
              try {
                for (; i > r; r++) (n = this[r] || {}), 1 === n.nodeType && (x.cleanData(Ft(n, !1)), (n.innerHTML = e));
                n = 0;
              } catch (o) {}
            }
            n && this.empty().append(e);
          },
          null,
          e,
          arguments.length
        );
      },
      replaceWith: function() {
        var e = x.map(this, function(e) {
            return [e.nextSibling, e.parentNode];
          }),
          t = 0;
        return (
          this.domManip(
            arguments,
            function(n) {
              var r = e[t++],
                i = e[t++];
              i && (r && r.parentNode !== i && (r = this.nextSibling), x(this).remove(), i.insertBefore(n, r));
            },
            !0
          ),
          t ? this : this.remove()
        );
      },
      detach: function(e) {
        return this.remove(e, !0);
      },
      domManip: function(e, t, n) {
        e = d.apply([], e);
        var r,
          i,
          o,
          a,
          s,
          l,
          u = 0,
          c = this.length,
          p = this,
          f = c - 1,
          h = e[0],
          g = x.isFunction(h);
        if (g || (!(1 >= c || 'string' != typeof h || x.support.checkClone) && Nt.test(h)))
          return this.each(function(r) {
            var i = p.eq(r);
            g && (e[0] = h.call(this, r, i.html())), i.domManip(e, t, n);
          });
        if (
          c &&
          ((l = x.buildFragment(e, this[0].ownerDocument, !1, !n && this)),
          (r = l.firstChild),
          1 === l.childNodes.length && (l = r),
          r)
        ) {
          for (a = x.map(Ft(l, 'script'), Ht), o = a.length; c > u; u++)
            (i = l), u !== f && ((i = x.clone(i, !0, !0)), o && x.merge(a, Ft(i, 'script'))), t.call(this[u], i, u);
          if (o)
            for (s = a[a.length - 1].ownerDocument, x.map(a, qt), u = 0; o > u; u++)
              (i = a[u]),
                kt.test(i.type || '') &&
                  !x._data(i, 'globalEval') &&
                  x.contains(s, i) &&
                  (i.src
                    ? x._evalUrl(i.src)
                    : x.globalEval((i.text || i.textContent || i.innerHTML || '').replace(St, '')));
          l = r = null;
        }
        return this;
      },
    });
  function Lt(e, t) {
    return x.nodeName(e, 'table') && x.nodeName(1 === t.nodeType ? t : t.firstChild, 'tr')
      ? e.getElementsByTagName('tbody')[0] || e.appendChild(e.ownerDocument.createElement('tbody'))
      : e;
  }
  function Ht(e) {
    return (e.type = (null !== x.find.attr(e, 'type')) + '/' + e.type), e;
  }
  function qt(e) {
    var t = Et.exec(e.type);
    return t ? (e.type = t[1]) : e.removeAttribute('type'), e;
  }
  function _t(e, t) {
    var n,
      r = 0;
    for (; null != (n = e[r]); r++) x._data(n, 'globalEval', !t || x._data(t[r], 'globalEval'));
  }
  function Mt(e, t) {
    if (1 === t.nodeType && x.hasData(e)) {
      var n,
        r,
        i,
        o = x._data(e),
        a = x._data(t, o),
        s = o.events;
      if (s) {
        delete a.handle, (a.events = {});
        for (n in s) for (r = 0, i = s[n].length; i > r; r++) x.event.add(t, n, s[n][r]);
      }
      a.data && (a.data = x.extend({}, a.data));
    }
  }
  function Ot(e, t) {
    var n, r, i;
    if (1 === t.nodeType) {
      if (((n = t.nodeName.toLowerCase()), !x.support.noCloneEvent && t[x.expando])) {
        i = x._data(t);
        for (r in i.events) x.removeEvent(t, r, i.handle);
        t.removeAttribute(x.expando);
      }
      'script' === n && t.text !== e.text
        ? ((Ht(t).text = e.text), qt(t))
        : 'object' === n
        ? (t.parentNode && (t.outerHTML = e.outerHTML),
          x.support.html5Clone && e.innerHTML && !x.trim(t.innerHTML) && (t.innerHTML = e.innerHTML))
        : 'input' === n && Ct.test(e.type)
        ? ((t.defaultChecked = t.checked = e.checked), t.value !== e.value && (t.value = e.value))
        : 'option' === n
        ? (t.defaultSelected = t.selected = e.defaultSelected)
        : ('input' === n || 'textarea' === n) && (t.defaultValue = e.defaultValue);
    }
  }
  x.each(
    {
      appendTo: 'append',
      prependTo: 'prepend',
      insertBefore: 'before',
      insertAfter: 'after',
      replaceAll: 'replaceWith',
    },
    function(e, t) {
      x.fn[e] = function(e) {
        var n,
          r = 0,
          i = [],
          o = x(e),
          a = o.length - 1;
        for (; a >= r; r++) (n = r === a ? this : this.clone(!0)), x(o[r])[t](n), h.apply(i, n.get());
        return this.pushStack(i);
      };
    }
  );
  function Ft(e, n) {
    var r,
      o,
      a = 0,
      s =
        typeof e.getElementsByTagName !== i
          ? e.getElementsByTagName(n || '*')
          : typeof e.querySelectorAll !== i
          ? e.querySelectorAll(n || '*')
          : t;
    if (!s)
      for (s = [], r = e.childNodes || e; null != (o = r[a]); a++)
        !n || x.nodeName(o, n) ? s.push(o) : x.merge(s, Ft(o, n));
    return n === t || (n && x.nodeName(e, n)) ? x.merge([e], s) : s;
  }
  function Bt(e) {
    Ct.test(e.type) && (e.defaultChecked = e.checked);
  }
  x.extend({
    clone: function(e, t, n) {
      var r,
        i,
        o,
        a,
        s,
        l = x.contains(e.ownerDocument, e);
      if (
        (x.support.html5Clone || x.isXMLDoc(e) || !mt.test('<' + e.nodeName + '>')
          ? (o = e.cloneNode(!0))
          : ((Dt.innerHTML = e.outerHTML), Dt.removeChild((o = Dt.firstChild))),
        !(
          (x.support.noCloneEvent && x.support.noCloneChecked) ||
          (1 !== e.nodeType && 11 !== e.nodeType) ||
          x.isXMLDoc(e)
        ))
      )
        for (r = Ft(o), s = Ft(e), a = 0; null != (i = s[a]); ++a) r[a] && Ot(i, r[a]);
      if (t)
        if (n) for (s = s || Ft(e), r = r || Ft(o), a = 0; null != (i = s[a]); a++) Mt(i, r[a]);
        else Mt(e, o);
      return (r = Ft(o, 'script')), r.length > 0 && _t(r, !l && Ft(e, 'script')), (r = s = i = null), o;
    },
    buildFragment: function(e, t, n, r) {
      var i,
        o,
        a,
        s,
        l,
        u,
        c,
        p = e.length,
        f = dt(t),
        d = [],
        h = 0;
      for (; p > h; h++)
        if (((o = e[h]), o || 0 === o))
          if ('object' === x.type(o)) x.merge(d, o.nodeType ? [o] : o);
          else if (wt.test(o)) {
            (s = s || f.appendChild(t.createElement('div'))),
              (l = (bt.exec(o) || ['', ''])[1].toLowerCase()),
              (c = At[l] || At._default),
              (s.innerHTML = c[1] + o.replace(vt, '<$1></$2>') + c[2]),
              (i = c[0]);
            while (i--) s = s.lastChild;
            if (
              (!x.support.leadingWhitespace && yt.test(o) && d.push(t.createTextNode(yt.exec(o)[0])), !x.support.tbody)
            ) {
              (o = 'table' !== l || xt.test(o) ? ('<table>' !== c[1] || xt.test(o) ? 0 : s) : s.firstChild),
                (i = o && o.childNodes.length);
              while (i--) x.nodeName((u = o.childNodes[i]), 'tbody') && !u.childNodes.length && o.removeChild(u);
            }
            x.merge(d, s.childNodes), (s.textContent = '');
            while (s.firstChild) s.removeChild(s.firstChild);
            s = f.lastChild;
          } else d.push(t.createTextNode(o));
      s && f.removeChild(s), x.support.appendChecked || x.grep(Ft(d, 'input'), Bt), (h = 0);
      while ((o = d[h++]))
        if (
          (!r || -1 === x.inArray(o, r)) &&
          ((a = x.contains(o.ownerDocument, o)), (s = Ft(f.appendChild(o), 'script')), a && _t(s), n)
        ) {
          i = 0;
          while ((o = s[i++])) kt.test(o.type || '') && n.push(o);
        }
      return (s = null), f;
    },
    cleanData: function(e, t) {
      var n,
        r,
        o,
        a,
        s = 0,
        l = x.expando,
        u = x.cache,
        c = x.support.deleteExpando,
        f = x.event.special;
      for (; null != (n = e[s]); s++)
        if ((t || x.acceptData(n)) && ((o = n[l]), (a = o && u[o]))) {
          if (a.events) for (r in a.events) f[r] ? x.event.remove(n, r) : x.removeEvent(n, r, a.handle);
          u[o] &&
            (delete u[o],
            c ? delete n[l] : typeof n.removeAttribute !== i ? n.removeAttribute(l) : (n[l] = null),
            p.push(o));
        }
    },
    _evalUrl: function(e) {
      return x.ajax({ url: e, type: 'GET', dataType: 'script', async: !1, global: !1, throws: !0 });
    },
  }),
    x.fn.extend({
      wrapAll: function(e) {
        if (x.isFunction(e))
          return this.each(function(t) {
            x(this).wrapAll(e.call(this, t));
          });
        if (this[0]) {
          var t = x(e, this[0].ownerDocument)
            .eq(0)
            .clone(!0);
          this[0].parentNode && t.insertBefore(this[0]),
            t
              .map(function() {
                var e = this;
                while (e.firstChild && 1 === e.firstChild.nodeType) e = e.firstChild;
                return e;
              })
              .append(this);
        }
        return this;
      },
      wrapInner: function(e) {
        return x.isFunction(e)
          ? this.each(function(t) {
              x(this).wrapInner(e.call(this, t));
            })
          : this.each(function() {
              var t = x(this),
                n = t.contents();
              n.length ? n.wrapAll(e) : t.append(e);
            });
      },
      wrap: function(e) {
        var t = x.isFunction(e);
        return this.each(function(n) {
          x(this).wrapAll(t ? e.call(this, n) : e);
        });
      },
      unwrap: function() {
        return this.parent()
          .each(function() {
            x.nodeName(this, 'body') || x(this).replaceWith(this.childNodes);
          })
          .end();
      },
    });
  var Pt,
    Rt,
    Wt,
    $t = /alpha\([^)]*\)/i,
    It = /opacity\s*=\s*([^)]*)/,
    zt = /^(top|right|bottom|left)$/,
    Xt = /^(none|table(?!-c[ea]).+)/,
    Ut = /^margin/,
    Vt = RegExp('^(' + w + ')(.*)$', 'i'),
    Yt = RegExp('^(' + w + ')(?!px)[a-z%]+$', 'i'),
    Jt = RegExp('^([+-])=(' + w + ')', 'i'),
    Gt = { BODY: 'block' },
    Qt = { position: 'absolute', visibility: 'hidden', display: 'block' },
    Kt = { letterSpacing: 0, fontWeight: 400 },
    Zt = ['Top', 'Right', 'Bottom', 'Left'],
    en = ['Webkit', 'O', 'Moz', 'ms'];
  function tn(e, t) {
    if (t in e) return t;
    var n = t.charAt(0).toUpperCase() + t.slice(1),
      r = t,
      i = en.length;
    while (i--) if (((t = en[i] + n), t in e)) return t;
    return r;
  }
  function nn(e, t) {
    return (e = t || e), 'none' === x.css(e, 'display') || !x.contains(e.ownerDocument, e);
  }
  function rn(e, t) {
    var n,
      r,
      i,
      o = [],
      a = 0,
      s = e.length;
    for (; s > a; a++)
      (r = e[a]),
        r.style &&
          ((o[a] = x._data(r, 'olddisplay')),
          (n = r.style.display),
          t
            ? (o[a] || 'none' !== n || (r.style.display = ''),
              '' === r.style.display && nn(r) && (o[a] = x._data(r, 'olddisplay', ln(r.nodeName))))
            : o[a] ||
              ((i = nn(r)), ((n && 'none' !== n) || !i) && x._data(r, 'olddisplay', i ? n : x.css(r, 'display'))));
    for (a = 0; s > a; a++)
      (r = e[a]),
        r.style &&
          ((t && 'none' !== r.style.display && '' !== r.style.display) || (r.style.display = t ? o[a] || '' : 'none'));
    return e;
  }
  x.fn.extend({
    css: function(e, n) {
      return x.access(
        this,
        function(e, n, r) {
          var i,
            o,
            a = {},
            s = 0;
          if (x.isArray(n)) {
            for (o = Rt(e), i = n.length; i > s; s++) a[n[s]] = x.css(e, n[s], !1, o);
            return a;
          }
          return r !== t ? x.style(e, n, r) : x.css(e, n);
        },
        e,
        n,
        arguments.length > 1
      );
    },
    show: function() {
      return rn(this, !0);
    },
    hide: function() {
      return rn(this);
    },
    toggle: function(e) {
      return 'boolean' == typeof e
        ? e
          ? this.show()
          : this.hide()
        : this.each(function() {
            nn(this) ? x(this).show() : x(this).hide();
          });
    },
  }),
    x.extend({
      cssHooks: {
        opacity: {
          get: function(e, t) {
            if (t) {
              var n = Wt(e, 'opacity');
              return '' === n ? '1' : n;
            }
          },
        },
      },
      cssNumber: {
        columnCount: !0,
        fillOpacity: !0,
        fontWeight: !0,
        lineHeight: !0,
        opacity: !0,
        order: !0,
        orphans: !0,
        widows: !0,
        zIndex: !0,
        zoom: !0,
      },
      cssProps: { float: x.support.cssFloat ? 'cssFloat' : 'styleFloat' },
      style: function(e, n, r, i) {
        if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) {
          var o,
            a,
            s,
            l = x.camelCase(n),
            u = e.style;
          if (((n = x.cssProps[l] || (x.cssProps[l] = tn(u, l))), (s = x.cssHooks[n] || x.cssHooks[l]), r === t))
            return s && 'get' in s && (o = s.get(e, !1, i)) !== t ? o : u[n];
          if (
            ((a = typeof r),
            'string' === a && (o = Jt.exec(r)) && ((r = (o[1] + 1) * o[2] + parseFloat(x.css(e, n))), (a = 'number')),
            !(
              null == r ||
              ('number' === a && isNaN(r)) ||
              ('number' !== a || x.cssNumber[l] || (r += 'px'),
              x.support.clearCloneStyle || '' !== r || 0 !== n.indexOf('background') || (u[n] = 'inherit'),
              s && 'set' in s && (r = s.set(e, r, i)) === t)
            ))
          )
            try {
              u[n] = r;
            } catch (c) {}
        }
      },
      css: function(e, n, r, i) {
        var o,
          a,
          s,
          l = x.camelCase(n);
        return (
          (n = x.cssProps[l] || (x.cssProps[l] = tn(e.style, l))),
          (s = x.cssHooks[n] || x.cssHooks[l]),
          s && 'get' in s && (a = s.get(e, !0, r)),
          a === t && (a = Wt(e, n, i)),
          'normal' === a && n in Kt && (a = Kt[n]),
          '' === r || r ? ((o = parseFloat(a)), r === !0 || x.isNumeric(o) ? o || 0 : a) : a
        );
      },
    }),
    e.getComputedStyle
      ? ((Rt = function(t) {
          return e.getComputedStyle(t, null);
        }),
        (Wt = function(e, n, r) {
          var i,
            o,
            a,
            s = r || Rt(e),
            l = s ? s.getPropertyValue(n) || s[n] : t,
            u = e.style;
          return (
            s &&
              ('' !== l || x.contains(e.ownerDocument, e) || (l = x.style(e, n)),
              Yt.test(l) &&
                Ut.test(n) &&
                ((i = u.width),
                (o = u.minWidth),
                (a = u.maxWidth),
                (u.minWidth = u.maxWidth = u.width = l),
                (l = s.width),
                (u.width = i),
                (u.minWidth = o),
                (u.maxWidth = a))),
            l
          );
        }))
      : a.documentElement.currentStyle &&
        ((Rt = function(e) {
          return e.currentStyle;
        }),
        (Wt = function(e, n, r) {
          var i,
            o,
            a,
            s = r || Rt(e),
            l = s ? s[n] : t,
            u = e.style;
          return (
            null == l && u && u[n] && (l = u[n]),
            Yt.test(l) &&
              !zt.test(n) &&
              ((i = u.left),
              (o = e.runtimeStyle),
              (a = o && o.left),
              a && (o.left = e.currentStyle.left),
              (u.left = 'fontSize' === n ? '1em' : l),
              (l = u.pixelLeft + 'px'),
              (u.left = i),
              a && (o.left = a)),
            '' === l ? 'auto' : l
          );
        }));
  function on(e, t, n) {
    var r = Vt.exec(t);
    return r ? Math.max(0, r[1] - (n || 0)) + (r[2] || 'px') : t;
  }
  function an(e, t, n, r, i) {
    var o = n === (r ? 'border' : 'content') ? 4 : 'width' === t ? 1 : 0,
      a = 0;
    for (; 4 > o; o += 2)
      'margin' === n && (a += x.css(e, n + Zt[o], !0, i)),
        r
          ? ('content' === n && (a -= x.css(e, 'padding' + Zt[o], !0, i)),
            'margin' !== n && (a -= x.css(e, 'border' + Zt[o] + 'Width', !0, i)))
          : ((a += x.css(e, 'padding' + Zt[o], !0, i)),
            'padding' !== n && (a += x.css(e, 'border' + Zt[o] + 'Width', !0, i)));
    return a;
  }
  function sn(e, t, n) {
    var r = !0,
      i = 'width' === t ? e.offsetWidth : e.offsetHeight,
      o = Rt(e),
      a = x.support.boxSizing && 'border-box' === x.css(e, 'boxSizing', !1, o);
    if (0 >= i || null == i) {
      if (((i = Wt(e, t, o)), (0 > i || null == i) && (i = e.style[t]), Yt.test(i))) return i;
      (r = a && (x.support.boxSizingReliable || i === e.style[t])), (i = parseFloat(i) || 0);
    }
    return i + an(e, t, n || (a ? 'border' : 'content'), r, o) + 'px';
  }
  function ln(e) {
    var t = a,
      n = Gt[e];
    return (
      n ||
        ((n = un(e, t)),
        ('none' !== n && n) ||
          ((Pt = (
            Pt || x("<iframe frameborder='0' width='0' height='0'/>").css('cssText', 'display:block !important')
          ).appendTo(t.documentElement)),
          (t = (Pt[0].contentWindow || Pt[0].contentDocument).document),
          t.write('<!doctype html><html><body>'),
          t.close(),
          (n = un(e, t)),
          Pt.detach()),
        (Gt[e] = n)),
      n
    );
  }
  function un(e, t) {
    var n = x(t.createElement(e)).appendTo(t.body),
      r = x.css(n[0], 'display');
    return n.remove(), r;
  }
  x.each(['height', 'width'], function(e, n) {
    x.cssHooks[n] = {
      get: function(e, r, i) {
        return r
          ? 0 === e.offsetWidth && Xt.test(x.css(e, 'display'))
            ? x.swap(e, Qt, function() {
                return sn(e, n, i);
              })
            : sn(e, n, i)
          : t;
      },
      set: function(e, t, r) {
        var i = r && Rt(e);
        return on(e, t, r ? an(e, n, r, x.support.boxSizing && 'border-box' === x.css(e, 'boxSizing', !1, i), i) : 0);
      },
    };
  }),
    x.support.opacity ||
      (x.cssHooks.opacity = {
        get: function(e, t) {
          return It.test((t && e.currentStyle ? e.currentStyle.filter : e.style.filter) || '')
            ? 0.01 * parseFloat(RegExp.$1) + ''
            : t
            ? '1'
            : '';
        },
        set: function(e, t) {
          var n = e.style,
            r = e.currentStyle,
            i = x.isNumeric(t) ? 'alpha(opacity=' + 100 * t + ')' : '',
            o = (r && r.filter) || n.filter || '';
          (n.zoom = 1),
            ((t >= 1 || '' === t) &&
              '' === x.trim(o.replace($t, '')) &&
              n.removeAttribute &&
              (n.removeAttribute('filter'), '' === t || (r && !r.filter))) ||
              (n.filter = $t.test(o) ? o.replace($t, i) : o + ' ' + i);
        },
      }),
    x(function() {
      x.support.reliableMarginRight ||
        (x.cssHooks.marginRight = {
          get: function(e, n) {
            return n ? x.swap(e, { display: 'inline-block' }, Wt, [e, 'marginRight']) : t;
          },
        }),
        !x.support.pixelPosition &&
          x.fn.position &&
          x.each(['top', 'left'], function(e, n) {
            x.cssHooks[n] = {
              get: function(e, r) {
                return r ? ((r = Wt(e, n)), Yt.test(r) ? x(e).position()[n] + 'px' : r) : t;
              },
            };
          });
    }),
    x.expr &&
      x.expr.filters &&
      ((x.expr.filters.hidden = function(e) {
        return (
          (0 >= e.offsetWidth && 0 >= e.offsetHeight) ||
          (!x.support.reliableHiddenOffsets && 'none' === ((e.style && e.style.display) || x.css(e, 'display')))
        );
      }),
      (x.expr.filters.visible = function(e) {
        return !x.expr.filters.hidden(e);
      })),
    x.each({ margin: '', padding: '', border: 'Width' }, function(e, t) {
      (x.cssHooks[e + t] = {
        expand: function(n) {
          var r = 0,
            i = {},
            o = 'string' == typeof n ? n.split(' ') : [n];
          for (; 4 > r; r++) i[e + Zt[r] + t] = o[r] || o[r - 2] || o[0];
          return i;
        },
      }),
        Ut.test(e) || (x.cssHooks[e + t].set = on);
    });
  var cn = /%20/g,
    pn = /\[\]$/,
    fn = /\r?\n/g,
    dn = /^(?:submit|button|image|reset|file)$/i,
    hn = /^(?:input|select|textarea|keygen)/i;
  x.fn.extend({
    serialize: function() {
      return x.param(this.serializeArray());
    },
    serializeArray: function() {
      return this.map(function() {
        var e = x.prop(this, 'elements');
        return e ? x.makeArray(e) : this;
      })
        .filter(function() {
          var e = this.type;
          return (
            this.name &&
            !x(this).is(':disabled') &&
            hn.test(this.nodeName) &&
            !dn.test(e) &&
            (this.checked || !Ct.test(e))
          );
        })
        .map(function(e, t) {
          var n = x(this).val();
          return null == n
            ? null
            : x.isArray(n)
            ? x.map(n, function(e) {
                return { name: t.name, value: e.replace(fn, '\r\n') };
              })
            : { name: t.name, value: n.replace(fn, '\r\n') };
        })
        .get();
    },
  }),
    (x.param = function(e, n) {
      var r,
        i = [],
        o = function(e, t) {
          (t = x.isFunction(t) ? t() : null == t ? '' : t),
            (i[i.length] = encodeURIComponent(e) + '=' + encodeURIComponent(t));
        };
      if (
        (n === t && (n = x.ajaxSettings && x.ajaxSettings.traditional),
        x.isArray(e) || (e.jquery && !x.isPlainObject(e)))
      )
        x.each(e, function() {
          o(this.name, this.value);
        });
      else for (r in e) gn(r, e[r], n, o);
      return i.join('&').replace(cn, '+');
    });
  function gn(e, t, n, r) {
    var i;
    if (x.isArray(t))
      x.each(t, function(t, i) {
        n || pn.test(e) ? r(e, i) : gn(e + '[' + ('object' == typeof i ? t : '') + ']', i, n, r);
      });
    else if (n || 'object' !== x.type(t)) r(e, t);
    else for (i in t) gn(e + '[' + i + ']', t[i], n, r);
  }
  x.each(
    'blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu'.split(
      ' '
    ),
    function(e, t) {
      x.fn[t] = function(e, n) {
        return arguments.length > 0 ? this.on(t, null, e, n) : this.trigger(t);
      };
    }
  ),
    x.fn.extend({
      hover: function(e, t) {
        return this.mouseenter(e).mouseleave(t || e);
      },
      bind: function(e, t, n) {
        return this.on(e, null, t, n);
      },
      unbind: function(e, t) {
        return this.off(e, null, t);
      },
      delegate: function(e, t, n, r) {
        return this.on(t, e, n, r);
      },
      undelegate: function(e, t, n) {
        return 1 === arguments.length ? this.off(e, '**') : this.off(t, e || '**', n);
      },
    });
  var mn,
    yn,
    vn = x.now(),
    bn = /\?/,
    xn = /#.*$/,
    wn = /([?&])_=[^&]*/,
    Tn = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm,
    Cn = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
    Nn = /^(?:GET|HEAD)$/,
    kn = /^\/\//,
    En = /^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,
    Sn = x.fn.load,
    An = {},
    jn = {},
    Dn = '*/'.concat('*');
  try {
    yn = o.href;
  } catch (Ln) {
    (yn = a.createElement('a')), (yn.href = ''), (yn = yn.href);
  }
  mn = En.exec(yn.toLowerCase()) || [];
  function Hn(e) {
    return function(t, n) {
      'string' != typeof t && ((n = t), (t = '*'));
      var r,
        i = 0,
        o = t.toLowerCase().match(T) || [];
      if (x.isFunction(n))
        while ((r = o[i++]))
          '+' === r[0] ? ((r = r.slice(1) || '*'), (e[r] = e[r] || []).unshift(n)) : (e[r] = e[r] || []).push(n);
    };
  }
  function qn(e, n, r, i) {
    var o = {},
      a = e === jn;
    function s(l) {
      var u;
      return (
        (o[l] = !0),
        x.each(e[l] || [], function(e, l) {
          var c = l(n, r, i);
          return 'string' != typeof c || a || o[c] ? (a ? !(u = c) : t) : (n.dataTypes.unshift(c), s(c), !1);
        }),
        u
      );
    }
    return s(n.dataTypes[0]) || (!o['*'] && s('*'));
  }
  function _n(e, n) {
    var r,
      i,
      o = x.ajaxSettings.flatOptions || {};
    for (i in n) n[i] !== t && ((o[i] ? e : r || (r = {}))[i] = n[i]);
    return r && x.extend(!0, e, r), e;
  }
  (x.fn.load = function(e, n, r) {
    if ('string' != typeof e && Sn) return Sn.apply(this, arguments);
    var i,
      o,
      a,
      s = this,
      l = e.indexOf(' ');
    return (
      l >= 0 && ((i = e.slice(l, e.length)), (e = e.slice(0, l))),
      x.isFunction(n) ? ((r = n), (n = t)) : n && 'object' == typeof n && (a = 'POST'),
      s.length > 0 &&
        x
          .ajax({ url: e, type: a, dataType: 'html', data: n })
          .done(function(e) {
            (o = arguments),
              s.html(
                i
                  ? x('<div>')
                      .append(x.parseHTML(e))
                      .find(i)
                  : e
              );
          })
          .complete(
            r &&
              function(e, t) {
                s.each(r, o || [e.responseText, t, e]);
              }
          ),
      this
    );
  }),
    x.each(['ajaxStart', 'ajaxStop', 'ajaxComplete', 'ajaxError', 'ajaxSuccess', 'ajaxSend'], function(e, t) {
      x.fn[t] = function(e) {
        return this.on(t, e);
      };
    }),
    x.extend({
      active: 0,
      lastModified: {},
      etag: {},
      ajaxSettings: {
        url: yn,
        type: 'GET',
        isLocal: Cn.test(mn[1]),
        global: !0,
        processData: !0,
        async: !0,
        contentType: 'application/x-www-form-urlencoded; charset=UTF-8',
        accepts: {
          '*': Dn,
          text: 'text/plain',
          html: 'text/html',
          xml: 'application/xml, text/xml',
          json: 'application/json, text/javascript',
        },
        contents: { xml: /xml/, html: /html/, json: /json/ },
        responseFields: { xml: 'responseXML', text: 'responseText', json: 'responseJSON' },
        converters: { '* text': String, 'text html': !0, 'text json': x.parseJSON, 'text xml': x.parseXML },
        flatOptions: { url: !0, context: !0 },
      },
      ajaxSetup: function(e, t) {
        return t ? _n(_n(e, x.ajaxSettings), t) : _n(x.ajaxSettings, e);
      },
      ajaxPrefilter: Hn(An),
      ajaxTransport: Hn(jn),
      ajax: function(e, n) {
        'object' == typeof e && ((n = e), (e = t)), (n = n || {});
        var r,
          i,
          o,
          a,
          s,
          l,
          u,
          c,
          p = x.ajaxSetup({}, n),
          f = p.context || p,
          d = p.context && (f.nodeType || f.jquery) ? x(f) : x.event,
          h = x.Deferred(),
          g = x.Callbacks('once memory'),
          m = p.statusCode || {},
          y = {},
          v = {},
          b = 0,
          w = 'canceled',
          C = {
            readyState: 0,
            getResponseHeader: function(e) {
              var t;
              if (2 === b) {
                if (!c) {
                  c = {};
                  while ((t = Tn.exec(a))) c[t[1].toLowerCase()] = t[2];
                }
                t = c[e.toLowerCase()];
              }
              return null == t ? null : t;
            },
            getAllResponseHeaders: function() {
              return 2 === b ? a : null;
            },
            setRequestHeader: function(e, t) {
              var n = e.toLowerCase();
              return b || ((e = v[n] = v[n] || e), (y[e] = t)), this;
            },
            overrideMimeType: function(e) {
              return b || (p.mimeType = e), this;
            },
            statusCode: function(e) {
              var t;
              if (e)
                if (2 > b) for (t in e) m[t] = [m[t], e[t]];
                else C.always(e[C.status]);
              return this;
            },
            abort: function(e) {
              var t = e || w;
              return u && u.abort(t), k(0, t), this;
            },
          };
        if (
          ((h.promise(C).complete = g.add),
          (C.success = C.done),
          (C.error = C.fail),
          (p.url = ((e || p.url || yn) + '').replace(xn, '').replace(kn, mn[1] + '//')),
          (p.type = n.method || n.type || p.method || p.type),
          (p.dataTypes = x
            .trim(p.dataType || '*')
            .toLowerCase()
            .match(T) || ['']),
          null == p.crossDomain &&
            ((r = En.exec(p.url.toLowerCase())),
            (p.crossDomain = !(
              !r ||
              (r[1] === mn[1] &&
                r[2] === mn[2] &&
                (r[3] || ('http:' === r[1] ? '80' : '443')) === (mn[3] || ('http:' === mn[1] ? '80' : '443')))
            ))),
          p.data && p.processData && 'string' != typeof p.data && (p.data = x.param(p.data, p.traditional)),
          qn(An, p, n, C),
          2 === b)
        )
          return C;
        (l = p.global),
          l && 0 === x.active++ && x.event.trigger('ajaxStart'),
          (p.type = p.type.toUpperCase()),
          (p.hasContent = !Nn.test(p.type)),
          (o = p.url),
          p.hasContent ||
            (p.data && ((o = p.url += (bn.test(o) ? '&' : '?') + p.data), delete p.data),
            p.cache === !1 &&
              (p.url = wn.test(o) ? o.replace(wn, '$1_=' + vn++) : o + (bn.test(o) ? '&' : '?') + '_=' + vn++)),
          p.ifModified &&
            (x.lastModified[o] && C.setRequestHeader('If-Modified-Since', x.lastModified[o]),
            x.etag[o] && C.setRequestHeader('If-None-Match', x.etag[o])),
          ((p.data && p.hasContent && p.contentType !== !1) || n.contentType) &&
            C.setRequestHeader('Content-Type', p.contentType),
          C.setRequestHeader(
            'Accept',
            p.dataTypes[0] && p.accepts[p.dataTypes[0]]
              ? p.accepts[p.dataTypes[0]] + ('*' !== p.dataTypes[0] ? ', ' + Dn + '; q=0.01' : '')
              : p.accepts['*']
          );
        for (i in p.headers) C.setRequestHeader(i, p.headers[i]);
        if (p.beforeSend && (p.beforeSend.call(f, C, p) === !1 || 2 === b)) return C.abort();
        w = 'abort';
        for (i in { success: 1, error: 1, complete: 1 }) C[i](p[i]);
        if ((u = qn(jn, p, n, C))) {
          (C.readyState = 1),
            l && d.trigger('ajaxSend', [C, p]),
            p.async &&
              p.timeout > 0 &&
              (s = setTimeout(function() {
                C.abort('timeout');
              }, p.timeout));
          try {
            (b = 1), u.send(y, k);
          } catch (N) {
            if (!(2 > b)) throw N;
            k(-1, N);
          }
        } else k(-1, 'No Transport');
        function k(e, n, r, i) {
          var c,
            y,
            v,
            w,
            T,
            N = n;
          2 !== b &&
            ((b = 2),
            s && clearTimeout(s),
            (u = t),
            (a = i || ''),
            (C.readyState = e > 0 ? 4 : 0),
            (c = (e >= 200 && 300 > e) || 304 === e),
            r && (w = Mn(p, C, r)),
            (w = On(p, w, C, c)),
            c
              ? (p.ifModified &&
                  ((T = C.getResponseHeader('Last-Modified')),
                  T && (x.lastModified[o] = T),
                  (T = C.getResponseHeader('etag')),
                  T && (x.etag[o] = T)),
                204 === e || 'HEAD' === p.type
                  ? (N = 'nocontent')
                  : 304 === e
                  ? (N = 'notmodified')
                  : ((N = w.state), (y = w.data), (v = w.error), (c = !v)))
              : ((v = N), (e || !N) && ((N = 'error'), 0 > e && (e = 0))),
            (C.status = e),
            (C.statusText = (n || N) + ''),
            c ? h.resolveWith(f, [y, N, C]) : h.rejectWith(f, [C, N, v]),
            C.statusCode(m),
            (m = t),
            l && d.trigger(c ? 'ajaxSuccess' : 'ajaxError', [C, p, c ? y : v]),
            g.fireWith(f, [C, N]),
            l && (d.trigger('ajaxComplete', [C, p]), --x.active || x.event.trigger('ajaxStop')));
        }
        return C;
      },
      getJSON: function(e, t, n) {
        return x.get(e, t, n, 'json');
      },
      getScript: function(e, n) {
        return x.get(e, t, n, 'script');
      },
    }),
    x.each(['get', 'post'], function(e, n) {
      x[n] = function(e, r, i, o) {
        return (
          x.isFunction(r) && ((o = o || i), (i = r), (r = t)),
          x.ajax({ url: e, type: n, dataType: o, data: r, success: i })
        );
      };
    });
  function Mn(e, n, r) {
    var i,
      o,
      a,
      s,
      l = e.contents,
      u = e.dataTypes;
    while ('*' === u[0]) u.shift(), o === t && (o = e.mimeType || n.getResponseHeader('Content-Type'));
    if (o)
      for (s in l)
        if (l[s] && l[s].test(o)) {
          u.unshift(s);
          break;
        }
    if (u[0] in r) a = u[0];
    else {
      for (s in r) {
        if (!u[0] || e.converters[s + ' ' + u[0]]) {
          a = s;
          break;
        }
        i || (i = s);
      }
      a = a || i;
    }
    return a ? (a !== u[0] && u.unshift(a), r[a]) : t;
  }
  function On(e, t, n, r) {
    var i,
      o,
      a,
      s,
      l,
      u = {},
      c = e.dataTypes.slice();
    if (c[1]) for (a in e.converters) u[a.toLowerCase()] = e.converters[a];
    o = c.shift();
    while (o)
      if (
        (e.responseFields[o] && (n[e.responseFields[o]] = t),
        !l && r && e.dataFilter && (t = e.dataFilter(t, e.dataType)),
        (l = o),
        (o = c.shift()))
      )
        if ('*' === o) o = l;
        else if ('*' !== l && l !== o) {
          if (((a = u[l + ' ' + o] || u['* ' + o]), !a))
            for (i in u)
              if (((s = i.split(' ')), s[1] === o && (a = u[l + ' ' + s[0]] || u['* ' + s[0]]))) {
                a === !0 ? (a = u[i]) : u[i] !== !0 && ((o = s[0]), c.unshift(s[1]));
                break;
              }
          if (a !== !0)
            if (a && e['throws']) t = a(t);
            else
              try {
                t = a(t);
              } catch (p) {
                return { state: 'parsererror', error: a ? p : 'No conversion from ' + l + ' to ' + o };
              }
        }
    return { state: 'success', data: t };
  }
  x.ajaxSetup({
    accepts: { script: 'text/javascript, application/javascript, application/ecmascript, application/x-ecmascript' },
    contents: { script: /(?:java|ecma)script/ },
    converters: {
      'text script': function(e) {
        return x.globalEval(e), e;
      },
    },
  }),
    x.ajaxPrefilter('script', function(e) {
      e.cache === t && (e.cache = !1), e.crossDomain && ((e.type = 'GET'), (e.global = !1));
    }),
    x.ajaxTransport('script', function(e) {
      if (e.crossDomain) {
        var n,
          r = a.head || x('head')[0] || a.documentElement;
        return {
          send: function(t, i) {
            (n = a.createElement('script')),
              (n.async = !0),
              e.scriptCharset && (n.charset = e.scriptCharset),
              (n.src = e.url),
              (n.onload = n.onreadystatechange = function(e, t) {
                (t || !n.readyState || /loaded|complete/.test(n.readyState)) &&
                  ((n.onload = n.onreadystatechange = null),
                  n.parentNode && n.parentNode.removeChild(n),
                  (n = null),
                  t || i(200, 'success'));
              }),
              r.insertBefore(n, r.firstChild);
          },
          abort: function() {
            n && n.onload(t, !0);
          },
        };
      }
    });
  var Fn = [],
    Bn = /(=)\?(?=&|$)|\?\?/;
  x.ajaxSetup({
    jsonp: 'callback',
    jsonpCallback: function() {
      var e = Fn.pop() || x.expando + '_' + vn++;
      return (this[e] = !0), e;
    },
  }),
    x.ajaxPrefilter('json jsonp', function(n, r, i) {
      var o,
        a,
        s,
        l =
          n.jsonp !== !1 &&
          (Bn.test(n.url)
            ? 'url'
            : 'string' == typeof n.data &&
              !(n.contentType || '').indexOf('application/x-www-form-urlencoded') &&
              Bn.test(n.data) &&
              'data');
      return l || 'jsonp' === n.dataTypes[0]
        ? ((o = n.jsonpCallback = x.isFunction(n.jsonpCallback) ? n.jsonpCallback() : n.jsonpCallback),
          l
            ? (n[l] = n[l].replace(Bn, '$1' + o))
            : n.jsonp !== !1 && (n.url += (bn.test(n.url) ? '&' : '?') + n.jsonp + '=' + o),
          (n.converters['script json'] = function() {
            return s || x.error(o + ' was not called'), s[0];
          }),
          (n.dataTypes[0] = 'json'),
          (a = e[o]),
          (e[o] = function() {
            s = arguments;
          }),
          i.always(function() {
            (e[o] = a),
              n[o] && ((n.jsonpCallback = r.jsonpCallback), Fn.push(o)),
              s && x.isFunction(a) && a(s[0]),
              (s = a = t);
          }),
          'script')
        : t;
    });
  var Pn,
    Rn,
    Wn = 0,
    $n =
      e.ActiveXObject &&
      function() {
        var e;
        for (e in Pn) Pn[e](t, !0);
      };
  function In() {
    try {
      return new e.XMLHttpRequest();
    } catch (t) {}
  }
  function zn() {
    try {
      return new e.ActiveXObject('Microsoft.XMLHTTP');
    } catch (t) {}
  }
  (x.ajaxSettings.xhr = e.ActiveXObject
    ? function() {
        return (!this.isLocal && In()) || zn();
      }
    : In),
    (Rn = x.ajaxSettings.xhr()),
    (x.support.cors = !!Rn && 'withCredentials' in Rn),
    (Rn = x.support.ajax = !!Rn),
    Rn &&
      x.ajaxTransport(function(n) {
        if (!n.crossDomain || x.support.cors) {
          var r;
          return {
            send: function(i, o) {
              var a,
                s,
                l = n.xhr();
              if (
                (n.username ? l.open(n.type, n.url, n.async, n.username, n.password) : l.open(n.type, n.url, n.async),
                n.xhrFields)
              )
                for (s in n.xhrFields) l[s] = n.xhrFields[s];
              n.mimeType && l.overrideMimeType && l.overrideMimeType(n.mimeType),
                n.crossDomain || i['X-Requested-With'] || (i['X-Requested-With'] = 'XMLHttpRequest');
              try {
                for (s in i) l.setRequestHeader(s, i[s]);
              } catch (u) {}
              l.send((n.hasContent && n.data) || null),
                (r = function(e, i) {
                  var s, u, c, p;
                  try {
                    if (r && (i || 4 === l.readyState))
                      if (((r = t), a && ((l.onreadystatechange = x.noop), $n && delete Pn[a]), i))
                        4 !== l.readyState && l.abort();
                      else {
                        (p = {}),
                          (s = l.status),
                          (u = l.getAllResponseHeaders()),
                          'string' == typeof l.responseText && (p.text = l.responseText);
                        try {
                          c = l.statusText;
                        } catch (f) {
                          c = '';
                        }
                        s || !n.isLocal || n.crossDomain ? 1223 === s && (s = 204) : (s = p.text ? 200 : 404);
                      }
                  } catch (d) {
                    i || o(-1, d);
                  }
                  p && o(s, c, p, u);
                }),
                n.async
                  ? 4 === l.readyState
                    ? setTimeout(r)
                    : ((a = ++Wn), $n && (Pn || ((Pn = {}), x(e).unload($n)), (Pn[a] = r)), (l.onreadystatechange = r))
                  : r();
            },
            abort: function() {
              r && r(t, !0);
            },
          };
        }
      });
  var Xn,
    Un,
    Vn = /^(?:toggle|show|hide)$/,
    Yn = RegExp('^(?:([+-])=|)(' + w + ')([a-z%]*)$', 'i'),
    Jn = /queueHooks$/,
    Gn = [nr],
    Qn = {
      '*': [
        function(e, t) {
          var n = this.createTween(e, t),
            r = n.cur(),
            i = Yn.exec(t),
            o = (i && i[3]) || (x.cssNumber[e] ? '' : 'px'),
            a = (x.cssNumber[e] || ('px' !== o && +r)) && Yn.exec(x.css(n.elem, e)),
            s = 1,
            l = 20;
          if (a && a[3] !== o) {
            (o = o || a[3]), (i = i || []), (a = +r || 1);
            do (s = s || '.5'), (a /= s), x.style(n.elem, e, a + o);
            while (s !== (s = n.cur() / r) && 1 !== s && --l);
          }
          return i && ((a = n.start = +a || +r || 0), (n.unit = o), (n.end = i[1] ? a + (i[1] + 1) * i[2] : +i[2])), n;
        },
      ],
    };
  function Kn() {
    return (
      setTimeout(function() {
        Xn = t;
      }),
      (Xn = x.now())
    );
  }
  function Zn(e, t, n) {
    var r,
      i = (Qn[t] || []).concat(Qn['*']),
      o = 0,
      a = i.length;
    for (; a > o; o++) if ((r = i[o].call(n, t, e))) return r;
  }
  function er(e, t, n) {
    var r,
      i,
      o = 0,
      a = Gn.length,
      s = x.Deferred().always(function() {
        delete l.elem;
      }),
      l = function() {
        if (i) return !1;
        var t = Xn || Kn(),
          n = Math.max(0, u.startTime + u.duration - t),
          r = n / u.duration || 0,
          o = 1 - r,
          a = 0,
          l = u.tweens.length;
        for (; l > a; a++) u.tweens[a].run(o);
        return s.notifyWith(e, [u, o, n]), 1 > o && l ? n : (s.resolveWith(e, [u]), !1);
      },
      u = s.promise({
        elem: e,
        props: x.extend({}, t),
        opts: x.extend(!0, { specialEasing: {} }, n),
        originalProperties: t,
        originalOptions: n,
        startTime: Xn || Kn(),
        duration: n.duration,
        tweens: [],
        createTween: function(t, n) {
          var r = x.Tween(e, u.opts, t, n, u.opts.specialEasing[t] || u.opts.easing);
          return u.tweens.push(r), r;
        },
        stop: function(t) {
          var n = 0,
            r = t ? u.tweens.length : 0;
          if (i) return this;
          for (i = !0; r > n; n++) u.tweens[n].run(1);
          return t ? s.resolveWith(e, [u, t]) : s.rejectWith(e, [u, t]), this;
        },
      }),
      c = u.props;
    for (tr(c, u.opts.specialEasing); a > o; o++) if ((r = Gn[o].call(u, e, c, u.opts))) return r;
    return (
      x.map(c, Zn, u),
      x.isFunction(u.opts.start) && u.opts.start.call(e, u),
      x.fx.timer(x.extend(l, { elem: e, anim: u, queue: u.opts.queue })),
      u
        .progress(u.opts.progress)
        .done(u.opts.done, u.opts.complete)
        .fail(u.opts.fail)
        .always(u.opts.always)
    );
  }
  function tr(e, t) {
    var n, r, i, o, a;
    for (n in e)
      if (
        ((r = x.camelCase(n)),
        (i = t[r]),
        (o = e[n]),
        x.isArray(o) && ((i = o[1]), (o = e[n] = o[0])),
        n !== r && ((e[r] = o), delete e[n]),
        (a = x.cssHooks[r]),
        a && 'expand' in a)
      ) {
        (o = a.expand(o)), delete e[r];
        for (n in o) n in e || ((e[n] = o[n]), (t[n] = i));
      } else t[r] = i;
  }
  x.Animation = x.extend(er, {
    tweener: function(e, t) {
      x.isFunction(e) ? ((t = e), (e = ['*'])) : (e = e.split(' '));
      var n,
        r = 0,
        i = e.length;
      for (; i > r; r++) (n = e[r]), (Qn[n] = Qn[n] || []), Qn[n].unshift(t);
    },
    prefilter: function(e, t) {
      t ? Gn.unshift(e) : Gn.push(e);
    },
  });
  function nr(e, t, n) {
    var r,
      i,
      o,
      a,
      s,
      l,
      u = this,
      c = {},
      p = e.style,
      f = e.nodeType && nn(e),
      d = x._data(e, 'fxshow');
    n.queue ||
      ((s = x._queueHooks(e, 'fx')),
      null == s.unqueued &&
        ((s.unqueued = 0),
        (l = s.empty.fire),
        (s.empty.fire = function() {
          s.unqueued || l();
        })),
      s.unqueued++,
      u.always(function() {
        u.always(function() {
          s.unqueued--, x.queue(e, 'fx').length || s.empty.fire();
        });
      })),
      1 === e.nodeType &&
        ('height' in t || 'width' in t) &&
        ((n.overflow = [p.overflow, p.overflowX, p.overflowY]),
        'inline' === x.css(e, 'display') &&
          'none' === x.css(e, 'float') &&
          (x.support.inlineBlockNeedsLayout && 'inline' !== ln(e.nodeName)
            ? (p.zoom = 1)
            : (p.display = 'inline-block'))),
      n.overflow &&
        ((p.overflow = 'hidden'),
        x.support.shrinkWrapBlocks ||
          u.always(function() {
            (p.overflow = n.overflow[0]), (p.overflowX = n.overflow[1]), (p.overflowY = n.overflow[2]);
          }));
    for (r in t)
      if (((i = t[r]), Vn.exec(i))) {
        if ((delete t[r], (o = o || 'toggle' === i), i === (f ? 'hide' : 'show'))) continue;
        c[r] = (d && d[r]) || x.style(e, r);
      }
    if (!x.isEmptyObject(c)) {
      d ? 'hidden' in d && (f = d.hidden) : (d = x._data(e, 'fxshow', {})),
        o && (d.hidden = !f),
        f
          ? x(e).show()
          : u.done(function() {
              x(e).hide();
            }),
        u.done(function() {
          var t;
          x._removeData(e, 'fxshow');
          for (t in c) x.style(e, t, c[t]);
        });
      for (r in c)
        (a = Zn(f ? d[r] : 0, r, u)),
          r in d || ((d[r] = a.start), f && ((a.end = a.start), (a.start = 'width' === r || 'height' === r ? 1 : 0)));
    }
  }
  function rr(e, t, n, r, i) {
    return new rr.prototype.init(e, t, n, r, i);
  }
  (x.Tween = rr),
    (rr.prototype = {
      constructor: rr,
      init: function(e, t, n, r, i, o) {
        (this.elem = e),
          (this.prop = n),
          (this.easing = i || 'swing'),
          (this.options = t),
          (this.start = this.now = this.cur()),
          (this.end = r),
          (this.unit = o || (x.cssNumber[n] ? '' : 'px'));
      },
      cur: function() {
        var e = rr.propHooks[this.prop];
        return e && e.get ? e.get(this) : rr.propHooks._default.get(this);
      },
      run: function(e) {
        var t,
          n = rr.propHooks[this.prop];
        return (
          (this.pos = t = this.options.duration
            ? x.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration)
            : e),
          (this.now = (this.end - this.start) * t + this.start),
          this.options.step && this.options.step.call(this.elem, this.now, this),
          n && n.set ? n.set(this) : rr.propHooks._default.set(this),
          this
        );
      },
    }),
    (rr.prototype.init.prototype = rr.prototype),
    (rr.propHooks = {
      _default: {
        get: function(e) {
          var t;
          return null == e.elem[e.prop] || (e.elem.style && null != e.elem.style[e.prop])
            ? ((t = x.css(e.elem, e.prop, '')), t && 'auto' !== t ? t : 0)
            : e.elem[e.prop];
        },
        set: function(e) {
          x.fx.step[e.prop]
            ? x.fx.step[e.prop](e)
            : e.elem.style && (null != e.elem.style[x.cssProps[e.prop]] || x.cssHooks[e.prop])
            ? x.style(e.elem, e.prop, e.now + e.unit)
            : (e.elem[e.prop] = e.now);
        },
      },
    }),
    (rr.propHooks.scrollTop = rr.propHooks.scrollLeft = {
      set: function(e) {
        e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now);
      },
    }),
    x.each(['toggle', 'show', 'hide'], function(e, t) {
      var n = x.fn[t];
      x.fn[t] = function(e, r, i) {
        return null == e || 'boolean' == typeof e ? n.apply(this, arguments) : this.animate(ir(t, !0), e, r, i);
      };
    }),
    x.fn.extend({
      fadeTo: function(e, t, n, r) {
        return this.filter(nn)
          .css('opacity', 0)
          .show()
          .end()
          .animate({ opacity: t }, e, n, r);
      },
      animate: function(e, t, n, r) {
        var i = x.isEmptyObject(e),
          o = x.speed(t, n, r),
          a = function() {
            var t = er(this, x.extend({}, e), o);
            (i || x._data(this, 'finish')) && t.stop(!0);
          };
        return (a.finish = a), i || o.queue === !1 ? this.each(a) : this.queue(o.queue, a);
      },
      stop: function(e, n, r) {
        var i = function(e) {
          var t = e.stop;
          delete e.stop, t(r);
        };
        return (
          'string' != typeof e && ((r = n), (n = e), (e = t)),
          n && e !== !1 && this.queue(e || 'fx', []),
          this.each(function() {
            var t = !0,
              n = null != e && e + 'queueHooks',
              o = x.timers,
              a = x._data(this);
            if (n) a[n] && a[n].stop && i(a[n]);
            else for (n in a) a[n] && a[n].stop && Jn.test(n) && i(a[n]);
            for (n = o.length; n--; )
              o[n].elem !== this || (null != e && o[n].queue !== e) || (o[n].anim.stop(r), (t = !1), o.splice(n, 1));
            (t || !r) && x.dequeue(this, e);
          })
        );
      },
      finish: function(e) {
        return (
          e !== !1 && (e = e || 'fx'),
          this.each(function() {
            var t,
              n = x._data(this),
              r = n[e + 'queue'],
              i = n[e + 'queueHooks'],
              o = x.timers,
              a = r ? r.length : 0;
            for (n.finish = !0, x.queue(this, e, []), i && i.stop && i.stop.call(this, !0), t = o.length; t--; )
              o[t].elem === this && o[t].queue === e && (o[t].anim.stop(!0), o.splice(t, 1));
            for (t = 0; a > t; t++) r[t] && r[t].finish && r[t].finish.call(this);
            delete n.finish;
          })
        );
      },
    });
  function ir(e, t) {
    var n,
      r = { height: e },
      i = 0;
    for (t = t ? 1 : 0; 4 > i; i += 2 - t) (n = Zt[i]), (r['margin' + n] = r['padding' + n] = e);
    return t && (r.opacity = r.width = e), r;
  }
  x.each(
    {
      slideDown: ir('show'),
      slideUp: ir('hide'),
      slideToggle: ir('toggle'),
      fadeIn: { opacity: 'show' },
      fadeOut: { opacity: 'hide' },
      fadeToggle: { opacity: 'toggle' },
    },
    function(e, t) {
      x.fn[e] = function(e, n, r) {
        return this.animate(t, e, n, r);
      };
    }
  ),
    (x.speed = function(e, t, n) {
      var r =
        e && 'object' == typeof e
          ? x.extend({}, e)
          : {
              complete: n || (!n && t) || (x.isFunction(e) && e),
              duration: e,
              easing: (n && t) || (t && !x.isFunction(t) && t),
            };
      return (
        (r.duration = x.fx.off
          ? 0
          : 'number' == typeof r.duration
          ? r.duration
          : r.duration in x.fx.speeds
          ? x.fx.speeds[r.duration]
          : x.fx.speeds._default),
        (null == r.queue || r.queue === !0) && (r.queue = 'fx'),
        (r.old = r.complete),
        (r.complete = function() {
          x.isFunction(r.old) && r.old.call(this), r.queue && x.dequeue(this, r.queue);
        }),
        r
      );
    }),
    (x.easing = {
      linear: function(e) {
        return e;
      },
      swing: function(e) {
        return 0.5 - Math.cos(e * Math.PI) / 2;
      },
    }),
    (x.timers = []),
    (x.fx = rr.prototype.init),
    (x.fx.tick = function() {
      var e,
        n = x.timers,
        r = 0;
      for (Xn = x.now(); n.length > r; r++) (e = n[r]), e() || n[r] !== e || n.splice(r--, 1);
      n.length || x.fx.stop(), (Xn = t);
    }),
    (x.fx.timer = function(e) {
      e() && x.timers.push(e) && x.fx.start();
    }),
    (x.fx.interval = 13),
    (x.fx.start = function() {
      Un || (Un = setInterval(x.fx.tick, x.fx.interval));
    }),
    (x.fx.stop = function() {
      clearInterval(Un), (Un = null);
    }),
    (x.fx.speeds = { slow: 600, fast: 200, _default: 400 }),
    (x.fx.step = {}),
    x.expr &&
      x.expr.filters &&
      (x.expr.filters.animated = function(e) {
        return x.grep(x.timers, function(t) {
          return e === t.elem;
        }).length;
      }),
    (x.fn.offset = function(e) {
      if (arguments.length)
        return e === t
          ? this
          : this.each(function(t) {
              x.offset.setOffset(this, e, t);
            });
      var n,
        r,
        o = { top: 0, left: 0 },
        a = this[0],
        s = a && a.ownerDocument;
      if (s)
        return (
          (n = s.documentElement),
          x.contains(n, a)
            ? (typeof a.getBoundingClientRect !== i && (o = a.getBoundingClientRect()),
              (r = or(s)),
              {
                top: o.top + (r.pageYOffset || n.scrollTop) - (n.clientTop || 0),
                left: o.left + (r.pageXOffset || n.scrollLeft) - (n.clientLeft || 0),
              })
            : o
        );
    }),
    (x.offset = {
      setOffset: function(e, t, n) {
        var r = x.css(e, 'position');
        'static' === r && (e.style.position = 'relative');
        var i = x(e),
          o = i.offset(),
          a = x.css(e, 'top'),
          s = x.css(e, 'left'),
          l = ('absolute' === r || 'fixed' === r) && x.inArray('auto', [a, s]) > -1,
          u = {},
          c = {},
          p,
          f;
        l ? ((c = i.position()), (p = c.top), (f = c.left)) : ((p = parseFloat(a) || 0), (f = parseFloat(s) || 0)),
          x.isFunction(t) && (t = t.call(e, n, o)),
          null != t.top && (u.top = t.top - o.top + p),
          null != t.left && (u.left = t.left - o.left + f),
          'using' in t ? t.using.call(e, u) : i.css(u);
      },
    }),
    x.fn.extend({
      position: function() {
        if (this[0]) {
          var e,
            t,
            n = { top: 0, left: 0 },
            r = this[0];
          return (
            'fixed' === x.css(r, 'position')
              ? (t = r.getBoundingClientRect())
              : ((e = this.offsetParent()),
                (t = this.offset()),
                x.nodeName(e[0], 'html') || (n = e.offset()),
                (n.top += x.css(e[0], 'borderTopWidth', !0)),
                (n.left += x.css(e[0], 'borderLeftWidth', !0))),
            { top: t.top - n.top - x.css(r, 'marginTop', !0), left: t.left - n.left - x.css(r, 'marginLeft', !0) }
          );
        }
      },
      offsetParent: function() {
        return this.map(function() {
          var e = this.offsetParent || s;
          while (e && !x.nodeName(e, 'html') && 'static' === x.css(e, 'position')) e = e.offsetParent;
          return e || s;
        });
      },
    }),
    x.each({ scrollLeft: 'pageXOffset', scrollTop: 'pageYOffset' }, function(e, n) {
      var r = /Y/.test(n);
      x.fn[e] = function(i) {
        return x.access(
          this,
          function(e, i, o) {
            var a = or(e);
            return o === t
              ? a
                ? n in a
                  ? a[n]
                  : a.document.documentElement[i]
                : e[i]
              : (a ? a.scrollTo(r ? x(a).scrollLeft() : o, r ? o : x(a).scrollTop()) : (e[i] = o), t);
          },
          e,
          i,
          arguments.length,
          null
        );
      };
    });
  function or(e) {
    return x.isWindow(e) ? e : 9 === e.nodeType ? e.defaultView || e.parentWindow : !1;
  }
  x.each({ Height: 'height', Width: 'width' }, function(e, n) {
    x.each({ padding: 'inner' + e, content: n, '': 'outer' + e }, function(r, i) {
      x.fn[i] = function(i, o) {
        var a = arguments.length && (r || 'boolean' != typeof i),
          s = r || (i === !0 || o === !0 ? 'margin' : 'border');
        return x.access(
          this,
          function(n, r, i) {
            var o;
            return x.isWindow(n)
              ? n.document.documentElement['client' + e]
              : 9 === n.nodeType
              ? ((o = n.documentElement),
                Math.max(n.body['scroll' + e], o['scroll' + e], n.body['offset' + e], o['offset' + e], o['client' + e]))
              : i === t
              ? x.css(n, r, s)
              : x.style(n, r, i, s);
          },
          n,
          a ? i : t,
          a,
          null
        );
      };
    });
  }),
    (x.fn.size = function() {
      return this.length;
    }),
    (x.fn.andSelf = x.fn.addBack),
    'object' == typeof module && module && 'object' == typeof module.exports
      ? (module.exports = x)
      : ((e.jQuery = e.$ = x),
        'function' == typeof define &&
          define.amd &&
          define('jquery', [], function() {
            return x;
          }));
})(window);

/*!
 * jQuery Validation Plugin v1.17.0
 *
 * https://jqueryvalidation.org/
 *
 * Copyright (c) 2017 Jörn Zaefferer
 * Released under the MIT license
 */
(function(factory) {
  if (typeof define === 'function' && define.amd) {
    define(['jquery'], factory);
  } else if (typeof module === 'object' && module.exports) {
    module.exports = factory(require('jquery'));
  } else {
    factory(jQuery);
  }
})(function($) {
  $.extend($.fn, {
    // https://jqueryvalidation.org/validate/
    validate: function(options) {
      // If nothing is selected, return nothing; can't chain anyway
      if (!this.length) {
        if (options && options.debug && window.console) {
          console.warn("Nothing selected, can't validate, returning nothing.");
        }
        return;
      }

      // Check if a validator for this form was already created
      var validator = $.data(this[0], 'validator');
      if (validator) {
        return validator;
      }

      // Add novalidate tag if HTML5.
      this.attr('novalidate', 'novalidate');

      validator = new $.validator(options, this[0]);
      $.data(this[0], 'validator', validator);

      if (validator.settings.onsubmit) {
        this.on('click.validate', ':submit', function(event) {
          // Track the used submit button to properly handle scripted
          // submits later.
          validator.submitButton = event.currentTarget;

          // Allow suppressing validation by adding a cancel class to the submit button
          if ($(this).hasClass('cancel')) {
            validator.cancelSubmit = true;
          }

          // Allow suppressing validation by adding the html5 formnovalidate attribute to the submit button
          if ($(this).attr('formnovalidate') !== undefined) {
            validator.cancelSubmit = true;
          }
        });

        // Validate the form on submit
        this.on('submit.validate', function(event) {
          if (validator.settings.debug) {
            // Prevent form submit to be able to see console output
            event.preventDefault();
          }
          function handle() {
            var hidden, result;

            // Insert a hidden input as a replacement for the missing submit button
            // The hidden input is inserted in two cases:
            //   - A user defined a `submitHandler`
            //   - There was a pending request due to `remote` method and `stopRequest()`
            //     was called to submit the form in case it's valid
            if (validator.submitButton && (validator.settings.submitHandler || validator.formSubmitted)) {
              hidden = $("<input type='hidden'/>")
                .attr('name', validator.submitButton.name)
                .val($(validator.submitButton).val())
                .appendTo(validator.currentForm);
            }

            if (validator.settings.submitHandler) {
              result = validator.settings.submitHandler.call(validator, validator.currentForm, event);
              if (hidden) {
                // And clean up afterwards; thanks to no-block-scope, hidden can be referenced
                hidden.remove();
              }
              if (result !== undefined) {
                return result;
              }
              return false;
            }
            return true;
          }

          // Prevent submit for invalid forms or custom submit handlers
          if (validator.cancelSubmit) {
            validator.cancelSubmit = false;
            return handle();
          }
          if (validator.form()) {
            if (validator.pendingRequest) {
              validator.formSubmitted = true;
              return false;
            }
            return handle();
          } else {
            validator.focusInvalid();
            return false;
          }
        });
      }

      return validator;
    },

    // https://jqueryvalidation.org/valid/
    valid: function() {
      var valid, validator, errorList;

      if ($(this[0]).is('form')) {
        valid = this.validate().form();
      } else {
        errorList = [];
        valid = true;
        validator = $(this[0].form).validate();
        this.each(function() {
          valid = validator.element(this) && valid;
          if (!valid) {
            errorList = errorList.concat(validator.errorList);
          }
        });
        validator.errorList = errorList;
      }
      return valid;
    },

    // https://jqueryvalidation.org/rules/
    rules: function(command, argument) {
      var element = this[0],
        settings,
        staticRules,
        existingRules,
        data,
        param,
        filtered;

      // If nothing is selected, return empty object; can't chain anyway
      if (element == null) {
        return;
      }

      if (!element.form && element.hasAttribute('contenteditable')) {
        element.form = this.closest('form')[0];
        element.name = this.attr('name');
      }

      if (element.form == null) {
        return;
      }

      if (command) {
        settings = $.data(element.form, 'validator').settings;
        staticRules = settings.rules;
        existingRules = $.validator.staticRules(element);
        switch (command) {
          case 'add':
            $.extend(existingRules, $.validator.normalizeRule(argument));

            // Remove messages from rules, but allow them to be set separately
            delete existingRules.messages;
            staticRules[element.name] = existingRules;
            if (argument.messages) {
              settings.messages[element.name] = $.extend(settings.messages[element.name], argument.messages);
            }
            break;
          case 'remove':
            if (!argument) {
              delete staticRules[element.name];
              return existingRules;
            }
            filtered = {};
            $.each(argument.split(/\s/), function(index, method) {
              filtered[method] = existingRules[method];
              delete existingRules[method];
            });
            return filtered;
        }
      }

      data = $.validator.normalizeRules(
        $.extend(
          {},
          $.validator.classRules(element),
          $.validator.attributeRules(element),
          $.validator.dataRules(element),
          $.validator.staticRules(element)
        ),
        element
      );

      // Make sure required is at front
      if (data.required) {
        param = data.required;
        delete data.required;
        data = $.extend({ required: param }, data);
      }

      // Make sure remote is at back
      if (data.remote) {
        param = data.remote;
        delete data.remote;
        data = $.extend(data, { remote: param });
      }

      return data;
    },
  });

  // Custom selectors
  $.extend($.expr.pseudos || $.expr[':'], {
    // '|| $.expr[ ":" ]' here enables backwards compatibility to jQuery 1.7. Can be removed when dropping jQ 1.7.x support

    // https://jqueryvalidation.org/blank-selector/
    blank: function(a) {
      return !$.trim('' + $(a).val());
    },

    // https://jqueryvalidation.org/filled-selector/
    filled: function(a) {
      var val = $(a).val();
      return val !== null && !!$.trim('' + val);
    },

    // https://jqueryvalidation.org/unchecked-selector/
    unchecked: function(a) {
      return !$(a).prop('checked');
    },
  });

  // Constructor for validator
  $.validator = function(options, form) {
    this.settings = $.extend(true, {}, $.validator.defaults, options);
    this.currentForm = form;
    this.init();
  };

  // https://jqueryvalidation.org/jQuery.validator.format/
  $.validator.format = function(source, params) {
    if (arguments.length === 1) {
      return function() {
        var args = $.makeArray(arguments);
        args.unshift(source);
        return $.validator.format.apply(this, args);
      };
    }
    if (params === undefined) {
      return source;
    }
    if (arguments.length > 2 && params.constructor !== Array) {
      params = $.makeArray(arguments).slice(1);
    }
    if (params.constructor !== Array) {
      params = [params];
    }
    $.each(params, function(i, n) {
      source = source.replace(new RegExp('\\{' + i + '\\}', 'g'), function() {
        return n;
      });
    });
    return source;
  };

  $.extend($.validator, {
    defaults: {
      messages: {},
      groups: {},
      rules: {},
      errorClass: 'error',
      pendingClass: 'pending',
      validClass: 'valid',
      errorElement: 'label',
      focusCleanup: false,
      focusInvalid: true,
      errorContainer: $([]),
      errorLabelContainer: $([]),
      onsubmit: true,
      ignore: ':hidden',
      ignoreTitle: false,
      onfocusin: function(element) {
        this.lastActive = element;

        // Hide error label and remove error class on focus if enabled
        if (this.settings.focusCleanup) {
          if (this.settings.unhighlight) {
            this.settings.unhighlight.call(this, element, this.settings.errorClass, this.settings.validClass);
          }
          this.hideThese(this.errorsFor(element));
        }
      },
      onfocusout: function(element) {
        if (!this.checkable(element) && (element.name in this.submitted || !this.optional(element))) {
          this.element(element);
        }
      },
      onkeyup: function(element, event) {
        // Avoid revalidate the field when pressing one of the following keys
        // Shift       => 16
        // Ctrl        => 17
        // Alt         => 18
        // Caps lock   => 20
        // End         => 35
        // Home        => 36
        // Left arrow  => 37
        // Up arrow    => 38
        // Right arrow => 39
        // Down arrow  => 40
        // Insert      => 45
        // Num lock    => 144
        // AltGr key   => 225
        var excludedKeys = [16, 17, 18, 20, 35, 36, 37, 38, 39, 40, 45, 144, 225];

        if ((event.which === 9 && this.elementValue(element) === '') || $.inArray(event.keyCode, excludedKeys) !== -1) {
          return;
        } else if (element.name in this.submitted || element.name in this.invalid) {
          this.element(element);
        }
      },
      onclick: function(element) {
        // Click on selects, radiobuttons and checkboxes
        if (element.name in this.submitted) {
          this.element(element);

          // Or option elements, check parent select in that case
        } else if (element.parentNode.name in this.submitted) {
          this.element(element.parentNode);
        }
      },
      highlight: function(element, errorClass, validClass) {
        if (element.type === 'radio') {
          this.findByName(element.name)
            .addClass(errorClass)
            .removeClass(validClass);
        } else {
          $(element)
            .addClass(errorClass)
            .removeClass(validClass);
        }
      },
      unhighlight: function(element, errorClass, validClass) {
        if (element.type === 'radio') {
          this.findByName(element.name)
            .removeClass(errorClass)
            .addClass(validClass);
        } else {
          $(element)
            .removeClass(errorClass)
            .addClass(validClass);
        }
      },
    },

    // https://jqueryvalidation.org/jQuery.validator.setDefaults/
    setDefaults: function(settings) {
      $.extend($.validator.defaults, settings);
    },

    messages: {
      required: 'This field is required.',
      remote: 'Please fix this field.',
      email: 'Please enter a valid email address.',
      url: 'Please enter a valid URL.',
      date: 'Please enter a valid date.',
      dateISO: 'Please enter a valid date (ISO).',
      number: 'Please enter a valid number.',
      digits: 'Please enter only digits.',
      equalTo: 'Please enter the same value again.',
      maxlength: $.validator.format('Please enter no more than {0} characters.'),
      minlength: $.validator.format('Please enter at least {0} characters.'),
      rangelength: $.validator.format('Please enter a value between {0} and {1} characters long.'),
      range: $.validator.format('Please enter a value between {0} and {1}.'),
      max: $.validator.format('Please enter a value less than or equal to {0}.'),
      min: $.validator.format('Please enter a value greater than or equal to {0}.'),
      step: $.validator.format('Please enter a multiple of {0}.'),
    },

    autoCreateRanges: false,

    prototype: {
      init: function() {
        this.labelContainer = $(this.settings.errorLabelContainer);
        this.errorContext = (this.labelContainer.length && this.labelContainer) || $(this.currentForm);
        this.containers = $(this.settings.errorContainer).add(this.settings.errorLabelContainer);
        this.submitted = {};
        this.valueCache = {};
        this.pendingRequest = 0;
        this.pending = {};
        this.invalid = {};
        this.reset();

        var groups = (this.groups = {}),
          rules;
        $.each(this.settings.groups, function(key, value) {
          if (typeof value === 'string') {
            value = value.split(/\s/);
          }
          $.each(value, function(index, name) {
            groups[name] = key;
          });
        });
        rules = this.settings.rules;
        $.each(rules, function(key, value) {
          rules[key] = $.validator.normalizeRule(value);
        });

        function delegate(event) {
          // Set form expando on contenteditable
          if (!this.form && this.hasAttribute('contenteditable')) {
            this.form = $(this).closest('form')[0];
            this.name = $(this).attr('name');
          }

          var validator = $.data(this.form, 'validator'),
            eventType = 'on' + event.type.replace(/^validate/, ''),
            settings = validator.settings;
          if (settings[eventType] && !$(this).is(settings.ignore)) {
            settings[eventType].call(validator, this, event);
          }
        }

        $(this.currentForm)
          .on(
            'focusin.validate focusout.validate keyup.validate',
            ":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], " +
              "[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], " +
              "[type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], " +
              "[type='radio'], [type='checkbox'], [contenteditable], [type='button']",
            delegate
          )

          // Support: Chrome, oldIE
          // "select" is provided as event.target when clicking a option
          .on('click.validate', "select, option, [type='radio'], [type='checkbox']", delegate);

        if (this.settings.invalidHandler) {
          $(this.currentForm).on('invalid-form.validate', this.settings.invalidHandler);
        }
      },

      // https://jqueryvalidation.org/Validator.form/
      form: function() {
        this.checkForm();
        $.extend(this.submitted, this.errorMap);
        this.invalid = $.extend({}, this.errorMap);
        if (!this.valid()) {
          $(this.currentForm).triggerHandler('invalid-form', [this]);
        }
        this.showErrors();
        return this.valid();
      },

      checkForm: function() {
        this.prepareForm();
        for (var i = 0, elements = (this.currentElements = this.elements()); elements[i]; i++) {
          this.check(elements[i]);
        }
        return this.valid();
      },

      // https://jqueryvalidation.org/Validator.element/
      element: function(element) {
        var cleanElement = this.clean(element),
          checkElement = this.validationTargetFor(cleanElement),
          v = this,
          result = true,
          rs,
          group;

        if (checkElement === undefined) {
          delete this.invalid[cleanElement.name];
        } else {
          this.prepareElement(checkElement);
          this.currentElements = $(checkElement);

          // If this element is grouped, then validate all group elements already
          // containing a value
          group = this.groups[checkElement.name];
          if (group) {
            $.each(this.groups, function(name, testgroup) {
              if (testgroup === group && name !== checkElement.name) {
                cleanElement = v.validationTargetFor(v.clean(v.findByName(name)));
                if (cleanElement && cleanElement.name in v.invalid) {
                  v.currentElements.push(cleanElement);
                  result = v.check(cleanElement) && result;
                }
              }
            });
          }

          rs = this.check(checkElement) !== false;
          result = result && rs;
          if (rs) {
            this.invalid[checkElement.name] = false;
          } else {
            this.invalid[checkElement.name] = true;
          }

          if (!this.numberOfInvalids()) {
            // Hide error containers on last error
            this.toHide = this.toHide.add(this.containers);
          }
          this.showErrors();

          // Add aria-invalid status for screen readers
          $(element).attr('aria-invalid', !rs);
        }

        return result;
      },

      // https://jqueryvalidation.org/Validator.showErrors/
      showErrors: function(errors) {
        if (errors) {
          var validator = this;

          // Add items to error list and map
          $.extend(this.errorMap, errors);
          this.errorList = $.map(this.errorMap, function(message, name) {
            return {
              message: message,
              element: validator.findByName(name)[0],
            };
          });

          // Remove items from success list
          this.successList = $.grep(this.successList, function(element) {
            return !(element.name in errors);
          });
        }
        if (this.settings.showErrors) {
          this.settings.showErrors.call(this, this.errorMap, this.errorList);
        } else {
          this.defaultShowErrors();
        }
      },

      // https://jqueryvalidation.org/Validator.resetForm/
      resetForm: function() {
        if ($.fn.resetForm) {
          $(this.currentForm).resetForm();
        }
        this.invalid = {};
        this.submitted = {};
        this.prepareForm();
        this.hideErrors();
        var elements = this.elements()
          .removeData('previousValue')
          .removeAttr('aria-invalid');

        this.resetElements(elements);
      },

      resetElements: function(elements) {
        var i;

        if (this.settings.unhighlight) {
          for (i = 0; elements[i]; i++) {
            this.settings.unhighlight.call(this, elements[i], this.settings.errorClass, '');
            this.findByName(elements[i].name).removeClass(this.settings.validClass);
          }
        } else {
          elements.removeClass(this.settings.errorClass).removeClass(this.settings.validClass);
        }
      },

      numberOfInvalids: function() {
        return this.objectLength(this.invalid);
      },

      objectLength: function(obj) {
        /* jshint unused: false */
        var count = 0,
          i;
        for (i in obj) {
          // This check allows counting elements with empty error
          // message as invalid elements
          if (obj[i] !== undefined && obj[i] !== null && obj[i] !== false) {
            count++;
          }
        }
        return count;
      },

      hideErrors: function() {
        this.hideThese(this.toHide);
      },

      hideThese: function(errors) {
        errors.not(this.containers).text('');
        this.addWrapper(errors).hide();
      },

      valid: function() {
        return this.size() === 0;
      },

      size: function() {
        return this.errorList.length;
      },

      focusInvalid: function() {
        if (this.settings.focusInvalid) {
          try {
            $(this.findLastActive() || (this.errorList.length && this.errorList[0].element) || [])
              .filter(':visible')
              .focus()

              // Manually trigger focusin event; without it, focusin handler isn't called, findLastActive won't have anything to find
              .trigger('focusin');
          } catch (e) {
            // Ignore IE throwing errors when focusing hidden elements
          }
        }
      },

      findLastActive: function() {
        var lastActive = this.lastActive;
        return (
          lastActive &&
          $.grep(this.errorList, function(n) {
            return n.element.name === lastActive.name;
          }).length === 1 &&
          lastActive
        );
      },

      elements: function() {
        var validator = this,
          rulesCache = {};

        // Select all valid inputs inside the form (no submit or reset buttons)
        return $(this.currentForm)
          .find('input, select, textarea, [contenteditable]')
          .not(':submit, :reset, :image, :disabled')
          .not(this.settings.ignore)
          .filter(function() {
            var name = this.name || $(this).attr('name'); // For contenteditable
            if (!name && validator.settings.debug && window.console) {
              console.error('%o has no name assigned', this);
            }

            // Set form expando on contenteditable
            if (this.hasAttribute('contenteditable')) {
              this.form = $(this).closest('form')[0];
              this.name = name;
            }

            // Select only the first element for each name, and only those with rules specified
            if (name in rulesCache || !validator.objectLength($(this).rules())) {
              return false;
            }

            rulesCache[name] = true;
            return true;
          });
      },

      clean: function(selector) {
        return $(selector)[0];
      },

      errors: function() {
        var errorClass = this.settings.errorClass.split(' ').join('.');
        return $(this.settings.errorElement + '.' + errorClass, this.errorContext);
      },

      resetInternals: function() {
        this.successList = [];
        this.errorList = [];
        this.errorMap = {};
        this.toShow = $([]);
        this.toHide = $([]);
      },

      reset: function() {
        this.resetInternals();
        this.currentElements = $([]);
      },

      prepareForm: function() {
        this.reset();
        this.toHide = this.errors().add(this.containers);
      },

      prepareElement: function(element) {
        this.reset();
        this.toHide = this.errorsFor(element);
      },

      elementValue: function(element) {
        var $element = $(element),
          type = element.type,
          val,
          idx;

        if (type === 'radio' || type === 'checkbox') {
          return this.findByName(element.name)
            .filter(':checked')
            .val();
        } else if (type === 'number' && typeof element.validity !== 'undefined') {
          return element.validity.badInput ? 'NaN' : $element.val();
        }

        if (element.hasAttribute('contenteditable')) {
          val = $element.text();
        } else {
          val = $element.val();
        }

        if (type === 'file') {
          // Modern browser (chrome & safari)
          if (val.substr(0, 12) === 'C:\\fakepath\\') {
            return val.substr(12);
          }

          // Legacy browsers
          // Unix-based path
          idx = val.lastIndexOf('/');
          if (idx >= 0) {
            return val.substr(idx + 1);
          }

          // Windows-based path
          idx = val.lastIndexOf('\\');
          if (idx >= 0) {
            return val.substr(idx + 1);
          }

          // Just the file name
          return val;
        }

        if (typeof val === 'string') {
          return val.replace(/\r/g, '');
        }
        return val;
      },

      check: function(element) {
        element = this.validationTargetFor(this.clean(element));

        var rules = $(element).rules(),
          rulesCount = $.map(rules, function(n, i) {
            return i;
          }).length,
          dependencyMismatch = false,
          val = this.elementValue(element),
          result,
          method,
          rule,
          normalizer;

        // Prioritize the local normalizer defined for this element over the global one
        // if the former exists, otherwise user the global one in case it exists.
        if (typeof rules.normalizer === 'function') {
          normalizer = rules.normalizer;
        } else if (typeof this.settings.normalizer === 'function') {
          normalizer = this.settings.normalizer;
        }

        // If normalizer is defined, then call it to retreive the changed value instead
        // of using the real one.
        // Note that `this` in the normalizer is `element`.
        if (normalizer) {
          val = normalizer.call(element, val);

          if (typeof val !== 'string') {
            throw new TypeError('The normalizer should return a string value.');
          }

          // Delete the normalizer from rules to avoid treating it as a pre-defined method.
          delete rules.normalizer;
        }

        for (method in rules) {
          rule = { method: method, parameters: rules[method] };
          try {
            result = $.validator.methods[method].call(this, val, element, rule.parameters);

            // If a method indicates that the field is optional and therefore valid,
            // don't mark it as valid when there are no other rules
            if (result === 'dependency-mismatch' && rulesCount === 1) {
              dependencyMismatch = true;
              continue;
            }
            dependencyMismatch = false;

            if (result === 'pending') {
              this.toHide = this.toHide.not(this.errorsFor(element));
              return;
            }

            if (!result) {
              this.formatAndAdd(element, rule);
              return false;
            }
          } catch (e) {
            if (this.settings.debug && window.console) {
              console.log(
                'Exception occurred when checking element ' + element.id + ", check the '" + rule.method + "' method.",
                e
              );
            }
            if (e instanceof TypeError) {
              e.message +=
                '.  Exception occurred when checking element ' +
                element.id +
                ", check the '" +
                rule.method +
                "' method.";
            }

            throw e;
          }
        }
        if (dependencyMismatch) {
          return;
        }
        if (this.objectLength(rules)) {
          this.successList.push(element);
        }
        return true;
      },

      // Return the custom message for the given element and validation method
      // specified in the element's HTML5 data attribute
      // return the generic message if present and no method specific message is present
      customDataMessage: function(element, method) {
        return (
          $(element).data('msg' + method.charAt(0).toUpperCase() + method.substring(1).toLowerCase()) ||
          $(element).data('msg')
        );
      },

      // Return the custom message for the given element name and validation method
      customMessage: function(name, method) {
        var m = this.settings.messages[name];
        return m && (m.constructor === String ? m : m[method]);
      },

      // Return the first defined argument, allowing empty strings
      findDefined: function() {
        for (var i = 0; i < arguments.length; i++) {
          if (arguments[i] !== undefined) {
            return arguments[i];
          }
        }
        return undefined;
      },

      // The second parameter 'rule' used to be a string, and extended to an object literal
      // of the following form:
      // rule = {
      //     method: "method name",
      //     parameters: "the given method parameters"
      // }
      //
      // The old behavior still supported, kept to maintain backward compatibility with
      // old code, and will be removed in the next major release.
      defaultMessage: function(element, rule) {
        if (typeof rule === 'string') {
          rule = { method: rule };
        }

        var message = this.findDefined(
            this.customMessage(element.name, rule.method),
            this.customDataMessage(element, rule.method),

            // 'title' is never undefined, so handle empty string as undefined
            (!this.settings.ignoreTitle && element.title) || undefined,
            $.validator.messages[rule.method],
            '<strong>Warning: No message defined for ' + element.name + '</strong>'
          ),
          theregex = /\$?\{(\d+)\}/g;
        if (typeof message === 'function') {
          message = message.call(this, rule.parameters, element);
        } else if (theregex.test(message)) {
          message = $.validator.format(message.replace(theregex, '{$1}'), rule.parameters);
        }

        return message;
      },

      formatAndAdd: function(element, rule) {
        var message = this.defaultMessage(element, rule);

        this.errorList.push({
          message: message,
          element: element,
          method: rule.method,
        });

        this.errorMap[element.name] = message;
        this.submitted[element.name] = message;
      },

      addWrapper: function(toToggle) {
        if (this.settings.wrapper) {
          toToggle = toToggle.add(toToggle.parent(this.settings.wrapper));
        }
        return toToggle;
      },

      defaultShowErrors: function() {
        var i, elements, error;
        for (i = 0; this.errorList[i]; i++) {
          error = this.errorList[i];
          if (this.settings.highlight) {
            this.settings.highlight.call(this, error.element, this.settings.errorClass, this.settings.validClass);
          }
          this.showLabel(error.element, error.message);
        }
        if (this.errorList.length) {
          this.toShow = this.toShow.add(this.containers);
        }
        if (this.settings.success) {
          for (i = 0; this.successList[i]; i++) {
            this.showLabel(this.successList[i]);
          }
        }
        if (this.settings.unhighlight) {
          for (i = 0, elements = this.validElements(); elements[i]; i++) {
            this.settings.unhighlight.call(this, elements[i], this.settings.errorClass, this.settings.validClass);
          }
        }
        this.toHide = this.toHide.not(this.toShow);
        this.hideErrors();
        this.addWrapper(this.toShow).show();
      },

      validElements: function() {
        return this.currentElements.not(this.invalidElements());
      },

      invalidElements: function() {
        return $(this.errorList).map(function() {
          return this.element;
        });
      },

      showLabel: function(element, message) {
        var place,
          group,
          errorID,
          v,
          error = this.errorsFor(element),
          elementID = this.idOrName(element),
          describedBy = $(element).attr('aria-describedby');

        if (error.length) {
          // Refresh error/success class
          error.removeClass(this.settings.validClass).addClass(this.settings.errorClass);

          // Replace message on existing label
          error.html(message);
        } else {
          // Create error element
          error = $('<' + this.settings.errorElement + '>')
            .attr('id', elementID + '-error')
            .addClass(this.settings.errorClass)
            .html(message || '');

          // Maintain reference to the element to be placed into the DOM
          place = error;
          if (this.settings.wrapper) {
            // Make sure the element is visible, even in IE
            // actually showing the wrapped element is handled elsewhere
            place = error
              .hide()
              .show()
              .wrap('<' + this.settings.wrapper + '/>')
              .parent();
          }
          if (this.labelContainer.length) {
            this.labelContainer.append(place);
          } else if (this.settings.errorPlacement) {
            this.settings.errorPlacement.call(this, place, $(element));
          } else {
            place.insertAfter(element);
          }

          // Link error back to the element
          if (error.is('label')) {
            // If the error is a label, then associate using 'for'
            error.attr('for', elementID);

            // If the element is not a child of an associated label, then it's necessary
            // to explicitly apply aria-describedby
          } else if (error.parents("label[for='" + this.escapeCssMeta(elementID) + "']").length === 0) {
            errorID = error.attr('id');

            // Respect existing non-error aria-describedby
            if (!describedBy) {
              describedBy = errorID;
            } else if (!describedBy.match(new RegExp('\\b' + this.escapeCssMeta(errorID) + '\\b'))) {
              // Add to end of list if not already present
              describedBy += ' ' + errorID;
            }
            $(element).attr('aria-describedby', describedBy);

            // If this element is grouped, then assign to all elements in the same group
            group = this.groups[element.name];
            if (group) {
              v = this;
              $.each(v.groups, function(name, testgroup) {
                if (testgroup === group) {
                  $("[name='" + v.escapeCssMeta(name) + "']", v.currentForm).attr('aria-describedby', error.attr('id'));
                }
              });
            }
          }
        }
        if (!message && this.settings.success) {
          error.text('');
          if (typeof this.settings.success === 'string') {
            error.addClass(this.settings.success);
          } else {
            this.settings.success(error, element);
          }
        }
        this.toShow = this.toShow.add(error);
      },

      errorsFor: function(element) {
        var name = this.escapeCssMeta(this.idOrName(element)),
          describer = $(element).attr('aria-describedby'),
          selector = "label[for='" + name + "'], label[for='" + name + "'] *";

        // 'aria-describedby' should directly reference the error element
        if (describer) {
          selector = selector + ', #' + this.escapeCssMeta(describer).replace(/\s+/g, ', #');
        }

        return this.errors().filter(selector);
      },

      // See https://api.jquery.com/category/selectors/, for CSS
      // meta-characters that should be escaped in order to be used with JQuery
      // as a literal part of a name/id or any selector.
      escapeCssMeta: function(string) {
        return string.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g, '\\$1');
      },

      idOrName: function(element) {
        return this.groups[element.name] || (this.checkable(element) ? element.name : element.id || element.name);
      },

      validationTargetFor: function(element) {
        // If radio/checkbox, validate first element in group instead
        if (this.checkable(element)) {
          element = this.findByName(element.name);
        }

        // Always apply ignore filter
        return $(element).not(this.settings.ignore)[0];
      },

      checkable: function(element) {
        return /radio|checkbox/i.test(element.type);
      },

      findByName: function(name) {
        return $(this.currentForm).find("[name='" + this.escapeCssMeta(name) + "']");
      },

      getLength: function(value, element) {
        switch (element.nodeName.toLowerCase()) {
          case 'select':
            return $('option:selected', element).length;
          case 'input':
            if (this.checkable(element)) {
              return this.findByName(element.name).filter(':checked').length;
            }
        }
        return value.length;
      },

      depend: function(param, element) {
        return this.dependTypes[typeof param] ? this.dependTypes[typeof param](param, element) : true;
      },

      dependTypes: {
        boolean: function(param) {
          return param;
        },
        string: function(param, element) {
          return !!$(param, element.form).length;
        },
        function: function(param, element) {
          return param(element);
        },
      },

      optional: function(element) {
        var val = this.elementValue(element);
        return !$.validator.methods.required.call(this, val, element) && 'dependency-mismatch';
      },

      startRequest: function(element) {
        if (!this.pending[element.name]) {
          this.pendingRequest++;
          $(element).addClass(this.settings.pendingClass);
          this.pending[element.name] = true;
        }
      },

      stopRequest: function(element, valid) {
        this.pendingRequest--;

        // Sometimes synchronization fails, make sure pendingRequest is never < 0
        if (this.pendingRequest < 0) {
          this.pendingRequest = 0;
        }
        delete this.pending[element.name];
        $(element).removeClass(this.settings.pendingClass);
        if (valid && this.pendingRequest === 0 && this.formSubmitted && this.form()) {
          $(this.currentForm).submit();

          // Remove the hidden input that was used as a replacement for the
          // missing submit button. The hidden input is added by `handle()`
          // to ensure that the value of the used submit button is passed on
          // for scripted submits triggered by this method
          if (this.submitButton) {
            $("input:hidden[name='" + this.submitButton.name + "']", this.currentForm).remove();
          }

          this.formSubmitted = false;
        } else if (!valid && this.pendingRequest === 0 && this.formSubmitted) {
          $(this.currentForm).triggerHandler('invalid-form', [this]);
          this.formSubmitted = false;
        }
      },

      previousValue: function(element, method) {
        method = (typeof method === 'string' && method) || 'remote';

        return (
          $.data(element, 'previousValue') ||
          $.data(element, 'previousValue', {
            old: null,
            valid: true,
            message: this.defaultMessage(element, { method: method }),
          })
        );
      },

      // Cleans up all forms and elements, removes validator-specific events
      destroy: function() {
        this.resetForm();

        $(this.currentForm)
          .off('.validate')
          .removeData('validator')
          .find('.validate-equalTo-blur')
          .off('.validate-equalTo')
          .removeClass('validate-equalTo-blur');
      },
    },

    classRuleSettings: {
      required: { required: true },
      email: { email: true },
      url: { url: true },
      date: { date: true },
      dateISO: { dateISO: true },
      number: { number: true },
      digits: { digits: true },
      creditcard: { creditcard: true },
    },

    addClassRules: function(className, rules) {
      if (className.constructor === String) {
        this.classRuleSettings[className] = rules;
      } else {
        $.extend(this.classRuleSettings, className);
      }
    },

    classRules: function(element) {
      var rules = {},
        classes = $(element).attr('class');

      if (classes) {
        $.each(classes.split(' '), function() {
          if (this in $.validator.classRuleSettings) {
            $.extend(rules, $.validator.classRuleSettings[this]);
          }
        });
      }
      return rules;
    },

    normalizeAttributeRule: function(rules, type, method, value) {
      // Convert the value to a number for number inputs, and for text for backwards compability
      // allows type="date" and others to be compared as strings
      if (/min|max|step/.test(method) && (type === null || /number|range|text/.test(type))) {
        value = Number(value);

        // Support Opera Mini, which returns NaN for undefined minlength
        if (isNaN(value)) {
          value = undefined;
        }
      }

      if (value || value === 0) {
        rules[method] = value;
      } else if (type === method && type !== 'range') {
        // Exception: the jquery validate 'range' method
        // does not test for the html5 'range' type
        rules[method] = true;
      }
    },

    attributeRules: function(element) {
      var rules = {},
        $element = $(element),
        type = element.getAttribute('type'),
        method,
        value;

      for (method in $.validator.methods) {
        // Support for <input required> in both html5 and older browsers
        if (method === 'required') {
          value = element.getAttribute(method);

          // Some browsers return an empty string for the required attribute
          // and non-HTML5 browsers might have required="" markup
          if (value === '') {
            value = true;
          }

          // Force non-HTML5 browsers to return bool
          value = !!value;
        } else {
          value = $element.attr(method);
        }

        this.normalizeAttributeRule(rules, type, method, value);
      }

      // 'maxlength' may be returned as -1, 2147483647 ( IE ) and 524288 ( safari ) for text inputs
      if (rules.maxlength && /-1|2147483647|524288/.test(rules.maxlength)) {
        delete rules.maxlength;
      }

      return rules;
    },

    dataRules: function(element) {
      var rules = {},
        $element = $(element),
        type = element.getAttribute('type'),
        method,
        value;

      for (method in $.validator.methods) {
        value = $element.data('rule' + method.charAt(0).toUpperCase() + method.substring(1).toLowerCase());
        this.normalizeAttributeRule(rules, type, method, value);
      }
      return rules;
    },

    staticRules: function(element) {
      var rules = {},
        validator = $.data(element.form, 'validator');

      if (validator.settings.rules) {
        rules = $.validator.normalizeRule(validator.settings.rules[element.name]) || {};
      }
      return rules;
    },

    normalizeRules: function(rules, element) {
      // Handle dependency check
      $.each(rules, function(prop, val) {
        // Ignore rule when param is explicitly false, eg. required:false
        if (val === false) {
          delete rules[prop];
          return;
        }
        if (val.param || val.depends) {
          var keepRule = true;
          switch (typeof val.depends) {
            case 'string':
              keepRule = !!$(val.depends, element.form).length;
              break;
            case 'function':
              keepRule = val.depends.call(element, element);
              break;
          }
          if (keepRule) {
            rules[prop] = val.param !== undefined ? val.param : true;
          } else {
            $.data(element.form, 'validator').resetElements($(element));
            delete rules[prop];
          }
        }
      });

      // Evaluate parameters
      $.each(rules, function(rule, parameter) {
        rules[rule] = $.isFunction(parameter) && rule !== 'normalizer' ? parameter(element) : parameter;
      });

      // Clean number parameters
      $.each(['minlength', 'maxlength'], function() {
        if (rules[this]) {
          rules[this] = Number(rules[this]);
        }
      });
      $.each(['rangelength', 'range'], function() {
        var parts;
        if (rules[this]) {
          if ($.isArray(rules[this])) {
            rules[this] = [Number(rules[this][0]), Number(rules[this][1])];
          } else if (typeof rules[this] === 'string') {
            parts = rules[this].replace(/[\[\]]/g, '').split(/[\s,]+/);
            rules[this] = [Number(parts[0]), Number(parts[1])];
          }
        }
      });

      if ($.validator.autoCreateRanges) {
        // Auto-create ranges
        if (rules.min != null && rules.max != null) {
          rules.range = [rules.min, rules.max];
          delete rules.min;
          delete rules.max;
        }
        if (rules.minlength != null && rules.maxlength != null) {
          rules.rangelength = [rules.minlength, rules.maxlength];
          delete rules.minlength;
          delete rules.maxlength;
        }
      }

      return rules;
    },

    // Converts a simple string to a {string: true} rule, e.g., "required" to {required:true}
    normalizeRule: function(data) {
      if (typeof data === 'string') {
        var transformed = {};
        $.each(data.split(/\s/), function() {
          transformed[this] = true;
        });
        data = transformed;
      }
      return data;
    },

    // https://jqueryvalidation.org/jQuery.validator.addMethod/
    addMethod: function(name, method, message) {
      $.validator.methods[name] = method;
      $.validator.messages[name] = message !== undefined ? message : $.validator.messages[name];
      if (method.length < 3) {
        $.validator.addClassRules(name, $.validator.normalizeRule(name));
      }
    },

    // https://jqueryvalidation.org/jQuery.validator.methods/
    methods: {
      // https://jqueryvalidation.org/required-method/
      required: function(value, element, param) {
        // Check if dependency is met
        if (!this.depend(param, element)) {
          return 'dependency-mismatch';
        }
        if (element.nodeName.toLowerCase() === 'select') {
          // Could be an array for select-multiple or a string, both are fine this way
          var val = $(element).val();
          return val && val.length > 0;
        }
        if (this.checkable(element)) {
          return this.getLength(value, element) > 0;
        }
        return value.length > 0;
      },

      // https://jqueryvalidation.org/email-method/
      email: function(value, element) {
        // From https://html.spec.whatwg.org/multipage/forms.html#valid-e-mail-address
        // Retrieved 2014-01-14
        // If you have a problem with this implementation, report a bug against the above spec
        // Or use custom methods to implement your own email validation
        return (
          this.optional(element) ||
          /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(
            value
          )
        );
      },

      // https://jqueryvalidation.org/url-method/
      url: function(value, element) {
        // Copyright (c) 2010-2013 Diego Perini, MIT licensed
        // https://gist.github.com/dperini/729294
        // see also https://mathiasbynens.be/demo/url-regex
        // modified to allow protocol-relative URLs
        return (
          this.optional(element) ||
          /^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(
            value
          )
        );
      },

      // https://jqueryvalidation.org/date-method/
      date: function(value, element) {
        return this.optional(element) || !/Invalid|NaN/.test(new Date(value).toString());
      },

      // https://jqueryvalidation.org/dateISO-method/
      dateISO: function(value, element) {
        return this.optional(element) || /^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(value);
      },

      // https://jqueryvalidation.org/number-method/
      number: function(value, element) {
        return this.optional(element) || /^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(value);
      },

      // https://jqueryvalidation.org/digits-method/
      digits: function(value, element) {
        return this.optional(element) || /^\d+$/.test(value);
      },

      // https://jqueryvalidation.org/minlength-method/
      minlength: function(value, element, param) {
        var length = $.isArray(value) ? value.length : this.getLength(value, element);
        return this.optional(element) || length >= param;
      },

      // https://jqueryvalidation.org/maxlength-method/
      maxlength: function(value, element, param) {
        var length = $.isArray(value) ? value.length : this.getLength(value, element);
        return this.optional(element) || length <= param;
      },

      // https://jqueryvalidation.org/rangelength-method/
      rangelength: function(value, element, param) {
        var length = $.isArray(value) ? value.length : this.getLength(value, element);
        return this.optional(element) || (length >= param[0] && length <= param[1]);
      },

      // https://jqueryvalidation.org/min-method/
      min: function(value, element, param) {
        return this.optional(element) || value >= param;
      },

      // https://jqueryvalidation.org/max-method/
      max: function(value, element, param) {
        return this.optional(element) || value <= param;
      },

      // https://jqueryvalidation.org/range-method/
      range: function(value, element, param) {
        return this.optional(element) || (value >= param[0] && value <= param[1]);
      },

      // https://jqueryvalidation.org/step-method/
      step: function(value, element, param) {
        var type = $(element).attr('type'),
          errorMessage = 'Step attribute on input type ' + type + ' is not supported.',
          supportedTypes = ['text', 'number', 'range'],
          re = new RegExp('\\b' + type + '\\b'),
          notSupported = type && !re.test(supportedTypes.join()),
          decimalPlaces = function(num) {
            var match = ('' + num).match(/(?:\.(\d+))?$/);
            if (!match) {
              return 0;
            }

            // Number of digits right of decimal point.
            return match[1] ? match[1].length : 0;
          },
          toInt = function(num) {
            return Math.round(num * Math.pow(10, decimals));
          },
          valid = true,
          decimals;

        // Works only for text, number and range input types
        // TODO find a way to support input types date, datetime, datetime-local, month, time and week
        if (notSupported) {
          throw new Error(errorMessage);
        }

        decimals = decimalPlaces(param);

        // Value can't have too many decimals
        if (decimalPlaces(value) > decimals || toInt(value) % toInt(param) !== 0) {
          valid = false;
        }

        return this.optional(element) || valid;
      },

      // https://jqueryvalidation.org/equalTo-method/
      equalTo: function(value, element, param) {
        // Bind to the blur event of the target in order to revalidate whenever the target field is updated
        var target = $(param);
        if (this.settings.onfocusout && target.not('.validate-equalTo-blur').length) {
          target.addClass('validate-equalTo-blur').on('blur.validate-equalTo', function() {
            $(element).valid();
          });
        }
        return value === target.val();
      },

      // https://jqueryvalidation.org/remote-method/
      remote: function(value, element, param, method) {
        if (this.optional(element)) {
          return 'dependency-mismatch';
        }

        method = (typeof method === 'string' && method) || 'remote';

        var previous = this.previousValue(element, method),
          validator,
          data,
          optionDataString;

        if (!this.settings.messages[element.name]) {
          this.settings.messages[element.name] = {};
        }
        previous.originalMessage = previous.originalMessage || this.settings.messages[element.name][method];
        this.settings.messages[element.name][method] = previous.message;

        param = (typeof param === 'string' && { url: param }) || param;
        optionDataString = $.param($.extend({ data: value }, param.data));
        if (previous.old === optionDataString) {
          return previous.valid;
        }

        previous.old = optionDataString;
        validator = this;
        this.startRequest(element);
        data = {};
        data[element.name] = value;
        $.ajax(
          $.extend(
            true,
            {
              mode: 'abort',
              port: 'validate' + element.name,
              dataType: 'json',
              data: data,
              context: validator.currentForm,
              success: function(response) {
                var valid = response === true || response === 'true',
                  errors,
                  message,
                  submitted;

                validator.settings.messages[element.name][method] = previous.originalMessage;
                if (valid) {
                  submitted = validator.formSubmitted;
                  validator.resetInternals();
                  validator.toHide = validator.errorsFor(element);
                  validator.formSubmitted = submitted;
                  validator.successList.push(element);
                  validator.invalid[element.name] = false;
                  validator.showErrors();
                } else {
                  errors = {};
                  message = response || validator.defaultMessage(element, { method: method, parameters: value });
                  errors[element.name] = previous.message = message;
                  validator.invalid[element.name] = true;
                  validator.showErrors(errors);
                }
                previous.valid = valid;
                validator.stopRequest(element, valid);
              },
            },
            param
          )
        );
        return 'pending';
      },
    },
  });

  // Ajax mode: abort
  // usage: $.ajax({ mode: "abort"[, port: "uniqueport"]});
  // if mode:"abort" is used, the previous request on that port (port can be undefined) is aborted via XMLHttpRequest.abort()

  var pendingRequests = {},
    ajax;

  // Use a prefilter if available (1.5+)
  if ($.ajaxPrefilter) {
    $.ajaxPrefilter(function(settings, _, xhr) {
      var port = settings.port;
      if (settings.mode === 'abort') {
        if (pendingRequests[port]) {
          pendingRequests[port].abort();
        }
        pendingRequests[port] = xhr;
      }
    });
  } else {
    // Proxy ajax
    ajax = $.ajax;
    $.ajax = function(settings) {
      var mode = ('mode' in settings ? settings : $.ajaxSettings).mode,
        port = ('port' in settings ? settings : $.ajaxSettings).port;
      if (mode === 'abort') {
        if (pendingRequests[port]) {
          pendingRequests[port].abort();
        }
        pendingRequests[port] = ajax.apply(this, arguments);
        return pendingRequests[port];
      }
      return ajax.apply(this, arguments);
    };
  }
  return $;
});

/*! jQuery Validation Plugin - v1.11.1 - 3/22/2013\n* https://github.com/jzaefferer/jquery-validation
 * Copyright (c) 2013 Jörn Zaefferer; Licensed MIT */ (function() {
  function t(t) {
    return t
      .replace(/<.[^<>]*?>/g, ' ')
      .replace(/&nbsp;|&#160;/gi, ' ')
      .replace(/[.(),;:!?%#$'"_+=\/\-]*/g, '');
  }
  jQuery.validator.addMethod(
    'maxWords',
    function(e, i, a) {
      return this.optional(i) || a >= t(e).match(/\b\w+\b/g).length;
    },
    jQuery.validator.format('Please enter {0} words or less.')
  ),
    jQuery.validator.addMethod(
      'minWords',
      function(e, i, a) {
        return this.optional(i) || t(e).match(/\b\w+\b/g).length >= a;
      },
      jQuery.validator.format('Please enter at least {0} words.')
    ),
    jQuery.validator.addMethod(
      'rangeWords',
      function(e, i, a) {
        var r = t(e),
          n = /\b\w+\b/g;
        return this.optional(i) || (r.match(n).length >= a[0] && r.match(n).length <= a[1]);
      },
      jQuery.validator.format('Please enter between {0} and {1} words.')
    );
})(),
  jQuery.validator.addMethod(
    'letterswithbasicpunc',
    function(t, e) {
      return this.optional(e) || /^[a-z\-.,()'"\s]+$/i.test(t);
    },
    'Letters or punctuation only please'
  ),
  jQuery.validator.addMethod(
    'alphanumeric',
    function(t, e) {
      return this.optional(e) || /^\w+$/i.test(t);
    },
    'Letters, numbers, and underscores only please'
  ),
  jQuery.validator.addMethod(
    'lettersonly',
    function(t, e) {
      return this.optional(e) || /^[a-z]+$/i.test(t);
    },
    'Letters only please'
  ),
  jQuery.validator.addMethod(
    'nowhitespace',
    function(t, e) {
      return this.optional(e) || /^\S+$/i.test(t);
    },
    'No white space please'
  ),
  jQuery.validator.addMethod(
    'ziprange',
    function(t, e) {
      return this.optional(e) || /^90[2-5]\d\{2\}-\d{4}$/.test(t);
    },
    'Your ZIP-code must be in the range 902xx-xxxx to 905-xx-xxxx'
  ),
  jQuery.validator.addMethod(
    'zipcodeUS',
    function(t, e) {
      return this.optional(e) || /\d{5}-\d{4}$|^\d{5}$/.test(t);
    },
    'The specified US ZIP Code is invalid'
  ),
  jQuery.validator.addMethod(
    'integer',
    function(t, e) {
      return this.optional(e) || /^-?\d+$/.test(t);
    },
    'A positive or negative non-decimal number please'
  ),
  jQuery.validator.addMethod(
    'vinUS',
    function(t) {
      if (17 !== t.length) return !1;
      var e,
        i,
        a,
        r,
        n,
        s,
        u = [
          'A',
          'B',
          'C',
          'D',
          'E',
          'F',
          'G',
          'H',
          'J',
          'K',
          'L',
          'M',
          'N',
          'P',
          'R',
          'S',
          'T',
          'U',
          'V',
          'W',
          'X',
          'Y',
          'Z',
        ],
        d = [1, 2, 3, 4, 5, 6, 7, 8, 1, 2, 3, 4, 5, 7, 9, 2, 3, 4, 5, 6, 7, 8, 9],
        o = [8, 7, 6, 5, 4, 3, 2, 10, 0, 9, 8, 7, 6, 5, 4, 3, 2],
        l = 0;
      for (e = 0; 17 > e; e++) {
        if (((r = o[e]), (a = t.slice(e, e + 1)), 8 === e && (s = a), isNaN(a))) {
          for (i = 0; u.length > i; i++)
            if (a.toUpperCase() === u[i]) {
              (a = d[i]), (a *= r), isNaN(s) && 8 === i && (s = u[i]);
              break;
            }
        } else a *= r;
        l += a;
      }
      return (n = l % 11), 10 === n && (n = 'X'), n === s ? !0 : !1;
    },
    'The specified vehicle identification number (VIN) is invalid.'
  ),
  jQuery.validator.addMethod(
    'dateITA',
    function(t, e) {
      var i = !1,
        a = /^\d{1,2}\/\d{1,2}\/\d{4}$/;
      if (a.test(t)) {
        var r = t.split('/'),
          n = parseInt(r[0], 10),
          s = parseInt(r[1], 10),
          u = parseInt(r[2], 10),
          d = new Date(u, s - 1, n);
        i = d.getFullYear() === u && d.getMonth() === s - 1 && d.getDate() === n ? !0 : !1;
      } else i = !1;
      return this.optional(e) || i;
    },
    'Please enter a correct date'
  ),
  jQuery.validator.addMethod(
    'iban',
    function(t, e) {
      if (this.optional(e)) return !0;
      if (!/^([a-zA-Z0-9]{4} ){2,8}[a-zA-Z0-9]{1,4}|[a-zA-Z0-9]{12,34}$/.test(t)) return !1;
      var i = t.replace(/ /g, '').toUpperCase(),
        a = i.substring(0, 2),
        r = {
          AL: '\\d{8}[\\dA-Z]{16}',
          AD: '\\d{8}[\\dA-Z]{12}',
          AT: '\\d{16}',
          AZ: '[\\dA-Z]{4}\\d{20}',
          BE: '\\d{12}',
          BH: '[A-Z]{4}[\\dA-Z]{14}',
          BA: '\\d{16}',
          BR: '\\d{23}[A-Z][\\dA-Z]',
          BG: '[A-Z]{4}\\d{6}[\\dA-Z]{8}',
          CR: '\\d{17}',
          HR: '\\d{17}',
          CY: '\\d{8}[\\dA-Z]{16}',
          CZ: '\\d{20}',
          DK: '\\d{14}',
          DO: '[A-Z]{4}\\d{20}',
          EE: '\\d{16}',
          FO: '\\d{14}',
          FI: '\\d{14}',
          FR: '\\d{10}[\\dA-Z]{11}\\d{2}',
          GE: '[\\dA-Z]{2}\\d{16}',
          DE: '\\d{18}',
          GI: '[A-Z]{4}[\\dA-Z]{15}',
          GR: '\\d{7}[\\dA-Z]{16}',
          GL: '\\d{14}',
          GT: '[\\dA-Z]{4}[\\dA-Z]{20}',
          HU: '\\d{24}',
          IS: '\\d{22}',
          IE: '[\\dA-Z]{4}\\d{14}',
          IL: '\\d{19}',
          IT: '[A-Z]\\d{10}[\\dA-Z]{12}',
          KZ: '\\d{3}[\\dA-Z]{13}',
          KW: '[A-Z]{4}[\\dA-Z]{22}',
          LV: '[A-Z]{4}[\\dA-Z]{13}',
          LB: '\\d{4}[\\dA-Z]{20}',
          LI: '\\d{5}[\\dA-Z]{12}',
          LT: '\\d{16}',
          LU: '\\d{3}[\\dA-Z]{13}',
          MK: '\\d{3}[\\dA-Z]{10}\\d{2}',
          MT: '[A-Z]{4}\\d{5}[\\dA-Z]{18}',
          MR: '\\d{23}',
          MU: '[A-Z]{4}\\d{19}[A-Z]{3}',
          MC: '\\d{10}[\\dA-Z]{11}\\d{2}',
          MD: '[\\dA-Z]{2}\\d{18}',
          ME: '\\d{18}',
          NL: '[A-Z]{4}\\d{10}',
          NO: '\\d{11}',
          PK: '[\\dA-Z]{4}\\d{16}',
          PS: '[\\dA-Z]{4}\\d{21}',
          PL: '\\d{24}',
          PT: '\\d{21}',
          RO: '[A-Z]{4}[\\dA-Z]{16}',
          SM: '[A-Z]\\d{10}[\\dA-Z]{12}',
          SA: '\\d{2}[\\dA-Z]{18}',
          RS: '\\d{18}',
          SK: '\\d{20}',
          SI: '\\d{15}',
          ES: '\\d{20}',
          SE: '\\d{20}',
          CH: '\\d{5}[\\dA-Z]{12}',
          TN: '\\d{20}',
          TR: '\\d{5}[\\dA-Z]{17}',
          AE: '\\d{3}\\d{16}',
          GB: '[A-Z]{4}\\d{14}',
          VG: '[\\dA-Z]{4}\\d{16}',
        },
        n = r[a];
      if (n !== void 0) {
        var s = RegExp('^[A-Z]{2}\\d{2}' + n + '$', '');
        if (!s.test(i)) return !1;
      }
      for (var u, d = i.substring(4, i.length) + i.substring(0, 4), o = '', l = !0, h = 0; d.length > h; h++)
        (u = d.charAt(h)), '0' !== u && (l = !1), l || (o += '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ'.indexOf(u));
      for (var F = '', c = '', m = 0; o.length > m; m++) {
        var f = o.charAt(m);
        (c = '' + F + f), (F = c % 97);
      }
      return 1 === F;
    },
    'Please specify a valid IBAN'
  ),
  jQuery.validator.addMethod(
    'dateNL',
    function(t, e) {
      return this.optional(e) || /^(0?[1-9]|[12]\d|3[01])[\.\/\-](0?[1-9]|1[012])[\.\/\-]([12]\d)?(\d\d)$/.test(t);
    },
    'Please enter a correct date'
  ),
  jQuery.validator.addMethod(
    'phoneNL',
    function(t, e) {
      return (
        this.optional(e) ||
        /^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)[1-9]((\s|\s?\-\s?)?[0-9]){8}$/.test(t)
      );
    },
    'Please specify a valid phone number.'
  ),
  jQuery.validator.addMethod(
    'mobileNL',
    function(t, e) {
      return (
        this.optional(e) ||
        /^((\+|00(\s|\s?\-\s?)?)31(\s|\s?\-\s?)?(\(0\)[\-\s]?)?|0)6((\s|\s?\-\s?)?[0-9]){8}$/.test(t)
      );
    },
    'Please specify a valid mobile number'
  ),
  jQuery.validator.addMethod(
    'postalcodeNL',
    function(t, e) {
      return this.optional(e) || /^[1-9][0-9]{3}\s?[a-zA-Z]{2}$/.test(t);
    },
    'Please specify a valid postal code'
  ),
  jQuery.validator.addMethod(
    'bankaccountNL',
    function(t, e) {
      if (this.optional(e)) return !0;
      if (!/^[0-9]{9}|([0-9]{2} ){3}[0-9]{3}$/.test(t)) return !1;
      for (var i = t.replace(/ /g, ''), a = 0, r = i.length, n = 0; r > n; n++) {
        var s = r - n,
          u = i.substring(n, n + 1);
        a += s * u;
      }
      return 0 === a % 11;
    },
    'Please specify a valid bank account number'
  ),
  jQuery.validator.addMethod(
    'giroaccountNL',
    function(t, e) {
      return this.optional(e) || /^[0-9]{1,7}$/.test(t);
    },
    'Please specify a valid giro account number'
  ),
  jQuery.validator.addMethod(
    'bankorgiroaccountNL',
    function(t, e) {
      return (
        this.optional(e) ||
        $.validator.methods.bankaccountNL.call(this, t, e) ||
        $.validator.methods.giroaccountNL.call(this, t, e)
      );
    },
    'Please specify a valid bank or giro account number'
  ),
  jQuery.validator.addMethod(
    'time',
    function(t, e) {
      return this.optional(e) || /^([01]\d|2[0-3])(:[0-5]\d){1,2}$/.test(t);
    },
    'Please enter a valid time, between 00:00 and 23:59'
  ),
  jQuery.validator.addMethod(
    'time12h',
    function(t, e) {
      return this.optional(e) || /^((0?[1-9]|1[012])(:[0-5]\d){1,2}(\ ?[AP]M))$/i.test(t);
    },
    'Please enter a valid time in 12-hour am/pm format'
  ),
  jQuery.validator.addMethod(
    'phoneUS',
    function(t, e) {
      return (
        (t = t.replace(/\s+/g, '')),
        this.optional(e) || (t.length > 9 && t.match(/^(\+?1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/))
      );
    },
    'Please specify a valid phone number'
  ),
  jQuery.validator.addMethod(
    'phoneUK',
    function(t, e) {
      return (
        (t = t.replace(/\(|\)|\s+|-/g, '')),
        this.optional(e) ||
          (t.length > 9 &&
            t.match(
              /^(?:(?:(?:00\s?|\+)44\s?)|(?:\(?0))(?:\d{2}\)?\s?\d{4}\s?\d{4}|\d{3}\)?\s?\d{3}\s?\d{3,4}|\d{4}\)?\s?(?:\d{5}|\d{3}\s?\d{3})|\d{5}\)?\s?\d{4,5})$/
            ))
      );
    },
    'Please specify a valid phone number'
  ),
  jQuery.validator.addMethod(
    'mobileUK',
    function(t, e) {
      return (
        (t = t.replace(/\(|\)|\s+|-/g, '')),
        this.optional(e) ||
          (t.length > 9 && t.match(/^(?:(?:(?:00\s?|\+)44\s?|0)7(?:[45789]\d{2}|624)\s?\d{3}\s?\d{3})$/))
      );
    },
    'Please specify a valid mobile number'
  ),
  jQuery.validator.addMethod(
    'phonesUK',
    function(t, e) {
      return (
        (t = t.replace(/\(|\)|\s+|-/g, '')),
        this.optional(e) ||
          (t.length > 9 && t.match(/^(?:(?:(?:00\s?|\+)44\s?|0)(?:1\d{8,9}|[23]\d{9}|7(?:[45789]\d{8}|624\d{6})))$/))
      );
    },
    'Please specify a valid uk phone number'
  ),
  jQuery.validator.addMethod(
    'postcodeUK',
    function(t, e) {
      return (
        this.optional(e) ||
        /^((([A-PR-UWYZ][0-9])|([A-PR-UWYZ][0-9][0-9])|([A-PR-UWYZ][A-HK-Y][0-9])|([A-PR-UWYZ][A-HK-Y][0-9][0-9])|([A-PR-UWYZ][0-9][A-HJKSTUW])|([A-PR-UWYZ][A-HK-Y][0-9][ABEHMNPRVWXY]))\s?([0-9][ABD-HJLNP-UW-Z]{2})|(GIR)\s?(0AA))$/i.test(
          t
        )
      );
    },
    'Please specify a valid UK postcode'
  ),
  jQuery.validator.addMethod(
    'strippedminlength',
    function(t, e, i) {
      return jQuery(t).text().length >= i;
    },
    jQuery.validator.format('Please enter at least {0} characters')
  ),
  jQuery.validator.addMethod(
    'email2',
    function(t, e) {
      return (
        this.optional(e) ||
        /^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(
          t
        )
      );
    },
    jQuery.validator.messages.email
  ),
  jQuery.validator.addMethod(
    'url2',
    function(t, e) {
      return (
        this.optional(e) ||
        /^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(
          t
        )
      );
    },
    jQuery.validator.messages.url
  ),
  jQuery.validator.addMethod(
    'creditcardtypes',
    function(t, e, i) {
      if (/[^0-9\-]+/.test(t)) return !1;
      t = t.replace(/\D/g, '');
      var a = 0;
      return (
        i.mastercard && (a |= 1),
        i.visa && (a |= 2),
        i.amex && (a |= 4),
        i.dinersclub && (a |= 8),
        i.enroute && (a |= 16),
        i.discover && (a |= 32),
        i.jcb && (a |= 64),
        i.unknown && (a |= 128),
        i.all && (a = 255),
        1 & a && /^(5[12345])/.test(t)
          ? 16 === t.length
          : 2 & a && /^(4)/.test(t)
          ? 16 === t.length
          : 4 & a && /^(3[47])/.test(t)
          ? 15 === t.length
          : 8 & a && /^(3(0[012345]|[68]))/.test(t)
          ? 14 === t.length
          : 16 & a && /^(2(014|149))/.test(t)
          ? 15 === t.length
          : 32 & a && /^(6011)/.test(t)
          ? 16 === t.length
          : 64 & a && /^(3)/.test(t)
          ? 16 === t.length
          : 64 & a && /^(2131|1800)/.test(t)
          ? 15 === t.length
          : 128 & a
          ? !0
          : !1
      );
    },
    'Please enter a valid credit card number.'
  ),
  jQuery.validator.addMethod(
    'ipv4',
    function(t, e) {
      return (
        this.optional(e) ||
        /^(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)\.(25[0-5]|2[0-4]\d|[01]?\d\d?)$/i.test(
          t
        )
      );
    },
    'Please enter a valid IP v4 address.'
  ),
  jQuery.validator.addMethod(
    'ipv6',
    function(t, e) {
      return (
        this.optional(e) ||
        /^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(
          t
        )
      );
    },
    'Please enter a valid IP v6 address.'
  ),
  jQuery.validator.addMethod(
    'pattern',
    function(t, e, i) {
      return this.optional(e) ? !0 : ('string' == typeof i && (i = RegExp('^(?:' + i + ')$')), i.test(t));
    },
    'Invalid format.'
  ),
  jQuery.validator.addMethod(
    'require_from_group',
    function(t, e, i) {
      var a = this,
        r = i[1],
        n =
          $(r, e.form).filter(function() {
            return a.elementValue(this);
          }).length >= i[0];
      if (!$(e).data('being_validated')) {
        var s = $(r, e.form);
        s.data('being_validated', !0), s.valid(), s.data('being_validated', !1);
      }
      return n;
    },
    jQuery.validator.format('Please fill at least {0} of these fields.')
  ),
  jQuery.validator.addMethod(
    'skip_or_fill_minimum',
    function(t, e, i) {
      var a = this,
        r = i[0],
        n = i[1],
        s = $(n, e.form).filter(function() {
          return a.elementValue(this);
        }).length,
        u = s >= r || 0 === s;
      if (!$(e).data('being_validated')) {
        var d = $(n, e.form);
        d.data('being_validated', !0), d.valid(), d.data('being_validated', !1);
      }
      return u;
    },
    jQuery.validator.format('Please either skip these fields or fill at least {0} of them.')
  ),
  jQuery.validator.addMethod(
    'accept',
    function(t, e, i) {
      var a,
        r,
        n = 'string' == typeof i ? i.replace(/\s/g, '').replace(/,/g, '|') : 'image/*',
        s = this.optional(e);
      if (s) return s;
      if ('file' === $(e).attr('type') && ((n = n.replace(/\*/g, '.*')), e.files && e.files.length))
        for (a = 0; e.files.length > a; a++)
          if (((r = e.files[a]), !r.type.match(RegExp('.?(' + n + ')$', 'i')))) return !1;
      return !0;
    },
    jQuery.validator.format('Please enter a value with a valid mimetype.')
  ),
  jQuery.validator.addMethod(
    'extension',
    function(t, e, i) {
      return (
        (i = 'string' == typeof i ? i.replace(/,/g, '|') : 'png|jpe?g|gif'),
        this.optional(e) || t.match(RegExp('.(' + i + ')$', 'i'))
      );
    },
    jQuery.validator.format('Please enter a value with a valid extension.')
  );

/*!
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 *
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

// Script: jQuery throttle / debounce: Sometimes, less is more!
//
// *Version: 1.1, Last updated: 3/7/2010*
//
// Project Home - http://benalman.com/projects/jquery-throttle-debounce-plugin/
// GitHub       - http://github.com/cowboy/jquery-throttle-debounce/
// Source       - http://github.com/cowboy/jquery-throttle-debounce/raw/master/jquery.ba-throttle-debounce.js
// (Minified)   - http://github.com/cowboy/jquery-throttle-debounce/raw/master/jquery.ba-throttle-debounce.min.js (0.7kb)
//
// About: License
//
// Copyright (c) 2010 "Cowboy" Ben Alman,
// Dual licensed under the MIT and GPL licenses.
// http://benalman.com/about/license/
//
// About: Examples
//
// These working examples, complete with fully commented code, illustrate a few
// ways in which this plugin can be used.
//
// Throttle - http://benalman.com/code/projects/jquery-throttle-debounce/examples/throttle/
// Debounce - http://benalman.com/code/projects/jquery-throttle-debounce/examples/debounce/
//
// About: Support and Testing
//
// Information about what version or versions of jQuery this plugin has been
// tested with, what browsers it has been tested in, and where the unit tests
// reside (so you can test it yourself).
//
// jQuery Versions - none, 1.3.2, 1.4.2
// Browsers Tested - Internet Explorer 6-8, Firefox 2-3.6, Safari 3-4, Chrome 4-5, Opera 9.6-10.1.
// Unit Tests      - http://benalman.com/code/projects/jquery-throttle-debounce/unit/
//
// About: Release History
//
// 1.1 - (3/7/2010) Fixed a bug in <jQuery.throttle> where trailing callbacks
//       executed later than they should. Reworked a fair amount of internal
//       logic as well.
// 1.0 - (3/6/2010) Initial release as a stand-alone project. Migrated over
//       from jquery-misc repo v0.4 to jquery-throttle repo v1.0, added the
//       no_trailing throttle parameter and debounce functionality.
//
// Topic: Note for non-jQuery users
//
// jQuery isn't actually required for this plugin, because nothing internal
// uses any jQuery methods or properties. jQuery is just used as a namespace
// under which these methods can exist.
//
// Since jQuery isn't actually required for this plugin, if jQuery doesn't exist
// when this plugin is loaded, the method described below will be created in
// the `Cowboy` namespace. Usage will be exactly the same, but instead of
// $.method() or jQuery.method(), you'll need to use Cowboy.method().

(function(window, undefined) {
  '$:nomunge'; // Used by YUI compressor.

  // Since jQuery really isn't required for this plugin, use `jQuery` as the
  // namespace only if it already exists, otherwise use the `Cowboy` namespace,
  // creating it if necessary.
  var $ = window.jQuery || window.Cowboy || (window.Cowboy = {}),
    // Internal method reference.
    jq_throttle;

  // Method: jQuery.throttle
  //
  // Throttle execution of a function. Especially useful for rate limiting
  // execution of handlers on events like resize and scroll. If you want to
  // rate-limit execution of a function to a single time, see the
  // <jQuery.debounce> method.
  //
  // In this visualization, | is a throttled-function call and X is the actual
  // callback execution:
  //
  // > Throttled with `no_trailing` specified as false or unspecified:
  // > ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
  // > X    X    X    X    X    X        X    X    X    X    X    X
  // >
  // > Throttled with `no_trailing` specified as true:
  // > ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
  // > X    X    X    X    X             X    X    X    X    X
  //
  // Usage:
  //
  // > var throttled = jQuery.throttle( delay, [ no_trailing, ] callback );
  // >
  // > jQuery('selector').bind( 'someevent', throttled );
  // > jQuery('selector').unbind( 'someevent', throttled );
  //
  // This also works in jQuery 1.4+:
  //
  // > jQuery('selector').bind( 'someevent', jQuery.throttle( delay, [ no_trailing, ] callback ) );
  // > jQuery('selector').unbind( 'someevent', callback );
  //
  // Arguments:
  //
  //  delay - (Number) A zero-or-greater delay in milliseconds. For event
  //    callbacks, values around 100 or 250 (or even higher) are most useful.
  //  no_trailing - (Boolean) Optional, defaults to false. If no_trailing is
  //    true, callback will only execute every `delay` milliseconds while the
  //    throttled-function is being called. If no_trailing is false or
  //    unspecified, callback will be executed one final time after the last
  //    throttled-function call. (After the throttled-function has not been
  //    called for `delay` milliseconds, the internal counter is reset)
  //  callback - (Function) A function to be executed after delay milliseconds.
  //    The `this` context and all arguments are passed through, as-is, to
  //    `callback` when the throttled-function is executed.
  //
  // Returns:
  //
  //  (Function) A new, throttled, function.

  $.throttle = jq_throttle = function(delay, no_trailing, callback, debounce_mode) {
    // After wrapper has stopped being called, this timeout ensures that
    // `callback` is executed at the proper times in `throttle` and `end`
    // debounce modes.
    var timeout_id,
      // Keep track of the last time `callback` was executed.
      last_exec = 0;

    // `no_trailing` defaults to falsy.
    if (typeof no_trailing !== 'boolean') {
      debounce_mode = callback;
      callback = no_trailing;
      no_trailing = undefined;
    }

    // The `wrapper` function encapsulates all of the throttling / debouncing
    // functionality and when executed will limit the rate at which `callback`
    // is executed.
    function wrapper() {
      var that = this,
        elapsed = +new Date() - last_exec,
        args = arguments;

      // Execute `callback` and update the `last_exec` timestamp.
      function exec() {
        last_exec = +new Date();
        callback.apply(that, args);
      }
      // If `debounce_mode` is true (at_begin) this is used to clear the flag
      // to allow future `callback` executions.
      function clear() {
        timeout_id = undefined;
      }
      if (debounce_mode && !timeout_id) {
        // Since `wrapper` is being called for the first time and
        // `debounce_mode` is true (at_begin), execute `callback`.
        exec();
      }

      // Clear any existing timeout.
      timeout_id && clearTimeout(timeout_id);

      if (debounce_mode === undefined && elapsed > delay) {
        // In throttle mode, if `delay` time has been exceeded, execute
        // `callback`.
        exec();
      } else if (no_trailing !== true) {
        // In trailing throttle mode, since `delay` time has not been
        // exceeded, schedule `callback` to execute `delay` ms after most
        // recent execution.
        //
        // If `debounce_mode` is true (at_begin), schedule `clear` to execute
        // after `delay` ms.
        //
        // If `debounce_mode` is false (at end), schedule `callback` to
        // execute after `delay` ms.
        timeout_id = setTimeout(debounce_mode ? clear : exec, debounce_mode === undefined ? delay - elapsed : delay);
      }
    }
    // Set the guid of `wrapper` function to the same of original callback, so
    // it can be removed in jQuery 1.4+ .unbind or .die by using the original
    // callback as a reference.
    if ($.guid) {
      wrapper.guid = callback.guid = callback.guid || $.guid++;
    }

    // Return the wrapper function.
    return wrapper;
  };

  // Method: jQuery.debounce
  //
  // Debounce execution of a function. Debouncing, unlike throttling,
  // guarantees that a function is only executed a single time, either at the
  // very beginning of a series of calls, or at the very end. If you want to
  // simply rate-limit execution of a function, see the <jQuery.throttle>
  // method.
  //
  // In this visualization, | is a debounced-function call and X is the actual
  // callback execution:
  //
  // > Debounced with `at_begin` specified as false or unspecified:
  // > ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
  // >                          X                                 X
  // >
  // > Debounced with `at_begin` specified as true:
  // > ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
  // > X                                 X
  //
  // Usage:
  //
  // > var debounced = jQuery.debounce( delay, [ at_begin, ] callback );
  // >
  // > jQuery('selector').bind( 'someevent', debounced );
  // > jQuery('selector').unbind( 'someevent', debounced );
  //
  // This also works in jQuery 1.4+:
  //
  // > jQuery('selector').bind( 'someevent', jQuery.debounce( delay, [ at_begin, ] callback ) );
  // > jQuery('selector').unbind( 'someevent', callback );
  //
  // Arguments:
  //
  //  delay - (Number) A zero-or-greater delay in milliseconds. For event
  //    callbacks, values around 100 or 250 (or even higher) are most useful.
  //  at_begin - (Boolean) Optional, defaults to false. If at_begin is false or
  //    unspecified, callback will only be executed `delay` milliseconds after
  //    the last debounced-function call. If at_begin is true, callback will be
  //    executed only at the first debounced-function call. (After the
  //    throttled-function has not been called for `delay` milliseconds, the
  //    internal counter is reset)
  //  callback - (Function) A function to be executed after delay milliseconds.
  //    The `this` context and all arguments are passed through, as-is, to
  //    `callback` when the debounced-function is executed.
  //
  // Returns:
  //
  //  (Function) A new, debounced, function.

  $.debounce = function(delay, at_begin, callback) {
    return callback === undefined
      ? jq_throttle(delay, at_begin, false)
      : jq_throttle(delay, callback, at_begin !== false);
  };
})(this);

/*!
	Colorbox v1.5.9 - 2014-04-25
	jQuery lightbox and modal window plugin
	(c) 2014 Jack Moore - http://www.jacklmoore.com/colorbox
	license: http://www.opensource.org/licenses/mit-license.php
*/
(function($, document, window) {
  var // Default settings object.
    // See http://jacklmoore.com/colorbox for details.
    defaults = {
      // data sources
      html: false,
      photo: false,
      iframe: false,
      inline: false,

      // behavior and appearance
      transition: 'elastic',
      speed: 300,
      fadeOut: 300,
      width: false,
      initialWidth: '600',
      innerWidth: false,
      maxWidth: false,
      height: false,
      initialHeight: '450',
      innerHeight: false,
      maxHeight: false,
      scalePhotos: true,
      scrolling: true,
      opacity: 0.9,
      preloading: true,
      className: false,
      overlayClose: true,
      escKey: true,
      arrowKey: true,
      top: false,
      bottom: false,
      left: false,
      right: false,
      fixed: false,
      data: undefined,
      closeButton: true,
      fastIframe: true,
      open: false,
      reposition: true,
      loop: true,
      slideshow: false,
      slideshowAuto: true,
      slideshowSpeed: 2500,
      slideshowStart: 'start slideshow',
      slideshowStop: 'stop slideshow',
      photoRegex: /\.(gif|png|jp(e|g|eg)|bmp|ico|webp|jxr|svg)((#|\?).*)?$/i,

      // alternate image paths for high-res displays
      retinaImage: false,
      retinaUrl: false,
      retinaSuffix: '@2x.$1',

      // internationalization
      current: 'image {current} of {total}',
      previous: 'previous',
      next: 'next',
      close: 'close',
      xhrError: 'This content failed to load.',
      imgError: 'This image failed to load.',

      // accessbility
      returnFocus: true,
      trapFocus: true,

      // callbacks
      onOpen: false,
      onLoad: false,
      onComplete: false,
      onCleanup: false,
      onClosed: false,

      rel: function() {
        return this.rel;
      },
      href: function() {
        // using this.href would give the absolute url, when the href may have been inteded as a selector (e.g. '#container')
        return $(this).attr('href');
      },
      title: function() {
        return this.title;
      },
    },
    // Abstracting the HTML and event identifiers for easy rebranding
    colorbox = 'colorbox',
    prefix = 'cbox',
    boxElement = prefix + 'Element',
    // Events
    event_open = prefix + '_open',
    event_load = prefix + '_load',
    event_complete = prefix + '_complete',
    event_cleanup = prefix + '_cleanup',
    event_closed = prefix + '_closed',
    event_purge = prefix + '_purge',
    // Cached jQuery Object Variables
    $overlay,
    $box,
    $wrap,
    $content,
    $topBorder,
    $leftBorder,
    $rightBorder,
    $bottomBorder,
    $related,
    $window,
    $loaded,
    $loadingBay,
    $loadingOverlay,
    $title,
    $current,
    $slideshow,
    $next,
    $prev,
    $close,
    $groupControls,
    $events = $('<a/>'), // $({}) would be prefered, but there is an issue with jQuery 1.4.2
    // Variables for cached values or use across multiple functions
    settings,
    interfaceHeight,
    interfaceWidth,
    loadedHeight,
    loadedWidth,
    index,
    photo,
    open,
    active,
    closing,
    loadingTimer,
    publicMethod,
    div = 'div',
    requests = 0,
    previousCSS = {},
    init;

  // ****************
  // HELPER FUNCTIONS
  // ****************

  // Convenience function for creating new jQuery objects
  function $tag(tag, id, css) {
    var element = document.createElement(tag);

    if (id) {
      element.id = prefix + id;
    }

    if (css) {
      element.style.cssText = css;
    }

    return $(element);
  }

  // Get the window height using innerHeight when available to avoid an issue with iOS
  // http://bugs.jquery.com/ticket/6724
  function winheight() {
    return window.innerHeight ? window.innerHeight : $(window).height();
  }

  function Settings(element, options) {
    if (options !== Object(options)) {
      options = {};
    }

    this.cache = {};
    this.el = element;

    this.value = function(key) {
      var dataAttr;

      if (this.cache[key] === undefined) {
        dataAttr = $(this.el).attr('data-cbox-' + key);

        if (dataAttr !== undefined) {
          this.cache[key] = dataAttr;
        } else if (options[key] !== undefined) {
          this.cache[key] = options[key];
        } else if (defaults[key] !== undefined) {
          this.cache[key] = defaults[key];
        }
      }

      return this.cache[key];
    };

    this.get = function(key) {
      var value = this.value(key);
      return $.isFunction(value) ? value.call(this.el, this) : value;
    };
  }

  // Determine the next and previous members in a group.
  function getIndex(increment) {
    var max = $related.length,
      newIndex = (index + increment) % max;

    return newIndex < 0 ? max + newIndex : newIndex;
  }

  // Convert '%' and 'px' values to integers
  function setSize(size, dimension) {
    return Math.round(
      (/%/.test(size) ? (dimension === 'x' ? $window.width() : winheight()) / 100 : 1) * parseInt(size, 10)
    );
  }

  // Checks an href to see if it is a photo.
  // There is a force photo option (photo: true) for hrefs that cannot be matched by the regex.
  function isImage(settings, url) {
    return settings.get('photo') || settings.get('photoRegex').test(url);
  }

  function retinaUrl(settings, url) {
    return settings.get('retinaUrl') && window.devicePixelRatio > 1
      ? url.replace(settings.get('photoRegex'), settings.get('retinaSuffix'))
      : url;
  }

  function trapFocus(e) {
    if ('contains' in $box[0] && !$box[0].contains(e.target) && e.target !== $overlay[0]) {
      e.stopPropagation();
      $box.focus();
    }
  }

  function setClass(str) {
    if (setClass.str !== str) {
      $box
        .add($overlay)
        .removeClass(setClass.str)
        .addClass(str);
      setClass.str = str;
    }
  }

  function getRelated(rel) {
    index = 0;

    if (rel && rel !== false && rel !== 'nofollow') {
      $related = $('.' + boxElement).filter(function() {
        var options = $.data(this, colorbox);
        var settings = new Settings(this, options);
        return settings.get('rel') === rel;
      });
      index = $related.index(settings.el);

      // Check direct calls to Colorbox.
      if (index === -1) {
        $related = $related.add(settings.el);
        index = $related.length - 1;
      }
    } else {
      $related = $(settings.el);
    }
  }

  function trigger(event) {
    // for external use
    $(document).trigger(event);
    // for internal use
    $events.triggerHandler(event);
  }

  var slideshow = (function() {
    var active,
      className = prefix + 'Slideshow_',
      click = 'click.' + prefix,
      timeOut;

    function clear() {
      clearTimeout(timeOut);
    }

    function set() {
      if (settings.get('loop') || $related[index + 1]) {
        clear();
        timeOut = setTimeout(publicMethod.next, settings.get('slideshowSpeed'));
      }
    }

    function start() {
      $slideshow
        .html(settings.get('slideshowStop'))
        .unbind(click)
        .one(click, stop);

      $events.bind(event_complete, set).bind(event_load, clear);

      $box.removeClass(className + 'off').addClass(className + 'on');
    }

    function stop() {
      clear();

      $events.unbind(event_complete, set).unbind(event_load, clear);

      $slideshow
        .html(settings.get('slideshowStart'))
        .unbind(click)
        .one(click, function() {
          publicMethod.next();
          start();
        });

      $box.removeClass(className + 'on').addClass(className + 'off');
    }

    function reset() {
      active = false;
      $slideshow.hide();
      clear();
      $events.unbind(event_complete, set).unbind(event_load, clear);
      $box.removeClass(className + 'off ' + className + 'on');
    }

    return function() {
      if (active) {
        if (!settings.get('slideshow')) {
          $events.unbind(event_cleanup, reset);
          reset();
        }
      } else {
        if (settings.get('slideshow') && $related[1]) {
          active = true;
          $events.one(event_cleanup, reset);
          if (settings.get('slideshowAuto')) {
            start();
          } else {
            stop();
          }
          $slideshow.show();
        }
      }
    };
  })();

  function launch(element) {
    var options;

    if (!closing) {
      options = $(element).data('colorbox');

      settings = new Settings(element, options);

      getRelated(settings.get('rel'));

      if (!open) {
        open = active = true; // Prevents the page-change action from queuing up if the visitor holds down the left or right keys.

        setClass(settings.get('className'));

        // Show colorbox so the sizes can be calculated in older versions of jQuery
        $box.css({ visibility: 'hidden', display: 'block', opacity: '' });

        $loaded = $tag(div, 'LoadedContent', 'width:0; height:0; overflow:hidden; visibility:hidden');
        $content.css({ width: '', height: '' }).append($loaded);

        // Cache values needed for size calculations
        interfaceHeight = $topBorder.height() + $bottomBorder.height() + $content.outerHeight(true) - $content.height();
        interfaceWidth = $leftBorder.width() + $rightBorder.width() + $content.outerWidth(true) - $content.width();
        loadedHeight = $loaded.outerHeight(true);
        loadedWidth = $loaded.outerWidth(true);

        // Opens inital empty Colorbox prior to content being loaded.
        var initialWidth = setSize(settings.get('initialWidth'), 'x');
        var initialHeight = setSize(settings.get('initialHeight'), 'y');
        var maxWidth = settings.get('maxWidth');
        var maxHeight = settings.get('maxHeight');

        settings.w =
          (maxWidth !== false ? Math.min(initialWidth, setSize(maxWidth, 'x')) : initialWidth) -
          loadedWidth -
          interfaceWidth;
        settings.h =
          (maxHeight !== false ? Math.min(initialHeight, setSize(maxHeight, 'y')) : initialHeight) -
          loadedHeight -
          interfaceHeight;

        $loaded.css({ width: '', height: settings.h });
        publicMethod.position();

        trigger(event_open);
        settings.get('onOpen');

        $groupControls.add($title).hide();

        $box.focus();

        if (settings.get('trapFocus')) {
          // Confine focus to the modal
          // Uses event capturing that is not supported in IE8-
          if (document.addEventListener) {
            document.addEventListener('focus', trapFocus, true);

            $events.one(event_closed, function() {
              document.removeEventListener('focus', trapFocus, true);
            });
          }
        }

        // Return focus on closing
        if (settings.get('returnFocus')) {
          $events.one(event_closed, function() {
            $(settings.el).focus();
          });
        }
      }

      $overlay
        .css({
          opacity: parseFloat(settings.get('opacity')) || '',
          cursor: settings.get('overlayClose') ? 'pointer' : '',
          visibility: 'visible',
        })
        .show();

      if (settings.get('closeButton')) {
        $close.html(settings.get('close')).appendTo($content);
      } else {
        $close.appendTo('<div/>'); // replace with .detach() when dropping jQuery < 1.4
      }

      load();
    }
  }

  // Colorbox's markup needs to be added to the DOM prior to being called
  // so that the browser will go ahead and load the CSS background images.
  function appendHTML() {
    if (!$box && document.body) {
      init = false;
      $window = $(window);
      $box = $tag(div)
        .attr({
          id: colorbox,
          class: $.support.opacity === false ? prefix + 'IE' : '', // class for optional IE8 & lower targeted CSS.
          role: 'dialog',
          tabindex: '-1',
        })
        .hide();
      $overlay = $tag(div, 'Overlay').hide();
      $loadingOverlay = $([$tag(div, 'LoadingOverlay')[0], $tag(div, 'LoadingGraphic')[0]]);
      $wrap = $tag(div, 'Wrapper');
      $content = $tag(div, 'Content').append(
        ($title = $tag(div, 'Title')),
        ($current = $tag(div, 'Current')),
        ($prev = $('<button type="button"/>').attr({ id: prefix + 'Previous' })),
        ($next = $('<button type="button"/>').attr({ id: prefix + 'Next' })),
        ($slideshow = $tag('button', 'Slideshow')),
        $loadingOverlay
      );

      $close = $('<button type="button"/>').attr({ id: prefix + 'Close' });

      $wrap
        .append(
          // The 3x3 Grid that makes up Colorbox
          $tag(div).append($tag(div, 'TopLeft'), ($topBorder = $tag(div, 'TopCenter')), $tag(div, 'TopRight')),
          $tag(div, false, 'clear:left').append(
            ($leftBorder = $tag(div, 'MiddleLeft')),
            $content,
            ($rightBorder = $tag(div, 'MiddleRight'))
          ),
          $tag(div, false, 'clear:left').append(
            $tag(div, 'BottomLeft'),
            ($bottomBorder = $tag(div, 'BottomCenter')),
            $tag(div, 'BottomRight')
          )
        )
        .find('div div')
        .css({ float: 'left' });

      $loadingBay = $tag(
        div,
        false,
        'position:absolute; width:9999px; visibility:hidden; display:none; max-width:none;'
      );

      $groupControls = $next
        .add($prev)
        .add($current)
        .add($slideshow);

      $(document.body).append($overlay, $box.append($wrap, $loadingBay));
    }
  }

  // Add Colorbox's event bindings
  function addBindings() {
    function clickHandler(e) {
      // ignore non-left-mouse-clicks and clicks modified with ctrl / command, shift, or alt.
      // See: http://jacklmoore.com/notes/click-events/
      if (!(e.which > 1 || e.shiftKey || e.altKey || e.metaKey || e.ctrlKey)) {
        e.preventDefault();
        launch(this);
      }
    }

    if ($box) {
      if (!init) {
        init = true;

        // Anonymous functions here keep the public method from being cached, thereby allowing them to be redefined on the fly.
        $next.click(function() {
          publicMethod.next();
        });
        $prev.click(function() {
          publicMethod.prev();
        });
        $close.click(function() {
          publicMethod.close();
        });
        $overlay.click(function() {
          if (settings.get('overlayClose')) {
            publicMethod.close();
          }
        });

        // Key Bindings
        $(document).bind('keydown.' + prefix, function(e) {
          var key = e.keyCode;
          if (open && settings.get('escKey') && key === 27) {
            e.preventDefault();
            publicMethod.close();
          }
          if (open && settings.get('arrowKey') && $related[1] && !e.altKey) {
            if (key === 37) {
              e.preventDefault();
              $prev.click();
            } else if (key === 39) {
              e.preventDefault();
              $next.click();
            }
          }
        });

        if ($.isFunction($.fn.on)) {
          // For jQuery 1.7+
          $(document).on('click.' + prefix, '.' + boxElement, clickHandler);
        } else {
          // For jQuery 1.3.x -> 1.6.x
          // This code is never reached in jQuery 1.9, so do not contact me about 'live' being removed.
          // This is not here for jQuery 1.9, it's here for legacy users.
          $('.' + boxElement).live('click.' + prefix, clickHandler);
        }
      }
      return true;
    }
    return false;
  }

  // Don't do anything if Colorbox already exists.
  if ($.colorbox) {
    return;
  }

  // Append the HTML when the DOM loads
  $(appendHTML);

  // ****************
  // PUBLIC FUNCTIONS
  // Usage format: $.colorbox.close();
  // Usage from within an iframe: parent.jQuery.colorbox.close();
  // ****************

  publicMethod = $.fn[colorbox] = $[colorbox] = function(options, callback) {
    var settings;
    var $obj = this;

    options = options || {};

    if ($.isFunction($obj)) {
      // assume a call to $.colorbox
      $obj = $('<a/>');
      options.open = true;
    } else if (!$obj[0]) {
      // colorbox being applied to empty collection
      return $obj;
    }

    if (!$obj[0]) {
      // colorbox being applied to empty collection
      return $obj;
    }

    appendHTML();

    if (addBindings()) {
      if (callback) {
        options.onComplete = callback;
      }

      $obj
        .each(function() {
          var old = $.data(this, colorbox) || {};
          $.data(this, colorbox, $.extend(old, options));
        })
        .addClass(boxElement);

      settings = new Settings($obj[0], options);

      if (settings.get('open')) {
        launch($obj[0]);
      }
    }

    return $obj;
  };

  publicMethod.position = function(speed, loadedCallback) {
    var css,
      top = 0,
      left = 0,
      offset = $box.offset(),
      scrollTop,
      scrollLeft;

    $window.unbind('resize.' + prefix);

    // remove the modal so that it doesn't influence the document width/height
    $box.css({ top: -9e4, left: -9e4 });

    scrollTop = $window.scrollTop();
    scrollLeft = $window.scrollLeft();

    if (settings.get('fixed')) {
      offset.top -= scrollTop;
      offset.left -= scrollLeft;
      $box.css({ position: 'fixed' });
    } else {
      top = scrollTop;
      left = scrollLeft;
      $box.css({ position: 'absolute' });
    }

    // keeps the top and left positions within the browser's viewport.
    if (settings.get('right') !== false) {
      left += Math.max(
        $window.width() - settings.w - loadedWidth - interfaceWidth - setSize(settings.get('right'), 'x'),
        0
      );
    } else if (settings.get('left') !== false) {
      left += setSize(settings.get('left'), 'x');
    } else {
      left += Math.round(Math.max($window.width() - settings.w - loadedWidth - interfaceWidth, 0) / 2);
    }

    if (settings.get('bottom') !== false) {
      top += Math.max(
        winheight() - settings.h - loadedHeight - interfaceHeight - setSize(settings.get('bottom'), 'y'),
        0
      );
    } else if (settings.get('top') !== false) {
      top += setSize(settings.get('top'), 'y');
    } else {
      top += Math.round(Math.max(winheight() - settings.h - loadedHeight - interfaceHeight, 0) / 2);
    }

    $box.css({ top: offset.top, left: offset.left, visibility: 'visible' });

    // this gives the wrapper plenty of breathing room so it's floated contents can move around smoothly,
    // but it has to be shrank down around the size of div#colorbox when it's done.  If not,
    // it can invoke an obscure IE bug when using iframes.
    $wrap[0].style.width = $wrap[0].style.height = '9999px';

    function modalDimensions() {
      $topBorder[0].style.width = $bottomBorder[0].style.width = $content[0].style.width =
        parseInt($box[0].style.width, 10) - interfaceWidth + 'px';
      $content[0].style.height = $leftBorder[0].style.height = $rightBorder[0].style.height =
        parseInt($box[0].style.height, 10) - interfaceHeight + 'px';
    }

    css = {
      width: settings.w + loadedWidth + interfaceWidth,
      height: settings.h + loadedHeight + interfaceHeight,
      top: top,
      left: left,
    };

    // setting the speed to 0 if the content hasn't changed size or position
    if (speed) {
      var tempSpeed = 0;
      $.each(css, function(i) {
        if (css[i] !== previousCSS[i]) {
          tempSpeed = speed;
        }
      });
      speed = tempSpeed;
    }

    previousCSS = css;

    if (!speed) {
      $box.css(css);
    }

    $box.dequeue().animate(css, {
      duration: speed || 0,
      complete: function() {
        modalDimensions();

        active = false;

        // shrink the wrapper down to exactly the size of colorbox to avoid a bug in IE's iframe implementation.
        $wrap[0].style.width = settings.w + loadedWidth + interfaceWidth + 'px';
        $wrap[0].style.height = settings.h + loadedHeight + interfaceHeight + 'px';

        if (settings.get('reposition')) {
          setTimeout(function() {
            // small delay before binding onresize due to an IE8 bug.
            $window.bind('resize.' + prefix, publicMethod.position);
          }, 1);
        }

        if (loadedCallback) {
          loadedCallback();
        }
      },
      step: modalDimensions,
    });
  };

  publicMethod.resize = function(options) {
    var scrolltop;

    if (open) {
      options = options || {};

      if (options.width) {
        settings.w = setSize(options.width, 'x') - loadedWidth - interfaceWidth;
      }

      if (options.innerWidth) {
        settings.w = setSize(options.innerWidth, 'x');
      }

      if (options.maxWidth) {
        var max_width = setSize(options.maxWidth, 'x');
        if (settings.w > max_width) {
          settings.w = max_width;
        }
      }

      $loaded.css({ width: settings.w });

      if (options.height) {
        settings.h = setSize(options.height, 'y') - loadedHeight - interfaceHeight;
      }

      if (options.innerHeight) {
        settings.h = setSize(options.innerHeight, 'y');
      }

      if (!options.innerHeight && !options.height) {
        scrolltop = $loaded.scrollTop();
        $loaded.css({ height: 'auto' });
        settings.h = $loaded.height();
      }

      $loaded.css({ height: settings.h });

      if (scrolltop) {
        $loaded.scrollTop(scrolltop);
      }

      publicMethod.position(settings.get('transition') === 'none' ? 0 : settings.get('speed'));
    }
  };

  publicMethod.prep = function(object) {
    if (!open) {
      return;
    }

    var callback,
      speed = settings.get('transition') === 'none' ? 0 : settings.get('speed');

    $loaded.remove();

    $loaded = $tag(div, 'LoadedContent').append(object);

    function getWidth() {
      settings.w = settings.w || $loaded.width();
      settings.w = settings.mw && settings.mw < settings.w ? settings.mw : settings.w;
      return settings.w;
    }
    function getHeight() {
      settings.h = settings.h || $loaded.height();
      settings.h = settings.mh && settings.mh < settings.h ? settings.mh : settings.h;
      return settings.h;
    }

    $loaded
      .hide()
      .appendTo($loadingBay.show()) // content has to be appended to the DOM for accurate size calculations.
      .css({ width: getWidth(), overflow: settings.get('scrolling') ? 'auto' : 'hidden' })
      .css({ height: getHeight() }) // sets the height independently from the width in case the new width influences the value of height.
      .prependTo($content);

    $loadingBay.hide();

    // floating the IMG removes the bottom line-height and fixed a problem where IE miscalculates the width of the parent element as 100% of the document width.

    $(photo).css({ float: 'none' });

    setClass(settings.get('className'));

    callback = function() {
      var total = $related.length,
        iframe,
        complete;

      if (!open) {
        return;
      }

      function removeFilter() {
        // Needed for IE8 in versions of jQuery prior to 1.7.2
        if ($.support.opacity === false) {
          $box[0].style.removeAttribute('filter');
        }
      }

      complete = function() {
        clearTimeout(loadingTimer);
        $loadingOverlay.hide();
        trigger(event_complete);
        settings.get('onComplete');
      };

      $title.html(settings.get('title')).show();
      $loaded.show();

      if (total > 1) {
        // handle grouping
        if (typeof settings.get('current') === 'string') {
          $current
            .html(
              settings
                .get('current')
                .replace('{current}', index + 1)
                .replace('{total}', total)
            )
            .show();
        }

        $next[settings.get('loop') || index < total - 1 ? 'show' : 'hide']().html(settings.get('next'));
        $prev[settings.get('loop') || index ? 'show' : 'hide']().html(settings.get('previous'));

        slideshow();

        // Preloads images within a rel group
        if (settings.get('preloading')) {
          $.each([getIndex(-1), getIndex(1)], function() {
            var img,
              i = $related[this],
              settings = new Settings(i, $.data(i, colorbox)),
              src = settings.get('href');

            if (src && isImage(settings, src)) {
              src = retinaUrl(settings, src);
              img = document.createElement('img');
              img.src = src;
            }
          });
        }
      } else {
        $groupControls.hide();
      }

      if (settings.get('iframe')) {
        iframe = document.createElement('iframe');

        if ('frameBorder' in iframe) {
          iframe.frameBorder = 0;
        }

        if ('allowTransparency' in iframe) {
          iframe.allowTransparency = 'true';
        }

        if (!settings.get('scrolling')) {
          iframe.scrolling = 'no';
        }

        $(iframe)
          .attr({
            src: settings.get('href'),
            name: new Date().getTime(), // give the iframe a unique name to prevent caching
            class: prefix + 'Iframe',
            allowFullScreen: true, // allow HTML5 video to go fullscreen
          })
          .one('load', complete)
          .appendTo($loaded);

        $events.one(event_purge, function() {
          iframe.src = '//about:blank';
        });

        if (settings.get('fastIframe')) {
          $(iframe).trigger('load');
        }
      } else {
        complete();
      }

      if (settings.get('transition') === 'fade') {
        $box.fadeTo(speed, 1, removeFilter);
      } else {
        removeFilter();
      }
    };

    if (settings.get('transition') === 'fade') {
      $box.fadeTo(speed, 0, function() {
        publicMethod.position(0, callback);
      });
    } else {
      publicMethod.position(speed, callback);
    }
  };

  function load() {
    var href,
      setResize,
      prep = publicMethod.prep,
      $inline,
      request = ++requests;

    active = true;

    photo = false;

    trigger(event_purge);
    trigger(event_load);
    settings.get('onLoad');

    settings.h = settings.get('height')
      ? setSize(settings.get('height'), 'y') - loadedHeight - interfaceHeight
      : settings.get('innerHeight') && setSize(settings.get('innerHeight'), 'y');

    settings.w = settings.get('width')
      ? setSize(settings.get('width'), 'x') - loadedWidth - interfaceWidth
      : settings.get('innerWidth') && setSize(settings.get('innerWidth'), 'x');

    // Sets the minimum dimensions for use in image scaling
    settings.mw = settings.w;
    settings.mh = settings.h;

    // Re-evaluate the minimum width and height based on maxWidth and maxHeight values.
    // If the width or height exceed the maxWidth or maxHeight, use the maximum values instead.
    if (settings.get('maxWidth')) {
      settings.mw = setSize(settings.get('maxWidth'), 'x') - loadedWidth - interfaceWidth;
      settings.mw = settings.w && settings.w < settings.mw ? settings.w : settings.mw;
    }
    if (settings.get('maxHeight')) {
      settings.mh = setSize(settings.get('maxHeight'), 'y') - loadedHeight - interfaceHeight;
      settings.mh = settings.h && settings.h < settings.mh ? settings.h : settings.mh;
    }

    href = settings.get('href');

    loadingTimer = setTimeout(function() {
      $loadingOverlay.show();
    }, 100);

    if (settings.get('inline')) {
      var $target = $(href);
      // Inserts an empty placeholder where inline content is being pulled from.
      // An event is bound to put inline content back when Colorbox closes or loads new content.
      $inline = $('<div>')
        .hide()
        .insertBefore($target);

      $events.one(event_purge, function() {
        $inline.replaceWith($target);
      });

      prep($target);
    } else if (settings.get('iframe')) {
      // IFrame element won't be added to the DOM until it is ready to be displayed,
      // to avoid problems with DOM-ready JS that might be trying to run in that iframe.
      prep(' ');
    } else if (settings.get('html')) {
      prep(settings.get('html'));
    } else if (isImage(settings, href)) {
      href = retinaUrl(settings, href);

      photo = new Image();

      $(photo)
        .addClass(prefix + 'Photo')
        .bind('error', function() {
          prep($tag(div, 'Error').html(settings.get('imgError')));
        })
        .one('load', function() {
          if (request !== requests) {
            return;
          }

          // A small pause because some browsers will occassionaly report a
          // img.width and img.height of zero immediately after the img.onload fires
          setTimeout(function() {
            var percent;

            $.each(['alt', 'longdesc', 'aria-describedby'], function(i, val) {
              var attr = $(settings.el).attr(val) || $(settings.el).attr('data-' + val);
              if (attr) {
                photo.setAttribute(val, attr);
              }
            });

            if (settings.get('retinaImage') && window.devicePixelRatio > 1) {
              photo.height = photo.height / window.devicePixelRatio;
              photo.width = photo.width / window.devicePixelRatio;
            }

            if (settings.get('scalePhotos')) {
              setResize = function() {
                photo.height -= photo.height * percent;
                photo.width -= photo.width * percent;
              };
              if (settings.mw && photo.width > settings.mw) {
                percent = (photo.width - settings.mw) / photo.width;
                setResize();
              }
              if (settings.mh && photo.height > settings.mh) {
                percent = (photo.height - settings.mh) / photo.height;
                setResize();
              }
            }

            if (settings.h) {
              photo.style.marginTop = Math.max(settings.mh - photo.height, 0) / 2 + 'px';
            }

            if ($related[1] && (settings.get('loop') || $related[index + 1])) {
              photo.style.cursor = 'pointer';
              photo.onclick = function() {
                publicMethod.next();
              };
            }

            photo.style.width = photo.width + 'px';
            photo.style.height = photo.height + 'px';
            prep(photo);
          }, 1);
        });

      photo.src = href;
    } else if (href) {
      $loadingBay.load(href, settings.get('data'), function(data, status) {
        if (request === requests) {
          prep(status === 'error' ? $tag(div, 'Error').html(settings.get('xhrError')) : $(this).contents());
        }
      });
    }
  }

  // Navigates to the next page/image in a set.
  publicMethod.next = function() {
    if (!active && $related[1] && (settings.get('loop') || $related[index + 1])) {
      index = getIndex(1);
      launch($related[index]);
    }
  };

  publicMethod.prev = function() {
    if (!active && $related[1] && (settings.get('loop') || index)) {
      index = getIndex(-1);
      launch($related[index]);
    }
  };

  // Note: to use this within an iframe use the following format: parent.jQuery.colorbox.close();
  publicMethod.close = function() {
    if (open && !closing) {
      closing = true;
      open = false;
      trigger(event_cleanup);
      settings.get('onCleanup');
      $window.unbind('.' + prefix);
      $overlay.fadeTo(settings.get('fadeOut') || 0, 0);

      $box.stop().fadeTo(settings.get('fadeOut') || 0, 0, function() {
        $box.hide();
        $overlay.hide();
        trigger(event_purge);
        $loaded.remove();

        setTimeout(function() {
          closing = false;
          trigger(event_closed);
          settings.get('onClosed');
        }, 1);
      });
    }
  };

  // Removes changes Colorbox made to the document, but does not remove the plugin.
  publicMethod.remove = function() {
    if (!$box) {
      return;
    }

    $box.stop();
    $.colorbox.close();
    $box.stop().remove();
    $overlay.remove();
    closing = false;
    $box = null;
    $('.' + boxElement)
      .removeData(colorbox)
      .removeClass(boxElement);

    $(document)
      .unbind('click.' + prefix)
      .unbind('keydown.' + prefix);
  };

  // A method for fetching the current element Colorbox is referencing.
  // returns a jQuery object.
  publicMethod.element = function() {
    return $(settings.el);
  };

  publicMethod.settings = defaults;
})(jQuery, document, window);

/*!
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function($, document, undefined) {
  var pluses = /\+/g;

  function raw(s) {
    return s;
  }

  function decoded(s) {
    return decodeURIComponent(s.replace(pluses, ' '));
  }

  var config = ($.cookie = function(key, value, options) {
    // write
    if (value !== undefined) {
      options = $.extend({}, config.defaults, options);

      if (value === null) {
        options.expires = -1;
      }

      if (typeof options.expires === 'number') {
        var days = options.expires,
          t = (options.expires = new Date());
        t.setDate(t.getDate() + days);
      }

      value = config.json ? JSON.stringify(value) : String(value);

      return (document.cookie = [
        encodeURIComponent(key),
        '=',
        config.raw ? value : encodeURIComponent(value),
        options.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE
        options.path ? '; path=' + options.path : '',
        options.domain ? '; domain=' + options.domain : '',
        options.secure ? '; secure' : '',
      ].join(''));
    }

    // read
    var decode = config.raw ? raw : decoded;
    var cookies = document.cookie.split('; ');
    for (var i = 0, l = cookies.length; i < l; i++) {
      var parts = cookies[i].split('=');
      if (decode(parts.shift()) === key) {
        var cookie = decode(parts.join('='));
        return config.json ? JSON.parse(cookie) : cookie;
      }
    }

    return null;
  });

  config.defaults = {};

  $.removeCookie = function(key, options) {
    if ($.cookie(key) !== null) {
      $.cookie(key, null, options);
      return true;
    }
    return false;
  };
})(jQuery, document);

/*
 * jQuery FlexSlider v2.6.0
 * Copyright 2012 WooThemes
 * Contributing Author: Tyler Smith
 */ !(function($) {
  var e = !0;
  ($.flexslider = function(t, a) {
    var n = $(t);
    n.vars = $.extend({}, $.flexslider.defaults, a);
    var i = n.vars.namespace,
      s = window.navigator && window.navigator.msPointerEnabled && window.MSGesture,
      r =
        ('ontouchstart' in window || s || (window.DocumentTouch && document instanceof DocumentTouch)) && n.vars.touch,
      o = 'click touchend MSPointerUp keyup',
      l = '',
      c,
      d = 'vertical' === n.vars.direction,
      u = n.vars.reverse,
      v = n.vars.itemWidth > 0,
      p = 'fade' === n.vars.animation,
      m = '' !== n.vars.asNavFor,
      f = {};
    $.data(t, 'flexslider', n),
      (f = {
        init: function() {
          (n.animating = !1),
            (n.currentSlide = parseInt(n.vars.startAt ? n.vars.startAt : 0, 10)),
            isNaN(n.currentSlide) && (n.currentSlide = 0),
            (n.animatingTo = n.currentSlide),
            (n.atEnd = 0 === n.currentSlide || n.currentSlide === n.last),
            (n.containerSelector = n.vars.selector.substr(0, n.vars.selector.search(' '))),
            (n.slides = $(n.vars.selector, n)),
            (n.container = $(n.containerSelector, n)),
            (n.count = n.slides.length),
            (n.syncExists = $(n.vars.sync).length > 0),
            'slide' === n.vars.animation && (n.vars.animation = 'swing'),
            (n.prop = d ? 'top' : 'marginLeft'),
            (n.args = {}),
            (n.manualPause = !1),
            (n.stopped = !1),
            (n.started = !1),
            (n.startTimeout = null),
            (n.transitions =
              !n.vars.video &&
              !p &&
              n.vars.useCSS &&
              (function() {
                var e = document.createElement('div'),
                  t = ['perspectiveProperty', 'WebkitPerspective', 'MozPerspective', 'OPerspective', 'msPerspective'];
                for (var a in t)
                  if (void 0 !== e.style[t[a]])
                    return (
                      (n.pfx = t[a].replace('Perspective', '').toLowerCase()), (n.prop = '-' + n.pfx + '-transform'), !0
                    );
                return !1;
              })()),
            (n.ensureAnimationEnd = ''),
            '' !== n.vars.controlsContainer &&
              (n.controlsContainer = $(n.vars.controlsContainer).length > 0 && $(n.vars.controlsContainer)),
            '' !== n.vars.manualControls &&
              (n.manualControls = $(n.vars.manualControls).length > 0 && $(n.vars.manualControls)),
            '' !== n.vars.customDirectionNav &&
              (n.customDirectionNav = 2 === $(n.vars.customDirectionNav).length && $(n.vars.customDirectionNav)),
            n.vars.randomize &&
              (n.slides.sort(function() {
                return Math.round(Math.random()) - 0.5;
              }),
              n.container.empty().append(n.slides)),
            n.doMath(),
            n.setup('init'),
            n.vars.controlNav && f.controlNav.setup(),
            n.vars.directionNav && f.directionNav.setup(),
            n.vars.keyboard &&
              (1 === $(n.containerSelector).length || n.vars.multipleKeyboard) &&
              $(document).bind('keyup', function(e) {
                var t = e.keyCode;
                if (!n.animating && (39 === t || 37 === t)) {
                  var a = 39 === t ? n.getTarget('next') : 37 === t ? n.getTarget('prev') : !1;
                  n.flexAnimate(a, n.vars.pauseOnAction);
                }
              }),
            n.vars.mousewheel &&
              n.bind('mousewheel', function(e, t, a, i) {
                e.preventDefault();
                var s = 0 > t ? n.getTarget('next') : n.getTarget('prev');
                n.flexAnimate(s, n.vars.pauseOnAction);
              }),
            n.vars.pausePlay && f.pausePlay.setup(),
            n.vars.slideshow && n.vars.pauseInvisible && f.pauseInvisible.init(),
            n.vars.slideshow &&
              (n.vars.pauseOnHover &&
                n.hover(
                  function() {
                    n.manualPlay || n.manualPause || n.pause();
                  },
                  function() {
                    n.manualPause || n.manualPlay || n.stopped || n.play();
                  }
                ),
              (n.vars.pauseInvisible && f.pauseInvisible.isHidden()) ||
                (n.vars.initDelay > 0 ? (n.startTimeout = setTimeout(n.play, n.vars.initDelay)) : n.play())),
            m && f.asNav.setup(),
            r && n.vars.touch && f.touch(),
            (!p || (p && n.vars.smoothHeight)) && $(window).bind('resize orientationchange focus', f.resize),
            n.find('img').attr('draggable', 'false'),
            setTimeout(function() {
              n.vars.start(n);
            }, 200);
        },
        asNav: {
          setup: function() {
            (n.asNav = !0),
              (n.animatingTo = Math.floor(n.currentSlide / n.move)),
              (n.currentItem = n.currentSlide),
              n.slides
                .removeClass(i + 'active-slide')
                .eq(n.currentItem)
                .addClass(i + 'active-slide'),
              s
                ? ((t._slider = n),
                  n.slides.each(function() {
                    var e = this;
                    (e._gesture = new MSGesture()),
                      (e._gesture.target = e),
                      e.addEventListener(
                        'MSPointerDown',
                        function(e) {
                          e.preventDefault(),
                            e.currentTarget._gesture && e.currentTarget._gesture.addPointer(e.pointerId);
                        },
                        !1
                      ),
                      e.addEventListener('MSGestureTap', function(e) {
                        e.preventDefault();
                        var t = $(this),
                          a = t.index();
                        $(n.vars.asNavFor).data('flexslider').animating ||
                          t.hasClass('active') ||
                          ((n.direction = n.currentItem < a ? 'next' : 'prev'),
                          n.flexAnimate(a, n.vars.pauseOnAction, !1, !0, !0));
                      });
                  }))
                : n.slides.on(o, function(e) {
                    e.preventDefault();
                    var t = $(this),
                      a = t.index(),
                      s = t.offset().left - $(n).scrollLeft();
                    0 >= s && t.hasClass(i + 'active-slide')
                      ? n.flexAnimate(n.getTarget('prev'), !0)
                      : $(n.vars.asNavFor).data('flexslider').animating ||
                        t.hasClass(i + 'active-slide') ||
                        ((n.direction = n.currentItem < a ? 'next' : 'prev'),
                        n.flexAnimate(a, n.vars.pauseOnAction, !1, !0, !0));
                  });
          },
        },
        controlNav: {
          setup: function() {
            n.manualControls ? f.controlNav.setupManual() : f.controlNav.setupPaging();
          },
          setupPaging: function() {
            var e = 'thumbnails' === n.vars.controlNav ? 'control-thumbs' : 'control-paging',
              t = 1,
              a,
              s;
            if (((n.controlNavScaffold = $('<ol class="' + i + 'control-nav ' + i + e + '"></ol>')), n.pagingCount > 1))
              for (var r = 0; r < n.pagingCount; r++) {
                if (
                  ((s = n.slides.eq(r)),
                  void 0 === s.attr('data-thumb-alt') && s.attr('data-thumb-alt', ''),
                  (altText =
                    '' !== s.attr('data-thumb-alt') ? (altText = ' alt="' + s.attr('data-thumb-alt') + '"') : ''),
                  (a =
                    'thumbnails' === n.vars.controlNav
                      ? '<img src="' + s.attr('data-thumb') + '"' + altText + '/>'
                      : '<a href="#">' + t + '</a>'),
                  'thumbnails' === n.vars.controlNav && !0 === n.vars.thumbCaptions)
                ) {
                  var c = s.attr('data-thumbcaption');
                  '' !== c && void 0 !== c && (a += '<span class="' + i + 'caption">' + c + '</span>');
                }
                n.controlNavScaffold.append('<li>' + a + '</li>'), t++;
              }
            n.controlsContainer ? $(n.controlsContainer).append(n.controlNavScaffold) : n.append(n.controlNavScaffold),
              f.controlNav.set(),
              f.controlNav.active(),
              n.controlNavScaffold.delegate('a, img', o, function(e) {
                if ((e.preventDefault(), '' === l || l === e.type)) {
                  var t = $(this),
                    a = n.controlNav.index(t);
                  t.hasClass(i + 'active') ||
                    ((n.direction = a > n.currentSlide ? 'next' : 'prev'), n.flexAnimate(a, n.vars.pauseOnAction));
                }
                '' === l && (l = e.type), f.setToClearWatchedEvent();
              });
          },
          setupManual: function() {
            (n.controlNav = n.manualControls),
              f.controlNav.active(),
              n.controlNav.bind(o, function(e) {
                if ((e.preventDefault(), '' === l || l === e.type)) {
                  var t = $(this),
                    a = n.controlNav.index(t);
                  t.hasClass(i + 'active') ||
                    (a > n.currentSlide ? (n.direction = 'next') : (n.direction = 'prev'),
                    n.flexAnimate(a, n.vars.pauseOnAction));
                }
                '' === l && (l = e.type), f.setToClearWatchedEvent();
              });
          },
          set: function() {
            var e = 'thumbnails' === n.vars.controlNav ? 'img' : 'a';
            n.controlNav = $('.' + i + 'control-nav li ' + e, n.controlsContainer ? n.controlsContainer : n);
          },
          active: function() {
            n.controlNav
              .removeClass(i + 'active')
              .eq(n.animatingTo)
              .addClass(i + 'active');
          },
          update: function(e, t) {
            n.pagingCount > 1 && 'add' === e
              ? n.controlNavScaffold.append($('<li><a href="#">' + n.count + '</a></li>'))
              : 1 === n.pagingCount
              ? n.controlNavScaffold.find('li').remove()
              : n.controlNav
                  .eq(t)
                  .closest('li')
                  .remove(),
              f.controlNav.set(),
              n.pagingCount > 1 && n.pagingCount !== n.controlNav.length ? n.update(t, e) : f.controlNav.active();
          },
        },
        directionNav: {
          setup: function() {
            var e = $(
              '<ul class="' +
                i +
                'direction-nav"><li class="' +
                i +
                'nav-prev"><a class="' +
                i +
                'prev" href="#">' +
                n.vars.prevText +
                '</a></li><li class="' +
                i +
                'nav-next"><a class="' +
                i +
                'next" href="#">' +
                n.vars.nextText +
                '</a></li></ul>'
            );
            n.customDirectionNav
              ? (n.directionNav = n.customDirectionNav)
              : n.controlsContainer
              ? ($(n.controlsContainer).append(e),
                (n.directionNav = $('.' + i + 'direction-nav li a', n.controlsContainer)))
              : (n.append(e), (n.directionNav = $('.' + i + 'direction-nav li a', n))),
              f.directionNav.update(),
              n.directionNav.bind(o, function(e) {
                e.preventDefault();
                var t;
                ('' === l || l === e.type) &&
                  ((t = $(this).hasClass(i + 'next') ? n.getTarget('next') : n.getTarget('prev')),
                  n.flexAnimate(t, n.vars.pauseOnAction)),
                  '' === l && (l = e.type),
                  f.setToClearWatchedEvent();
              });
          },
          update: function() {
            var e = i + 'disabled';
            1 === n.pagingCount
              ? n.directionNav.addClass(e).attr('tabindex', '-1')
              : n.vars.animationLoop
              ? n.directionNav.removeClass(e).removeAttr('tabindex')
              : 0 === n.animatingTo
              ? n.directionNav
                  .removeClass(e)
                  .filter('.' + i + 'prev')
                  .addClass(e)
                  .attr('tabindex', '-1')
              : n.animatingTo === n.last
              ? n.directionNav
                  .removeClass(e)
                  .filter('.' + i + 'next')
                  .addClass(e)
                  .attr('tabindex', '-1')
              : n.directionNav.removeClass(e).removeAttr('tabindex');
          },
        },
        pausePlay: {
          setup: function() {
            var e = $('<div class="' + i + 'pauseplay"><a href="#"></a></div>');
            n.controlsContainer
              ? (n.controlsContainer.append(e), (n.pausePlay = $('.' + i + 'pauseplay a', n.controlsContainer)))
              : (n.append(e), (n.pausePlay = $('.' + i + 'pauseplay a', n))),
              f.pausePlay.update(n.vars.slideshow ? i + 'pause' : i + 'play'),
              n.pausePlay.bind(o, function(e) {
                e.preventDefault(),
                  ('' === l || l === e.type) &&
                    ($(this).hasClass(i + 'pause')
                      ? ((n.manualPause = !0), (n.manualPlay = !1), n.pause())
                      : ((n.manualPause = !1), (n.manualPlay = !0), n.play())),
                  '' === l && (l = e.type),
                  f.setToClearWatchedEvent();
              });
          },
          update: function(e) {
            'play' === e
              ? n.pausePlay
                  .removeClass(i + 'pause')
                  .addClass(i + 'play')
                  .html(n.vars.playText)
              : n.pausePlay
                  .removeClass(i + 'play')
                  .addClass(i + 'pause')
                  .html(n.vars.pauseText);
          },
        },
        touch: function() {
          function e(e) {
            e.stopPropagation(),
              n.animating
                ? e.preventDefault()
                : (n.pause(),
                  t._gesture.addPointer(e.pointerId),
                  (T = 0),
                  (c = d ? n.h : n.w),
                  (f = Number(new Date())),
                  (l =
                    v && u && n.animatingTo === n.last
                      ? 0
                      : v && u
                      ? n.limit - (n.itemW + n.vars.itemMargin) * n.move * n.animatingTo
                      : v && n.currentSlide === n.last
                      ? n.limit
                      : v
                      ? (n.itemW + n.vars.itemMargin) * n.move * n.currentSlide
                      : u
                      ? (n.last - n.currentSlide + n.cloneOffset) * c
                      : (n.currentSlide + n.cloneOffset) * c));
          }
          function a(e) {
            e.stopPropagation();
            var a = e.target._slider;
            if (a) {
              var n = -e.translationX,
                i = -e.translationY;
              return (
                (T += d ? i : n),
                (m = T),
                (x = d ? Math.abs(T) < Math.abs(-n) : Math.abs(T) < Math.abs(-i)),
                e.detail === e.MSGESTURE_FLAG_INERTIA
                  ? void setImmediate(function() {
                      t._gesture.stop();
                    })
                  : void (
                      (!x || Number(new Date()) - f > 500) &&
                      (e.preventDefault(),
                      !p &&
                        a.transitions &&
                        (a.vars.animationLoop ||
                          (m =
                            T /
                            ((0 === a.currentSlide && 0 > T) || (a.currentSlide === a.last && T > 0)
                              ? Math.abs(T) / c + 2
                              : 1)),
                        a.setProps(l + m, 'setTouch')))
                    )
              );
            }
          }
          function i(e) {
            e.stopPropagation();
            var t = e.target._slider;
            if (t) {
              if (t.animatingTo === t.currentSlide && !x && null !== m) {
                var a = u ? -m : m,
                  n = a > 0 ? t.getTarget('next') : t.getTarget('prev');
                t.canAdvance(n) && ((Number(new Date()) - f < 550 && Math.abs(a) > 50) || Math.abs(a) > c / 2)
                  ? t.flexAnimate(n, t.vars.pauseOnAction)
                  : p || t.flexAnimate(t.currentSlide, t.vars.pauseOnAction, !0);
              }
              (r = null), (o = null), (m = null), (l = null), (T = 0);
            }
          }
          var r,
            o,
            l,
            c,
            m,
            f,
            g,
            h,
            S,
            x = !1,
            y = 0,
            b = 0,
            T = 0;
          s
            ? ((t.style.msTouchAction = 'none'),
              (t._gesture = new MSGesture()),
              (t._gesture.target = t),
              t.addEventListener('MSPointerDown', e, !1),
              (t._slider = n),
              t.addEventListener('MSGestureChange', a, !1),
              t.addEventListener('MSGestureEnd', i, !1))
            : ((g = function(e) {
                n.animating
                  ? e.preventDefault()
                  : (window.navigator.msPointerEnabled || 1 === e.touches.length) &&
                    (n.pause(),
                    (c = d ? n.h : n.w),
                    (f = Number(new Date())),
                    (y = e.touches[0].pageX),
                    (b = e.touches[0].pageY),
                    (l =
                      v && u && n.animatingTo === n.last
                        ? 0
                        : v && u
                        ? n.limit - (n.itemW + n.vars.itemMargin) * n.move * n.animatingTo
                        : v && n.currentSlide === n.last
                        ? n.limit
                        : v
                        ? (n.itemW + n.vars.itemMargin) * n.move * n.currentSlide
                        : u
                        ? (n.last - n.currentSlide + n.cloneOffset) * c
                        : (n.currentSlide + n.cloneOffset) * c),
                    (r = d ? b : y),
                    (o = d ? y : b),
                    t.addEventListener('touchmove', h, !1),
                    t.addEventListener('touchend', S, !1));
              }),
              (h = function(e) {
                (y = e.touches[0].pageX),
                  (b = e.touches[0].pageY),
                  (m = d ? r - b : r - y),
                  (x = d ? Math.abs(m) < Math.abs(y - o) : Math.abs(m) < Math.abs(b - o));
                var t = 500;
                (!x || Number(new Date()) - f > t) &&
                  (e.preventDefault(),
                  !p &&
                    n.transitions &&
                    (n.vars.animationLoop ||
                      (m /=
                        (0 === n.currentSlide && 0 > m) || (n.currentSlide === n.last && m > 0)
                          ? Math.abs(m) / c + 2
                          : 1),
                    n.setProps(l + m, 'setTouch')));
              }),
              (S = function(e) {
                if ((t.removeEventListener('touchmove', h, !1), n.animatingTo === n.currentSlide && !x && null !== m)) {
                  var a = u ? -m : m,
                    i = a > 0 ? n.getTarget('next') : n.getTarget('prev');
                  n.canAdvance(i) && ((Number(new Date()) - f < 550 && Math.abs(a) > 50) || Math.abs(a) > c / 2)
                    ? n.flexAnimate(i, n.vars.pauseOnAction)
                    : p || n.flexAnimate(n.currentSlide, n.vars.pauseOnAction, !0);
                }
                t.removeEventListener('touchend', S, !1), (r = null), (o = null), (m = null), (l = null);
              }),
              t.addEventListener('touchstart', g, !1));
        },
        resize: function() {
          !n.animating &&
            n.is(':visible') &&
            (v || n.doMath(),
            p
              ? f.smoothHeight()
              : v
              ? (n.slides.width(n.computedW), n.update(n.pagingCount), n.setProps())
              : d
              ? (n.viewport.height(n.h), n.setProps(n.h, 'setTotal'))
              : (n.vars.smoothHeight && f.smoothHeight(),
                n.newSlides.width(n.computedW),
                n.setProps(n.computedW, 'setTotal')));
        },
        smoothHeight: function(e) {
          if (!d || p) {
            var t = p ? n : n.viewport;
            e
              ? t.animate({ height: n.slides.eq(n.animatingTo).height() }, e)
              : t.height(n.slides.eq(n.animatingTo).height());
          }
        },
        sync: function(e) {
          var t = $(n.vars.sync).data('flexslider'),
            a = n.animatingTo;
          switch (e) {
            case 'animate':
              t.flexAnimate(a, n.vars.pauseOnAction, !1, !0);
              break;
            case 'play':
              t.playing || t.asNav || t.play();
              break;
            case 'pause':
              t.pause();
          }
        },
        uniqueID: function(e) {
          return (
            e
              .filter('[id]')
              .add(e.find('[id]'))
              .each(function() {
                var e = $(this);
                e.attr('id', e.attr('id') + '_clone');
              }),
            e
          );
        },
        pauseInvisible: {
          visProp: null,
          init: function() {
            var e = f.pauseInvisible.getHiddenProp();
            if (e) {
              var t = e.replace(/[H|h]idden/, '') + 'visibilitychange';
              document.addEventListener(t, function() {
                f.pauseInvisible.isHidden()
                  ? n.startTimeout
                    ? clearTimeout(n.startTimeout)
                    : n.pause()
                  : n.started
                  ? n.play()
                  : n.vars.initDelay > 0
                  ? setTimeout(n.play, n.vars.initDelay)
                  : n.play();
              });
            }
          },
          isHidden: function() {
            var e = f.pauseInvisible.getHiddenProp();
            return e ? document[e] : !1;
          },
          getHiddenProp: function() {
            var e = ['webkit', 'moz', 'ms', 'o'];
            if ('hidden' in document) return 'hidden';
            for (var t = 0; t < e.length; t++) if (e[t] + 'Hidden' in document) return e[t] + 'Hidden';
            return null;
          },
        },
        setToClearWatchedEvent: function() {
          clearTimeout(c),
            (c = setTimeout(function() {
              l = '';
            }, 3e3));
        },
      }),
      (n.flexAnimate = function(e, t, a, s, o) {
        if (
          (n.vars.animationLoop || e === n.currentSlide || (n.direction = e > n.currentSlide ? 'next' : 'prev'),
          m && 1 === n.pagingCount && (n.direction = n.currentItem < e ? 'next' : 'prev'),
          !n.animating && (n.canAdvance(e, o) || a) && n.is(':visible'))
        ) {
          if (m && s) {
            var l = $(n.vars.asNavFor).data('flexslider');
            if (
              ((n.atEnd = 0 === e || e === n.count - 1),
              l.flexAnimate(e, !0, !1, !0, o),
              (n.direction = n.currentItem < e ? 'next' : 'prev'),
              (l.direction = n.direction),
              Math.ceil((e + 1) / n.visible) - 1 === n.currentSlide || 0 === e)
            )
              return (
                (n.currentItem = e),
                n.slides
                  .removeClass(i + 'active-slide')
                  .eq(e)
                  .addClass(i + 'active-slide'),
                !1
              );
            (n.currentItem = e),
              n.slides
                .removeClass(i + 'active-slide')
                .eq(e)
                .addClass(i + 'active-slide'),
              (e = Math.floor(e / n.visible));
          }
          if (
            ((n.animating = !0),
            (n.animatingTo = e),
            t && n.pause(),
            n.vars.before(n),
            n.syncExists && !o && f.sync('animate'),
            n.vars.controlNav && f.controlNav.active(),
            v ||
              n.slides
                .removeClass(i + 'active-slide')
                .eq(e)
                .addClass(i + 'active-slide'),
            (n.atEnd = 0 === e || e === n.last),
            n.vars.directionNav && f.directionNav.update(),
            e === n.last && (n.vars.end(n), n.vars.animationLoop || n.pause()),
            p)
          )
            r
              ? (n.slides.eq(n.currentSlide).css({ opacity: 0, zIndex: 1 }),
                n.slides.eq(e).css({ opacity: 1, zIndex: 2 }),
                n.wrapup(c))
              : (n.slides
                  .eq(n.currentSlide)
                  .css({ zIndex: 1 })
                  .animate({ opacity: 0 }, n.vars.animationSpeed, n.vars.easing),
                n.slides
                  .eq(e)
                  .css({ zIndex: 2 })
                  .animate({ opacity: 1 }, n.vars.animationSpeed, n.vars.easing, n.wrapup));
          else {
            var c = d ? n.slides.filter(':first').height() : n.computedW,
              g,
              h,
              S;
            v
              ? ((g = n.vars.itemMargin),
                (S = (n.itemW + g) * n.move * n.animatingTo),
                (h = S > n.limit && 1 !== n.visible ? n.limit : S))
              : (h =
                  0 === n.currentSlide && e === n.count - 1 && n.vars.animationLoop && 'next' !== n.direction
                    ? u
                      ? (n.count + n.cloneOffset) * c
                      : 0
                    : n.currentSlide === n.last && 0 === e && n.vars.animationLoop && 'prev' !== n.direction
                    ? u
                      ? 0
                      : (n.count + 1) * c
                    : u
                    ? (n.count - 1 - e + n.cloneOffset) * c
                    : (e + n.cloneOffset) * c),
              n.setProps(h, '', n.vars.animationSpeed),
              n.transitions
                ? ((n.vars.animationLoop && n.atEnd) || ((n.animating = !1), (n.currentSlide = n.animatingTo)),
                  n.container.unbind('webkitTransitionEnd transitionend'),
                  n.container.bind('webkitTransitionEnd transitionend', function() {
                    clearTimeout(n.ensureAnimationEnd), n.wrapup(c);
                  }),
                  clearTimeout(n.ensureAnimationEnd),
                  (n.ensureAnimationEnd = setTimeout(function() {
                    n.wrapup(c);
                  }, n.vars.animationSpeed + 100)))
                : n.container.animate(n.args, n.vars.animationSpeed, n.vars.easing, function() {
                    n.wrapup(c);
                  });
          }
          n.vars.smoothHeight && f.smoothHeight(n.vars.animationSpeed);
        }
      }),
      (n.wrapup = function(e) {
        p ||
          v ||
          (0 === n.currentSlide && n.animatingTo === n.last && n.vars.animationLoop
            ? n.setProps(e, 'jumpEnd')
            : n.currentSlide === n.last && 0 === n.animatingTo && n.vars.animationLoop && n.setProps(e, 'jumpStart')),
          (n.animating = !1),
          (n.currentSlide = n.animatingTo),
          n.vars.after(n);
      }),
      (n.animateSlides = function() {
        !n.animating && e && n.flexAnimate(n.getTarget('next'));
      }),
      (n.pause = function() {
        clearInterval(n.animatedSlides),
          (n.animatedSlides = null),
          (n.playing = !1),
          n.vars.pausePlay && f.pausePlay.update('play'),
          n.syncExists && f.sync('pause');
      }),
      (n.play = function() {
        n.playing && clearInterval(n.animatedSlides),
          (n.animatedSlides = n.animatedSlides || setInterval(n.animateSlides, n.vars.slideshowSpeed)),
          (n.started = n.playing = !0),
          n.vars.pausePlay && f.pausePlay.update('pause'),
          n.syncExists && f.sync('play');
      }),
      (n.stop = function() {
        n.pause(), (n.stopped = !0);
      }),
      (n.canAdvance = function(e, t) {
        var a = m ? n.pagingCount - 1 : n.last;
        return t
          ? !0
          : m && n.currentItem === n.count - 1 && 0 === e && 'prev' === n.direction
          ? !0
          : m && 0 === n.currentItem && e === n.pagingCount - 1 && 'next' !== n.direction
          ? !1
          : e !== n.currentSlide || m
          ? n.vars.animationLoop
            ? !0
            : n.atEnd && 0 === n.currentSlide && e === a && 'next' !== n.direction
            ? !1
            : n.atEnd && n.currentSlide === a && 0 === e && 'next' === n.direction
            ? !1
            : !0
          : !1;
      }),
      (n.getTarget = function(e) {
        return (
          (n.direction = e),
          'next' === e
            ? n.currentSlide === n.last
              ? 0
              : n.currentSlide + 1
            : 0 === n.currentSlide
            ? n.last
            : n.currentSlide - 1
        );
      }),
      (n.setProps = function(e, t, a) {
        var i = (function() {
          var a = e ? e : (n.itemW + n.vars.itemMargin) * n.move * n.animatingTo,
            i = (function() {
              if (v)
                return 'setTouch' === t
                  ? e
                  : u && n.animatingTo === n.last
                  ? 0
                  : u
                  ? n.limit - (n.itemW + n.vars.itemMargin) * n.move * n.animatingTo
                  : n.animatingTo === n.last
                  ? n.limit
                  : a;
              switch (t) {
                case 'setTotal':
                  return u ? (n.count - 1 - n.currentSlide + n.cloneOffset) * e : (n.currentSlide + n.cloneOffset) * e;
                case 'setTouch':
                  return u ? e : e;
                case 'jumpEnd':
                  return u ? e : n.count * e;
                case 'jumpStart':
                  return u ? n.count * e : e;
                default:
                  return e;
              }
            })();
          return -1 * i + 'px';
        })();
        n.transitions &&
          ((i = d ? 'translate3d(0,' + i + ',0)' : 'translate3d(' + i + ',0,0)'),
          (a = void 0 !== a ? a / 1e3 + 's' : '0s'),
          n.container.css('-' + n.pfx + '-transition-duration', a),
          n.container.css('transition-duration', a)),
          (n.args[n.prop] = i),
          (n.transitions || void 0 === a) && n.container.css(n.args),
          n.container.css('transform', i);
      }),
      (n.setup = function(e) {
        if (p)
          n.slides.css({ width: '100%', float: 'left', marginRight: '-100%', position: 'relative' }),
            'init' === e &&
              (r
                ? n.slides
                    .css({
                      opacity: 0,
                      display: 'block',
                      webkitTransition: 'opacity ' + n.vars.animationSpeed / 1e3 + 's ease',
                      zIndex: 1,
                    })
                    .eq(n.currentSlide)
                    .css({ opacity: 1, zIndex: 2 })
                : 0 == n.vars.fadeFirstSlide
                ? n.slides
                    .css({ opacity: 0, display: 'block', zIndex: 1 })
                    .eq(n.currentSlide)
                    .css({ zIndex: 2 })
                    .css({ opacity: 1 })
                : n.slides
                    .css({ opacity: 0, display: 'block', zIndex: 1 })
                    .eq(n.currentSlide)
                    .css({ zIndex: 2 })
                    .animate({ opacity: 1 }, n.vars.animationSpeed, n.vars.easing)),
            n.vars.smoothHeight && f.smoothHeight();
        else {
          var t, a;
          'init' === e &&
            ((n.viewport = $('<div class="' + i + 'viewport"></div>')
              .css({ overflow: 'hidden', position: 'relative' })
              .appendTo(n)
              .append(n.container)),
            (n.cloneCount = 0),
            (n.cloneOffset = 0),
            u && ((a = $.makeArray(n.slides).reverse()), (n.slides = $(a)), n.container.empty().append(n.slides))),
            n.vars.animationLoop &&
              !v &&
              ((n.cloneCount = 2),
              (n.cloneOffset = 1),
              'init' !== e && n.container.find('.clone').remove(),
              n.container
                .append(
                  f
                    .uniqueID(
                      n.slides
                        .first()
                        .clone()
                        .addClass('clone')
                    )
                    .attr('aria-hidden', 'true')
                )
                .prepend(
                  f
                    .uniqueID(
                      n.slides
                        .last()
                        .clone()
                        .addClass('clone')
                    )
                    .attr('aria-hidden', 'true')
                )),
            (n.newSlides = $(n.vars.selector, n)),
            (t = u ? n.count - 1 - n.currentSlide + n.cloneOffset : n.currentSlide + n.cloneOffset),
            d && !v
              ? (n.container
                  .height(200 * (n.count + n.cloneCount) + '%')
                  .css('position', 'absolute')
                  .width('100%'),
                setTimeout(
                  function() {
                    n.newSlides.css({ display: 'block' }),
                      n.doMath(),
                      n.viewport.height(n.h),
                      n.setProps(t * n.h, 'init');
                  },
                  'init' === e ? 100 : 0
                ))
              : (n.container.width(200 * (n.count + n.cloneCount) + '%'),
                n.setProps(t * n.computedW, 'init'),
                setTimeout(
                  function() {
                    n.doMath(),
                      n.newSlides.css({
                        width: n.computedW,
                        marginRight: n.computedM,
                        float: 'left',
                        display: 'block',
                      }),
                      n.vars.smoothHeight && f.smoothHeight();
                  },
                  'init' === e ? 100 : 0
                ));
        }
        v ||
          n.slides
            .removeClass(i + 'active-slide')
            .eq(n.currentSlide)
            .addClass(i + 'active-slide'),
          n.vars.init(n);
      }),
      (n.doMath = function() {
        var e = n.slides.first(),
          t = n.vars.itemMargin,
          a = n.vars.minItems,
          i = n.vars.maxItems;
        (n.w = void 0 === n.viewport ? n.width() : n.viewport.width()),
          (n.h = e.height()),
          (n.boxPadding = e.outerWidth() - e.width()),
          v
            ? ((n.itemT = n.vars.itemWidth + t),
              (n.itemM = t),
              (n.minW = a ? a * n.itemT : n.w),
              (n.maxW = i ? i * n.itemT - t : n.w),
              (n.itemW =
                n.minW > n.w
                  ? (n.w - t * (a - 1)) / a
                  : n.maxW < n.w
                  ? (n.w - t * (i - 1)) / i
                  : n.vars.itemWidth > n.w
                  ? n.w
                  : n.vars.itemWidth),
              (n.visible = Math.floor(n.w / n.itemW)),
              (n.move = n.vars.move > 0 && n.vars.move < n.visible ? n.vars.move : n.visible),
              (n.pagingCount = Math.ceil((n.count - n.visible) / n.move + 1)),
              (n.last = n.pagingCount - 1),
              (n.limit =
                1 === n.pagingCount
                  ? 0
                  : n.vars.itemWidth > n.w
                  ? n.itemW * (n.count - 1) + t * (n.count - 1)
                  : (n.itemW + t) * n.count - n.w - t))
            : ((n.itemW = n.w), (n.itemM = t), (n.pagingCount = n.count), (n.last = n.count - 1)),
          (n.computedW = n.itemW - n.boxPadding),
          (n.computedM = n.itemM);
      }),
      (n.update = function(e, t) {
        n.doMath(),
          v ||
            (e < n.currentSlide ? (n.currentSlide += 1) : e <= n.currentSlide && 0 !== e && (n.currentSlide -= 1),
            (n.animatingTo = n.currentSlide)),
          n.vars.controlNav &&
            !n.manualControls &&
            (('add' === t && !v) || n.pagingCount > n.controlNav.length
              ? f.controlNav.update('add')
              : (('remove' === t && !v) || n.pagingCount < n.controlNav.length) &&
                (v && n.currentSlide > n.last && ((n.currentSlide -= 1), (n.animatingTo -= 1)),
                f.controlNav.update('remove', n.last))),
          n.vars.directionNav && f.directionNav.update();
      }),
      (n.addSlide = function(e, t) {
        var a = $(e);
        (n.count += 1),
          (n.last = n.count - 1),
          d && u
            ? void 0 !== t
              ? n.slides.eq(n.count - t).after(a)
              : n.container.prepend(a)
            : void 0 !== t
            ? n.slides.eq(t).before(a)
            : n.container.append(a),
          n.update(t, 'add'),
          (n.slides = $(n.vars.selector + ':not(.clone)', n)),
          n.setup(),
          n.vars.added(n);
      }),
      (n.removeSlide = function(e) {
        var t = isNaN(e) ? n.slides.index($(e)) : e;
        (n.count -= 1),
          (n.last = n.count - 1),
          isNaN(e) ? $(e, n.slides).remove() : d && u ? n.slides.eq(n.last).remove() : n.slides.eq(e).remove(),
          n.doMath(),
          n.update(t, 'remove'),
          (n.slides = $(n.vars.selector + ':not(.clone)', n)),
          n.setup(),
          n.vars.removed(n);
      }),
      f.init();
  }),
    $(window)
      .blur(function(t) {
        e = !1;
      })
      .focus(function(t) {
        e = !0;
      }),
    ($.flexslider.defaults = {
      namespace: 'flex-',
      selector: '.slides > li',
      animation: 'fade',
      easing: 'swing',
      direction: 'horizontal',
      reverse: !1,
      animationLoop: !0,
      smoothHeight: !1,
      startAt: 0,
      slideshow: !0,
      slideshowSpeed: 7e3,
      animationSpeed: 600,
      initDelay: 0,
      randomize: !1,
      fadeFirstSlide: !0,
      thumbCaptions: !1,
      pauseOnAction: !0,
      pauseOnHover: !1,
      pauseInvisible: !0,
      useCSS: !0,
      touch: !0,
      video: !1,
      controlNav: !0,
      directionNav: !0,
      prevText: 'Previous',
      nextText: 'Next',
      keyboard: !0,
      multipleKeyboard: !1,
      mousewheel: !1,
      pausePlay: !1,
      pauseText: 'Pause',
      playText: 'Play',
      controlsContainer: '',
      manualControls: '',
      customDirectionNav: '',
      sync: '',
      asNavFor: '',
      itemWidth: 0,
      itemMargin: 0,
      minItems: 1,
      maxItems: 0,
      move: 0,
      allowOneSlide: !0,
      start: function() {},
      before: function() {},
      after: function() {},
      end: function() {},
      added: function() {},
      removed: function() {},
      init: function() {},
    }),
    ($.fn.flexslider = function(e) {
      if ((void 0 === e && (e = {}), 'object' == typeof e))
        return this.each(function() {
          var t = $(this),
            a = e.selector ? e.selector : '.slides > li',
            n = t.find(a);
          (1 === n.length && e.allowOneSlide === !0) || 0 === n.length
            ? (n.fadeIn(400), e.start && e.start(t))
            : void 0 === t.data('flexslider') && new $.flexslider(this, e);
        });
      var t = $(this).data('flexslider');
      switch (e) {
        case 'play':
          t.play();
          break;
        case 'pause':
          t.pause();
          break;
        case 'stop':
          t.stop();
          break;
        case 'next':
          t.flexAnimate(t.getTarget('next'), !0);
          break;
        case 'prev':
        case 'previous':
          t.flexAnimate(t.getTarget('prev'), !0);
          break;
        default:
          'number' == typeof e && t.flexAnimate(e, !0);
      }
    });
})(jQuery);

/*! Lazy Load 1.9.3 - MIT license - Copyright 2010-2013 Mika Tuupola */
!(function(a, b, c, d) {
  var e = a(b);
  (a.fn.lazyload = function(f) {
    function g() {
      var b = 0;
      i.each(function() {
        var c = a(this);
        if (!j.skip_invisible || c.is(':visible'))
          if (a.abovethetop(this, j) || a.leftofbegin(this, j));
          else if (a.belowthefold(this, j) || a.rightoffold(this, j)) {
            if (++b > j.failure_limit) return !1;
          } else c.trigger('appear'), (b = 0);
      });
    }
    var h,
      i = this,
      j = {
        threshold: 0,
        failure_limit: 0,
        event: 'scroll',
        effect: 'show',
        container: b,
        data_attribute: 'original',
        skip_invisible: !0,
        appear: null,
        load: null,
        placeholder:
          'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC',
      };
    return (
      f &&
        (d !== f.failurelimit && ((f.failure_limit = f.failurelimit), delete f.failurelimit),
        d !== f.effectspeed && ((f.effect_speed = f.effectspeed), delete f.effectspeed),
        a.extend(j, f)),
      (h = j.container === d || j.container === b ? e : a(j.container)),
      0 === j.event.indexOf('scroll') &&
        h.bind(j.event, function() {
          return g();
        }),
      this.each(function() {
        var b = this,
          c = a(b);
        (b.loaded = !1),
          (c.attr('src') === d || c.attr('src') === !1) && c.is('img') && c.attr('src', j.placeholder),
          c.one('appear', function() {
            if (!this.loaded) {
              if (j.appear) {
                var d = i.length;
                j.appear.call(b, d, j);
              }
              a('<img />')
                .bind('load', function() {
                  var d = c.attr('data-' + j.data_attribute);
                  c.hide(),
                    c.is('img') ? c.attr('src', d) : c.css('background-image', "url('" + d + "')"),
                    c[j.effect](j.effect_speed),
                    (b.loaded = !0);
                  var e = a.grep(i, function(a) {
                    return !a.loaded;
                  });
                  if (((i = a(e)), j.load)) {
                    var f = i.length;
                    j.load.call(b, f, j);
                  }
                })
                .attr('src', c.attr('data-' + j.data_attribute));
            }
          }),
          0 !== j.event.indexOf('scroll') &&
            c.bind(j.event, function() {
              b.loaded || c.trigger('appear');
            });
      }),
      e.bind('resize', function() {
        g();
      }),
      /(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion) &&
        e.bind('pageshow', function(b) {
          b.originalEvent &&
            b.originalEvent.persisted &&
            i.each(function() {
              a(this).trigger('appear');
            });
        }),
      a(c).ready(function() {
        g();
      }),
      this
    );
  }),
    (a.belowthefold = function(c, f) {
      var g;
      return (
        (g =
          f.container === d || f.container === b
            ? (b.innerHeight ? b.innerHeight : e.height()) + e.scrollTop()
            : a(f.container).offset().top + a(f.container).height()),
        g <= a(c).offset().top - f.threshold
      );
    }),
    (a.rightoffold = function(c, f) {
      var g;
      return (
        (g =
          f.container === d || f.container === b
            ? e.width() + e.scrollLeft()
            : a(f.container).offset().left + a(f.container).width()),
        g <= a(c).offset().left - f.threshold
      );
    }),
    (a.abovethetop = function(c, f) {
      var g;
      return (
        (g = f.container === d || f.container === b ? e.scrollTop() : a(f.container).offset().top),
        g >= a(c).offset().top + f.threshold + a(c).height()
      );
    }),
    (a.leftofbegin = function(c, f) {
      var g;
      return (
        (g = f.container === d || f.container === b ? e.scrollLeft() : a(f.container).offset().left),
        g >= a(c).offset().left + f.threshold + a(c).width()
      );
    }),
    (a.inviewport = function(b, c) {
      return !(a.rightoffold(b, c) || a.leftofbegin(b, c) || a.belowthefold(b, c) || a.abovethetop(b, c));
    }),
    a.extend(a.expr[':'], {
      'below-the-fold': function(b) {
        return a.belowthefold(b, { threshold: 0 });
      },
      'above-the-top': function(b) {
        return !a.belowthefold(b, { threshold: 0 });
      },
      'right-of-screen': function(b) {
        return a.rightoffold(b, { threshold: 0 });
      },
      'left-of-screen': function(b) {
        return !a.rightoffold(b, { threshold: 0 });
      },
      'in-viewport': function(b) {
        return a.inviewport(b, { threshold: 0 });
      },
      'above-the-fold': function(b) {
        return !a.belowthefold(b, { threshold: 0 });
      },
      'right-of-fold': function(b) {
        return a.rightoffold(b, { threshold: 0 });
      },
      'left-of-fold': function(b) {
        return !a.rightoffold(b, { threshold: 0 });
      },
    });
})(jQuery, window, document);

/* == malihu jquery custom scrollbar plugin == Version: 3.0.3, License: MIT License (MIT) */
(function(b, a, c) {
  (function(d) {
    if (typeof define === 'function' && define.amd) {
      define(['jquery', 'jquery-mousewheel'], d);
    } else {
      d(jQuery);
    }
  })(function(j) {
    var g = 'mCustomScrollbar',
      d = 'mCS',
      m = '.mCustomScrollbar',
      h = {
        setWidth: false,
        setHeight: false,
        setTop: 0,
        setLeft: 0,
        axis: 'y',
        scrollbarPosition: 'inside',
        scrollInertia: 950,
        autoDraggerLength: true,
        autoHideScrollbar: false,
        autoExpandScrollbar: false,
        alwaysShowScrollbar: 0,
        snapAmount: null,
        snapOffset: 0,
        mouseWheel: {
          enable: true,
          scrollAmount: 'auto',
          axis: 'y',
          preventDefault: false,
          deltaFactor: 'auto',
          normalizeDelta: false,
          invert: false,
          disableOver: ['select', 'option', 'keygen', 'datalist', 'textarea'],
        },
        scrollButtons: { enable: false, scrollType: 'stepless', scrollAmount: 'auto' },
        keyboard: { enable: true, scrollType: 'stepless', scrollAmount: 'auto' },
        contentTouchScroll: 25,
        advanced: {
          autoExpandHorizontalScroll: false,
          autoScrollOnFocus:
            "input,textarea,select,button,datalist,keygen,a[tabindex],area,object,[contenteditable='true']",
          updateOnContentResize: true,
          updateOnImageLoad: true,
          updateOnSelectorChange: false,
        },
        theme: 'light',
        callbacks: {
          onScrollStart: false,
          onScroll: false,
          onTotalScroll: false,
          onTotalScrollBack: false,
          whileScrolling: false,
          onTotalScrollOffset: 0,
          onTotalScrollBackOffset: 0,
          alwaysTriggerOffsets: true,
        },
        live: false,
        liveSelector: null,
      },
      l = 0,
      o = {},
      f = function(p) {
        if (o[p]) {
          clearTimeout(o[p]);
          i._delete.call(null, o[p]);
        }
      },
      k = b.attachEvent && !b.addEventListener ? 1 : 0,
      n = false,
      e = {
        init: function(q) {
          var q = j.extend(true, {}, h, q),
            p = i._selector.call(this);
          if (q.live) {
            var s = q.liveSelector || this.selector || m,
              r = j(s);
            if (q.live === 'off') {
              f(s);
              return;
            }
            o[s] = setTimeout(function() {
              r.mCustomScrollbar(q);
              if (q.live === 'once' && r.length) {
                f(s);
              }
            }, 500);
          } else {
            f(s);
          }
          q.setWidth = q.set_width ? q.set_width : q.setWidth;
          q.setHeight = q.set_height ? q.set_height : q.setHeight;
          q.axis = q.horizontalScroll ? 'x' : i._findAxis.call(null, q.axis);
          q.scrollInertia = q.scrollInertia < 17 ? 17 : q.scrollInertia;
          if (typeof q.mouseWheel !== 'object' && q.mouseWheel == true) {
            q.mouseWheel = {
              enable: true,
              scrollAmount: 'auto',
              axis: 'y',
              preventDefault: false,
              deltaFactor: 'auto',
              normalizeDelta: false,
              invert: false,
            };
          }
          q.mouseWheel.scrollAmount = !q.mouseWheelPixels ? q.mouseWheel.scrollAmount : q.mouseWheelPixels;
          q.mouseWheel.normalizeDelta = !q.advanced.normalizeMouseWheelDelta
            ? q.mouseWheel.normalizeDelta
            : q.advanced.normalizeMouseWheelDelta;
          q.scrollButtons.scrollType = i._findScrollButtonsType.call(null, q.scrollButtons.scrollType);
          i._theme.call(null, q);
          return j(p).each(function() {
            var u = j(this);
            if (!u.data(d)) {
              u.data(d, {
                idx: ++l,
                opt: q,
                scrollRatio: { y: null, x: null },
                overflowed: null,
                bindEvents: false,
                tweenRunning: false,
                sequential: {},
                langDir: u.css('direction'),
                cbOffsets: null,
                trigger: null,
              });
              var w = u.data(d).opt,
                v = u.data('mcs-axis'),
                t = u.data('mcs-scrollbar-position'),
                x = u.data('mcs-theme');
              if (v) {
                w.axis = v;
              }
              if (t) {
                w.scrollbarPosition = t;
              }
              if (x) {
                w.theme = x;
                i._theme.call(null, w);
              }
              i._pluginMarkup.call(this);
              e.update.call(null, u);
            }
          });
        },
        update: function(q) {
          var p = q || i._selector.call(this);
          return j(p).each(function() {
            var t = j(this);
            if (t.data(d)) {
              var v = t.data(d),
                u = v.opt,
                r = j('#mCSB_' + v.idx + '_container'),
                s = [j('#mCSB_' + v.idx + '_dragger_vertical'), j('#mCSB_' + v.idx + '_dragger_horizontal')];
              if (!r.length) {
                return;
              }
              if (v.tweenRunning) {
                i._stop.call(null, t);
              }
              if (t.hasClass('mCS_disabled')) {
                t.removeClass('mCS_disabled');
              }
              if (t.hasClass('mCS_destroyed')) {
                t.removeClass('mCS_destroyed');
              }
              i._maxHeight.call(this);
              i._expandContentHorizontally.call(this);
              if (u.axis !== 'y' && !u.advanced.autoExpandHorizontalScroll) {
                r.css('width', i._contentWidth(r.children()));
              }
              v.overflowed = i._overflowed.call(this);
              i._scrollbarVisibility.call(this);
              if (u.autoDraggerLength) {
                i._setDraggerLength.call(this);
              }
              i._scrollRatio.call(this);
              i._bindEvents.call(this);
              var w = [Math.abs(r[0].offsetTop), Math.abs(r[0].offsetLeft)];
              if (u.axis !== 'x') {
                if (!v.overflowed[0]) {
                  i._resetContentPosition.call(this);
                  if (u.axis === 'y') {
                    i._unbindEvents.call(this);
                  } else {
                    if (u.axis === 'yx' && v.overflowed[1]) {
                      i._scrollTo.call(this, t, w[1].toString(), { dir: 'x', dur: 0, overwrite: 'none' });
                    }
                  }
                } else {
                  if (s[0].height() > s[0].parent().height()) {
                    i._resetContentPosition.call(this);
                  } else {
                    i._scrollTo.call(this, t, w[0].toString(), { dir: 'y', dur: 0, overwrite: 'none' });
                  }
                }
              }
              if (u.axis !== 'y') {
                if (!v.overflowed[1]) {
                  i._resetContentPosition.call(this);
                  if (u.axis === 'x') {
                    i._unbindEvents.call(this);
                  } else {
                    if (u.axis === 'yx' && v.overflowed[0]) {
                      i._scrollTo.call(this, t, w[0].toString(), { dir: 'y', dur: 0, overwrite: 'none' });
                    }
                  }
                } else {
                  if (s[1].width() > s[1].parent().width()) {
                    i._resetContentPosition.call(this);
                  } else {
                    i._scrollTo.call(this, t, w[1].toString(), { dir: 'x', dur: 0, overwrite: 'none' });
                  }
                }
              }
              i._autoUpdate.call(this);
            }
          });
        },
        scrollTo: function(r, q) {
          if (typeof r == 'undefined' || r == null) {
            return;
          }
          var p = i._selector.call(this);
          return j(p).each(function() {
            var u = j(this);
            if (u.data(d)) {
              var x = u.data(d),
                w = x.opt,
                v = {
                  trigger: 'external',
                  scrollInertia: w.scrollInertia,
                  scrollEasing: 'mcsEaseInOut',
                  moveDragger: false,
                  callbacks: true,
                  onStart: true,
                  onUpdate: true,
                  onComplete: true,
                },
                s = j.extend(true, {}, v, q),
                y = i._arr.call(this, r),
                t = s.scrollInertia < 17 ? 17 : s.scrollInertia;
              y[0] = i._to.call(this, y[0], 'y');
              y[1] = i._to.call(this, y[1], 'x');
              if (s.moveDragger) {
                y[0] *= x.scrollRatio.y;
                y[1] *= x.scrollRatio.x;
              }
              s.dur = t;
              setTimeout(function() {
                if (y[0] !== null && typeof y[0] !== 'undefined' && w.axis !== 'x' && x.overflowed[0]) {
                  s.dir = 'y';
                  s.overwrite = 'all';
                  i._scrollTo.call(this, u, y[0].toString(), s);
                }
                if (y[1] !== null && typeof y[1] !== 'undefined' && w.axis !== 'y' && x.overflowed[1]) {
                  s.dir = 'x';
                  s.overwrite = 'none';
                  i._scrollTo.call(this, u, y[1].toString(), s);
                }
              }, 60);
            }
          });
        },
        stop: function() {
          var p = i._selector.call(this);
          return j(p).each(function() {
            var q = j(this);
            if (q.data(d)) {
              i._stop.call(null, q);
            }
          });
        },
        disable: function(q) {
          var p = i._selector.call(this);
          return j(p).each(function() {
            var r = j(this);
            if (r.data(d)) {
              var t = r.data(d),
                s = t.opt;
              i._autoUpdate.call(this, 'remove');
              i._unbindEvents.call(this);
              if (q) {
                i._resetContentPosition.call(this);
              }
              i._scrollbarVisibility.call(this, true);
              r.addClass('mCS_disabled');
            }
          });
        },
        destroy: function() {
          var p = i._selector.call(this);
          return j(p).each(function() {
            var s = j(this);
            if (s.data(d)) {
              var u = s.data(d),
                t = u.opt,
                q = j('#mCSB_' + u.idx),
                r = j('#mCSB_' + u.idx + '_container'),
                v = j('.mCSB_' + u.idx + '_scrollbar');
              if (t.live) {
                f(p);
              }
              i._autoUpdate.call(this, 'remove');
              i._unbindEvents.call(this);
              i._resetContentPosition.call(this);
              s.removeData(d);
              i._delete.call(null, this.mcs);
              v.remove();
              q.replaceWith(r.contents());
              s.removeClass(
                g + ' _' + d + '_' + u.idx + ' mCS-autoHide mCS-dir-rtl mCS_no_scrollbar mCS_disabled'
              ).addClass('mCS_destroyed');
            }
          });
        },
      },
      i = {
        _selector: function() {
          return typeof j(this) !== 'object' || j(this).length < 1 ? m : this;
        },
        _theme: function(s) {
          var r = ['rounded', 'rounded-dark', 'rounded-dots', 'rounded-dots-dark'],
            q = [
              'rounded-dots',
              'rounded-dots-dark',
              '3d',
              '3d-dark',
              '3d-thick',
              '3d-thick-dark',
              'inset',
              'inset-dark',
              'inset-2',
              'inset-2-dark',
              'inset-3',
              'inset-3-dark',
            ],
            p = ['minimal', 'minimal-dark'],
            u = ['minimal', 'minimal-dark'],
            t = ['minimal', 'minimal-dark'];
          s.autoDraggerLength = j.inArray(s.theme, r) > -1 ? false : s.autoDraggerLength;
          s.autoExpandScrollbar = j.inArray(s.theme, q) > -1 ? false : s.autoExpandScrollbar;
          s.scrollButtons.enable = j.inArray(s.theme, p) > -1 ? false : s.scrollButtons.enable;
          s.autoHideScrollbar = j.inArray(s.theme, u) > -1 ? true : s.autoHideScrollbar;
          s.scrollbarPosition = j.inArray(s.theme, t) > -1 ? 'outside' : s.scrollbarPosition;
        },
        _findAxis: function(p) {
          return p === 'yx' || p === 'xy' || p === 'auto' ? 'yx' : p === 'x' || p === 'horizontal' ? 'x' : 'y';
        },
        _findScrollButtonsType: function(p) {
          return p === 'stepped' || p === 'pixels' || p === 'step' || p === 'click' ? 'stepped' : 'stepless';
        },
        _pluginMarkup: function() {
          var y = j(this),
            x = y.data(d),
            r = x.opt,
            t = r.autoExpandScrollbar ? ' mCSB_scrollTools_onDrag_expand' : '',
            B = [
              "<div id='mCSB_" +
                x.idx +
                "_scrollbar_vertical' class='mCSB_scrollTools mCSB_" +
                x.idx +
                '_scrollbar mCS-' +
                r.theme +
                ' mCSB_scrollTools_vertical' +
                t +
                "'><div class='mCSB_draggerContainer'><div id='mCSB_" +
                x.idx +
                "_dragger_vertical' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>",
              "<div id='mCSB_" +
                x.idx +
                "_scrollbar_horizontal' class='mCSB_scrollTools mCSB_" +
                x.idx +
                '_scrollbar mCS-' +
                r.theme +
                ' mCSB_scrollTools_horizontal' +
                t +
                "'><div class='mCSB_draggerContainer'><div id='mCSB_" +
                x.idx +
                "_dragger_horizontal' class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' /></div><div class='mCSB_draggerRail' /></div></div>",
            ],
            u = r.axis === 'yx' ? 'mCSB_vertical_horizontal' : r.axis === 'x' ? 'mCSB_horizontal' : 'mCSB_vertical',
            w = r.axis === 'yx' ? B[0] + B[1] : r.axis === 'x' ? B[1] : B[0],
            v =
              r.axis === 'yx' ? "<div id='mCSB_" + x.idx + "_container_wrapper' class='mCSB_container_wrapper' />" : '',
            s = r.autoHideScrollbar ? ' mCS-autoHide' : '',
            p = r.axis !== 'x' && x.langDir === 'rtl' ? ' mCS-dir-rtl' : '';
          if (r.setWidth) {
            y.css('width', r.setWidth);
          }
          if (r.setHeight) {
            y.css('height', r.setHeight);
          }
          r.setLeft = r.axis !== 'y' && x.langDir === 'rtl' ? '989999px' : r.setLeft;
          y.addClass(g + ' _' + d + '_' + x.idx + s + p).wrapInner(
            "<div id='mCSB_" +
              x.idx +
              "' class='mCustomScrollBox mCS-" +
              r.theme +
              ' ' +
              u +
              "'><div id='mCSB_" +
              x.idx +
              "_container' class='mCSB_container' style='position:relative; top:" +
              r.setTop +
              '; left:' +
              r.setLeft +
              ";' dir=" +
              x.langDir +
              ' /></div>'
          );
          var q = j('#mCSB_' + x.idx),
            z = j('#mCSB_' + x.idx + '_container');
          if (r.axis !== 'y' && !r.advanced.autoExpandHorizontalScroll) {
            z.css('width', i._contentWidth(z.children()));
          }
          if (r.scrollbarPosition === 'outside') {
            if (y.css('position') === 'static') {
              y.css('position', 'relative');
            }
            y.css('overflow', 'visible');
            q.addClass('mCSB_outside').after(w);
          } else {
            q.addClass('mCSB_inside').append(w);
            z.wrap(v);
          }
          i._scrollButtons.call(this);
          var A = [j('#mCSB_' + x.idx + '_dragger_vertical'), j('#mCSB_' + x.idx + '_dragger_horizontal')];
          A[0].css('min-height', A[0].height());
          A[1].css('min-width', A[1].width());
        },
        _contentWidth: function(p) {
          return Math.max.apply(
            Math,
            p
              .map(function() {
                return j(this).outerWidth(true);
              })
              .get()
          );
        },
        _expandContentHorizontally: function() {
          var q = j(this),
            s = q.data(d),
            r = s.opt,
            p = j('#mCSB_' + s.idx + '_container');
          if (r.advanced.autoExpandHorizontalScroll && r.axis !== 'y') {
            p.css({ position: 'absolute', width: 'auto' })
              .wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />")
              .css({
                width:
                  Math.ceil(p[0].getBoundingClientRect().right + 0.4) - Math.floor(p[0].getBoundingClientRect().left),
                position: 'relative',
              })
              .unwrap();
          }
        },
        _scrollButtons: function() {
          var s = j(this),
            u = s.data(d),
            t = u.opt,
            q = j('.mCSB_' + u.idx + '_scrollbar:first'),
            r = [
              "<a href='#' class='mCSB_buttonUp' oncontextmenu='return false;' />",
              "<a href='#' class='mCSB_buttonDown' oncontextmenu='return false;' />",
              "<a href='#' class='mCSB_buttonLeft' oncontextmenu='return false;' />",
              "<a href='#' class='mCSB_buttonRight' oncontextmenu='return false;' />",
            ],
            p = [t.axis === 'x' ? r[2] : r[0], t.axis === 'x' ? r[3] : r[1], r[2], r[3]];
          if (t.scrollButtons.enable) {
            q.prepend(p[0])
              .append(p[1])
              .next('.mCSB_scrollTools')
              .prepend(p[2])
              .append(p[3]);
          }
        },
        _maxHeight: function() {
          var t = j(this),
            w = t.data(d),
            v = w.opt,
            r = j('#mCSB_' + w.idx),
            q = t.css('max-height'),
            s = q.indexOf('%') !== -1,
            p = t.css('box-sizing');
          if (q !== 'none') {
            var u = s ? (t.parent().height() * parseInt(q)) / 100 : parseInt(q);
            if (p === 'border-box') {
              u -= t.innerHeight() - t.height() + (t.outerHeight() - t.innerHeight());
            }
            r.css('max-height', Math.round(u));
          }
        },
        _setDraggerLength: function() {
          var u = j(this),
            s = u.data(d),
            p = j('#mCSB_' + s.idx),
            v = j('#mCSB_' + s.idx + '_container'),
            y = [j('#mCSB_' + s.idx + '_dragger_vertical'), j('#mCSB_' + s.idx + '_dragger_horizontal')],
            t = [p.height() / v.outerHeight(false), p.width() / v.outerWidth(false)],
            q = [
              parseInt(y[0].css('min-height')),
              Math.round(t[0] * y[0].parent().height()),
              parseInt(y[1].css('min-width')),
              Math.round(t[1] * y[1].parent().width()),
            ],
            r = k && q[1] < q[0] ? q[0] : q[1],
            x = k && q[3] < q[2] ? q[2] : q[3];
          y[0]
            .css({ height: r, 'max-height': y[0].parent().height() - 10 })
            .find('.mCSB_dragger_bar')
            .css({ 'line-height': q[0] + 'px' });
          y[1].css({ width: x, 'max-width': y[1].parent().width() - 10 });
        },
        _scrollRatio: function() {
          var t = j(this),
            v = t.data(d),
            q = j('#mCSB_' + v.idx),
            r = j('#mCSB_' + v.idx + '_container'),
            s = [j('#mCSB_' + v.idx + '_dragger_vertical'), j('#mCSB_' + v.idx + '_dragger_horizontal')],
            u = [r.outerHeight(false) - q.height(), r.outerWidth(false) - q.width()],
            p = [u[0] / (s[0].parent().height() - s[0].height()), u[1] / (s[1].parent().width() - s[1].width())];
          v.scrollRatio = { y: p[0], x: p[1] };
        },
        _onDragClasses: function(r, t, q) {
          var s = q ? 'mCSB_dragger_onDrag_expanded' : '',
            p = ['mCSB_dragger_onDrag', 'mCSB_scrollTools_onDrag'],
            u = r.closest('.mCSB_scrollTools');
          if (t === 'active') {
            r.toggleClass(p[0] + ' ' + s);
            u.toggleClass(p[1]);
            r[0]._draggable = r[0]._draggable ? 0 : 1;
          } else {
            if (!r[0]._draggable) {
              if (t === 'hide') {
                r.removeClass(p[0]);
                u.removeClass(p[1]);
              } else {
                r.addClass(p[0]);
                u.addClass(p[1]);
              }
            }
          }
        },
        _overflowed: function() {
          var t = j(this),
            u = t.data(d),
            q = j('#mCSB_' + u.idx),
            s = j('#mCSB_' + u.idx + '_container'),
            r = u.overflowed == null ? s.height() : s.outerHeight(false),
            p = u.overflowed == null ? s.width() : s.outerWidth(false);
          return [r > q.height(), p > q.width()];
        },
        _resetContentPosition: function() {
          var t = j(this),
            v = t.data(d),
            u = v.opt,
            q = j('#mCSB_' + v.idx),
            r = j('#mCSB_' + v.idx + '_container'),
            s = [j('#mCSB_' + v.idx + '_dragger_vertical'), j('#mCSB_' + v.idx + '_dragger_horizontal')];
          i._stop(t);
          if ((u.axis !== 'x' && !v.overflowed[0]) || (u.axis === 'y' && v.overflowed[0])) {
            s[0].add(r).css('top', 0);
          }
          if ((u.axis !== 'y' && !v.overflowed[1]) || (u.axis === 'x' && v.overflowed[1])) {
            var p = (dx = 0);
            if (v.langDir === 'rtl') {
              p = q.width() - r.outerWidth(false);
              dx = Math.abs(p / v.scrollRatio.x);
            }
            r.css('left', p);
            s[1].css('left', dx);
          }
        },
        _bindEvents: function() {
          var r = j(this),
            t = r.data(d),
            s = t.opt;
          if (!t.bindEvents) {
            i._draggable.call(this);
            if (s.contentTouchScroll) {
              i._contentDraggable.call(this);
            }
            if (s.mouseWheel.enable) {
              function q() {
                p = setTimeout(function() {
                  if (!j.event.special.mousewheel) {
                    q();
                  } else {
                    clearTimeout(p);
                    i._mousewheel.call(r[0]);
                  }
                }, 1000);
              }
              var p;
              q();
            }
            i._draggerRail.call(this);
            i._wrapperScroll.call(this);
            if (s.advanced.autoScrollOnFocus) {
              i._focus.call(this);
            }
            if (s.scrollButtons.enable) {
              i._buttons.call(this);
            }
            if (s.keyboard.enable) {
              i._keyboard.call(this);
            }
            t.bindEvents = true;
          }
        },
        _unbindEvents: function() {
          var s = j(this),
            t = s.data(d),
            p = d + '_' + t.idx,
            u = '.mCSB_' + t.idx + '_scrollbar',
            r = j(
              '#mCSB_' +
                t.idx +
                ',#mCSB_' +
                t.idx +
                '_container,#mCSB_' +
                t.idx +
                '_container_wrapper,' +
                u +
                ' .mCSB_draggerContainer,#mCSB_' +
                t.idx +
                '_dragger_vertical,#mCSB_' +
                t.idx +
                '_dragger_horizontal,' +
                u +
                '>a'
            ),
            q = j('#mCSB_' + t.idx + '_container');
          if (t.bindEvents) {
            j(a).unbind('.' + p);
            r.each(function() {
              j(this).unbind('.' + p);
            });
            clearTimeout(s[0]._focusTimeout);
            i._delete.call(null, s[0]._focusTimeout);
            clearTimeout(t.sequential.step);
            i._delete.call(null, t.sequential.step);
            clearTimeout(q[0].onCompleteTimeout);
            i._delete.call(null, q[0].onCompleteTimeout);
            t.bindEvents = false;
          }
        },
        _scrollbarVisibility: function(q) {
          var t = j(this),
            v = t.data(d),
            u = v.opt,
            p = j('#mCSB_' + v.idx + '_container_wrapper'),
            r = p.length ? p : j('#mCSB_' + v.idx + '_container'),
            w = [j('#mCSB_' + v.idx + '_scrollbar_vertical'), j('#mCSB_' + v.idx + '_scrollbar_horizontal')],
            s = [w[0].find('.mCSB_dragger'), w[1].find('.mCSB_dragger')];
          if (u.axis !== 'x') {
            if (v.overflowed[0] && !q) {
              w[0]
                .add(s[0])
                .add(w[0].children('a'))
                .css('display', 'block');
              r.removeClass('mCS_no_scrollbar_y mCS_y_hidden');
            } else {
              if (u.alwaysShowScrollbar) {
                if (u.alwaysShowScrollbar !== 2) {
                  s[0].add(w[0].children('a')).css('display', 'none');
                }
                r.removeClass('mCS_y_hidden');
              } else {
                w[0].css('display', 'none');
                r.addClass('mCS_y_hidden');
              }
              r.addClass('mCS_no_scrollbar_y');
            }
          }
          if (u.axis !== 'y') {
            if (v.overflowed[1] && !q) {
              w[1]
                .add(s[1])
                .add(w[1].children('a'))
                .css('display', 'block');
              r.removeClass('mCS_no_scrollbar_x mCS_x_hidden');
            } else {
              if (u.alwaysShowScrollbar) {
                if (u.alwaysShowScrollbar !== 2) {
                  s[1].add(w[1].children('a')).css('display', 'none');
                }
                r.removeClass('mCS_x_hidden');
              } else {
                w[1].css('display', 'none');
                r.addClass('mCS_x_hidden');
              }
              r.addClass('mCS_no_scrollbar_x');
            }
          }
          if (!v.overflowed[0] && !v.overflowed[1]) {
            t.addClass('mCS_no_scrollbar');
          } else {
            t.removeClass('mCS_no_scrollbar');
          }
        },
        _coordinates: function(q) {
          var p = q.type;
          switch (p) {
            case 'pointerdown':
            case 'MSPointerDown':
            case 'pointermove':
            case 'MSPointerMove':
            case 'pointerup':
            case 'MSPointerUp':
              return [q.originalEvent.pageY, q.originalEvent.pageX];
              break;
            case 'touchstart':
            case 'touchmove':
            case 'touchend':
              var r = q.originalEvent.touches[0] || q.originalEvent.changedTouches[0];
              return [r.pageY, r.pageX];
              break;
            default:
              return [q.pageY, q.pageX];
          }
        },
        _draggable: function() {
          var u = j(this),
            s = u.data(d),
            p = s.opt,
            r = d + '_' + s.idx,
            t = ['mCSB_' + s.idx + '_dragger_vertical', 'mCSB_' + s.idx + '_dragger_horizontal'],
            v = j('#mCSB_' + s.idx + '_container'),
            w = j('#' + t[0] + ',#' + t[1]),
            A,
            y,
            z;
          w.bind('mousedown.' + r + ' touchstart.' + r + ' pointerdown.' + r + ' MSPointerDown.' + r, function(E) {
            E.stopImmediatePropagation();
            E.preventDefault();
            if (!i._mouseBtnLeft(E)) {
              return;
            }
            n = true;
            if (k) {
              a.onselectstart = function() {
                return false;
              };
            }
            x(false);
            i._stop(u);
            A = j(this);
            var F = A.offset(),
              G = i._coordinates(E)[0] - F.top,
              B = i._coordinates(E)[1] - F.left,
              D = A.height() + F.top,
              C = A.width() + F.left;
            if (G < D && G > 0 && B < C && B > 0) {
              y = G;
              z = B;
            }
            i._onDragClasses(A, 'active', p.autoExpandScrollbar);
          }).bind('touchmove.' + r, function(C) {
            C.stopImmediatePropagation();
            C.preventDefault();
            var D = A.offset(),
              E = i._coordinates(C)[0] - D.top,
              B = i._coordinates(C)[1] - D.left;
            q(y, z, E, B);
          });
          j(a)
            .bind('mousemove.' + r + ' pointermove.' + r + ' MSPointerMove.' + r, function(C) {
              if (A) {
                var D = A.offset(),
                  E = i._coordinates(C)[0] - D.top,
                  B = i._coordinates(C)[1] - D.left;
                if (y === E) {
                  return;
                }
                q(y, z, E, B);
              }
            })
            .add(w)
            .bind('mouseup.' + r + ' touchend.' + r + ' pointerup.' + r + ' MSPointerUp.' + r, function(B) {
              if (A) {
                i._onDragClasses(A, 'active', p.autoExpandScrollbar);
                A = null;
              }
              n = false;
              if (k) {
                a.onselectstart = null;
              }
              x(true);
            });
          function x(B) {
            var C = v.find('iframe');
            if (!C.length) {
              return;
            }
            var D = !B ? 'none' : 'auto';
            C.css('pointer-events', D);
          }
          function q(D, E, G, B) {
            v[0].idleTimer = p.scrollInertia < 233 ? 250 : 0;
            if (A.attr('id') === t[1]) {
              var C = 'x',
                F = (A[0].offsetLeft - E + B) * s.scrollRatio.x;
            } else {
              var C = 'y',
                F = (A[0].offsetTop - D + G) * s.scrollRatio.y;
            }
            i._scrollTo(u, F.toString(), { dir: C, drag: true });
          }
        },
        _contentDraggable: function() {
          var y = j(this),
            K = y.data(d),
            I = K.opt,
            F = d + '_' + K.idx,
            v = j('#mCSB_' + K.idx),
            z = j('#mCSB_' + K.idx + '_container'),
            w = [j('#mCSB_' + K.idx + '_dragger_vertical'), j('#mCSB_' + K.idx + '_dragger_horizontal')],
            E,
            G,
            L,
            M,
            C = [],
            D = [],
            H,
            A,
            u,
            t,
            J,
            x,
            r = 0,
            q,
            s = I.axis === 'yx' ? 'none' : 'all';
          z.bind('touchstart.' + F + ' pointerdown.' + F + ' MSPointerDown.' + F, function(N) {
            if (!i._pointerTouch(N) || n) {
              return;
            }
            var O = z.offset();
            E = i._coordinates(N)[0] - O.top;
            G = i._coordinates(N)[1] - O.left;
          }).bind('touchmove.' + F + ' pointermove.' + F + ' MSPointerMove.' + F, function(Q) {
            if (!i._pointerTouch(Q) || n) {
              return;
            }
            Q.stopImmediatePropagation();
            A = i._getTime();
            var P = v.offset(),
              S = i._coordinates(Q)[0] - P.top,
              U = i._coordinates(Q)[1] - P.left,
              R = 'mcsLinearOut';
            C.push(S);
            D.push(U);
            if (K.overflowed[0]) {
              var O = w[0].parent().height() - w[0].height(),
                T = E - S > 0 && S - E > -(O * K.scrollRatio.y);
            }
            if (K.overflowed[1]) {
              var N = w[1].parent().width() - w[1].width(),
                V = G - U > 0 && U - G > -(N * K.scrollRatio.x);
            }
            if (T || V) {
              Q.preventDefault();
            }
            x = I.axis === 'yx' ? [E - S, G - U] : I.axis === 'x' ? [null, G - U] : [E - S, null];
            z[0].idleTimer = 250;
            if (K.overflowed[0]) {
              B(x[0], r, R, 'y', 'all', true);
            }
            if (K.overflowed[1]) {
              B(x[1], r, R, 'x', s, true);
            }
          });
          v.bind('touchstart.' + F + ' pointerdown.' + F + ' MSPointerDown.' + F, function(N) {
            if (!i._pointerTouch(N) || n) {
              return;
            }
            N.stopImmediatePropagation();
            i._stop(y);
            H = i._getTime();
            var O = v.offset();
            L = i._coordinates(N)[0] - O.top;
            M = i._coordinates(N)[1] - O.left;
            C = [];
            D = [];
          }).bind('touchend.' + F + ' pointerup.' + F + ' MSPointerUp.' + F, function(P) {
            if (!i._pointerTouch(P) || n) {
              return;
            }
            P.stopImmediatePropagation();
            u = i._getTime();
            var N = v.offset(),
              T = i._coordinates(P)[0] - N.top,
              V = i._coordinates(P)[1] - N.left;
            if (u - A > 30) {
              return;
            }
            J = 1000 / (u - H);
            var Q = 'mcsEaseOut',
              R = J < 2.5,
              W = R ? [C[C.length - 2], D[D.length - 2]] : [0, 0];
            t = R ? [T - W[0], V - W[1]] : [T - L, V - M];
            var O = [Math.abs(t[0]), Math.abs(t[1])];
            J = R ? [Math.abs(t[0] / 4), Math.abs(t[1] / 4)] : [J, J];
            var U = [
              Math.abs(z[0].offsetTop) - t[0] * p(O[0] / J[0], J[0]),
              Math.abs(z[0].offsetLeft) - t[1] * p(O[1] / J[1], J[1]),
            ];
            x = I.axis === 'yx' ? [U[0], U[1]] : I.axis === 'x' ? [null, U[1]] : [U[0], null];
            q = [O[0] * 4 + I.scrollInertia, O[1] * 4 + I.scrollInertia];
            var S = parseInt(I.contentTouchScroll) || 0;
            x[0] = O[0] > S ? x[0] : 0;
            x[1] = O[1] > S ? x[1] : 0;
            if (K.overflowed[0]) {
              B(x[0], q[0], Q, 'y', s, false);
            }
            if (K.overflowed[1]) {
              B(x[1], q[1], Q, 'x', s, false);
            }
          });
          function p(P, N) {
            var O = [N * 1.5, N * 2, N / 1.5, N / 2];
            if (P > 90) {
              return N > 4 ? O[0] : O[3];
            } else {
              if (P > 60) {
                return N > 3 ? O[3] : O[2];
              } else {
                if (P > 30) {
                  return N > 8 ? O[1] : N > 6 ? O[0] : N > 4 ? N : O[2];
                } else {
                  return N > 8 ? N : O[3];
                }
              }
            }
          }
          function B(P, R, S, O, N, Q) {
            if (!P) {
              return;
            }
            i._scrollTo(y, P.toString(), { dur: R, scrollEasing: S, dir: O, overwrite: N, drag: Q });
          }
        },
        _mousewheel: function() {
          var s = j(this),
            u = s.data(d);
          if (u) {
            var t = u.opt,
              q = d + '_' + u.idx,
              p = j('#mCSB_' + u.idx),
              r = [j('#mCSB_' + u.idx + '_dragger_vertical'), j('#mCSB_' + u.idx + '_dragger_horizontal')];
            p.bind('mousewheel.' + q, function(z, D) {
              i._stop(s);
              if (i._disableMousewheel(s, z.target)) {
                return;
              }
              var B =
                t.mouseWheel.deltaFactor !== 'auto'
                  ? parseInt(t.mouseWheel.deltaFactor)
                  : k && z.deltaFactor < 100
                  ? 100
                  : z.deltaFactor < 40
                  ? 40
                  : z.deltaFactor || 100;
              if (t.axis === 'x' || t.mouseWheel.axis === 'x') {
                var w = 'x',
                  C = [Math.round(B * u.scrollRatio.x), parseInt(t.mouseWheel.scrollAmount)],
                  y = t.mouseWheel.scrollAmount !== 'auto' ? C[1] : C[0] >= p.width() ? p.width() * 0.9 : C[0],
                  E = Math.abs(j('#mCSB_' + u.idx + '_container')[0].offsetLeft),
                  A = r[1][0].offsetLeft,
                  x = r[1].parent().width() - r[1].width(),
                  v = z.deltaX || z.deltaY || D;
              } else {
                var w = 'y',
                  C = [Math.round(B * u.scrollRatio.y), parseInt(t.mouseWheel.scrollAmount)],
                  y = t.mouseWheel.scrollAmount !== 'auto' ? C[1] : C[0] >= p.height() ? p.height() * 0.9 : C[0],
                  E = Math.abs(j('#mCSB_' + u.idx + '_container')[0].offsetTop),
                  A = r[0][0].offsetTop,
                  x = r[0].parent().height() - r[0].height(),
                  v = z.deltaY || D;
              }
              if ((w === 'y' && !u.overflowed[0]) || (w === 'x' && !u.overflowed[1])) {
                return;
              }
              if (t.mouseWheel.invert) {
                v = -v;
              }
              if (t.mouseWheel.normalizeDelta) {
                v = v < 0 ? -1 : 1;
              }
              if ((v > 0 && A !== 0) || (v < 0 && A !== x) || t.mouseWheel.preventDefault) {
                z.stopImmediatePropagation();
                z.preventDefault();
              }
              i._scrollTo(s, (E - v * y).toString(), { dir: w });
            });
          }
        },
        _disableMousewheel: function(r, t) {
          var p = t.nodeName.toLowerCase(),
            q = r.data(d).opt.mouseWheel.disableOver,
            s = ['select', 'textarea'];
          return j.inArray(p, q) > -1 && !(j.inArray(p, s) > -1 && !j(t).is(':focus'));
        },
        _draggerRail: function() {
          var s = j(this),
            t = s.data(d),
            q = d + '_' + t.idx,
            r = j('#mCSB_' + t.idx + '_container'),
            u = r.parent(),
            p = j('.mCSB_' + t.idx + '_scrollbar .mCSB_draggerContainer');
          p.bind('touchstart.' + q + ' pointerdown.' + q + ' MSPointerDown.' + q, function(v) {
            n = true;
          })
            .bind('touchend.' + q + ' pointerup.' + q + ' MSPointerUp.' + q, function(v) {
              n = false;
            })
            .bind('click.' + q, function(z) {
              if (j(z.target).hasClass('mCSB_draggerContainer') || j(z.target).hasClass('mCSB_draggerRail')) {
                i._stop(s);
                var w = j(this),
                  y = w.find('.mCSB_dragger');
                if (w.parent('.mCSB_scrollTools_horizontal').length > 0) {
                  if (!t.overflowed[1]) {
                    return;
                  }
                  var v = 'x',
                    x = z.pageX > y.offset().left ? -1 : 1,
                    A = Math.abs(r[0].offsetLeft) - x * (u.width() * 0.9);
                } else {
                  if (!t.overflowed[0]) {
                    return;
                  }
                  var v = 'y',
                    x = z.pageY > y.offset().top ? -1 : 1,
                    A = Math.abs(r[0].offsetTop) - x * (u.height() * 0.9);
                }
                i._scrollTo(s, A.toString(), { dir: v, scrollEasing: 'mcsEaseInOut' });
              }
            });
        },
        _focus: function() {
          var r = j(this),
            t = r.data(d),
            s = t.opt,
            p = d + '_' + t.idx,
            q = j('#mCSB_' + t.idx + '_container'),
            u = q.parent();
          q.bind('focusin.' + p, function(x) {
            var w = j(a.activeElement),
              y = q.find('.mCustomScrollBox').length,
              v = 0;
            if (!w.is(s.advanced.autoScrollOnFocus)) {
              return;
            }
            i._stop(r);
            clearTimeout(r[0]._focusTimeout);
            r[0]._focusTimer = y ? (v + 17) * y : 0;
            r[0]._focusTimeout = setTimeout(function() {
              var C = [w.offset().top - q.offset().top, w.offset().left - q.offset().left],
                B = [q[0].offsetTop, q[0].offsetLeft],
                z = [
                  B[0] + C[0] >= 0 && B[0] + C[0] < u.height() - w.outerHeight(false),
                  B[1] + C[1] >= 0 && B[0] + C[1] < u.width() - w.outerWidth(false),
                ],
                A = s.axis === 'yx' && !z[0] && !z[1] ? 'none' : 'all';
              if (s.axis !== 'x' && !z[0]) {
                i._scrollTo(r, C[0].toString(), { dir: 'y', scrollEasing: 'mcsEaseInOut', overwrite: A, dur: v });
              }
              if (s.axis !== 'y' && !z[1]) {
                i._scrollTo(r, C[1].toString(), { dir: 'x', scrollEasing: 'mcsEaseInOut', overwrite: A, dur: v });
              }
            }, r[0]._focusTimer);
          });
        },
        _wrapperScroll: function() {
          var q = j(this),
            r = q.data(d),
            p = d + '_' + r.idx,
            s = j('#mCSB_' + r.idx + '_container').parent();
          s.bind('scroll.' + p, function(t) {
            s.scrollTop(0).scrollLeft(0);
          });
        },
        _buttons: function() {
          var u = j(this),
            w = u.data(d),
            v = w.opt,
            p = w.sequential,
            r = d + '_' + w.idx,
            t = j('#mCSB_' + w.idx + '_container'),
            s = '.mCSB_' + w.idx + '_scrollbar',
            q = j(s + '>a');
          q.bind(
            'mousedown.' +
              r +
              ' touchstart.' +
              r +
              ' pointerdown.' +
              r +
              ' MSPointerDown.' +
              r +
              ' mouseup.' +
              r +
              ' touchend.' +
              r +
              ' pointerup.' +
              r +
              ' MSPointerUp.' +
              r +
              ' mouseout.' +
              r +
              ' pointerout.' +
              r +
              ' MSPointerOut.' +
              r +
              ' click.' +
              r,
            function(z) {
              z.preventDefault();
              if (!i._mouseBtnLeft(z)) {
                return;
              }
              var y = j(this).attr('class');
              p.type = v.scrollButtons.scrollType;
              switch (z.type) {
                case 'mousedown':
                case 'touchstart':
                case 'pointerdown':
                case 'MSPointerDown':
                  if (p.type === 'stepped') {
                    return;
                  }
                  n = true;
                  w.tweenRunning = false;
                  x('on', y);
                  break;
                case 'mouseup':
                case 'touchend':
                case 'pointerup':
                case 'MSPointerUp':
                case 'mouseout':
                case 'pointerout':
                case 'MSPointerOut':
                  if (p.type === 'stepped') {
                    return;
                  }
                  n = false;
                  if (p.dir) {
                    x('off', y);
                  }
                  break;
                case 'click':
                  if (p.type !== 'stepped' || w.tweenRunning) {
                    return;
                  }
                  x('on', y);
                  break;
              }
              function x(A, B) {
                p.scrollAmount = v.snapAmount || v.scrollButtons.scrollAmount;
                i._sequentialScroll.call(this, u, A, B);
              }
            }
          );
        },
        _keyboard: function() {
          var u = j(this),
            t = u.data(d),
            q = t.opt,
            x = t.sequential,
            s = d + '_' + t.idx,
            r = j('#mCSB_' + t.idx),
            w = j('#mCSB_' + t.idx + '_container'),
            p = w.parent(),
            v = "input,textarea,select,datalist,keygen,[contenteditable='true']";
          r.attr('tabindex', '0').bind('blur.' + s + ' keydown.' + s + ' keyup.' + s, function(D) {
            switch (D.type) {
              case 'blur':
                if (t.tweenRunning && x.dir) {
                  y('off', null);
                }
                break;
              case 'keydown':
              case 'keyup':
                var A = D.keyCode ? D.keyCode : D.which,
                  B = 'on';
                if ((q.axis !== 'x' && (A === 38 || A === 40)) || (q.axis !== 'y' && (A === 37 || A === 39))) {
                  if (((A === 38 || A === 40) && !t.overflowed[0]) || ((A === 37 || A === 39) && !t.overflowed[1])) {
                    return;
                  }
                  if (D.type === 'keyup') {
                    B = 'off';
                  }
                  if (!j(a.activeElement).is(v)) {
                    D.preventDefault();
                    D.stopImmediatePropagation();
                    y(B, A);
                  }
                } else {
                  if (A === 33 || A === 34) {
                    if (t.overflowed[0] || t.overflowed[1]) {
                      D.preventDefault();
                      D.stopImmediatePropagation();
                    }
                    if (D.type === 'keyup') {
                      i._stop(u);
                      var C = A === 34 ? -1 : 1;
                      if (q.axis === 'x' || (q.axis === 'yx' && t.overflowed[1] && !t.overflowed[0])) {
                        var z = 'x',
                          E = Math.abs(w[0].offsetLeft) - C * (p.width() * 0.9);
                      } else {
                        var z = 'y',
                          E = Math.abs(w[0].offsetTop) - C * (p.height() * 0.9);
                      }
                      i._scrollTo(u, E.toString(), { dir: z, scrollEasing: 'mcsEaseInOut' });
                    }
                  } else {
                    if (A === 35 || A === 36) {
                      if (!j(a.activeElement).is(v)) {
                        if (t.overflowed[0] || t.overflowed[1]) {
                          D.preventDefault();
                          D.stopImmediatePropagation();
                        }
                        if (D.type === 'keyup') {
                          if (q.axis === 'x' || (q.axis === 'yx' && t.overflowed[1] && !t.overflowed[0])) {
                            var z = 'x',
                              E = A === 35 ? Math.abs(p.width() - w.outerWidth(false)) : 0;
                          } else {
                            var z = 'y',
                              E = A === 35 ? Math.abs(p.height() - w.outerHeight(false)) : 0;
                          }
                          i._scrollTo(u, E.toString(), { dir: z, scrollEasing: 'mcsEaseInOut' });
                        }
                      }
                    }
                  }
                }
                break;
            }
            function y(F, G) {
              x.type = q.keyboard.scrollType;
              x.scrollAmount = q.snapAmount || q.keyboard.scrollAmount;
              if (x.type === 'stepped' && t.tweenRunning) {
                return;
              }
              i._sequentialScroll.call(this, u, F, G);
            }
          });
        },
        _sequentialScroll: function(r, u, s) {
          var w = r.data(d),
            q = w.opt,
            y = w.sequential,
            x = j('#mCSB_' + w.idx + '_container'),
            p = y.type === 'stepped' ? true : false;
          switch (u) {
            case 'on':
              y.dir = [
                s === 'mCSB_buttonRight' || s === 'mCSB_buttonLeft' || s === 39 || s === 37 ? 'x' : 'y',
                s === 'mCSB_buttonUp' || s === 'mCSB_buttonLeft' || s === 38 || s === 37 ? -1 : 1,
              ];
              i._stop(r);
              if (i._isNumeric(s) && y.type === 'stepped') {
                return;
              }
              t(p);
              break;
            case 'off':
              v();
              if (p || (w.tweenRunning && y.dir)) {
                t(true);
              }
              break;
          }
          function t(z) {
            var F = y.type !== 'stepped',
              J = !z ? 1000 / 60 : F ? q.scrollInertia / 1.5 : q.scrollInertia,
              B = !z ? 2.5 : F ? 7.5 : 40,
              I = [Math.abs(x[0].offsetTop), Math.abs(x[0].offsetLeft)],
              E = [w.scrollRatio.y > 10 ? 10 : w.scrollRatio.y, w.scrollRatio.x > 10 ? 10 : w.scrollRatio.x],
              C = y.dir[0] === 'x' ? I[1] + y.dir[1] * (E[1] * B) : I[0] + y.dir[1] * (E[0] * B),
              H =
                y.dir[0] === 'x'
                  ? I[1] + y.dir[1] * parseInt(y.scrollAmount)
                  : I[0] + y.dir[1] * parseInt(y.scrollAmount),
              G = y.scrollAmount !== 'auto' ? H : C,
              D = !z ? 'mcsLinear' : F ? 'mcsLinearOut' : 'mcsEaseInOut',
              A = !z ? false : true;
            if (z && J < 17) {
              G = y.dir[0] === 'x' ? I[1] : I[0];
            }
            i._scrollTo(r, G.toString(), { dir: y.dir[0], scrollEasing: D, dur: J, onComplete: A });
            if (z) {
              y.dir = false;
              return;
            }
            clearTimeout(y.step);
            y.step = setTimeout(function() {
              t();
            }, J);
          }
          function v() {
            clearTimeout(y.step);
            i._stop(r);
          }
        },
        _arr: function(r) {
          var q = j(this).data(d).opt,
            p = [];
          if (typeof r === 'function') {
            r = r();
          }
          if (!(r instanceof Array)) {
            p[0] = r.y ? r.y : r.x || q.axis === 'x' ? null : r;
            p[1] = r.x ? r.x : r.y || q.axis === 'y' ? null : r;
          } else {
            p = r.length > 1 ? [r[0], r[1]] : q.axis === 'x' ? [null, r[0]] : [r[0], null];
          }
          if (typeof p[0] === 'function') {
            p[0] = p[0]();
          }
          if (typeof p[1] === 'function') {
            p[1] = p[1]();
          }
          return p;
        },
        _to: function(v, w) {
          if (v == null || typeof v == 'undefined') {
            return;
          }
          var C = j(this),
            B = C.data(d),
            u = B.opt,
            D = j('#mCSB_' + B.idx + '_container'),
            r = D.parent(),
            F = typeof v;
          if (!w) {
            w = u.axis === 'x' ? 'x' : 'y';
          }
          var q = w === 'x' ? D.outerWidth(false) : D.outerHeight(false),
            x = w === 'x' ? D.offset().left : D.offset().top,
            E = w === 'x' ? D[0].offsetLeft : D[0].offsetTop,
            z = w === 'x' ? 'left' : 'top';
          switch (F) {
            case 'function':
              return v();
              break;
            case 'object':
              if (v.nodeType) {
                var A = w === 'x' ? j(v).offset().left : j(v).offset().top;
              } else {
                if (v.jquery) {
                  if (!v.length) {
                    return;
                  }
                  var A = w === 'x' ? v.offset().left : v.offset().top;
                }
              }
              return A - x;
              break;
            case 'string':
            case 'number':
              if (i._isNumeric.call(null, v)) {
                return Math.abs(v);
              } else {
                if (v.indexOf('%') !== -1) {
                  return Math.abs((q * parseInt(v)) / 100);
                } else {
                  if (v.indexOf('-=') !== -1) {
                    return Math.abs(E - parseInt(v.split('-=')[1]));
                  } else {
                    if (v.indexOf('+=') !== -1) {
                      var s = E + parseInt(v.split('+=')[1]);
                      return s >= 0 ? 0 : Math.abs(s);
                    } else {
                      if (v.indexOf('px') !== -1 && i._isNumeric.call(null, v.split('px')[0])) {
                        return Math.abs(v.split('px')[0]);
                      } else {
                        if (v === 'top' || v === 'left') {
                          return 0;
                        } else {
                          if (v === 'bottom') {
                            return Math.abs(r.height() - D.outerHeight(false));
                          } else {
                            if (v === 'right') {
                              return Math.abs(r.width() - D.outerWidth(false));
                            } else {
                              if (v === 'first' || v === 'last') {
                                var y = D.find(':' + v),
                                  A = w === 'x' ? j(y).offset().left : j(y).offset().top;
                                return A - x;
                              } else {
                                if (j(v).length) {
                                  var A = w === 'x' ? j(v).offset().left : j(v).offset().top;
                                  return A - x;
                                } else {
                                  D.css(z, v);
                                  e.update.call(null, C[0]);
                                  return;
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
              break;
          }
        },
        _autoUpdate: function(q) {
          var t = j(this),
            F = t.data(d),
            z = F.opt,
            v = j('#mCSB_' + F.idx + '_container');
          if (q) {
            clearTimeout(v[0].autoUpdate);
            i._delete.call(null, v[0].autoUpdate);
            return;
          }
          var s = v.parent(),
            p = [j('#mCSB_' + F.idx + '_scrollbar_vertical'), j('#mCSB_' + F.idx + '_scrollbar_horizontal')],
            D = function() {
              return [
                p[0].is(':visible') ? p[0].outerHeight(true) : 0,
                p[1].is(':visible') ? p[1].outerWidth(true) : 0,
              ];
            },
            E = y(),
            x,
            u = [v.outerHeight(false), v.outerWidth(false), s.height(), s.width(), D()[0], D()[1]],
            H,
            B = G(),
            w;
          C();
          function C() {
            clearTimeout(v[0].autoUpdate);
            v[0].autoUpdate = setTimeout(function() {
              if (z.advanced.updateOnSelectorChange) {
                x = y();
                if (x !== E) {
                  r();
                  E = x;
                  return;
                }
              }
              if (z.advanced.updateOnContentResize) {
                H = [v.outerHeight(false), v.outerWidth(false), s.height(), s.width(), D()[0], D()[1]];
                if (
                  H[0] !== u[0] ||
                  H[1] !== u[1] ||
                  H[2] !== u[2] ||
                  H[3] !== u[3] ||
                  H[4] !== u[4] ||
                  H[5] !== u[5]
                ) {
                  r();
                  u = H;
                }
              }
              if (z.advanced.updateOnImageLoad) {
                w = G();
                if (w !== B) {
                  v.find('img').each(function() {
                    A(this.src);
                  });
                  B = w;
                }
              }
              if (
                z.advanced.updateOnSelectorChange ||
                z.advanced.updateOnContentResize ||
                z.advanced.updateOnImageLoad
              ) {
                C();
              }
            }, 60);
          }
          function G() {
            var I = 0;
            if (z.advanced.updateOnImageLoad) {
              I = v.find('img').length;
            }
            return I;
          }
          function A(L) {
            var I = new Image();
            function K(M, N) {
              return function() {
                return N.apply(M, arguments);
              };
            }
            function J() {
              this.onload = null;
              r();
            }
            I.onload = K(I, J);
            I.src = L;
          }
          function y() {
            if (z.advanced.updateOnSelectorChange === true) {
              z.advanced.updateOnSelectorChange = '*';
            }
            var I = 0,
              J = v.find(z.advanced.updateOnSelectorChange);
            if (z.advanced.updateOnSelectorChange && J.length > 0) {
              J.each(function() {
                I += j(this).height() + j(this).width();
              });
            }
            return I;
          }
          function r() {
            clearTimeout(v[0].autoUpdate);
            e.update.call(null, t[0]);
          }
        },
        _snapAmount: function(r, p, q) {
          return Math.round(r / p) * p - q;
        },
        _stop: function(p) {
          var r = p.data(d),
            q = j(
              '#mCSB_' +
                r.idx +
                '_container,#mCSB_' +
                r.idx +
                '_container_wrapper,#mCSB_' +
                r.idx +
                '_dragger_vertical,#mCSB_' +
                r.idx +
                '_dragger_horizontal'
            );
          q.each(function() {
            i._stopTween.call(this);
          });
        },
        _scrollTo: function(q, s, u) {
          var I = q.data(d),
            E = I.opt,
            D = {
              trigger: 'internal',
              dir: 'y',
              scrollEasing: 'mcsEaseOut',
              drag: false,
              dur: E.scrollInertia,
              overwrite: 'all',
              callbacks: true,
              onStart: true,
              onUpdate: true,
              onComplete: true,
            },
            u = j.extend(D, u),
            G = [u.dur, u.drag ? 0 : u.dur],
            v = j('#mCSB_' + I.idx),
            B = j('#mCSB_' + I.idx + '_container'),
            K = E.callbacks.onTotalScrollOffset ? i._arr.call(q, E.callbacks.onTotalScrollOffset) : [0, 0],
            p = E.callbacks.onTotalScrollBackOffset ? i._arr.call(q, E.callbacks.onTotalScrollBackOffset) : [0, 0];
          I.trigger = u.trigger;
          if (E.snapAmount) {
            s = i._snapAmount(s, E.snapAmount, E.snapOffset);
          }
          switch (u.dir) {
            case 'x':
              var x = j('#mCSB_' + I.idx + '_dragger_horizontal'),
                z = 'left',
                C = B[0].offsetLeft,
                H = [v.width() - B.outerWidth(false), x.parent().width() - x.width()],
                r = [s, s / I.scrollRatio.x],
                L = K[1],
                J = p[1],
                A = L > 0 ? L / I.scrollRatio.x : 0,
                w = J > 0 ? J / I.scrollRatio.x : 0;
              break;
            case 'y':
              var x = j('#mCSB_' + I.idx + '_dragger_vertical'),
                z = 'top',
                C = B[0].offsetTop,
                H = [v.height() - B.outerHeight(false), x.parent().height() - x.height()],
                r = [s, s / I.scrollRatio.y],
                L = K[0],
                J = p[0],
                A = L > 0 ? L / I.scrollRatio.y : 0,
                w = J > 0 ? J / I.scrollRatio.y : 0;
              break;
          }
          if (r[1] < 0) {
            r = [0, 0];
          } else {
            if (r[1] >= H[1]) {
              r = [H[0], H[1]];
            } else {
              r[0] = -r[0];
            }
          }
          clearTimeout(B[0].onCompleteTimeout);
          if (!I.tweenRunning && ((C === 0 && r[0] >= 0) || (C === H[0] && r[0] <= H[0]))) {
            return;
          }
          i._tweenTo.call(null, x[0], z, Math.round(r[1]), G[1], u.scrollEasing);
          i._tweenTo.call(null, B[0], z, Math.round(r[0]), G[0], u.scrollEasing, u.overwrite, {
            onStart: function() {
              if (u.callbacks && u.onStart && !I.tweenRunning) {
                if (t('onScrollStart')) {
                  F();
                  E.callbacks.onScrollStart.call(q[0]);
                }
                I.tweenRunning = true;
                i._onDragClasses(x);
                I.cbOffsets = y();
              }
            },
            onUpdate: function() {
              if (u.callbacks && u.onUpdate) {
                if (t('whileScrolling')) {
                  F();
                  E.callbacks.whileScrolling.call(q[0]);
                }
              }
            },
            onComplete: function() {
              if (u.callbacks && u.onComplete) {
                if (E.axis === 'yx') {
                  clearTimeout(B[0].onCompleteTimeout);
                }
                var M = B[0].idleTimer || 0;
                B[0].onCompleteTimeout = setTimeout(function() {
                  if (t('onScroll')) {
                    F();
                    E.callbacks.onScroll.call(q[0]);
                  }
                  if (t('onTotalScroll') && r[1] >= H[1] - A && I.cbOffsets[0]) {
                    F();
                    E.callbacks.onTotalScroll.call(q[0]);
                  }
                  if (t('onTotalScrollBack') && r[1] <= w && I.cbOffsets[1]) {
                    F();
                    E.callbacks.onTotalScrollBack.call(q[0]);
                  }
                  I.tweenRunning = false;
                  B[0].idleTimer = 0;
                  i._onDragClasses(x, 'hide');
                }, M);
              }
            },
          });
          function t(M) {
            return I && E.callbacks[M] && typeof E.callbacks[M] === 'function';
          }
          function y() {
            return [E.callbacks.alwaysTriggerOffsets || C >= H[0] + L, E.callbacks.alwaysTriggerOffsets || C <= -J];
          }
          function F() {
            var O = [B[0].offsetTop, B[0].offsetLeft],
              P = [x[0].offsetTop, x[0].offsetLeft],
              M = [B.outerHeight(false), B.outerWidth(false)],
              N = [v.height(), v.width()];
            q[0].mcs = {
              content: B,
              top: O[0],
              left: O[1],
              draggerTop: P[0],
              draggerLeft: P[1],
              topPct: Math.round((100 * Math.abs(O[0])) / (Math.abs(M[0]) - N[0])),
              leftPct: Math.round((100 * Math.abs(O[1])) / (Math.abs(M[1]) - N[1])),
              direction: u.dir,
            };
          }
        },
        _tweenTo: function(r, u, s, q, A, t, J) {
          var J = J || {},
            G = J.onStart || function() {},
            B = J.onUpdate || function() {},
            H = J.onComplete || function() {},
            z = i._getTime(),
            x,
            v = 0,
            D = r.offsetTop,
            E = r.style;
          if (u === 'left') {
            D = r.offsetLeft;
          }
          var y = s - D;
          r._mcsstop = 0;
          if (t !== 'none') {
            C();
          }
          p();
          function I() {
            if (r._mcsstop) {
              return;
            }
            if (!v) {
              G.call();
            }
            v = i._getTime() - z;
            F();
            if (v >= r._mcstime) {
              r._mcstime = v > r._mcstime ? v + x - (v - r._mcstime) : v + x - 1;
              if (r._mcstime < v + 1) {
                r._mcstime = v + 1;
              }
            }
            if (r._mcstime < q) {
              r._mcsid = _request(I);
            } else {
              H.call();
            }
          }
          function F() {
            if (q > 0) {
              r._mcscurrVal = w(r._mcstime, D, y, q, A);
              E[u] = Math.round(r._mcscurrVal) + 'px';
            } else {
              E[u] = s + 'px';
            }
            B.call();
          }
          function p() {
            x = 1000 / 60;
            r._mcstime = v + x;
            _request = !b.requestAnimationFrame
              ? function(K) {
                  F();
                  return setTimeout(K, 0.01);
                }
              : b.requestAnimationFrame;
            r._mcsid = _request(I);
          }
          function C() {
            if (r._mcsid == null) {
              return;
            }
            if (!b.requestAnimationFrame) {
              clearTimeout(r._mcsid);
            } else {
              b.cancelAnimationFrame(r._mcsid);
            }
            r._mcsid = null;
          }
          function w(M, L, Q, P, N) {
            switch (N) {
              case 'linear':
              case 'mcsLinear':
                return (Q * M) / P + L;
                break;
              case 'mcsLinearOut':
                M /= P;
                M--;
                return Q * Math.sqrt(1 - M * M) + L;
                break;
              case 'easeInOutSmooth':
                M /= P / 2;
                if (M < 1) {
                  return (Q / 2) * M * M + L;
                }
                M--;
                return (-Q / 2) * (M * (M - 2) - 1) + L;
                break;
              case 'easeInOutStrong':
                M /= P / 2;
                if (M < 1) {
                  return (Q / 2) * Math.pow(2, 10 * (M - 1)) + L;
                }
                M--;
                return (Q / 2) * (-Math.pow(2, -10 * M) + 2) + L;
                break;
              case 'easeInOut':
              case 'mcsEaseInOut':
                M /= P / 2;
                if (M < 1) {
                  return (Q / 2) * M * M * M + L;
                }
                M -= 2;
                return (Q / 2) * (M * M * M + 2) + L;
                break;
              case 'easeOutSmooth':
                M /= P;
                M--;
                return -Q * (M * M * M * M - 1) + L;
                break;
              case 'easeOutStrong':
                return Q * (-Math.pow(2, (-10 * M) / P) + 1) + L;
                break;
              case 'easeOut':
              case 'mcsEaseOut':
              default:
                var O = (M /= P) * M,
                  K = O * M;
                return L + Q * (0.499999999999997 * K * O + -2.5 * O * O + 5.5 * K + -6.5 * O + 4 * M);
            }
          }
        },
        _getTime: function() {
          if (b.performance && b.performance.now) {
            return b.performance.now();
          } else {
            if (b.performance && b.performance.webkitNow) {
              return b.performance.webkitNow();
            } else {
              if (Date.now) {
                return Date.now();
              } else {
                return new Date().getTime();
              }
            }
          }
        },
        _stopTween: function() {
          var p = this;
          if (p._mcsid == null) {
            return;
          }
          if (!b.requestAnimationFrame) {
            clearTimeout(p._mcsid);
          } else {
            b.cancelAnimationFrame(p._mcsid);
          }
          p._mcsid = null;
          p._mcsstop = 1;
        },
        _delete: function(r) {
          try {
            delete r;
          } catch (q) {
            r = null;
          }
        },
        _mouseBtnLeft: function(p) {
          return !(p.which && p.which !== 1);
        },
        _pointerTouch: function(q) {
          var p = q.originalEvent.pointerType;
          return !(p && p !== 'touch' && p !== 2);
        },
        _isNumeric: function(p) {
          return !isNaN(parseFloat(p)) && isFinite(p);
        },
      };
    j.fn[g] = function(p) {
      if (e[p]) {
        return e[p].apply(this, Array.prototype.slice.call(arguments, 1));
      } else {
        if (typeof p === 'object' || !p) {
          return e.init.apply(this, arguments);
        } else {
          j.error('Method ' + p + ' does not exist');
        }
      }
    };
    j[g] = function(p) {
      if (e[p]) {
        return e[p].apply(this, Array.prototype.slice.call(arguments, 1));
      } else {
        if (typeof p === 'object' || !p) {
          return e.init.apply(this, arguments);
        } else {
          j.error('Method ' + p + ' does not exist');
        }
      }
    };
    j[g].defaults = h;
    b[g] = true;
    j(b).load(function() {
      j(m)[g]();
    });
  });
})(window, document);

/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 3.1.12
 *
 * Requires: jQuery 1.2.2+
 */
!(function(a) {
  'function' == typeof define && define.amd
    ? define(['jquery'], a)
    : 'object' == typeof exports
    ? (module.exports = a)
    : a(jQuery);
})(function(a) {
  function b(b) {
    var g = b || window.event,
      h = i.call(arguments, 1),
      j = 0,
      l = 0,
      m = 0,
      n = 0,
      o = 0,
      p = 0;
    if (
      ((b = a.event.fix(g)),
      (b.type = 'mousewheel'),
      'detail' in g && (m = -1 * g.detail),
      'wheelDelta' in g && (m = g.wheelDelta),
      'wheelDeltaY' in g && (m = g.wheelDeltaY),
      'wheelDeltaX' in g && (l = -1 * g.wheelDeltaX),
      'axis' in g && g.axis === g.HORIZONTAL_AXIS && ((l = -1 * m), (m = 0)),
      (j = 0 === m ? l : m),
      'deltaY' in g && ((m = -1 * g.deltaY), (j = m)),
      'deltaX' in g && ((l = g.deltaX), 0 === m && (j = -1 * l)),
      0 !== m || 0 !== l)
    ) {
      if (1 === g.deltaMode) {
        var q = a.data(this, 'mousewheel-line-height');
        (j *= q), (m *= q), (l *= q);
      } else if (2 === g.deltaMode) {
        var r = a.data(this, 'mousewheel-page-height');
        (j *= r), (m *= r), (l *= r);
      }
      if (
        ((n = Math.max(Math.abs(m), Math.abs(l))),
        (!f || f > n) && ((f = n), d(g, n) && (f /= 40)),
        d(g, n) && ((j /= 40), (l /= 40), (m /= 40)),
        (j = Math[j >= 1 ? 'floor' : 'ceil'](j / f)),
        (l = Math[l >= 1 ? 'floor' : 'ceil'](l / f)),
        (m = Math[m >= 1 ? 'floor' : 'ceil'](m / f)),
        k.settings.normalizeOffset && this.getBoundingClientRect)
      ) {
        var s = this.getBoundingClientRect();
        (o = b.clientX - s.left), (p = b.clientY - s.top);
      }
      return (
        (b.deltaX = l),
        (b.deltaY = m),
        (b.deltaFactor = f),
        (b.offsetX = o),
        (b.offsetY = p),
        (b.deltaMode = 0),
        h.unshift(b, j, l, m),
        e && clearTimeout(e),
        (e = setTimeout(c, 200)),
        (a.event.dispatch || a.event.handle).apply(this, h)
      );
    }
  }
  function c() {
    f = null;
  }
  function d(a, b) {
    return k.settings.adjustOldDeltas && 'mousewheel' === a.type && b % 120 === 0;
  }
  var e,
    f,
    g = ['wheel', 'mousewheel', 'DOMMouseScroll', 'MozMousePixelScroll'],
    h =
      'onwheel' in document || document.documentMode >= 9
        ? ['wheel']
        : ['mousewheel', 'DomMouseScroll', 'MozMousePixelScroll'],
    i = Array.prototype.slice;
  if (a.event.fixHooks) for (var j = g.length; j; ) a.event.fixHooks[g[--j]] = a.event.mouseHooks;
  var k = (a.event.special.mousewheel = {
    version: '3.1.12',
    setup: function() {
      if (this.addEventListener) for (var c = h.length; c; ) this.addEventListener(h[--c], b, !1);
      else this.onmousewheel = b;
      a.data(this, 'mousewheel-line-height', k.getLineHeight(this)),
        a.data(this, 'mousewheel-page-height', k.getPageHeight(this));
    },
    teardown: function() {
      if (this.removeEventListener) for (var c = h.length; c; ) this.removeEventListener(h[--c], b, !1);
      else this.onmousewheel = null;
      a.removeData(this, 'mousewheel-line-height'), a.removeData(this, 'mousewheel-page-height');
    },
    getLineHeight: function(b) {
      var c = a(b),
        d = c['offsetParent' in a.fn ? 'offsetParent' : 'parent']();
      return d.length || (d = a('body')), parseInt(d.css('fontSize'), 10) || parseInt(c.css('fontSize'), 10) || 16;
    },
    getPageHeight: function(b) {
      return a(b).height();
    },
    settings: { adjustOldDeltas: !0, normalizeOffset: !0 },
  });
  a.fn.extend({
    mousewheel: function(a) {
      return a ? this.bind('mousewheel', a) : this.trigger('mousewheel');
    },
    unmousewheel: function(a) {
      return this.unbind('mousewheel', a);
    },
  });
});

/*! Selectric ϟ v1.6.7 (2014-05-02) - git.io/tjl9sQ - Copyright (c) 2014 Leonardo Santos - Dual licensed: MIT/GPL */
!(function(a) {
  var b = 'selectric',
    c = function(a) {
      var b,
        c = '40-46 50-53 54-57 62-70 71-74 61 47 77'.replace(/\d+/g, '\\3$&').split(' ');
      for (b in c) {
        if (!c.hasOwnProperty(b)) return;
        a = a.toLowerCase().replace(RegExp('[' + c[b] + ']', 'g'), 'aeiouncy'.charAt(b));
      }
      return a;
    },
    d = function(a) {
      var b = arguments;
      return ('' + a).replace(/{(\d+|(\w+))}/g, function(a, c, d) {
        return d && b[1] ? b[1][d] : b[c];
      });
    },
    e = function(e, f) {
      function g() {
        function e(a) {
          /^(9|13|27)$/.test(a.keyCode || a.which) && (a.stopPropagation(), l(x, !0));
        }
        var g = D.children();
        (_$li = '<ul>'),
          (selectedIndex = g.filter(':' + R).index()),
          (y = x = ~selectedIndex ? selectedIndex : 0),
          (C = g.length) &&
            (g.each(function(b) {
              var e = a(this),
                g = e.html(),
                h = e.prop('disabled'),
                i = f.optionsItemBuilder;
              (I[b] = { value: e.val(), text: g, slug: c(g), disabled: h }),
                (_$li += d(
                  '<li class="{1}">{2}</li>',
                  a.trim([b == y ? R : '', b == C - 1 ? 'last' : '', h ? 'disabled' : ''].join(' ')),
                  a.isFunction(i) ? i(I[b], e, b) : d(i, I[b])
                ));
            }),
            G.html(_$li + '</ul>'),
            J.html(I[y].text)),
          F.add(D).off(K),
          H.data(b, !0).prop('class', [s[6], D.prop('class'), P, f.responsive ? s[8] : ''].join(' ')),
          D.prop('disabled')
            ? E.prop('disabled', !0)
            : (H.removeClass(P).hover(function() {
                a(this).toggleClass(s[7]);
              }),
              f.openOnHover && F.on('mouseenter' + K, i),
              F.on(N, function(a) {
                u ? k() : i(a);
              }),
              E.prop('disabled', !1)
                .off()
                .on({
                  keypress: e,
                  keydown: function(a) {
                    e(a),
                      clearTimeout(w),
                      (w = setTimeout(function() {
                        E.val('');
                      }, f.keySearchTimeout));
                    var b = a.keyCode || a.which;
                    b > 36 && 41 > b && l(39 > b ? o() : n());
                  },
                  focusin: function(a) {
                    E.one('blur', function() {
                      E.blur();
                    }),
                      u || i(a);
                  },
                })
                .on(S, function() {
                  E.val().length &&
                    a.each(I, function(a, b) {
                      return RegExp('^' + E.val(), 'i').test(b.slug) && !b.disabled ? (l(a), !1) : void 0;
                    });
                }),
              (v = a('li', G.removeAttr('style')).click(function() {
                return l(a(this).index(), !0), !1;
              })));
      }
      function h() {
        var a = G.closest(':visible').children(':hidden'),
          b = f.maxHeight;
        a.addClass(Q);
        var c = G.outerWidth(),
          d = F.outerWidth() - (c - G.width());
        !f.expandToItemText || d > c
          ? (B = d)
          : (G.css('overflow', 'scroll'), H.width(9e4), (B = G.width()), G.css('overflow', ''), H.width('')),
          G.width(B).height() > b && G.height(b),
          a.removeClass(Q);
      }
      function i(b) {
        b.preventDefault(),
          b.stopPropagation(),
          h(),
          a('.' + O).removeClass(O),
          (u = !0),
          (z = G.outerHeight()),
          E.val('').is(':focus') || E.focus(),
          L.on(N, k).on('scroll' + K, j),
          j(),
          f.openOnHover &&
            (clearTimeout(A),
            H.one('mouseleave' + K, function() {
              A = setTimeout(k, 500);
            })),
          H.addClass(O),
          m(x),
          f.onOpen(e);
      }
      function j() {
        h(), G.css('top', H.offset().top + H.outerHeight() + z > M.scrollTop() + M.height() ? -z : '');
      }
      function k(a) {
        if (!a && y != x) {
          var b = I[x].text;
          D.prop('selectedIndex', (y = x))
            .data('value', b)
            .trigger('change', [b, y]),
            f.onChange(e),
            J.html(b);
        }
        L.off(K), H.removeClass(O), (u = !1), f.onClose(e);
      }
      function l(a, b) {
        I[(x = a)].disabled ||
          (v
            .removeClass(R)
            .eq(a)
            .addClass(R),
          m(a),
          b && k());
      }
      function m(a) {
        var b = v.eq(a).outerHeight(),
          c = v[a].offsetTop,
          d = G.scrollTop(),
          e = c + 2 * b;
        G.scrollTop(e > d + z ? e - z : d > c - b ? c - b : d);
      }
      function n(a) {
        if (I[(a = (x + 1) % C)].disabled) for (; I[(a = (a + 1) % C)].disabled; );
        return a;
      }
      function o(a) {
        if (I[(a = (x > 0 ? x : C) - 1)].disabled) for (; I[(a = (a > 0 ? a : C) - 1)].disabled; );
        return a;
      }
      var p,
        f = a.extend(
          !0,
          {
            onOpen: a.noop,
            onClose: a.noop,
            onChange: a.noop,
            maxHeight: 300,
            keySearchTimeout: 500,
            arrowButtonMarkup: '<b class="button">&#x25be;</b>',
            disableOnMobile: !0,
            openOnHover: !1,
            expandToItemText: !1,
            responsive: !1,
            customClass: {
              prefix: 'selectric',
              postfixes: 'Input Items Open Disabled TempShow HideSelect Wrapper Hover Responsive',
              camelCase: !0,
            },
            optionsItemBuilder: '{text}',
          },
          f
        ),
        q = f.customClass,
        r = q.postfixes.split(' '),
        s = [];
      if (!f.disableOnMobile || !/android|ip(hone|od|ad)/i.test(navigator.userAgent)) {
        for (; (p = r.shift()); ) {
          var t = q.prefix + p;
          s.push(q.camelCase ? t : t.replace(/([A-Z])/g, '-$&').toLowerCase());
        }
        var u,
          v,
          w,
          x,
          y,
          z,
          A,
          B,
          C,
          D = a(e),
          E = a('<input type="text" class="' + s[0] + '"/>'),
          F = a('<div class="' + q.prefix + '"><p class="label"/>' + f.arrowButtonMarkup + '</div>'),
          G = a('<div class="' + s[1] + '" tabindex="-1"></div>'),
          H = D.data(b, !0)
            .wrap('<div>')
            .parent()
            .append(F.add(G).add(E)),
          I = [],
          J = a('.label', F),
          K = '.sl',
          L = a(document),
          M = a(window),
          N = 'click' + K,
          O = s[2],
          P = s[3],
          Q = s[4],
          R = 'selected',
          S = 'oninput' in E[0] ? 'input' : 'keyup';
        D.wrap('<div class="' + s[5] + '">'),
          g(),
          D.on({
            refresh: g,
            destroy: function() {
              G.add(F)
                .add(E)
                .remove(),
                D.removeData(b)
                  .removeData('value')
                  .off(K + ' refresh destroy open close')
                  .unwrap()
                  .unwrap();
            },
            open: i,
            close: k,
          });
      }
    };
  a.fn[b] = function(c, d) {
    return this.each(function() {
      a(this).data(b) ? '' + c === c && a(this).trigger(c) : e(this, c || d);
    });
  };
})(jQuery);

/*!
 * Shuffle.js by @Vestride
 * Categorize, sort, and filter a responsive grid of items.
 * Dependencies: jQuery 1.9+, Modernizr 2.6.2+
 * @license MIT license
 * @version 2.1.1
 */

/* Modernizr 2.6.2 (Custom Build) | MIT & BSD
 * Build: http://modernizr.com/download/#-csstransforms-csstransforms3d-csstransitions-cssclasses-prefixed-teststyles-testprop-testallprops-prefixes-domprefixes
 */
window.Modernizr = (function(a, b, c) {
  function z(a) {
    j.cssText = a;
  }
  function A(a, b) {
    return z(m.join(a + ';') + (b || ''));
  }
  function B(a, b) {
    return typeof a === b;
  }
  function C(a, b) {
    return !!~('' + a).indexOf(b);
  }
  function D(a, b) {
    for (var d in a) {
      var e = a[d];
      if (!C(e, '-') && j[e] !== c) return b == 'pfx' ? e : !0;
    }
    return !1;
  }
  function E(a, b, d) {
    for (var e in a) {
      var f = b[a[e]];
      if (f !== c) return d === !1 ? a[e] : B(f, 'function') ? f.bind(d || b) : f;
    }
    return !1;
  }
  function F(a, b, c) {
    var d = a.charAt(0).toUpperCase() + a.slice(1),
      e = (a + ' ' + o.join(d + ' ') + d).split(' ');
    return B(b, 'string') || B(b, 'undefined')
      ? D(e, b)
      : ((e = (a + ' ' + p.join(d + ' ') + d).split(' ')), E(e, b, c));
  }
  var d = '2.6.2',
    e = {},
    f = !0,
    g = b.documentElement,
    h = 'modernizr',
    i = b.createElement(h),
    j = i.style,
    k,
    l = {}.toString,
    m = ' -webkit- -moz- -o- -ms- '.split(' '),
    n = 'Webkit Moz O ms',
    o = n.split(' '),
    p = n.toLowerCase().split(' '),
    q = {},
    r = {},
    s = {},
    t = [],
    u = t.slice,
    v,
    w = function(a, c, d, e) {
      var f,
        i,
        j,
        k,
        l = b.createElement('div'),
        m = b.body,
        n = m || b.createElement('body');
      if (parseInt(d, 10)) while (d--) (j = b.createElement('div')), (j.id = e ? e[d] : h + (d + 1)), l.appendChild(j);
      return (
        (f = ['&#173;', '<style id="s', h, '">', a, '</style>'].join('')),
        (l.id = h),
        ((m ? l : n).innerHTML += f),
        n.appendChild(l),
        m ||
          ((n.style.background = ''),
          (n.style.overflow = 'hidden'),
          (k = g.style.overflow),
          (g.style.overflow = 'hidden'),
          g.appendChild(n)),
        (i = c(l, a)),
        m ? l.parentNode.removeChild(l) : (n.parentNode.removeChild(n), (g.style.overflow = k)),
        !!i
      );
    },
    x = {}.hasOwnProperty,
    y;
  !B(x, 'undefined') && !B(x.call, 'undefined')
    ? (y = function(a, b) {
        return x.call(a, b);
      })
    : (y = function(a, b) {
        return b in a && B(a.constructor.prototype[b], 'undefined');
      }),
    Function.prototype.bind ||
      (Function.prototype.bind = function(b) {
        var c = this;
        if (typeof c != 'function') throw new TypeError();
        var d = u.call(arguments, 1),
          e = function() {
            if (this instanceof e) {
              var a = function() {};
              a.prototype = c.prototype;
              var f = new a(),
                g = c.apply(f, d.concat(u.call(arguments)));
              return Object(g) === g ? g : f;
            }
            return c.apply(b, d.concat(u.call(arguments)));
          };
        return e;
      }),
    (q.csstransforms = function() {
      return !!F('transform');
    }),
    (q.csstransforms3d = function() {
      var a = !!F('perspective');
      return (
        a &&
          'webkitPerspective' in g.style &&
          w(
            '@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}',
            function(b, c) {
              a = b.offsetLeft === 9 && b.offsetHeight === 3;
            }
          ),
        a
      );
    }),
    (q.csstransitions = function() {
      return F('transition');
    });
  for (var G in q) y(q, G) && ((v = G.toLowerCase()), (e[v] = q[G]()), t.push((e[v] ? '' : 'no-') + v));
  return (
    (e.addTest = function(a, b) {
      if (typeof a == 'object') for (var d in a) y(a, d) && e.addTest(d, a[d]);
      else {
        a = a.toLowerCase();
        if (e[a] !== c) return e;
        (b = typeof b == 'function' ? b() : b),
          typeof f != 'undefined' && f && (g.className += ' ' + (b ? '' : 'no-') + a),
          (e[a] = b);
      }
      return e;
    }),
    z(''),
    (i = k = null),
    (e._version = d),
    (e._prefixes = m),
    (e._domPrefixes = p),
    (e._cssomPrefixes = o),
    (e.testProp = function(a) {
      return D([a]);
    }),
    (e.testAllProps = F),
    (e.testStyles = w),
    (e.prefixed = function(a, b, c) {
      return b ? F(a, b, c) : F(a, 'pfx');
    }),
    (g.className = g.className.replace(/(^|\s)no-js(\s|$)/, '$1$2') + (f ? ' js ' + t.join(' ') : '')),
    e
  );
})(this, this.document);

(function(factory) {
  if (typeof define === 'function' && define.amd) {
    define(['jquery', 'modernizr'], factory);
  } else {
    factory(window.$, window.Modernizr);
  }
})(function($, Modernizr, undefined) {
  'use strict';

  // Validate Modernizr exists.
  // Shuffle requires `csstransitions`, `csstransforms`, `csstransforms3d`,
  // and `prefixed` to exist on the Modernizr object.
  if (typeof Modernizr !== 'object') {
    throw new Error('Shuffle.js requires Modernizr.\n' + 'http://vestride.github.io/Shuffle/#dependencies');
  }

  /**
   * Returns css prefixed properties like `-webkit-transition` or `box-sizing`
   * from `transition` or `boxSizing`, respectively.
   * @param {(string|boolean)} prop Property to be prefixed.
   * @return {string} The prefixed css property.
   */
  function dashify(prop) {
    if (!prop) {
      return '';
    }

    // Replace upper case with dash-lowercase,
    // then fix ms- prefixes because they're not capitalized.
    return prop
      .replace(/([A-Z])/g, function(str, m1) {
        return '-' + m1.toLowerCase();
      })
      .replace(/^ms-/, '-ms-');
  }

  // Constant, prefixed variables.
  var TRANSITION = Modernizr.prefixed('transition');
  var TRANSITION_DELAY = Modernizr.prefixed('transitionDelay');
  var TRANSITION_DURATION = Modernizr.prefixed('transitionDuration');
  var TRANSITIONEND = {
    WebkitTransition: 'webkitTransitionEnd',
    transition: 'transitionend',
  }[TRANSITION];
  var TRANSFORM = Modernizr.prefixed('transform');
  var CSS_TRANSFORM = dashify(TRANSFORM);

  // Constants
  var CAN_TRANSITION_TRANSFORMS = Modernizr.csstransforms && Modernizr.csstransitions;
  var HAS_TRANSFORMS_3D = Modernizr.csstransforms3d;
  var SHUFFLE = 'shuffle';

  // Configurable. You can change these constants to fit your application.
  // The default scale and concealed scale, however, have to be different values.
  var ALL_ITEMS = 'all';
  var FILTER_ATTRIBUTE_KEY = 'groups';
  var DEFAULT_SCALE = 1;
  var CONCEALED_SCALE = 0.001;

  // Underscore's throttle function.
  function throttle(func, wait, options) {
    var context, args, result;
    var timeout = null;
    var previous = 0;
    options = options || {};
    var later = function() {
      previous = options.leading === false ? 0 : $.now();
      timeout = null;
      result = func.apply(context, args);
      context = args = null;
    };
    return function() {
      var now = $.now();
      if (!previous && options.leading === false) {
        previous = now;
      }
      var remaining = wait - (now - previous);
      context = this;
      args = arguments;
      if (remaining <= 0 || remaining > wait) {
        clearTimeout(timeout);
        timeout = null;
        previous = now;
        result = func.apply(context, args);
        context = args = null;
      } else if (!timeout && options.trailing !== false) {
        timeout = setTimeout(later, remaining);
      }
      return result;
    };
  }

  // Used for unique instance variables
  var id = 0;

  /**
   * Categorize, sort, and filter a responsive grid of items.
   *
   * @param {Element|jQuery} element An element or a jQuery collection which
   *     is the parent container for the grid items.
   * @param {Object} [options=Shuffle.options] Options object.
   * @constructor
   */
  var Shuffle = function(element, options) {
    options = options || {};
    $.extend(this, Shuffle.options, options, Shuffle.settings);

    this.$el = $(element);
    this.$window = $(window);
    this.unique = 'shuffle_' + id++;

    this._fire(Shuffle.EventType.LOADING);
    this._init();

    // Dispatch the done event asynchronously so that people can bind to it after
    // Shuffle has been initialized.
    setTimeout(
      $.proxy(function() {
        this.initialized = true;
        this._fire(Shuffle.EventType.DONE);
      }, this),
      16
    );
  };

  /**
   * Events the container element emits with the .shuffle namespace.
   * For example, "done.shuffle".
   * @enum {string}
   */
  Shuffle.EventType = {
    LOADING: 'loading',
    DONE: 'done',
    SHRINK: 'shrink',
    SHRUNK: 'shrunk',
    FILTER: 'filter',
    FILTERED: 'filtered',
    SORTED: 'sorted',
    LAYOUT: 'layout',
    REMOVED: 'removed',
  };

  Shuffle.prototype = {
    _init: function() {
      var self = this,
        containerCSS,
        containerWidth,
        resizeFunction = $.proxy(self._onResize, self),
        debouncedResize = self.throttle ? self.throttle(resizeFunction, self.throttleTime) : resizeFunction,
        sort = self.initialSort ? self.initialSort : null;

      self._layoutList = [];
      self._shrinkList = [];

      self._setVars();

      // Zero out all columns
      self._resetCols();

      // Add classes and invalidate styles
      self._addClasses();

      // Set initial css for each item
      self._initItems();

      // Bind resize events
      // http://stackoverflow.com/questions/1852751/window-resize-event-firing-in-internet-explorer
      self.$window.on('resize.' + SHUFFLE + '.' + self.unique, debouncedResize);

      // Get container css all in one request. Causes reflow
      containerCSS = self.$el.css(['paddingLeft', 'paddingRight', 'position']);
      containerWidth = self._getOuterWidth(self.$el[0]);

      // Position cannot be static.
      if (containerCSS.position === 'static') {
        self.$el[0].style.position = 'relative';
      }

      // Get offset from container
      self.offset = {
        left: parseInt(containerCSS.paddingLeft, 10) || 0,
        top: parseInt(containerCSS.paddingTop, 10) || 0,
      };

      // We already got the container's width above, no need to cause another reflow getting it again...
      // Calculate the number of columns there will be
      self._setColumns(parseInt(containerWidth, 10));

      // Kick off!
      self.shuffle(self.group, sort);

      // The shuffle items haven't had transitions set on them yet
      // so the user doesn't see the first layout. Set them now that the first layout is done.
      if (self.supported) {
        setTimeout(function() {
          self._setTransitions();
          self.$el[0].style[TRANSITION] = 'height ' + self.speed + 'ms ' + self.easing;
        }, 0);
      }
    },

    // Will invalidate styles
    _addClasses: function() {
      this.$el.addClass(SHUFFLE);
      this.$items.addClass('shuffle-item filtered');
    },

    _setVars: function() {
      var self = this,
        columnWidth = self.columnWidth;

      self.$items = self._getItems();

      // Column width is the default setting and sizer is not (meaning passed in)
      // Assume they meant column width to be the sizer
      if (columnWidth === 0 && self.sizer !== null) {
        columnWidth = self.sizer;
      }

      // If column width is a string, treat is as a selector and search for the
      // sizer element within the outermost container
      if (typeof columnWidth === 'string') {
        self.$sizer = self.$el.find(columnWidth);

        // Check for an element
      } else if (columnWidth && columnWidth.nodeType && columnWidth.nodeType === 1) {
        // Wrap it in jQuery
        self.$sizer = $(columnWidth);

        // Check for jQuery object
      } else if (columnWidth && columnWidth.jquery) {
        self.$sizer = columnWidth;
      }

      if (self.$sizer && self.$sizer.length) {
        self.useSizer = true;
        self.sizer = self.$sizer[0];
      }
    },

    /**
     * Filter the elements by a category.
     * @param {string} [category] Category to filter by. If it's given, the last
     *     category will be used to filter the items.
     * @param {jQuery} [$collection] Optionally filter a collection. Defaults to
     *     all the items.
     * @return {jQuery} Filtered items.
     */
    _filter: function(category, $collection) {
      var self = this,
        isPartialSet = $collection !== undefined,
        $items = isPartialSet ? $collection : self.$items,
        $filtered = $();

      category = category || self.lastFilter;

      self._fire(Shuffle.EventType.FILTER);

      // Loop through each item and use provided function to determine
      // whether to hide it or not.
      if ($.isFunction(category)) {
        $items.each(function() {
          var $item = $(this);
          if (category.call($item[0], $item, self)) {
            $filtered = $filtered.add($item);
          }
        });

        // Otherwise we've been passed a category to filter by
      } else {
        self.group = category;

        // category === 'all', add filtered class to everything
        if (category === ALL_ITEMS) {
          $filtered = $items;

          // Check each element's data-groups attribute against the given category.
        } else {
          $items.each(function() {
            var $item = $(this),
              groups = $item.data(FILTER_ATTRIBUTE_KEY),
              keys = self.delimeter && !$.isArray(groups) ? groups.split(self.delimeter) : groups;

            if ($.inArray(category, keys) > -1) {
              $filtered = $filtered.add($item);
            }
          });
        }
      }

      // Individually add/remove concealed/filtered classes
      self._toggleFilterClasses($items, $filtered);

      $items = null;
      $collection = null;

      return $filtered;
    },

    _toggleFilterClasses: function($items, $filtered) {
      var concealed = 'concealed',
        filtered = 'filtered';

      $items.filter($filtered).each(function() {
        var $filteredItem = $(this);
        // Remove concealed if it's there
        if ($filteredItem.hasClass(concealed)) {
          $filteredItem.removeClass(concealed);
        }
        // Add filtered class if it's not there
        if (!$filteredItem.hasClass(filtered)) {
          $filteredItem.addClass(filtered);
        }
      });

      $items.not($filtered).each(function() {
        var $filteredItem = $(this);
        // Add concealed if it's not there
        if (!$filteredItem.hasClass(concealed)) {
          $filteredItem.addClass(concealed);
        }
        // Remove filtered class if it's there
        if ($filteredItem.hasClass(filtered)) {
          $filteredItem.removeClass(filtered);
        }
      });
    },

    /**
     * Set the initial css for each item
     * @param {jQuery} [$items] Optionally specifiy at set to initialize
     */
    _initItems: function($items) {
      $items = $items || this.$items;
      $items.css(this.itemCss).data('position', { x: 0, y: 0 });
    },

    _updateItemCount: function() {
      this.visibleItems = this.$items.filter('.filtered').length;
    },

    _setTransition: function(element) {
      element.style[TRANSITION] =
        CSS_TRANSFORM + ' ' + this.speed + 'ms ' + this.easing + ', opacity ' + this.speed + 'ms ' + this.easing;
    },

    _setTransitions: function($items) {
      var self = this;

      $items = $items || self.$items;
      $items.each(function() {
        self._setTransition(this);
      });
    },

    _setSequentialDelay: function($collection) {
      var self = this;

      if (!self.supported) {
        return;
      }

      // $collection can be an array of dom elements or jquery object
      $.each($collection, function(i, el) {
        // This works because the transition-property: transform, opacity;
        el.style[TRANSITION_DELAY] = '0ms,' + (i + 1) * self.sequentialFadeDelay + 'ms';

        // Set the delay back to zero after one transition
        $(el).on(TRANSITIONEND + '.' + self.unique, function(evt) {
          var target = evt.currentTarget;
          if (target === evt.target) {
            target.style[TRANSITION_DELAY] = '0ms';
            $(target).off(TRANSITIONEND + '.' + self.unique);
          }
        });
      });
    },

    _getItems: function() {
      return this.$el.children(this.itemSelector);
    },

    _getPreciseDimension: function(element, style) {
      var dimension;
      if (window.getComputedStyle) {
        dimension = window.getComputedStyle(element, null)[style];
      } else {
        dimension = $(element).css(style);
      }
      return parseFloat(dimension);
    },

    /**
     * Returns the outer width of an element, optionally including its margins.
     * @param {Element} element The element.
     * @param {boolean} [includeMargins] Whether to include margins. Default is false.
     * @return {number} The width.
     */
    _getOuterWidth: function(element, includeMargins) {
      var width = element.offsetWidth;

      // Use jQuery here because it uses getComputedStyle internally and is
      // cross-browser. Using the style property of the element will only work
      // if there are inline styles.
      if (includeMargins) {
        var styles = $(element).css(['marginLeft', 'marginRight']);

        // Defaults to zero if parsing fails because IE will return 'auto' when
        // the element doesn't have margins instead of the computed style.
        var marginLeft = parseFloat(styles.marginLeft) || 0;
        var marginRight = parseFloat(styles.marginRight) || 0;
        width += marginLeft + marginRight;
      }

      return width;
    },

    /**
     * Returns the outer height of an element, optionally including its margins.
     * @param {Element} element The element.
     * @param {boolean} [includeMargins] Whether to include margins. Default is false.
     * @return {number} The height.
     */
    _getOuterHeight: function(element, includeMargins) {
      var height = element.offsetHeight;

      if (includeMargins) {
        var styles = $(element).css(['marginTop', 'marginBottom']);
        var marginTop = parseFloat(styles.marginTop) || 0;
        var marginBottom = parseFloat(styles.marginBottom) || 0;
        height += marginTop + marginBottom;
      }

      return height;
    },

    _getColumnSize: function(gutterSize, containerWidth) {
      var size;

      // If the columnWidth property is a function, then the grid is fluid
      if ($.isFunction(this.columnWidth)) {
        size = this.columnWidth(containerWidth);

        // columnWidth option isn't a function, are they using a sizing element?
      } else if (this.useSizer) {
        size = this._getPreciseDimension(this.sizer, 'width');

        // if not, how about the explicitly set option?
      } else if (this.columnWidth) {
        size = this.columnWidth;

        // or use the size of the first item
      } else if (this.$items.length > 0) {
        size = this._getOuterWidth(this.$items[0], true);

        // if there's no items, use size of container
      } else {
        size = containerWidth;
      }

      // Don't let them set a column width of zero.
      if (size === 0) {
        size = containerWidth;
      }

      return size + gutterSize;
    },

    _getGutterSize: function(containerWidth) {
      var size;
      if ($.isFunction(this.gutterWidth)) {
        size = this.gutterWidth(containerWidth);
      } else if (this.useSizer) {
        size = this._getPreciseDimension(this.sizer, 'marginLeft');
      } else {
        size = this.gutterWidth;
      }

      return size;
    },

    /**
     * Calculate the number of columns to be used. Gets css if using sizer element.
     * @param {number} [theContainerWidth] Optionally specify a container width if it's already available.
     */
    _setColumns: function(theContainerWidth) {
      var containerWidth = theContainerWidth || this._getOuterWidth(this.$el[0]);
      var gutter = this._getGutterSize(containerWidth);
      var columnWidth = this._getColumnSize(gutter, containerWidth);
      var calculatedColumns = (containerWidth + gutter) / columnWidth;

      // Widths given from getComputedStyle are not precise enough...
      if (Math.abs(Math.round(calculatedColumns) - calculatedColumns) < 0.03) {
        // e.g. calculatedColumns = 11.998876
        calculatedColumns = Math.round(calculatedColumns);
      }

      this.cols = Math.max(Math.floor(calculatedColumns), 1);
      this.containerWidth = containerWidth;
      this.colWidth = columnWidth;
    },

    /**
     * Adjust the height of the grid
     */
    _setContainerSize: function() {
      this.$el.css('height', Math.max.apply(Math, this.colYs));
    },

    /**
     * Fire events with .shuffle namespace
     */
    _fire: function(name, args) {
      this.$el.trigger(name + '.' + SHUFFLE, args && args.length ? args : [this]);
    },

    /**
     * Loops through each item that should be shown and calculates the x, y position.
     * @param {Array.<Element>} items Array of items that will be shown/layed out in order in their array.
     *     Because jQuery collection are always ordered in DOM order, we can't pass a jq collection.
     * @param {function} fn Callback function.
     * @param {boolean} isOnlyPosition If true this will position the items with zero opacity.
     */
    _layout: function(items, fn, isOnlyPosition) {
      var self = this;

      fn = fn || self._filterEnd;

      $.each(items, function(index, item) {
        var $item = $(item);
        var itemData = $item.data();
        var currPos = itemData.position;
        var pos = self._getItemPosition($item);

        // Save data for shrink
        $item.data('position', pos);

        // If the item will not change its position, do not add it to the render
        // queue. Transitions don't fire when setting a property to the same value.
        if (pos.x === currPos.x && pos.y === currPos.y && itemData.scale === DEFAULT_SCALE) {
          return;
        }

        var transitionObj = {
          $item: $item,
          x: pos.x,
          y: pos.y,
          scale: DEFAULT_SCALE,
        };

        if (isOnlyPosition) {
          transitionObj.skipTransition = true;
          transitionObj.opacity = 0;
        } else {
          transitionObj.opacity = 1;
          transitionObj.callback = fn;
        }

        self.styleQueue.push(transitionObj);
        self._layoutList.push($item[0]);
      });

      // `_layout` always happens after `_shrink`, so it's safe to process the style
      // queue here with styles from the shrink method
      self._processStyleQueue();

      // Adjust the height of the container
      self._setContainerSize();
    },

    // Reset columns.
    _resetCols: function() {
      var i = this.cols;
      this.colYs = [];
      while (i--) {
        this.colYs.push(0);
      }
    },

    _reLayout: function() {
      this._resetCols();

      // If we've already sorted the elements, keep them sorted
      if (this.lastSort) {
        this.sort(this.lastSort, true);
      } else {
        this._layout(this.$items.filter('.filtered').get(), this._filterEnd);
      }
    },

    _getItemPosition: function($item) {
      var self = this;
      var itemWidth = self._getOuterWidth($item[0], true);
      var columnSpan = itemWidth / self.colWidth;

      // If the difference between the rounded column span number and the
      // calculated column span number is really small, round the number to
      // make it fit.
      if (Math.abs(Math.round(columnSpan) - columnSpan) < 0.03) {
        // e.g. columnSpan = 4.0089945390298745
        columnSpan = Math.round(columnSpan);
      }

      // How many columns does this item span. Ensure it's not more than the
      // amount of columns in the whole layout.
      var colSpan = Math.min(Math.ceil(columnSpan), self.cols);

      // The item spans only one column.
      if (colSpan === 1) {
        return self._placeItem($item, self.colYs);

        // The item spans more than one column, figure out how many different
        // places it could fit horizontally
      } else {
        var groupCount = self.cols + 1 - colSpan,
          groupY = [],
          groupColY,
          i;

        // for each group potential horizontal position
        for (i = 0; i < groupCount; i++) {
          // make an array of colY values for that one group
          groupColY = self.colYs.slice(i, i + colSpan);
          // and get the max value of the array
          groupY[i] = Math.max.apply(Math, groupColY);
        }

        return self._placeItem($item, groupY);
      }
    },

    // worker method that places item in the columnSet with the the minY
    _placeItem: function($item, setY) {
      // get the minimum Y value from the columns
      var self = this,
        minimumY = Math.min.apply(Math, setY),
        shortCol = 0;

      // Find index of short column, the first from the left where this item will go
      // if ( setY[i] === minimumY ) requires items' height to be exact every time.
      // The buffer value is very useful when the height is a percentage of the width
      for (var i = 0, len = setY.length; i < len; i++) {
        if (setY[i] >= minimumY - self.buffer && setY[i] <= minimumY + self.buffer) {
          shortCol = i;
          break;
        }
      }

      // Position the item
      var position = {
        x: Math.round(self.colWidth * shortCol + self.offset.left),
        y: Math.round(minimumY + self.offset.top),
      };

      // Apply setHeight to necessary columns
      var setHeight = minimumY + self._getOuterHeight($item[0], true),
        setSpan = self.cols + 1 - len;
      for (i = 0; i < setSpan; i++) {
        self.colYs[shortCol + i] = setHeight;
      }

      return position;
    },

    /**
     * Hides the elements that don't match our filter.
     * @param {jQuery} $collection jQuery collection to shrink.
     * @param {Function} fn Callback function.
     * @private
     */
    _shrink: function($collection, fn) {
      var self = this,
        $concealed = $collection || self.$items.filter('.concealed');

      fn = fn || self._shrinkEnd;

      // Abort if no items
      if (!$concealed.length) {
        return;
      }

      self._fire(Shuffle.EventType.SHRINK);

      $concealed.each(function() {
        var $item = $(this);
        var itemData = $item.data();
        var alreadyShrunk = itemData.scale === CONCEALED_SCALE;

        // Continuing would add a transitionend event listener to the element, but
        // that listener would execute because the transform and opacity would
        // stay the same.
        if (alreadyShrunk) {
          return;
        }

        var transitionObj = {
          $item: $item,
          x: itemData.position.x,
          y: itemData.position.y,
          scale: CONCEALED_SCALE,
          opacity: 0,
          callback: fn,
        };

        self.styleQueue.push(transitionObj);
        self._shrinkList.push($item[0]);
      });
    },

    _onResize: function() {
      // If shuffle is disabled, destroyed, don't do anything
      if (!this.enabled || this.destroyed) {
        return;
      }

      // Will need to check height in the future if it's layed out horizontaly
      var containerWidth = this._getOuterWidth(this.$el[0]);

      // containerWidth hasn't changed, don't do anything
      if (containerWidth === this.containerWidth) {
        return;
      }

      this.resized();
    },

    /**
     * If the browser has 3d transforms available, build a string with those,
     * otherwise use 2d transforms.
     * @param {number} x X position.
     * @param {number} y Y position.
     * @param {number} scale Scale amount.
     * @return {string} A normalized string which can be used with the transform style.
     * @private
     */
    _getItemTransformString: function(x, y, scale) {
      if (HAS_TRANSFORMS_3D) {
        return 'translate3d(' + x + 'px, ' + y + 'px, 0) scale3d(' + scale + ', ' + scale + ', 1)';
      } else {
        return 'translate(' + x + 'px, ' + y + 'px) scale(' + scale + ', ' + scale + ')';
      }
    },

    _getStylesForTransition: function(opts) {
      var styles = {
        opacity: opts.opacity,
      };

      if (this.supported) {
        if (opts.x !== undefined) {
          styles[TRANSFORM] = this._getItemTransformString(opts.x, opts.y, opts.scale);
        }
      } else {
        styles.left = opts.x;
        styles.top = opts.y;
      }

      // Show the item if its opacity will be 1.
      if (opts.opacity === 1) {
        styles.visibility = 'visible';
      }

      return styles;
    },

    /**
     * Transitions an item in the grid
     *
     * @param {Object}   opts options
     * @param {jQuery}   opts.$item jQuery object representing the current item
     * @param {number}   opts.x translate's x
     * @param {number}   opts.y translate's y
     * @param {number}   opts.scale amount to scale the item
     * @param {number}   opts.opacity opacity of the item
     * @param {Function} opts.callback complete function for the animation
     * @private
     */
    _transition: function(opts) {
      opts.$item.data('scale', opts.scale);

      var styles = this._getStylesForTransition(opts);
      this._startItemAnimation(opts.$item, styles, opts.callback);
    },

    _startItemAnimation: function($item, styles, callback) {
      var willBeVisible = styles.opacity === 1;
      var complete = $.proxy(this._handleItemAnimationEnd, this, callback || $.noop, $item[0], willBeVisible);

      // Use CSS Transforms if we have them
      if (this.supported) {
        $item.css(styles);

        // Transitions are not set until shuffle has loaded to avoid the initial transition.
        if (this.initialized) {
          // Namespaced because the reveal appended function also wants to know
          // about the transition end event.
          $item.on(TRANSITIONEND + '.shuffleitem', complete);
        } else {
          complete();
        }

        // Use jQuery to animate left/top
      } else {
        // jQuery cannot animate visibility, set it immediately.
        if ('visibility' in styles) {
          $item.css('visibility', styles.visibility);
          delete styles.visibility;
        }
        $item.stop(true).animate(styles, this.speed, 'swing', complete);
      }
    },

    _handleItemAnimationEnd: function(callback, item, willBeVisible, evt) {
      // Make sure this event handler has not bubbled up from a child.
      if (evt) {
        if (evt.target === item) {
          $(item).off('.shuffleitem');
        } else {
          return;
        }
      }

      if (this._layoutList.length > 0 && $.inArray(item, this._layoutList) > -1) {
        this._fire(Shuffle.EventType.LAYOUT);
        callback.call(this);
        this._layoutList.length = 0;
      } else if (this._shrinkList.length > 0 && $.inArray(item, this._shrinkList) > -1) {
        callback.call(this);
        this._shrinkList.length = 0;
      }

      if (!willBeVisible) {
        item.style.visibility = 'hidden';
      }
    },

    _processStyleQueue: function() {
      var self = this;

      $.each(this.styleQueue, function(i, transitionObj) {
        if (transitionObj.skipTransition) {
          self._skipTransition(transitionObj.$item[0], function() {
            transitionObj.$item.css(self._getStylesForTransition(transitionObj));
          });
        } else {
          self._transition(transitionObj);
        }
      });

      // Remove everything in the style queue
      self.styleQueue.length = 0;
    },

    _shrinkEnd: function() {
      this._fire(Shuffle.EventType.SHRUNK);
    },

    _filterEnd: function() {
      this._fire(Shuffle.EventType.FILTERED);
    },

    _sortEnd: function() {
      this._fire(Shuffle.EventType.SORTED);
    },

    /**
     * Change a property or execute a function which will not have a transition
     * @param {Element} element DOM element that won't be transitioned
     * @param {(string|Function)} property The new style property which will be set or a function which will be called
     * @param {string} [value] The value that `property` should be.
     * @private
     */
    _skipTransition: function(element, property, value) {
      var duration = element.style[TRANSITION_DURATION];

      // Set the duration to zero so it happens immediately
      element.style[TRANSITION_DURATION] = '0ms'; // ms needed for firefox!

      if ($.isFunction(property)) {
        property();
      } else {
        element.style[property] = value;
      }

      // Force reflow
      var reflow = element.offsetWidth;
      // Avoid jshint warnings: unused variables and expressions.
      reflow = null;

      // Put the duration back
      element.style[TRANSITION_DURATION] = duration;
    },

    _addItems: function($newItems, animateIn, isSequential) {
      var self = this;

      if (!self.supported) {
        animateIn = false;
      }

      $newItems.addClass('shuffle-item');
      self._initItems($newItems);
      self._setTransitions($newItems);
      self.$items = self._getItems();

      // Hide all items
      $newItems.css('opacity', 0);

      // Get ones that passed the current filter
      var $passed = self._filter(undefined, $newItems);
      var passed = $passed.get();

      // How many filtered elements?
      self._updateItemCount();

      if (animateIn) {
        self._layout(passed, null, true);

        if (isSequential) {
          self._setSequentialDelay($passed);
        }

        self._revealAppended($passed);
      } else {
        self._layout(passed);
      }
    },

    _revealAppended: function($newFilteredItems) {
      var self = this;

      setTimeout(function() {
        $newFilteredItems.each(function(i, el) {
          self._transition({
            $item: $(el),
            opacity: 1,
            scale: DEFAULT_SCALE,
          });
        });
      }, self.revealAppendedDelay);
    },

    /**
     * Public Methods
     */

    /**
     * The magic. This is what makes the plugin 'shuffle'
     * @param {(string|Function)} [category] Category to filter by. Can be a function
     * @param {Object} [sortObj] A sort object which can sort the filtered set
     */
    shuffle: function(category, sortObj) {
      var self = this;

      if (!self.enabled) {
        return;
      }

      if (!category) {
        category = ALL_ITEMS;
      }

      self._filter(category);
      // Save the last filter in case elements are appended.
      self.lastFilter = category;

      // How many filtered elements?
      self._updateItemCount();

      // Shrink each concealed item
      self._shrink();

      // If given a valid sort object, save it so that _reLayout() will sort the items
      if (sortObj) {
        self.lastSort = sortObj;
      }
      // Update transforms on .filtered elements so they will animate to their new positions
      self._reLayout();
    },

    /**
     * Gets the .filtered elements, sorts them, and passes them to layout
     *
     * @param {Object} opts the options object for the sorted plugin
     * @param {boolean} [fromFilter] was called from Shuffle.filter method.
     */
    sort: function(opts, fromFilter) {
      var self = this,
        items = self.$items.filter('.filtered').sorted(opts);

      if (!fromFilter) {
        self._resetCols();
      }

      self._layout(items, function() {
        if (fromFilter) {
          self._filterEnd();
        }
        self._sortEnd();
      });

      self.lastSort = opts;
    },

    /**
     * Relayout everything
     */
    resized: function(isOnlyLayout) {
      if (this.enabled) {
        if (!isOnlyLayout) {
          // Get updated colCount
          this._setColumns();
        }

        // Layout items
        this._reLayout();
      }
    },

    /**
     * Use this instead of `update()` if you don't need the columns and gutters updated
     * Maybe an image inside `shuffle` loaded (and now has a height), which means calculations
     * could be off.
     */
    layout: function() {
      this.update(true);
    },

    update: function(isOnlyLayout) {
      this.resized(isOnlyLayout);
    },

    /**
     * New items have been appended to shuffle. Fade them in sequentially
     * @param {jQuery} $newItems jQuery collection of new items
     * @param {boolean} [animateIn] If false, the new items won't animate in
     * @param {boolean} [isSequential] If false, new items won't sequentially fade in
     */
    appended: function($newItems, animateIn, isSequential) {
      // True if undefined
      animateIn = animateIn === false ? false : true;
      isSequential = isSequential === false ? false : true;

      this._addItems($newItems, animateIn, isSequential);
    },

    /**
     * Disables shuffle from updating dimensions and layout on resize
     */
    disable: function() {
      this.enabled = false;
    },

    /**
     * Enables shuffle again
     * @param {boolean} [isUpdateLayout=true] if undefined, shuffle will update columns and gutters
     */
    enable: function(isUpdateLayout) {
      this.enabled = true;
      if (isUpdateLayout !== false) {
        this.update();
      }
    },

    /**
     * Remove 1 or more shuffle items
     * @param {jQuery} $collection A jQuery object containing one or more element in shuffle
     * @return {Shuffle} The shuffle object
     */
    remove: function($collection) {
      // If this isn't a jquery object, exit
      if (!$collection.length || !$collection.jquery) {
        return;
      }

      var self = this;

      // Hide collection first
      self._shrink($collection, function() {
        var shuffle = this;

        // Remove the collection in the callback
        $collection.remove();

        // Update the items, layout, count and fire off `removed` event
        setTimeout(function() {
          shuffle.$items = shuffle._getItems();
          shuffle.layout();
          shuffle._updateItemCount();
          shuffle._fire(Shuffle.EventType.REMOVED, [$collection, shuffle]);

          // Let it get garbage collected
          $collection = null;
        }, 0);
      });

      // Process changes
      self._processStyleQueue();

      return self;
    },

    /**
     * Destroys shuffle, removes events, styles, and classes
     */
    destroy: function() {
      var self = this;

      // If there is more than one shuffle instance on the page,
      // removing the resize handler from the window would remove them
      // all. This is why a unique value is needed.
      self.$window.off('.' + self.unique);

      // Reset container styles
      self.$el
        .removeClass(SHUFFLE)
        .removeAttr('style')
        .removeData(SHUFFLE);

      // Reset individual item styles
      self.$items.removeAttr('style').removeClass('concealed filtered shuffle-item');

      // Null DOM references
      self.$window = null;
      self.$items = null;
      self.$el = null;
      self.$sizer = null;
      self.sizer = null;

      // Set a flag so if a debounced resize has been triggered,
      // it can first check if it is actually destroyed and not doing anything
      self.destroyed = true;
    },
  };

  // Overrideable options
  Shuffle.options = {
    group: ALL_ITEMS, // Filter group
    speed: 250, // Transition/animation speed (milliseconds)
    easing: 'ease-out', // css easing function to use
    itemSelector: '', // e.g. '.picture-item'
    sizer: null, // sizer element. Can be anything columnWidth is
    gutterWidth: 0, // a static number or function that tells the plugin how wide the gutters between columns are (in pixels)
    columnWidth: 0, // a static number or function that returns a number which tells the plugin how wide the columns are (in pixels)
    delimeter: null, // if your group is not json, and is comma delimeted, you could set delimeter to ','
    buffer: 0, // useful for percentage based heights when they might not always be exactly the same (in pixels)
    initialSort: null, // Shuffle can be initialized with a sort object. It is the same object given to the sort method
    throttle: throttle, // By default, shuffle will try to throttle the resize event. This option will change the method it uses
    throttleTime: 300, // How often shuffle can be called on resize (in milliseconds)
    sequentialFadeDelay: 150, // Delay between each item that fades in when adding items
    supported: CAN_TRANSITION_TRANSFORMS, // supports transitions and transforms
  };

  // Not overrideable
  Shuffle.settings = {
    $sizer: null,
    useSizer: false,
    itemCss: {
      // default CSS for each item
      position: 'absolute',
      top: 0,
      left: 0,
    },
    offset: { top: 0, left: 0 },
    revealAppendedDelay: 300,
    enabled: true,
    destroyed: false,
    initialized: false,
    styleQueue: [],
  };

  // Plugin definition
  $.fn.shuffle = function(opts) {
    var args = Array.prototype.slice.call(arguments, 1);
    return this.each(function() {
      var $this = $(this),
        shuffle = $this.data(SHUFFLE);

      // If we don't have a stored shuffle, make a new one and save it
      if (!shuffle) {
        shuffle = new Shuffle($this, opts);
        $this.data(SHUFFLE, shuffle);
      }

      if (typeof opts === 'string' && shuffle[opts]) {
        shuffle[opts].apply(shuffle, args);
      }
    });
  };

  // You can return `undefined` from the `by` function to revert to DOM order
  // This plugin does NOT return a jQuery object. It returns a plain array because
  // jQuery sorts everything in DOM order.
  $.fn.sorted = function(options) {
    var opts = $.extend({}, $.fn.sorted.defaults, options),
      arr = this.get(),
      revert = false;

    if (!arr.length) {
      return [];
    }

    if (opts.randomize) {
      return $.fn.sorted.randomize(arr);
    }

    // Sort the elements by the opts.by function.
    // If we don't have opts.by, default to DOM order
    if (opts.by !== $.noop && opts.by !== null && opts.by !== undefined) {
      arr.sort(function(a, b) {
        // Exit early if we already know we want to revert
        if (revert) {
          return 0;
        }

        var valA = opts.by($(a)),
          valB = opts.by($(b));

        // If both values are undefined, use the DOM order
        if (valA === undefined && valB === undefined) {
          revert = true;
          return 0;
        }

        if (valA === 'sortFirst' || valB === 'sortLast') {
          return -1;
        }

        if (valA === 'sortLast' || valB === 'sortFirst') {
          return 1;
        }

        return valA < valB ? -1 : valA > valB ? 1 : 0;
      });
    }

    // Revert to the original array if necessary
    if (revert) {
      return this.get();
    }

    if (opts.reverse) {
      arr.reverse();
    }

    return arr;
  };

  $.fn.sorted.defaults = {
    reverse: false, // Use array.reverse() to reverse the results
    by: null, // Sorting function
    randomize: false, // If true, this will skip the sorting and return a randomized order in the array
  };

  // http://stackoverflow.com/a/962890/373422
  $.fn.sorted.randomize = function(array) {
    var top = array.length,
      tmp,
      current;

    if (!top) {
      return array;
    }

    while (--top) {
      current = Math.floor(Math.random() * (top + 1));
      tmp = array[current];
      array[current] = array[top];
      array[top] = tmp;
    }

    return array;
  };

  return Shuffle;
});

/**
 * DaData.ru Suggestions jQuery plugin, version 18.3.1
 *
 * DaData.ru Suggestions jQuery plugin is freely distributable under the terms of MIT-style license
 * Built on DevBridge Autocomplete for jQuery (https://github.com/devbridge/jQuery-Autocomplete)
 * For details, see https://github.com/hflabs/suggestions-jquery
 */
(function(global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined'
    ? factory(require('jquery'))
    : typeof define === 'function' && define.amd
    ? define(['jquery'], factory)
    : factory(global.jQuery);
})(this, function($) {
  'use strict';

  $ = $ && 'default' in $ ? $['default'] : $;

  /**
   * Утилиты для работы с типами.
   */
  var lang_util = {
    /**
     * Проверяет, является ли аргумент массивом.
     */
    isArray: function(array) {
      return Array.isArray(array);
    },

    /**
     * Проверяет, является ли аргумент функцией.
     */
    isFunction: function(it) {
      return Object.prototype.toString.call(it) === '[object Function]';
    },

    /**
     * Проверяет, является ли аргумент пустым объектом ({}).
     */
    isEmptyObject: function(obj) {
      return Object.keys(obj).length === 0 && obj.constructor === Object;
    },

    /**
     * Проверяет, является ли аргумент «обычным» объектом
     * (не undefiend, не null, не DOM-элемент)
     */
    isPlainObject: function(obj) {
      if (obj === undefined || typeof obj !== 'object' || obj === null || obj.nodeType || obj === obj.window) {
        return false;
      }
      if (obj.constructor && !Object.prototype.hasOwnProperty.call(obj.constructor.prototype, 'isPrototypeOf')) {
        return false;
      }
      return true;
    },
  };

  /**
   * Утилиты для работы с коллекциями.
   */
  var collection_util = {
    /**
     * Функция-обработчик для итератора. Принимает ключ и значение элемента.
     *
     * @callback eachCallback
     * @param key - ключ
     * @param value - значение
     */

    /**
     * Возвращает массив без пустых элементов
     */
    compact: function(array) {
      return array.filter(function(el) {
        return !!el;
      });
    },

    /**
     * Итерирует по элементам массива или полям объекта.
     * Ведёт себя как $.each() - прерывает выполнение, если функция-обработчик возвращает false.
     * @param {Object|Array} obj - массив или объект
     * @param {eachCallback} callback - функция-обработчик
     */
    each: function(obj, callback) {
      if (Array.isArray(obj)) {
        obj.some(function(el, idx) {
          return callback(el, idx) === false;
        });
        return;
      }
      Object.keys(obj).some(function(key) {
        var value = obj[key];
        return callback(value, key) === false;
      });
    },

    /**
     * Пересечение массивов: ([1,2,3,4], [2,4,5,6]) => [2,4]
     * Исходные массивы не меняются.
     */
    intersect: function(array1, array2) {
      var result = [];
      if (!Array.isArray(array1) || !Array.isArray(array2)) {
        return result;
      }
      return array1.filter(function(el) {
        return array2.indexOf(el) !== -1;
      });
    },

    /**
     * Разность массивов: ([1,2,3,4], [2,4,5,6]) => [1,3]
     * Исходные массивы не меняются.
     */
    minus: function(array1, array2) {
      if (!array2 || array2.length === 0) {
        return array1;
      }
      return array1.filter(function(el) {
        return array2.indexOf(el) === -1;
      });
    },

    /**
     * Обрачивает переданный объект в массив.
     * Если передан массив, возвращает его копию.
     */
    makeArray: function(arrayLike) {
      if (lang_util.isArray(arrayLike)) {
        return Array.prototype.slice.call(arrayLike);
      } else {
        return [arrayLike];
      }
    },

    /**
     * Разность массивов с частичным совпадением элементов.
     * Если элемент второго массива включает в себя элемент первого,
     * элементы считаются равными.
     */
    minusWithPartialMatching: function(array1, array2) {
      if (!array2 || array2.length === 0) {
        return array1;
      }
      return array1.filter(function(el) {
        return !array2.some(function(el2) {
          return el2.indexOf(el) === 0;
        });
      });
    },

    /**
     * Копирует массив, начиная с указанного элемента.
     * @param obj - массив
     * @param start - индекс, начиная с которого надо скопировать
     */
    slice: function(obj, start) {
      return Array.prototype.slice.call(obj, start);
    },
  };

  /**
   * Утилиты для работы с функциями.
   */
  var func_util = {
    /**
     * Выполняет функцию с указанной задержкой.
     * @param {Function} handler - функция
     * @param {number} delay - задержка в миллисекундах
     */
    delay: function(handler, delay) {
      return setTimeout(handler, delay || 0);
    },
  };

  /**
   * Утилиты для работы с объектами.
   */
  var object_util = {
    /**
     * Сравнивает два объекта по полям, которые присутствуют в обоих
     * @returns {boolean} true, если поля совпадают, false в противном случае
     */
    areSame: function self(a, b) {
      var same = true;

      if (typeof a != typeof b) {
        return false;
      }

      if (typeof a == 'object' && a != null && b != null) {
        collection_util.each(a, function(value, i) {
          return (same = self(value, b[i]));
        });
        return same;
      }

      return a === b;
    },

    /**
     * Клонирует объект глубоким копированием
     */
    clone: function(obj) {
      return JSON.parse(JSON.stringify(obj));
    },

    /**
     * Возвращает копию объекта без пустых полей
     * (без undefined, null и '')
     * @param obj
     */
    compact: function(obj) {
      var copy = object_util.clone(obj);

      collection_util.each(copy, function(val, key) {
        if (val === null || val === undefined || val === '') {
          delete copy[key];
        }
      });

      return copy;
    },

    /**
     * Возвращает вложенное значение по указанному пути
     * например, 'data.address.value'
     */
    getDeepValue: function self(obj, name) {
      var path = name.split('.'),
        step = path.shift();

      return obj && (path.length ? self(obj[step], path.join('.')) : obj[step]);
    },
  };

  var KEYS = {
    ENTER: 13,
    ESC: 27,
    TAB: 9,
    SPACE: 32,
    UP: 38,
    DOWN: 40,
  };

  var CLASSES = {
    hint: 'suggestions-hint',
    mobile: 'suggestions-mobile',
    nowrap: 'suggestions-nowrap',
    promo: 'suggestions-promo',
    selected: 'suggestions-selected',
    suggestion: 'suggestions-suggestion',
    subtext: 'suggestions-subtext',
    subtext_inline: 'suggestions-subtext suggestions-subtext_inline',
    subtext_delimiter: 'suggestions-subtext-delimiter',
    subtext_label: 'suggestions-subtext suggestions-subtext_label',
    removeConstraint: 'suggestions-remove',
    value: 'suggestions-value',
  };

  var EVENT_NS = '.suggestions';
  var DATA_ATTR_KEY = 'suggestions';
  var WORD_DELIMITERS = '\\s"\'~\\*\\.,:\\|\\[\\]\\(\\)\\{\\}<>№';
  var WORD_PARTS_DELIMITERS = '\\-\\+\\/\\\\\\?!@#$%^&';

  /**
   * Утилиты для работы с текстом.
   */

  var WORD_SPLITTER = new RegExp('[' + WORD_DELIMITERS + ']+', 'g');
  var WORD_PARTS_SPLITTER = new RegExp('[' + WORD_PARTS_DELIMITERS + ']+', 'g');

  var text_util = {
    /**
     * Заменяет амперсанд, угловые скобки и другие подобные символы
     * на HTML-коды
     */
    escapeHtml: function(str) {
      var map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#x27;',
        '/': '&#x2F;',
      };

      if (str) {
        collection_util.each(map, function(html, ch) {
          str = str.replace(new RegExp(ch, 'g'), html);
        });
      }
      return str;
    },

    /**
     * Эскейпирует символы RegExp-шаблона обратным слешем
     * (для передачи в конструктор регулярных выражений)
     */
    escapeRegExChars: function(value) {
      return value.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, '\\$&');
    },

    /**
     * Приводит слово к нижнему регистру и заменяет ё → е
     */
    formatToken: function(token) {
      return token && token.toLowerCase().replace(/[ёЁ]/g, 'е');
    },

    /**
     * Возвращает регулярное выражение для разбивки строки на слова
     */
    getWordExtractorRegExp: function() {
      return new RegExp('([^' + WORD_DELIMITERS + ']*)([' + WORD_DELIMITERS + ']*)', 'g');
    },

    /**
     * Вырезает из строки стоп-слова
     */
    normalize: function(str, stopwords) {
      return text_util.split(str, stopwords).join(' ');
    },

    /**
     * Разбивает строку на слова.
     * Отсеивает стоп-слова из списка.
     */
    split: function(str, stopwords) {
      // Split numbers and letters written together
      str = str.replace(/(\d+)([а-яА-ЯёЁ]{2,})/g, '$1 $2').replace(/([а-яА-ЯёЁ]+)(\d+)/g, '$1 $2');

      var words = collection_util.compact(str.split(WORD_SPLITTER)),
        lastWord = words.pop(),
        goodWords = collection_util.minus(words, stopwords);

      goodWords.push(lastWord);
      return goodWords;
    },

    /**
     * Проверяет, включает ли строка 1 строку 2.
     * Если строки равны, возвращает false.
     */
    stringEncloses: function(str1, str2) {
      return str1.length > str2.length && str1.indexOf(str2) !== -1;
    },

    /**
     * Возвращает список слов из строки.
     * При этом первыми по порядку идут «предпочтительные» слова
     * (те, что не входят в список «нежелательных»).
     * Составные слова тоже разбивает на части.
     * @param {string} value - строка
     * @param {Array} unformattableTokens - «нежелательные» слова
     * @return {Array} Массив атомарных слов
     */
    tokenize: function(value, unformattableTokens) {
      var tokens = collection_util.compact(text_util.formatToken(value).split(WORD_SPLITTER));
      // Move unformattableTokens to the end.
      // This will help to apply them only if no other tokens match
      var preferredTokens = collection_util.minus(tokens, unformattableTokens);
      var otherTokens = collection_util.minus(tokens, preferredTokens);
      tokens = text_util.withSubTokens(preferredTokens.concat(otherTokens));
      return tokens;
    },

    /**
     * Разбивает составные слова на части.
     * @param {Array} tokens - слова
     * @return {Array} Массив атомарных слов
     */
    withSubTokens: function(tokens) {
      var result = [];
      collection_util.each(tokens, function(token, i) {
        var subtokens = token.split(WORD_PARTS_SPLITTER);
        result.push(token);
        if (subtokens.length > 1) {
          result = result.concat(collection_util.compact(subtokens));
        }
      });
      return result;
    },
  };

  /**
   * jQuery API.
   */
  var jqapi = {
    Deferred: function() {
      return $.Deferred();
    },

    ajax: function(settings) {
      return $.ajax(settings);
    },

    extend: function() {
      return $.extend.apply(null, arguments);
    },

    param: function(obj) {
      return $.param(obj);
    },

    proxy: function(func, context) {
      return $.proxy(func, context);
    },

    supportsCors: function() {
      return $.support.cors;
    },
  };

  /**
   * Утилиты для работы через AJAX
   */
  var ajax = {
    /**
     * HTTP-метод, который поддерживает браузер
     */
    getDefaultType: function() {
      return jqapi.supportsCors() ? 'POST' : 'GET';
    },

    /**
     * Content-type, который поддерживает браузер
     */
    getDefaultContentType: function() {
      return jqapi.supportsCors() ? 'application/json' : 'application/x-www-form-urlencoded';
    },

    /**
     * Меняет HTTPS на протокол страницы, если браузер не поддерживает CORS
     */
    fixURLProtocol: function(url) {
      return jqapi.supportsCors() ? url : url.replace(/^https?:/, location.protocol);
    },

    /**
     * Записывает параметры в GET-строку
     */
    addUrlParams: function(url, params) {
      return url + (/\?/.test(url) ? '&' : '?') + jqapi.param(params);
    },

    /**
     * Сериализует объект для передачи по сети.
     * Либо в JSON-строку (если браузер поддерживает CORS),
     *   либо в GET-строку.
     */
    serialize: function(data) {
      if (jqapi.supportsCors()) {
        return JSON.stringify(data, function(key, value) {
          return value === null ? undefined : value;
        });
      } else {
        data = object_util.compact(data);
        return jqapi.param(data, true);
      }
    },
  };

  /**
   * Возвращает автоинкрементный идентификатор.
   * @param {string} prefix - префикс для идентификатора
   */
  var generateId = (function() {
    var counter = 0;
    return function(prefix) {
      return (prefix || '') + ++counter;
    };
  })();

  /**
   * Утилиты на все случаи жизни.
   */
  var utils = {
    escapeRegExChars: text_util.escapeRegExChars,
    escapeHtml: text_util.escapeHtml,
    formatToken: text_util.formatToken,
    getTokens: text_util.tokenize,
    getWords: text_util.split,
    normalize: text_util.normalize,
    reWordExtractor: text_util.getWordExtractorRegExp,
    stringEncloses: text_util.stringEncloses,
    withSubTokens: text_util.withSubTokens,

    addUrlParams: ajax.addUrlParams,
    getDefaultContentType: ajax.getDefaultContentType,
    getDefaultType: ajax.getDefaultType,
    fixURLProtocol: ajax.fixURLProtocol,
    serialize: ajax.serialize,

    arrayMinus: collection_util.minus,
    arrayMinusWithPartialMatching: collection_util.minusWithPartialMatching,
    arraysIntersection: collection_util.intersect,
    compact: collection_util.compact,
    each: collection_util.each,
    makeArray: collection_util.makeArray,
    slice: collection_util.slice,

    delay: func_util.delay,

    areSame: object_util.areSame,
    compactObject: object_util.compact,
    getDeepValue: object_util.getDeepValue,

    isArray: lang_util.isArray,
    isEmptyObject: lang_util.isEmptyObject,
    isFunction: lang_util.isFunction,
    isPlainObject: lang_util.isPlainObject,

    uniqueId: generateId,

    /**
     * Проверяет, что указанные поля в объекте заполнены.
     * @param {Object} obj - проверяемый объект
     * @param {Array} fields - список названий полей, которые надо проверить
     * @returns {boolean}
     */
    fieldsNotEmpty: function(obj, fields) {
      if (!lang_util.isPlainObject(obj)) {
        return false;
      }
      var result = true;
      collection_util.each(fields, function(field, i) {
        result = !!obj[field];
        return result;
      });
      return result;
    },

    /**
     * Возвращает карту объектов по их идентификаторам.
     * Принимает на вход массив объектов и идентифицирующее поле.
     * Возвращает карты, ключом в которой является значение идентифицирующего поля,
     *   а значением — исходный объект.
     * Заодно добавляет объектам поле с порядковым номером.
     * @param {Array} arr - массив объектов
     * @param {string} idField - название идентифицирующего поля
     * @param {string} indexField - название поля с порядковым номером
     * @return {Object} карта объектов по их идентификаторам
     */
    indexBy: function(arr, idField, indexField) {
      var result = {};

      collection_util.each(arr, function(obj, idx) {
        var key = obj[idField],
          val = {};

        if (indexField) {
          val[indexField] = idx;
        }

        result[key] = jqapi.extend(true, val, obj);
      });

      return result;
    },
  };

  var DEFAULT_OPTIONS = {
    autoSelectFirst: false,
    // основной url, может быть переопределен
    serviceUrl: 'https://suggestions.dadata.ru/suggestions/api/4_1/rs',
    // url, который заменяет serviceUrl + method + type
    // то есть, если он задан, то для всех запросов будет использоваться именно он
    // если не поддерживается cors то к url будут добавлены параметры ?token=...&version=...
    // и заменен протокол на протокол текущей страницы
    url: null,
    onSearchStart: $.noop,
    onSearchComplete: $.noop,
    onSearchError: $.noop,
    onSuggestionsFetch: null,
    onSelect: null,
    onSelectNothing: null,
    onInvalidateSelection: null,
    minChars: 1,
    deferRequestBy: 100,
    enrichmentEnabled: true,
    params: {},
    paramName: 'query',
    timeout: 3000,
    formatResult: null,
    formatSelected: null,
    noCache: false,
    containerClass: 'suggestions-suggestions',
    tabDisabled: false,
    triggerSelectOnSpace: false,
    triggerSelectOnEnter: true,
    triggerSelectOnBlur: true,
    preventBadQueries: false,
    hint: 'Выберите вариант или продолжите ввод',
    noSuggestionsHint: null,
    type: null,
    requestMode: 'suggest',
    count: 5,
    $helpers: null,
    headers: null,
    scrollOnFocus: true,
    mobileWidth: 980,
    initializeInterval: 100,
  };

  /**
   * Matchers return index of suitable suggestion
   * Context inside is optionally set in types.js
   */
  var matchers = (function() {
    /**
     * Factory to create same parent checker function
     * @param preprocessFn called on each value before comparison
     * @returns {Function} same parent checker function
     */
    function sameParentChecker(preprocessFn) {
      return function(suggestions) {
        if (suggestions.length === 0) {
          return false;
        }
        if (suggestions.length === 1) {
          return true;
        }

        var parentValue = preprocessFn(suggestions[0].value),
          aliens = $.grep(
            suggestions,
            function(suggestion) {
              return preprocessFn(suggestion.value).indexOf(parentValue) === 0;
            },
            true
          );

        return aliens.length === 0;
      };
    }

    /**
     * Default same parent checker. Compares raw values.
     * @type {Function}
     */
    var haveSameParent = sameParentChecker(function(val) {
      return val;
    });

    /**
     * Same parent checker for addresses. Strips house and extension before comparison.
     * @type {Function}
     */
    var haveSameParentAddress = sameParentChecker(function(val) {
      return val.replace(/, (?:д|вл|двлд|к) .+$/, '');
    });

    return {
      /**
       * Matches query against suggestions, removing all the stopwords.
       */
      matchByNormalizedQuery: function(query, suggestions) {
        var queryLowerCase = query.toLowerCase(),
          stopwords = this && this.stopwords,
          normalizedQuery = utils.normalize(queryLowerCase, stopwords),
          matches = [];

        $.each(suggestions, function(i, suggestion) {
          var suggestedValue = suggestion.value.toLowerCase();
          // if query encloses suggestion, than it has already been selected
          // so we should not select it anymore
          if (utils.stringEncloses(queryLowerCase, suggestedValue)) {
            return false;
          }
          // if there is suggestion that contains query as its part
          // than we should ignore all other matches, even full ones
          if (suggestedValue.indexOf(normalizedQuery) > 0) {
            return false;
          }
          if (normalizedQuery === utils.normalize(suggestedValue, stopwords)) {
            matches.push(i);
          }
        });

        return matches.length === 1 ? matches[0] : -1;
      },

      /**
       * Matches query against suggestions word-by-word (with respect to stopwords).
       * Matches if query words are a subset of suggested words.
       */
      matchByWords: function(query, suggestions) {
        var stopwords = this && this.stopwords,
          queryLowerCase = query.toLowerCase(),
          queryTokens,
          matches = [];

        if (haveSameParent(suggestions)) {
          queryTokens = utils.withSubTokens(utils.getWords(queryLowerCase, stopwords));

          $.each(suggestions, function(i, suggestion) {
            var suggestedValue = suggestion.value.toLowerCase();

            if (utils.stringEncloses(queryLowerCase, suggestedValue)) {
              return false;
            }

            // check if query words are a subset of suggested words
            var suggestionWords = utils.withSubTokens(utils.getWords(suggestedValue, stopwords));

            if (utils.arrayMinus(queryTokens, suggestionWords).length === 0) {
              matches.push(i);
            }
          });
        }

        return matches.length === 1 ? matches[0] : -1;
      },

      matchByWordsAddress: function(query, suggestions) {
        var stopwords = this && this.stopwords,
          queryLowerCase = query.toLowerCase(),
          queryTokens,
          index = -1;

        if (haveSameParentAddress(suggestions)) {
          queryTokens = utils.withSubTokens(utils.getWords(queryLowerCase, stopwords));

          $.each(suggestions, function(i, suggestion) {
            var suggestedValue = suggestion.value.toLowerCase();

            if (utils.stringEncloses(queryLowerCase, suggestedValue)) {
              return false;
            }

            // check if query words are a subset of suggested words
            var suggestionWords = utils.withSubTokens(utils.getWords(suggestedValue, stopwords));

            if (utils.arrayMinus(queryTokens, suggestionWords).length === 0) {
              index = i;
              return false;
            }
          });
        }

        return index;
      },

      /**
       * Matches query against values contained in suggestion fields
       * for cases, when there is only one suggestion
       * only considers fields specified in fieldsStopwords map
       * uses partial matching:
       *   "0445" vs { value: "ALFA-BANK", data: { "bic": "044525593" }} is a match
       */
      matchByFields: function(query, suggestions) {
        var stopwords = this && this.stopwords,
          fieldsStopwords = this && this.fieldsStopwords,
          tokens = utils.withSubTokens(utils.getWords(query.toLowerCase(), stopwords)),
          suggestionWords = [];

        if (suggestions.length === 1) {
          if (fieldsStopwords) {
            $.each(fieldsStopwords, function(field, stopwords) {
              var fieldValue = utils.getDeepValue(suggestions[0], field),
                fieldWords = fieldValue && utils.withSubTokens(utils.getWords(fieldValue.toLowerCase(), stopwords));

              if (fieldWords && fieldWords.length) {
                suggestionWords = suggestionWords.concat(fieldWords);
              }
            });
          }

          if (utils.arrayMinusWithPartialMatching(tokens, suggestionWords).length === 0) {
            return 0;
          }
        }

        return -1;
      },
    };
  })();

  /**
   * Type is a bundle of properties:
   * - urlSuffix Mandatory. String
   * - matchers Mandatory. Array of functions (with optional data bound as a context) that find appropriate suggestion to select
   * - `fieldNames` Map fields of suggestion.data to their displayable names
   * - `unformattableTokens` Array of strings which should not be highlighted
   * - `dataComponents` Array of 'bound's can be set as `bounds` option. Order is important.
   *
   * flags:
   * - `alwaysContinueSelecting` Forbids to hide dropdown after selecting
   * - `geoEnabled` Makes to detect client's location for passing it to all requests
   * - `enrichmentEnabled` Makes to send additional request when a suggestion is selected
   *
   * and methods:
   * - `isDataComplete` Checks if suggestion.data can be operated as full data of it's type
   * - `composeValue` returns string value based on suggestion.data
   * - `formatResult` returns html of a suggestion. Overrides default method
   * - `formatResultInn` returns html of suggestion.data.inn
   * - `isQueryRequestable` checks if query is appropriated for requesting server
   * - `formatSelected` returns string to be inserted in textbox
   */

  var ADDRESS_STOPWORDS = [
    'ао',
    'аобл',
    'дом',
    'респ',
    'а/я',
    'аал',
    'автодорога',
    'аллея',
    'арбан',
    'аул',
    'б-р',
    'берег',
    'бугор',
    'вал',
    'вл',
    'волость',
    'въезд',
    'высел',
    'г',
    'городок',
    'гск',
    'д',
    'двлд',
    'днп',
    'дор',
    'дп',
    'ж/д_будка',
    'ж/д_казарм',
    'ж/д_оп',
    'ж/д_платф',
    'ж/д_пост',
    'ж/д_рзд',
    'ж/д_ст',
    'жилзона',
    'жилрайон',
    'жт',
    'заезд',
    'заимка',
    'зона',
    'к',
    'казарма',
    'канал',
    'кв',
    'кв-л',
    'км',
    'кольцо',
    'комн',
    'кордон',
    'коса',
    'кп',
    'край',
    'линия',
    'лпх',
    'м',
    'массив',
    'местность',
    'мкр',
    'мост',
    'н/п',
    'наб',
    'нп',
    'обл',
    'округ',
    'остров',
    'оф',
    'п',
    'п/о',
    'п/р',
    'п/ст',
    'парк',
    'пгт',
    'пер',
    'переезд',
    'пл',
    'пл-ка',
    'платф',
    'погост',
    'полустанок',
    'починок',
    'пр-кт',
    'проезд',
    'промзона',
    'просек',
    'просека',
    'проселок',
    'проток',
    'протока',
    'проулок',
    'р-н',
    'рзд',
    'россия',
    'рп',
    'ряды',
    'с',
    'с/а',
    'с/мо',
    'с/о',
    'с/п',
    'с/с',
    'сад',
    'сквер',
    'сл',
    'снт',
    'спуск',
    'ст',
    'ст-ца',
    'стр',
    'тер',
    'тракт',
    'туп',
    'у',
    'ул',
    'уч-к',
    'ф/х',
    'ферма',
    'х',
    'ш',
    'бульвар',
    'владение',
    'выселки',
    'гаражно-строительный',
    'город',
    'деревня',
    'домовладение',
    'дорога',
    'квартал',
    'километр',
    'комната',
    'корпус',
    'литер',
    'леспромхоз',
    'местечко',
    'микрорайон',
    'набережная',
    'область',
    'переулок',
    'платформа',
    'площадка',
    'площадь',
    'поселение',
    'поселок',
    'проспект',
    'разъезд',
    'район',
    'республика',
    'село',
    'сельсовет',
    'слобода',
    'сооружение',
    'станица',
    'станция',
    'строение',
    'территория',
    'тупик',
    'улица',
    'улус',
    'участок',
    'хутор',
    'шоссе',
  ];

  /**
   * Компоненты адреса
   * @type {*[]}
   * id {String} Наименование типа
   * fields {Array of Strings}
   * forBounds {Boolean} может использоваться в ограничениях
   * forLocations {Boolean}
   * kladrFormat {Object}
   * fiasType {String} Наименование соответствующего ФИАС типа
   */
  var ADDRESS_COMPONENTS = [
    {
      id: 'kladr_id',
      fields: ['kladr_id'],
      forBounds: false,
      forLocations: true,
    },
    {
      id: 'postal_code',
      fields: ['postal_code'],
      forBounds: false,
      forLocations: true,
    },
    {
      id: 'country',
      fields: ['country'],
      forBounds: false,
      forLocations: true,
    },
    {
      id: 'region_fias_id',
      fields: ['region_fias_id'],
      forBounds: false,
      forLocations: true,
    },
    {
      id: 'region_type_full',
      fields: ['region_type_full'],
      forBounds: false,
      forLocations: true,
      kladrFormat: { digits: 2, zeros: 11 },
      fiasType: 'region_fias_id',
    },
    {
      id: 'region',
      fields: ['region', 'region_type', 'region_type_full', 'region_with_type'],
      forBounds: true,
      forLocations: true,
      kladrFormat: { digits: 2, zeros: 11 },
      fiasType: 'region_fias_id',
    },
    {
      id: 'area_fias_id',
      fields: ['area_fias_id'],
      forBounds: false,
      forLocations: true,
    },
    {
      id: 'area_type_full',
      fields: ['area_type_full'],
      forBounds: false,
      forLocations: true,
      kladrFormat: { digits: 5, zeros: 8 },
      fiasType: 'area_fias_id',
    },
    {
      id: 'area',
      fields: ['area', 'area_type', 'area_type_full', 'area_with_type'],
      forBounds: true,
      forLocations: true,
      kladrFormat: { digits: 5, zeros: 8 },
      fiasType: 'area_fias_id',
    },
    {
      id: 'city_fias_id',
      fields: ['city_fias_id'],
      forBounds: false,
      forLocations: true,
    },
    {
      id: 'city_type_full',
      fields: ['city_type_full'],
      forBounds: false,
      forLocations: true,
      kladrFormat: { digits: 8, zeros: 5 },
      fiasType: 'city_fias_id',
    },
    {
      id: 'city',
      fields: ['city', 'city_type', 'city_type_full', 'city_with_type'],
      forBounds: true,
      forLocations: true,
      kladrFormat: { digits: 8, zeros: 5 },
      fiasType: 'city_fias_id',
    },
    {
      id: 'city_district_fias_id',
      fields: ['city_district_fias_id'],
      forBounds: false,
      forLocations: true,
    },
    {
      id: 'city_district_type_full',
      fields: ['city_district_type_full'],
      forBounds: false,
      forLocations: true,
      kladrFormat: { digits: 11, zeros: 2 },
      fiasType: 'city_district_fias_id',
    },
    {
      id: 'city_district',
      fields: ['city_district', 'city_district_type', 'city_district_type_full', 'city_district_with_type'],
      forBounds: true,
      forLocations: true,
      kladrFormat: { digits: 11, zeros: 2 },
      fiasType: 'city_district_fias_id',
    },
    {
      id: 'settlement_fias_id',
      fields: ['settlement_fias_id'],
      forBounds: false,
      forLocations: true,
    },
    {
      id: 'settlement_type_full',
      fields: ['settlement_type_full'],
      forBounds: false,
      forLocations: true,
      kladrFormat: { digits: 11, zeros: 2 },
      fiasType: 'settlement_fias_id',
    },
    {
      id: 'settlement',
      fields: ['settlement', 'settlement_type', 'settlement_type_full', 'settlement_with_type'],
      forBounds: true,
      forLocations: true,
      kladrFormat: { digits: 11, zeros: 2 },
      fiasType: 'settlement_fias_id',
    },
    {
      id: 'street_fias_id',
      fields: ['street_fias_id'],
      forBounds: false,
      forLocations: true,
    },
    {
      id: 'street_type_full',
      fields: ['street_type_full'],
      forBounds: false,
      forLocations: true,
      kladrFormat: { digits: 15, zeros: 2 },
      fiasType: 'street_fias_id',
    },
    {
      id: 'street',
      fields: ['street', 'street_type', 'street_type_full', 'street_with_type'],
      forBounds: true,
      forLocations: true,
      kladrFormat: { digits: 15, zeros: 2 },
      fiasType: 'street_fias_id',
    },
    {
      id: 'house',
      fields: ['house', 'house_type', 'house_type_full', 'block', 'block_type'],
      forBounds: true,
      forLocations: false,
      kladrFormat: { digits: 19 },
    },
  ];

  var rHasMatch = /<strong>/;

  var innPartsLengths = {
    LEGAL: [2, 2, 5, 1],
    INDIVIDUAL: [2, 2, 6, 2],
  };

  function valueStartsWith(suggestion, field) {
    var fieldValue = suggestion.data && suggestion.data[field];

    return (
      fieldValue &&
      new RegExp('^' + utils.escapeRegExChars(fieldValue) + '([' + WORD_DELIMITERS + ']|$)', 'i').test(suggestion.value)
    );
  }

  function chooseFormattedField(formattedMain, formattedAlt) {
    return rHasMatch.test(formattedAlt) && !rHasMatch.test(formattedMain) ? formattedAlt : formattedMain;
  }

  function formattedField(main, alt, currentValue, suggestion, options) {
    var that = this,
      formattedMain = that.highlightMatches(main, currentValue, suggestion, options),
      formattedAlt = that.highlightMatches(alt, currentValue, suggestion, options);

    return chooseFormattedField(formattedMain, formattedAlt);
  }

  var types = {};

  types['NAME'] = {
    urlSuffix: 'fio',
    noSuggestionsHint: false,
    matchers: [matchers.matchByNormalizedQuery, matchers.matchByWords],
    // names for labels, describing which fields are displayed
    fieldNames: {
      surname: 'фамилия',
      name: 'имя',
      patronymic: 'отчество',
    },
    isDataComplete: function(suggestion) {
      var that = this,
        params = that.options.params,
        data = suggestion.data,
        fields;

      if (utils.isFunction(params)) {
        params = params.call(that.element, suggestion.value);
      }
      if (params && params.parts) {
        fields = params.parts.map(function(part) {
          return part.toLowerCase();
        });
      } else {
        // when NAME is first, patronymic is mot mandatory
        fields = ['surname', 'name'];
        // when SURNAME is first, it is
        if (valueStartsWith(suggestion, 'surname')) {
          fields.push('patronymic');
        }
      }
      return utils.fieldsNotEmpty(data, fields);
    },
    composeValue: function(data) {
      return utils.compact([data.surname, data.name, data.patronymic]).join(' ');
    },
  };

  types['ADDRESS'] = {
    urlSuffix: 'address',
    noSuggestionsHint: 'Неизвестный адрес',
    matchers: [
      jqapi.proxy(matchers.matchByNormalizedQuery, { stopwords: ADDRESS_STOPWORDS }),
      jqapi.proxy(matchers.matchByWordsAddress, { stopwords: ADDRESS_STOPWORDS }),
    ],
    dataComponents: ADDRESS_COMPONENTS,
    dataComponentsById: utils.indexBy(ADDRESS_COMPONENTS, 'id', 'index'),
    unformattableTokens: ADDRESS_STOPWORDS,
    enrichmentEnabled: true,
    enrichmentMethod: 'suggest',
    enrichmentParams: {
      count: 1,
      locations: null,
      locations_boost: null,
      from_bound: null,
      to_bound: null,
    },
    getEnrichmentQuery: function(suggestion) {
      return suggestion.unrestricted_value;
    },
    geoEnabled: true,
    isDataComplete: function(suggestion) {
      var fields = [this.bounds.to || 'flat'],
        data = suggestion.data;

      return !utils.isPlainObject(data) || utils.fieldsNotEmpty(data, fields);
    },
    composeValue: function(data, options) {
      var region =
          data.region_with_type || utils.compact([data.region, data.region_type]).join(' ') || data.region_type_full,
        area = data.area_with_type || utils.compact([data.area_type, data.area]).join(' ') || data.area_type_full,
        city = data.city_with_type || utils.compact([data.city_type, data.city]).join(' ') || data.city_type_full,
        settelement =
          data.settlement_with_type ||
          utils.compact([data.settlement_type, data.settlement]).join(' ') ||
          data.settlement_type_full,
        cityDistrict =
          data.city_district_with_type ||
          utils.compact([data.city_district_type, data.city_district]).join(' ') ||
          data.city_district_type_full,
        street =
          data.street_with_type || utils.compact([data.street_type, data.street]).join(' ') || data.street_type_full,
        house = utils.compact([data.house_type, data.house, data.block_type, data.block]).join(' '),
        flat = utils.compact([data.flat_type, data.flat]).join(' '),
        postal_box = data.postal_box && 'а/я ' + data.postal_box,
        result;

      // если регион совпадает с городом
      // например г Москва, г Москва
      // то не показываем регион
      if (region === city) {
        region = '';
      }

      // иногда не показываем район
      if (!(options && options.saveCityDistrict)) {
        if (options && options.excludeCityDistrict) {
          // если район явно запрещен
          cityDistrict = '';
        } else if (cityDistrict && !data.city_district_fias_id) {
          // если район взят из ОКАТО (у него пустой city_district_fias_id)
          cityDistrict = '';
        }
      }

      result = utils
        .compact([region, area, city, cityDistrict, settelement, street, house, flat, postal_box])
        .join(', ');

      return result;
    },
    formatResult: (function() {
      var componentsUnderCityDistrict = [],
        _underCityDistrict = false;

      ADDRESS_COMPONENTS.forEach(function(component) {
        if (_underCityDistrict) componentsUnderCityDistrict.push(component.id);
        if (component.id === 'city_district') _underCityDistrict = true;
      });

      return function(value, currentValue, suggestion, options) {
        var that = this,
          district = suggestion.data && suggestion.data.city_district_with_type,
          unformattableTokens = options && options.unformattableTokens,
          historyValues = suggestion.data && suggestion.data.history_values,
          tokens,
          unusedTokens,
          formattedHistoryValues;

        // добавляем исторические значения
        if (historyValues && historyValues.length > 0) {
          tokens = utils.getTokens(currentValue, unformattableTokens);
          unusedTokens = this.type.findUnusedTokens(tokens, value);
          formattedHistoryValues = this.type.getFormattedHistoryValues(unusedTokens, historyValues);
          if (formattedHistoryValues) {
            value += formattedHistoryValues;
          }
        }

        value = that.highlightMatches(value, currentValue, suggestion, options);
        value = that.wrapFormattedValue(value, suggestion);

        if (
          district &&
          (!that.bounds.own.length || that.bounds.own.indexOf('street') >= 0) &&
          !utils.isEmptyObject(that.copyDataComponents(suggestion.data, componentsUnderCityDistrict))
        ) {
          value +=
            '<div class="' +
            that.classes.subtext +
            '">' +
            that.highlightMatches(district, currentValue, suggestion) +
            '</div>';
        }

        return value;
      };
    })(),

    /**
     * Возвращает список слов в запросе для которых не найдено соответствующего слова в ответе
     */
    findUnusedTokens: function(tokens, value) {
      var tokenIndex,
        token,
        unused = [];

      for (tokenIndex in tokens) {
        token = tokens[tokenIndex];
        if (value.indexOf(token) === -1) {
          unused.push(token);
        }
      }

      return unused;
    },

    /**
     * Возвращает исторические названия для слов запроса, для которых не найдено совпадения в основном значении
     */
    getFormattedHistoryValues: function(unusedTokens, historyValues) {
      var tokenIndex,
        token,
        historyValueIndex,
        historyValue,
        values = [],
        formatted = '';

      for (historyValueIndex in historyValues) {
        historyValue = historyValues[historyValueIndex];
        for (tokenIndex in unusedTokens) {
          token = unusedTokens[tokenIndex];
          //if (historyValue.toLowerCase().indexOf(token) >= 0) {
          //    values.push(historyValue);
          //    break;
          //}
        }
      }

      if (values.length > 0) {
        formatted = ' (бывш. ' + values.join(', ') + ')';
      }

      return formatted;
    },

    /**
     * @param instance
     * @param options
     * @param options.suggestion
     * @param options.hasSameValues
     * @param options.hasBeenEnreached
     */
    getSuggestionValue: function(instance, options) {
      var formattedValue = null;

      if (options.hasSameValues) {
        if (instance.options.restrict_value) {
          // Can not use unrestricted address,
          // because some components (from constraints) must be omitted
          formattedValue = this.getValueWithinConstraints(instance, options.suggestion);
        } else if (instance.bounds.own.length) {
          // Can not use unrestricted address,
          // because only components from bounds must be included
          formattedValue = this.getValueWithinBounds(instance, options.suggestion);
        } else {
          // Can use full unrestricted address
          formattedValue = options.suggestion.unrestricted_value;
        }
      } else if (options.hasBeenEnriched) {
        if (instance.options.restrict_value) {
          formattedValue = this.getValueWithinConstraints(instance, options.suggestion, { excludeCityDistrict: true });
        }
      }

      return formattedValue;
    },
    /*
     * Compose suggestion value with respect to constraints
     */
    getValueWithinConstraints: function(instance, suggestion, options) {
      return this.composeValue(instance.getUnrestrictedData(suggestion.data), options);
    },
    /*
     * Compose suggestion value with respect to bounds
     */
    getValueWithinBounds: function(instance, suggestion, options) {
      // для корректного составления адреса нужен city_district_fias_id
      var data = instance.copyDataComponents(suggestion.data, instance.bounds.own.concat(['city_district_fias_id']));

      return this.composeValue(data, options);
    },
  };

  types['PARTY'] = {
    urlSuffix: 'party',
    noSuggestionsHint: 'Неизвестная организация',
    matchers: [
      jqapi.proxy(matchers.matchByFields, {
        // These fields of suggestion's `data` used by by-words matcher
        fieldsStopwords: {
          value: null,
          'data.address.value': ADDRESS_STOPWORDS,
          'data.inn': null,
          'data.ogrn': null,
        },
      }),
    ],
    dataComponents: ADDRESS_COMPONENTS,
    enrichmentEnabled: true,
    enrichmentMethod: 'findById',
    enrichmentParams: {
      count: 1,
      locations_boost: null,
    },
    getEnrichmentQuery: function(suggestion) {
      return suggestion.data.hid;
    },
    geoEnabled: true,
    formatResult: function(value, currentValue, suggestion, options) {
      var that = this,
        formattedInn = that.type.formatResultInn.call(that, suggestion, currentValue),
        formatterOGRN = that.highlightMatches(utils.getDeepValue(suggestion.data, 'ogrn'), currentValue, suggestion),
        formattedInnOGRN = chooseFormattedField(formattedInn, formatterOGRN),
        formattedFIO = that.highlightMatches(
          utils.getDeepValue(suggestion.data, 'management.name'),
          currentValue,
          suggestion
        ),
        address = utils.getDeepValue(suggestion.data, 'address.value') || '';

      if (that.isMobile) {
        (options || (options = {})).maxLength = 50;
      }

      value = formattedField.call(
        that,
        value,
        utils.getDeepValue(suggestion.data, 'name.latin'),
        currentValue,
        suggestion,
        options
      );
      value = that.wrapFormattedValue(value, suggestion);

      if (address) {
        address = address.replace(/^(\d{6}?\s+|Россия,\s+)/i, '');
        if (that.isMobile) {
          // keep only two first words
          address = address.replace(
            new RegExp('^([^' + WORD_DELIMITERS + ']+[' + WORD_DELIMITERS + ']+[^' + WORD_DELIMITERS + ']+).*'),
            '$1'
          );
        } else {
          address = that.highlightMatches(address, currentValue, suggestion, {
            unformattableTokens: ADDRESS_STOPWORDS,
          });
        }
      }

      if (formattedInnOGRN || address || formattedFIO) {
        value +=
          '<div class="' +
          that.classes.subtext +
          '">' +
          '<span class="' +
          that.classes.subtext_inline +
          '">' +
          (formattedInnOGRN || '') +
          '</span>' +
          (chooseFormattedField(address, formattedFIO) || '') +
          '</div>';
      }
      return value;
    },
    formatResultInn: function(suggestion, currentValue) {
      var that = this,
        inn = suggestion.data && suggestion.data.inn,
        innPartsLength = innPartsLengths[suggestion.data && suggestion.data.type],
        innParts,
        formattedInn,
        rDigit = /\d/;

      if (inn) {
        formattedInn = that.highlightMatches(inn, currentValue, suggestion);
        if (innPartsLength) {
          formattedInn = formattedInn.split('');
          innParts = innPartsLength.map(function(partLength) {
            var formattedPart = '',
              ch;

            while (partLength && (ch = formattedInn.shift())) {
              formattedPart += ch;
              if (rDigit.test(ch)) partLength--;
            }

            return formattedPart;
          });
          formattedInn =
            innParts.join('<span class="' + that.classes.subtext_delimiter + '"></span>') + formattedInn.join('');
        }

        return formattedInn;
      }
    },
  };

  types['EMAIL'] = {
    urlSuffix: 'email',
    noSuggestionsHint: false,
    matchers: [matchers.matchByNormalizedQuery],
    isQueryRequestable: function(query) {
      return this.options.suggest_local || query.indexOf('@') >= 0;
    },
  };

  types['BANK'] = {
    urlSuffix: 'bank',
    noSuggestionsHint: 'Неизвестный банк',
    matchers: [
      jqapi.proxy(matchers.matchByFields, {
        // These fields of suggestion's `data` used by by-words matcher
        fieldsStopwords: {
          value: null,
          'data.bic': null,
          'data.swift': null,
        },
      }),
    ],
    dataComponents: ADDRESS_COMPONENTS,
    geoEnabled: true,
    formatResult: function(value, currentValue, suggestion, options) {
      var that = this,
        formattedBIC = that.highlightMatches(utils.getDeepValue(suggestion.data, 'bic'), currentValue, suggestion),
        address = utils.getDeepValue(suggestion.data, 'address.value') || '';

      value = that.highlightMatches(value, currentValue, suggestion, options);
      value = that.wrapFormattedValue(value, suggestion);

      if (address) {
        address = address.replace(/^\d{6}( РОССИЯ)?, /i, '');
        if (that.isMobile) {
          // keep only two first words
          address = address.replace(
            new RegExp('^([^' + WORD_DELIMITERS + ']+[' + WORD_DELIMITERS + ']+[^' + WORD_DELIMITERS + ']+).*'),
            '$1'
          );
        } else {
          address = that.highlightMatches(address, currentValue, suggestion, {
            unformattableTokens: ADDRESS_STOPWORDS,
          });
        }
      }

      if (formattedBIC || address) {
        value +=
          '<div class="' +
          that.classes.subtext +
          '">' +
          '<span class="' +
          that.classes.subtext_inline +
          '">' +
          formattedBIC +
          '</span>' +
          address +
          '</div>';
      }
      return value;
    },
    formatSelected: function(suggestion) {
      return utils.getDeepValue(suggestion, 'data.name.payment') || null;
    },
  };

  jqapi.extend(DEFAULT_OPTIONS, {
    suggest_local: true,
  });

  var notificator = {
    chains: {},

    on: function(name, method) {
      this.get(name).push(method);
      return this;
    },

    get: function(name) {
      var chains = this.chains;
      return chains[name] || (chains[name] = []);
    },
  };

  var serviceMethods = {
    suggest: {
      defaultParams: {
        type: utils.getDefaultType(),
        dataType: 'json',
        contentType: utils.getDefaultContentType(),
      },
      addTypeInUrl: true,
    },
    detectAddressByIp: {
      defaultParams: {
        type: 'GET',
        dataType: 'json',
      },
      addTypeInUrl: false,
    },
    status: {
      defaultParams: {
        type: 'GET',
        dataType: 'json',
      },
      addTypeInUrl: true,
    },
    findById: {
      defaultParams: {
        type: utils.getDefaultType(),
        dataType: 'json',
        contentType: utils.getDefaultContentType(),
      },
      addTypeInUrl: true,
    },
  };

  var requestModes = {
    suggest: {
      method: 'suggest',
      userSelect: true,
      updateValue: true,
      enrichmentEnabled: true,
    },
    findById: {
      method: 'findById',
      userSelect: false,
      updateValue: false,
      enrichmentEnabled: false,
    },
  };

  function Suggestions(el, options) {
    var that = this;

    // Shared variables:
    that.element = el;
    that.el = $(el);
    that.suggestions = [];
    that.badQueries = [];
    that.selectedIndex = -1;
    that.currentValue = that.element.value;
    that.intervalId = 0;
    that.cachedResponse = {};
    that.enrichmentCache = {};
    that.currentRequest = null;
    that.inputPhase = $.Deferred();
    that.fetchPhase = $.Deferred();
    that.enrichPhase = $.Deferred();
    that.onChangeTimeout = null;
    that.triggering = {};
    that.$wrapper = null;
    that.options = $.extend({}, DEFAULT_OPTIONS, options);
    that.classes = CLASSES;
    that.disabled = false;
    that.selection = null;
    that.$viewport = $(window);
    that.$body = $(document.body);
    that.type = null;
    that.status = {};

    that.setupElement();

    that.initializer = $.Deferred();

    if (that.el.is(':visible')) {
      that.initializer.resolve();
    } else {
      that.deferInitialization();
    }

    that.initializer.done($.proxy(that.initialize, that));
  }

  Suggestions.prototype = {
    // Creation and destruction

    initialize: function() {
      var that = this;

      that.uniqueId = utils.uniqueId('i');

      that.createWrapper();
      that.notify('initialize');

      that.bindWindowEvents();

      that.setOptions();
      that.fixPosition();
    },

    /**
     * Initialize when element is firstly interacted
     */
    deferInitialization: function() {
      var that = this,
        events = 'mouseover focus keydown',
        timer,
        callback = function() {
          that.initializer.resolve();
          that.enable();
        };

      that.initializer.always(function() {
        that.el.off(events, callback);
        clearInterval(timer);
      });

      that.disabled = true;
      that.el.on(events, callback);
      timer = setInterval(function() {
        if (that.el.is(':visible')) {
          callback();
        }
      }, that.options.initializeInterval);
    },

    isInitialized: function() {
      return this.initializer.state() === 'resolved';
    },

    dispose: function() {
      //var that = this;
      //
      //that.initializer.reject();
      //that.notify('dispose');
      //that.el.removeData(DATA_ATTR_KEY)
      //    .removeClass('suggestions-input');
      //that.unbindWindowEvents();
      //that.removeWrapper();
      //that.el.trigger('suggestions-dispose');
    },

    notify: function(chainName) {
      var that = this,
        args = utils.slice(arguments, 1);

      return $.map(notificator.get(chainName), function(method) {
        return method.apply(that, args);
      });
    },

    createWrapper: function() {
      var that = this;

      that.$wrapper = $('<div class="suggestions-wrapper"/>');
      that.el.after(that.$wrapper);

      that.$wrapper.on('mousedown' + EVENT_NS, $.proxy(that.onMousedown, that));
    },

    removeWrapper: function() {
      var that = this;

      if (that.$wrapper) {
        that.$wrapper.remove();
      }
      $(that.options.$helpers).off(EVENT_NS);
    },

    /** This whole handler is needed to prevent blur event on textbox
     * when suggestion is clicked (blur leads to suggestions hide, so we need to prevent it).
     * See https://github.com/jquery/jquery-ui/blob/master/ui/autocomplete.js for details
     */
    onMousedown: function(e) {
      var that = this;

      // prevent moving focus out of the text field
      e.preventDefault();

      // IE doesn't prevent moving focus even with e.preventDefault()
      // so we set a flag to know when we should ignore the blur event
      that.cancelBlur = true;
      utils.delay(function() {
        delete that.cancelBlur;
      });

      // clicking on the scrollbar causes focus to shift to the body
      // but we can't detect a mouseup or a click immediately afterward
      // so we have to track the next mousedown and close the menu if
      // the user clicks somewhere outside of the autocomplete
      if ($(e.target).closest('.ui-menu-item').length == 0) {
        utils.delay(function() {
          $(document).one('mousedown', function(e) {
            var $elements = that.el.add(that.$wrapper).add(that.options.$helpers);

            if (that.options.floating) {
              $elements = $elements.add(that.$container);
            }

            $elements = $elements.filter(function() {
              return this === e.target || $.contains(this, e.target);
            });

            if (!$elements.length) {
              that.hide();
            }
          });
        });
      }
    },

    bindWindowEvents: function() {
      var that = this,
        handler = $.proxy(that.fixPosition, that);

      that.$viewport.on('resize' + EVENT_NS + that.uniqueId, handler).on('scroll' + EVENT_NS + that.uniqueId, handler);
    },

    unbindWindowEvents: function() {
      this.$viewport.off('resize' + EVENT_NS + this.uniqueId).off('scroll' + EVENT_NS + this.uniqueId);
    },

    scrollToTop: function() {
      var that = this,
        scrollTarget = that.options.scrollOnFocus;

      if (scrollTarget === true) {
        scrollTarget = that.el;
      }
      if (scrollTarget instanceof $ && scrollTarget.length > 0) {
        $('body,html').animate(
          {
            scrollTop: scrollTarget.offset().top,
          },
          'fast'
        );
      }
    },

    // Configuration methods

    setOptions: function(suppliedOptions) {
      var that = this;

      $.extend(that.options, suppliedOptions);

      // Check mandatory options
      $.each(
        {
          type: types,
          requestMode: requestModes,
        },
        function(option, available) {
          that[option] = available[that.options[option]];
          if (!that[option]) {
            that.disable();
            throw '`' +
              option +
              '` option is incorrect! Must be one of: ' +
              $.map(available, function(value, name) {
                return '"' + name + '"';
              }).join(', ');
          }
        }
      );

      $(that.options.$helpers)
        .off(EVENT_NS)
        .on('mousedown' + EVENT_NS, $.proxy(that.onMousedown, that));

      if (that.isInitialized()) {
        that.notify('setOptions');
      }
    },

    // Common public methods

    fixPosition: function(e) {
      var that = this,
        elLayout = {},
        wrapperOffset,
        origin;

      that.isMobile = that.$viewport.width() <= that.options.mobileWidth;

      if (!that.isInitialized() || (e && e.type == 'scroll' && !(that.options.floating || that.isMobile))) return;
      that.$container.appendTo(that.options.floating ? that.$body : that.$wrapper);

      that.notify('resetPosition');
      // reset input's padding to default, determined by css
      that.el.css('paddingLeft', '');
      that.el.css('paddingRight', '');
      elLayout.paddingLeft = parseFloat(that.el.css('paddingLeft'));
      elLayout.paddingRight = parseFloat(that.el.css('paddingRight'));

      $.extend(elLayout, that.el.offset());
      elLayout.borderTop = that.el.css('border-top-style') == 'none' ? 0 : parseFloat(that.el.css('border-top-width'));
      elLayout.borderLeft =
        that.el.css('border-left-style') == 'none' ? 0 : parseFloat(that.el.css('border-left-width'));
      elLayout.innerHeight = that.el.innerHeight();
      elLayout.innerWidth = that.el.innerWidth();
      elLayout.outerHeight = that.el.outerHeight();
      elLayout.componentsLeft = 0;
      elLayout.componentsRight = 0;
      wrapperOffset = that.$wrapper.offset();

      origin = {
        top: elLayout.top - wrapperOffset.top,
        left: elLayout.left - wrapperOffset.left,
      };

      that.notify('fixPosition', origin, elLayout);

      if (elLayout.componentsLeft > elLayout.paddingLeft) {
        that.el.css('paddingLeft', elLayout.componentsLeft + 'px');
      }
      if (elLayout.componentsRight > elLayout.paddingRight) {
        that.el.css('paddingRight', elLayout.componentsRight + 'px');
      }
    },

    clearCache: function() {
      this.cachedResponse = {};
      this.enrichmentCache = {};
      this.badQueries = [];
    },

    clear: function() {
      var that = this,
        currentSelection = that.selection;

      if (that.isInitialized()) {
        that.clearCache();
        that.currentValue = '';
        that.selection = null;
        that.hide();
        that.suggestions = [];
        that.el.val('');
        that.el.trigger('suggestions-clear');
        that.notify('clear');
        that.trigger('InvalidateSelection', currentSelection);
      }
    },

    disable: function() {
      var that = this;

      that.disabled = true;
      that.abortRequest();
      if (that.visible) {
        that.hide();
      }
    },

    enable: function() {
      this.disabled = false;
    },

    isUnavailable: function() {
      return this.disabled;
    },

    update: function() {
      var that = this,
        query = that.el.val();

      if (that.isInitialized()) {
        that.currentValue = query;
        if (that.isQueryRequestable(query)) {
          that.updateSuggestions(query);
        } else {
          that.hide();
        }
      }
    },

    setSuggestion: function(suggestion) {
      var that = this,
        data,
        value;

      if ($.isPlainObject(suggestion) && $.isPlainObject(suggestion.data)) {
        suggestion = $.extend(true, {}, suggestion);

        if (that.isUnavailable() && that.initializer && that.initializer.state() === 'pending') {
          that.initializer.resolve();
          that.enable();
        }

        if (that.bounds.own.length) {
          that.checkValueBounds(suggestion);
          data = that.copyDataComponents(suggestion.data, that.bounds.all);
          if (suggestion.data.kladr_id) {
            data.kladr_id = that.getBoundedKladrId(suggestion.data.kladr_id, that.bounds.all);
          }
          suggestion.data = data;
        }

        that.selection = suggestion;

        // `that.suggestions` required by `that.getSuggestionValue` and must be set before
        that.suggestions = [suggestion];
        value = that.getSuggestionValue(suggestion) || '';
        that.currentValue = value;
        that.el.val(value);
        that.abortRequest();
        that.el.trigger('suggestions-set');
      }
    },

    /**
     * Fetch full object for current INPUT's value
     * if no suitable object found, clean input element
     */
    fixData: function() {
      var that = this,
        fullQuery = that.extendedCurrentValue(),
        currentValue = that.el.val(),
        resolver = $.Deferred();

      resolver
        .done(function(suggestion) {
          that.selectSuggestion(suggestion, 0, currentValue, { hasBeenEnriched: true });
          that.el.trigger('suggestions-fixdata', suggestion);
        })
        .fail(function() {
          that.selection = null;
          that.el.trigger('suggestions-fixdata');
        });

      if (that.isQueryRequestable(fullQuery)) {
        that.currentValue = fullQuery;
        that
          .getSuggestions(fullQuery, { count: 1, from_bound: null, to_bound: null })
          .done(function(suggestions) {
            // data fetched
            var suggestion = suggestions[0];
            if (suggestion) {
              resolver.resolve(suggestion);
            } else {
              resolver.reject();
            }
          })
          .fail(function() {
            // no data fetched
            resolver.reject();
          });
      } else {
        resolver.reject();
      }
    },

    // Querying related methods

    /**
     * Looks up parent instances
     * @returns {String} current value prepended by parents' values
     */
    extendedCurrentValue: function() {
      var that = this,
        parentInstance = that.getParentInstance(),
        parentValue = parentInstance && parentInstance.extendedCurrentValue(),
        currentValue = $.trim(that.el.val());

      return utils.compact([parentValue, currentValue]).join(' ');
    },

    getAjaxParams: function(method, custom) {
      var that = this,
        token = $.trim(that.options.token),
        partner = $.trim(that.options.partner),
        serviceUrl = that.options.serviceUrl,
        url = that.options.url,
        serviceMethod = serviceMethods[method],
        params = $.extend(
          {
            timeout: that.options.timeout,
          },
          serviceMethod.defaultParams
        ),
        headers = {};

      if (url) {
        serviceUrl = url;
      } else {
        if (!/\/$/.test(serviceUrl)) {
          serviceUrl += '/';
        }
        serviceUrl += method;
        if (serviceMethod.addTypeInUrl) {
          serviceUrl += '/' + that.type.urlSuffix;
        }
      }

      serviceUrl = utils.fixURLProtocol(serviceUrl);

      if ($.support.cors) {
        // for XMLHttpRequest put token in header
        if (token) {
          headers['Authorization'] = 'Token ' + token;
        }
        if (partner) {
          headers['X-Partner'] = partner;
        }
        headers['X-Version'] = Suggestions.version;
        if (!params.headers) {
          params.headers = {};
        }
        if (!params.xhrFields) {
          params.xhrFields = {};
        }
        $.extend(params.headers, that.options.headers, headers);
        // server sets Access-Control-Allow-Origin: *
        // which requires no credentials
        params.xhrFields.withCredentials = false;
      } else {
        // for XDomainRequest put token into URL
        if (token) {
          headers['token'] = token;
        }
        if (partner) {
          headers['partner'] = partner;
        }
        headers['version'] = Suggestions.version;
        serviceUrl = utils.addUrlParams(serviceUrl, headers);
      }

      params.url = serviceUrl;

      return $.extend(params, custom);
    },

    isQueryRequestable: function(query) {
      var that = this,
        result;

      result = query.length >= that.options.minChars;

      if (result && that.type.isQueryRequestable) {
        result = that.type.isQueryRequestable.call(that, query);
      }

      return result;
    },

    constructRequestParams: function(query, customParams) {
      var that = this,
        options = that.options,
        params = $.isFunction(options.params) ? options.params.call(that.element, query) : $.extend({}, options.params);

      if (that.type.constructRequestParams) {
        $.extend(params, that.type.constructRequestParams.call(that));
      }
      $.each(that.notify('requestParams'), function(i, hookParams) {
        $.extend(params, hookParams);
      });
      params[options.paramName] = query;
      if ($.isNumeric(options.count) && options.count > 0) {
        params.count = options.count;
      }

      return $.extend(params, customParams);
    },

    updateSuggestions: function(query) {
      var that = this;

      that.fetchPhase = that.getSuggestions(query).done(function(suggestions) {
        that.assignSuggestions(suggestions, query);
      });
    },

    /**
     * Get suggestions from cache or from server
     * @param {String} query
     * @param {Object} customParams parameters specified here will be passed to request body
     * @param {Object} requestOptions
     * @param {Boolean} [requestOptions.noCallbacks]  flag, request competence callbacks will not be invoked
     * @param {Boolean} [requestOptions.useEnrichmentCache]
     * @return {$.Deferred} waiter which is to be resolved with suggestions as argument
     */
    getSuggestions: function(query, customParams, requestOptions) {
      var response,
        that = this,
        options = that.options,
        noCallbacks = requestOptions && requestOptions.noCallbacks,
        useEnrichmentCache = requestOptions && requestOptions.useEnrichmentCache,
        method = (requestOptions && requestOptions.method) || that.requestMode.method,
        params = that.constructRequestParams(query, customParams),
        cacheKey = $.param(params || {}),
        resolver = $.Deferred();

      response = that.cachedResponse[cacheKey];
      if (response && $.isArray(response.suggestions)) {
        resolver.resolve(response.suggestions);
      } else {
        if (that.isBadQuery(query)) {
          resolver.reject();
        } else {
          if (!noCallbacks && options.onSearchStart.call(that.element, params) === false) {
            resolver.reject();
          } else {
            that
              .doGetSuggestions(params, method)
              .done(function(response) {
                // if response is correct and current value has not been changed
                if (that.processResponse(response) && query == that.currentValue) {
                  // Cache results if cache is not disabled:
                  if (!options.noCache) {
                    if (useEnrichmentCache) {
                      that.enrichmentCache[query] = response.suggestions[0];
                    } else {
                      that.enrichResponse(response, query);
                      that.cachedResponse[cacheKey] = response;
                      if (options.preventBadQueries && response.suggestions.length === 0) {
                        that.badQueries.push(query);
                      }
                    }
                  }

                  resolver.resolve(response.suggestions);
                } else {
                  resolver.reject();
                }
                if (!noCallbacks) {
                  options.onSearchComplete.call(that.element, query, response.suggestions);
                }
              })
              .fail(function(jqXHR, textStatus, errorThrown) {
                resolver.reject();
                if (!noCallbacks && textStatus !== 'abort') {
                  options.onSearchError.call(that.element, query, jqXHR, textStatus, errorThrown);
                }
              });
          }
        }
      }
      return resolver;
    },

    /**
     * Sends an AJAX request to server suggest method.
     * @param {Object} params request params
     * @returns {$.Deferred} response promise
     */
    doGetSuggestions: function(params, method) {
      var that = this,
        request = $.ajax(that.getAjaxParams(method, { data: utils.serialize(params) }));

      that.abortRequest();
      that.currentRequest = request;
      that.notify('request');

      request.always(function() {
        that.currentRequest = null;
        that.notify('request');
      });

      return request;
    },

    isBadQuery: function(q) {
      if (!this.options.preventBadQueries) {
        return false;
      }

      var result = false;
      $.each(this.badQueries, function(i, query) {
        return !(result = q.indexOf(query) === 0);
      });
      return result;
    },

    abortRequest: function() {
      var that = this;

      if (that.currentRequest) {
        that.currentRequest.abort();
      }
    },

    /**
     * Checks response format and data
     * @return {Boolean} response contains acceptable data
     */
    processResponse: function(response) {
      var that = this,
        suggestions;

      if (!response || !$.isArray(response.suggestions)) {
        return false;
      }

      that.verifySuggestionsFormat(response.suggestions);
      that.setUnrestrictedValues(response.suggestions);

      if ($.isFunction(that.options.onSuggestionsFetch)) {
        suggestions = that.options.onSuggestionsFetch.call(that.element, response.suggestions);
        if ($.isArray(suggestions)) {
          response.suggestions = suggestions;
        }
      }

      return true;
    },

    verifySuggestionsFormat: function(suggestions) {
      if (typeof suggestions[0] === 'string') {
        $.each(suggestions, function(i, value) {
          suggestions[i] = { value: value, data: null };
        });
      }
    },

    /**
     * Gets string to set as input value
     *
     * @param suggestion
     * @param {Object} [selectionOptions]
     * @param {boolean} selectionOptions.hasBeenEnriched
     * @param {boolean} selectionOptions.hasSameValues
     * @return {string}
     */
    getSuggestionValue: function(suggestion, selectionOptions) {
      var that = this,
        formatSelected = that.options.formatSelected || that.type.formatSelected,
        hasSameValues = selectionOptions && selectionOptions.hasSameValues,
        hasBeenEnriched = selectionOptions && selectionOptions.hasBeenEnriched,
        formattedValue,
        typeFormattedValue = null;

      if ($.isFunction(formatSelected)) {
        formattedValue = formatSelected.call(that, suggestion);
      }

      if (typeof formattedValue !== 'string') {
        formattedValue = suggestion.value;

        if (that.type.getSuggestionValue) {
          typeFormattedValue = that.type.getSuggestionValue(that, {
            suggestion: suggestion,
            hasSameValues: hasSameValues,
            hasBeenEnriched: hasBeenEnriched,
          });

          if (typeFormattedValue !== null) {
            formattedValue = typeFormattedValue;
          }
        }
      }

      return formattedValue;
    },

    hasSameValues: function(suggestion) {
      var hasSame = false;

      $.each(this.suggestions, function(i, anotherSuggestion) {
        if (anotherSuggestion.value === suggestion.value && anotherSuggestion !== suggestion) {
          hasSame = true;
          return false;
        }
      });

      return hasSame;
    },

    assignSuggestions: function(suggestions, query) {
      var that = this;
      that.suggestions = suggestions;
      that.notify('assignSuggestions', query);
    },

    shouldRestrictValues: function() {
      var that = this;
      // treat suggestions value as restricted only if there is one constraint
      // and restrict_value is true
      return that.options.restrict_value && that.constraints && Object.keys(that.constraints).length == 1;
    },

    /**
     * Fills suggestion.unrestricted_value property
     */
    setUnrestrictedValues: function(suggestions) {
      var that = this,
        shouldRestrict = that.shouldRestrictValues(),
        label = that.getFirstConstraintLabel();

      $.each(suggestions, function(i, suggestion) {
        if (!suggestion.unrestricted_value) {
          suggestion.unrestricted_value = shouldRestrict ? label + ', ' + suggestion.value : suggestion.value;
        }
      });
    },

    areSuggestionsSame: function(a, b) {
      return a && b && a.value === b.value && utils.areSame(a.data, b.data);
    },

    getNoSuggestionsHint: function() {
      var that = this;
      if (that.options.noSuggestionsHint === false) {
        return false;
      }
      return that.options.noSuggestionsHint || that.type.noSuggestionsHint;
    },
  };

  /**
   * Methods related to INPUT's behavior
   */

  var methods = {
    setupElement: function() {
      // Remove autocomplete attribute to prevent native suggestions:
      this.el
        .attr('autocomplete', 'off')
        .attr('autocorrect', 'off')
        .attr('autocapitalize', 'off')
        .attr('spellcheck', 'false')
        .addClass('suggestions-input')
        .css('box-sizing', 'border-box');
    },

    bindElementEvents: function() {
      var that = this;

      that.el.on('keydown' + EVENT_NS, $.proxy(that.onElementKeyDown, that));
      // IE is buggy, it doesn't trigger `input` on text deletion, so use following events
      that.el.on(
        ['keyup' + EVENT_NS, 'cut' + EVENT_NS, 'paste' + EVENT_NS, 'input' + EVENT_NS].join(' '),
        $.proxy(that.onElementKeyUp, that)
      );
      that.el.on('blur' + EVENT_NS, $.proxy(that.onElementBlur, that));
      // FIXME: ECOM-8070 przypadek z wypełnionym adresem
      // that.el.on('focus' + EVENT_NS, $.proxy(that.onElementFocus, that));
    },

    unbindElementEvents: function() {
      this.el.off(EVENT_NS);
    },

    onElementBlur: function() {
      var that = this;

      // suggestion was clicked, blur should be ignored
      // see container mousedown handler
      if (that.cancelBlur) {
        that.cancelBlur = false;
        return;
      }

      if (that.options.triggerSelectOnBlur) {
        if (!that.isUnavailable()) {
          that.selectCurrentValue({ noSpace: true }).always(function() {
            // For NAMEs selecting keeps suggestions list visible, so hide it
            that.hide();
          });
        }
      } else {
        that.hide();
      }

      if (that.fetchPhase.abort) {
        that.fetchPhase.abort();
      }
    },

    onElementFocus: function() {
      var that = this;

      if (!that.cancelFocus) {
        // defer methods to allow browser update input's style before
        utils.delay($.proxy(that.completeOnFocus, that));
      }
      that.cancelFocus = false;
    },

    onElementKeyDown: function(e) {
      var that = this;

      if (that.isUnavailable()) {
        return;
      }

      if (!that.visible) {
        switch (e.which) {
          // If suggestions are hidden and user presses arrow down, display suggestions
          case KEYS.DOWN:
            that.suggest();
            break;
          // if no suggestions available and user pressed Enter
          case KEYS.ENTER:
            if (that.options.triggerSelectOnEnter) {
              that.triggerOnSelectNothing();
            }
            break;
        }
        return;
      }

      switch (e.which) {
        case KEYS.ESC:
          that.el.val(that.currentValue);
          that.hide();
          that.abortRequest();
          break;

        case KEYS.TAB:
          if (that.options.tabDisabled === false) {
            return;
          }
          break;

        case KEYS.ENTER:
          if (that.options.triggerSelectOnEnter) {
            that.selectCurrentValue();
          }
          break;

        case KEYS.SPACE:
          if (that.options.triggerSelectOnSpace && that.isCursorAtEnd()) {
            e.preventDefault();
            that.selectCurrentValue({ continueSelecting: true, dontEnrich: true }).fail(function() {
              // If all data fetched but nothing selected
              that.currentValue += ' ';
              that.el.val(that.currentValue);
              that.proceedChangedValue();
            });
          }
          return;
        case KEYS.UP:
          that.moveUp();
          break;
        case KEYS.DOWN:
          that.moveDown();
          break;
        default:
          return;
      }

      // Cancel event if function did not return:
      e.stopImmediatePropagation();
      e.preventDefault();
    },

    onElementKeyUp: function(e) {
      var that = this;

      if (that.isUnavailable()) {
        return;
      }

      switch (e.which) {
        case KEYS.UP:
        case KEYS.DOWN:
        case KEYS.ENTER:
          return;
      }

      // Cancel pending change
      clearTimeout(that.onChangeTimeout);
      that.inputPhase.reject();

      if (that.currentValue !== that.el.val()) {
        that.proceedChangedValue();
      }
    },

    proceedChangedValue: function() {
      var that = this;

      // Cancel fetching, because it became obsolete
      that.abortRequest();

      that.inputPhase = $.Deferred().done($.proxy(that.onValueChange, that));

      if (that.options.deferRequestBy > 0) {
        // Defer lookup in case when value changes very quickly:
        that.onChangeTimeout = utils.delay(function() {
          that.inputPhase.resolve();
        }, that.options.deferRequestBy);
      } else {
        that.inputPhase.resolve();
      }
    },

    onValueChange: function() {
      var that = this,
        currentSelection;

      if (that.selection) {
        currentSelection = that.selection;
        that.selection = null;
        that.trigger('InvalidateSelection', currentSelection);
      }

      that.selectedIndex = -1;

      that.update();
      that.notify('valueChange');
    },

    completeOnFocus: function() {
      var that = this;

      if (that.isUnavailable()) {
        return;
      }

      if (that.isElementFocused()) {
        that.fixPosition();
        that.update();
        if (that.isMobile) {
          that.setCursorAtEnd();
          that.scrollToTop();
        }
      }
    },

    isElementFocused: function() {
      return document.activeElement === this.element;
    },

    isCursorAtEnd: function() {
      var that = this,
        valLength = that.el.val().length,
        selectionStart,
        range;

      // `selectionStart` and `selectionEnd` are not supported by some input types
      try {
        selectionStart = that.element.selectionStart;
        if (typeof selectionStart === 'number') {
          return selectionStart === valLength;
        }
      } catch (ex) {}

      if (document.selection) {
        range = document.selection.createRange();
        range.moveStart('character', -valLength);
        return valLength === range.text.length;
      }
      return true;
    },

    setCursorAtEnd: function() {
      var element = this.element;

      // `selectionStart` and `selectionEnd` are not supported by some input types
      try {
        element.selectionEnd = element.selectionStart = element.value.length;
        element.scrollLeft = element.scrollWidth;
      } catch (ex) {
        element.value = element.value;
      }
    },
  };

  $.extend(Suggestions.prototype, methods);

  notificator.on('initialize', methods.bindElementEvents).on('dispose', methods.unbindElementEvents);

  /**
   * Methods related to plugin's authorization on server
   */

  // keys are "[type][token]"
  var statusRequests = {};

  function resetTokens() {
    utils.each(statusRequests, function(req) {
      req.abort();
    });
    statusRequests = {};
  }

  resetTokens();

  var methods$1 = {
    checkStatus: function() {
      var that = this,
        token = (that.options.token && that.options.token.trim()) || '',
        requestKey = that.options.type + token,
        request = statusRequests[requestKey];

      if (!request) {
        request = statusRequests[requestKey] = jqapi.ajax(that.getAjaxParams('status'));
      }

      request
        .done(function(status) {
          if (status.search) {
            jqapi.extend(that.status, status);
          } else {
            triggerError('Service Unavailable');
          }
        })
        .fail(function() {
          triggerError(request.statusText);
        });

      function triggerError(errorThrown) {
        // If unauthorized
        if (utils.isFunction(that.options.onSearchError)) {
          that.options.onSearchError.call(that.element, null, request, 'error', errorThrown);
        }
      }
    },
  };

  Suggestions.resetTokens = resetTokens;

  jqapi.extend(Suggestions.prototype, methods$1);

  notificator.on('setOptions', methods$1.checkStatus);

  //export { methods, resetTokens };

  var locationRequest;
  var defaultGeoLocation = true;

  function resetLocation() {
    locationRequest = null;
    DEFAULT_OPTIONS.geoLocation = defaultGeoLocation;
  }

  var methods$2 = {
    checkLocation: function() {
      var that = this,
        providedLocation = that.options.geoLocation;

      if (!that.type.geoEnabled || !providedLocation) {
        return;
      }

      that.geoLocation = $.Deferred();
      if ($.isPlainObject(providedLocation) || $.isArray(providedLocation)) {
        that.geoLocation.resolve(providedLocation);
      } else {
        if (!locationRequest) {
          locationRequest = $.ajax(that.getAjaxParams('detectAddressByIp'));
        }

        locationRequest
          .done(function(resp) {
            var locationData = resp && resp.location && resp.location.data;
            if (locationData && locationData.kladr_id) {
              that.geoLocation.resolve(locationData);
            } else {
              that.geoLocation.reject();
            }
          })
          .fail(function() {
            that.geoLocation.reject();
          });
      }
    },

    /**
     * Public method to get `geoLocation` promise
     * @returns {$.Deferred}
     */
    getGeoLocation: function() {
      return this.geoLocation;
    },

    constructParams: function() {
      var that = this,
        params = {};

      if (that.geoLocation && $.isFunction(that.geoLocation.promise) && that.geoLocation.state() == 'resolved') {
        that.geoLocation.done(function(locationData) {
          params['locations_boost'] = $.makeArray(locationData);
        });
      }

      return params;
    },
  };

  // Disable this feature when GET method used. See SUG-202
  if (utils.getDefaultType() != 'GET') {
    $.extend(DEFAULT_OPTIONS, {
      geoLocation: defaultGeoLocation,
    });

    $.extend(Suggestions, {
      resetLocation: resetLocation,
    });

    $.extend(Suggestions.prototype, {
      getGeoLocation: methods$2.getGeoLocation,
    });

    notificator.on('setOptions', methods$2.checkLocation).on('requestParams', methods$2.constructParams);
  }

  var methods$3 = {
    enrichSuggestion: function(suggestion, selectionOptions) {
      var that = this,
        resolver = $.Deferred();

      if (
        !that.options.enrichmentEnabled ||
        !that.type.enrichmentEnabled ||
        !that.requestMode.enrichmentEnabled ||
        (selectionOptions && selectionOptions.dontEnrich)
      ) {
        return resolver.resolve(suggestion);
      }

      // if current suggestion is already enriched, use it
      if (suggestion.data && suggestion.data.qc != null) {
        return resolver.resolve(suggestion);
      }

      that.disableDropdown();

      var query = that.type.getEnrichmentQuery(suggestion);
      var customParams = that.type.enrichmentParams;
      var requestOptions = {
        noCallbacks: true,
        useEnrichmentCache: true,
        method: that.type.enrichmentMethod,
      };

      // Set `currentValue` to make `processResponse` to consider enrichment response valid
      that.currentValue = query;

      // prevent request abortion during onBlur
      that.enrichPhase = that
        .getSuggestions(query, customParams, requestOptions)
        .always(function() {
          that.enableDropdown();
        })
        .done(function(suggestions) {
          var enrichedSuggestion = suggestions && suggestions[0];

          resolver.resolve(enrichedSuggestion || suggestion, !!enrichedSuggestion);
        })
        .fail(function() {
          resolver.resolve(suggestion);
        });

      return resolver;
    },

    /**
     * Injects enriched suggestion into response
     * @param response
     * @param query
     */
    enrichResponse: function(response, query) {
      var that = this,
        enrichedSuggestion = that.enrichmentCache[query];

      if (enrichedSuggestion) {
        $.each(response.suggestions, function(i, suggestion) {
          if (suggestion.value === query) {
            response.suggestions[i] = enrichedSuggestion;
            return false;
          }
        });
      }
    },
  };

  $.extend(Suggestions.prototype, methods$3);

  /**
   * Methods related to suggestions dropdown list
   */

  function highlightMatches(chunks) {
    return $.map(chunks, function(chunk) {
      var text = utils.escapeHtml(chunk.text);

      if (text && chunk.matched) {
        text = '<strong>' + text + '</strong>';
      }
      return text;
    }).join('');
  }

  function nowrapLinkedParts(formattedStr, nowrapClass) {
    var delimitedParts = formattedStr.split(', ');
    // string has no delimiters, should not wrap
    if (delimitedParts.length === 1) {
      return formattedStr;
    }
    // disable word-wrap inside delimited parts
    return $.map(delimitedParts, function(part) {
      return '<span class="' + nowrapClass + '">' + part + '</span>';
    }).join(', ');
  }

  function hasAnotherSuggestion(suggestions, suggestion) {
    var result = false;

    $.each(suggestions, function(i, s) {
      result = s.value == suggestion.value && s != suggestion;
      if (result) {
        return false;
      }
    });

    return result;
  }

  var optionsUsed = {
    width: 'auto',
    floating: false,
  };

  var methods$4 = {
    createContainer: function() {
      var that = this,
        suggestionSelector = '.' + that.classes.suggestion,
        options = that.options,
        $container = $('<div/>')
          .addClass(options.containerClass)
          .css({
            position: 'absolute',
            display: 'none',
          });

      that.$container = $container;

      $container.on('click' + EVENT_NS, suggestionSelector, $.proxy(that.onSuggestionClick, that));
    },

    getContainer: function() {
      return this.$container.get(0);
    },

    removeContainer: function() {
      var that = this;

      //if (that.options.floating) {
      //    that.$container.remove();
      //}
    },

    setContainerOptions: function() {
      var that = this,
        mousedownEvent = 'mousedown' + EVENT_NS;

      that.$container.off(mousedownEvent);
      if (that.options.floating) {
        that.$container.on(mousedownEvent, $.proxy(that.onMousedown, that));
      }
    },

    /**
     * Listen for click event on suggestions list:
     */
    onSuggestionClick: function(e) {
      var that = this,
        $el = $(e.target),
        index;

      if (!that.dropdownDisabled) {
        that.cancelFocus = true;
        that.el.focus();

        while ($el.length && !(index = $el.attr('data-index'))) {
          $el = $el.closest('.' + that.classes.suggestion);
        }

        if (index && !isNaN(index)) {
          that.select(+index);
        }
      }
    },

    // Dropdown UI methods

    setDropdownPosition: function(origin, elLayout) {
      var that = this,
        scrollLeft = that.$viewport.scrollLeft(),
        style;

      if (that.isMobile) {
        style = that.options.floating
          ? {
              left: elLayout.left + 'px',
              top: elLayout.top + elLayout.borderTop + elLayout.innerHeight + 'px',
            }
          : {
              left: origin.left + 'px',
              top: origin.top + elLayout.borderTop + elLayout.innerHeight + 'px',
            };

        style.width = that.el.outerWidth() + 'px';
      } else {
        style = that.options.floating
          ? {
              left: elLayout.left + 'px',
              top: elLayout.top + elLayout.borderTop + elLayout.innerHeight + 'px',
            }
          : {
              left: origin.left + 'px',
              top: origin.top + elLayout.borderTop + elLayout.innerHeight + 'px',
            };

        // Defer to let body show scrollbars
        utils.delay(function() {
          var width = that.options.width;

          if (width === 'auto') {
            width = that.el.outerWidth();
          }
          that.$container.outerWidth(width);
        });
      }

      that.$container.toggleClass(that.classes.mobile, that.isMobile).css(style);

      that.containerItemsPadding = elLayout.left + elLayout.borderLeft + elLayout.paddingLeft - scrollLeft;
    },

    setItemsPositions: function() {
      var that = this,
        $items = that.getSuggestionsItems();

      //$items.css('paddingLeft', that.isMobile ? that.containerItemsPadding + 'px' : '');
    },

    getSuggestionsItems: function() {
      return this.$container.children('.' + this.classes.suggestion);
    },

    toggleDropdownEnabling: function(enable) {
      this.dropdownDisabled = !enable;
      this.$container.attr('disabled', !enable);
    },

    disableDropdown: function() {
      this.toggleDropdownEnabling(false);
    },

    enableDropdown: function() {
      this.toggleDropdownEnabling(true);
    },

    /**
     * Shows if there are any suggestions besides currently selected
     * @returns {boolean}
     */
    hasSuggestionsToChoose: function() {
      var that = this;

      return (
        that.suggestions.length > 1 ||
        (that.suggestions.length === 1 &&
          (!that.selection || $.trim(that.suggestions[0].value) !== $.trim(that.selection.value)))
      );
    },

    suggest: function() {
      var that = this,
        options = that.options,
        formatResult,
        html = [];

      if (!that.requestMode.userSelect) {
        return;
      }

      // если нечего показывать, то сообщаем об этом
      if (!that.hasSuggestionsToChoose()) {
        if (that.suggestions.length) {
          that.hide();
          return;
        } else {
          var noSuggestionsHint = that.getNoSuggestionsHint();
          if (noSuggestionsHint) {
            html.push('<div class="' + that.classes.hint + '">' + noSuggestionsHint + '</div>');
          } else {
            that.hide();
            return;
          }
        }
      } else {
        // Build hint html
        if (!that.isMobile && options.hint && that.suggestions.length) {
          html.push('<div class="' + that.classes.hint + '">' + options.hint + '</div>');
        }
        that.selectedIndex = -1;
        // Build suggestions inner HTML:
        that.suggestions.forEach(function(suggestion, i) {
          if (suggestion == that.selection) {
            that.selectedIndex = i;
          }
          that.buildSuggestionHtml(suggestion, i, html);
        });
      }

      html.push('<div class="' + CLASSES.promo + '"></div>');
      html.push('</div>');

      that.$container.html(html.join(''));

      // Select first value by default:
      if (options.autoSelectFirst && that.selectedIndex === -1) {
        that.selectedIndex = 0;
      }
      if (that.selectedIndex !== -1) {
        that
          .getSuggestionsItems()
          .eq(that.selectedIndex)
          .addClass(that.classes.selected);
      }

      if ($.isFunction(options.beforeRender)) {
        options.beforeRender.call(that.element, that.$container);
      }

      that.$container.show();
      that.visible = true;
      that.fixPosition();
      that.setItemsPositions();
    },

    buildSuggestionHtml: function(suggestion, ordinal, html) {
      html.push('<div class="' + this.classes.suggestion + '" data-index="' + ordinal + '">');

      var formatResult = this.options.formatResult || this.type.formatResult || this.formatResult;
      html.push(
        formatResult.call(this, suggestion.value, this.currentValue, suggestion, {
          unformattableTokens: this.type.unformattableTokens,
        })
      );

      var labels = this.makeSuggestionLabel(this.suggestions, suggestion);
      if (labels) {
        html.push('<span class="' + this.classes.subtext_label + '">' + utils.escapeHtml(labels) + '</span>');
      }
      html.push('</div>');
    },

    wrapFormattedValue: function(value, suggestion) {
      var that = this,
        status = utils.getDeepValue(suggestion.data, 'state.status');

      return (
        '<span class="' +
        that.classes.value +
        '"' +
        (status ? ' data-suggestion-status="' + status + '"' : '') +
        '>' +
        value +
        '</span>'
      );
    },

    formatResult: function(value, currentValue, suggestion, options) {
      var that = this;

      value = that.highlightMatches(value, currentValue, suggestion, options);

      return that.wrapFormattedValue(value, suggestion);
    },

    /**
     * Makes HTML contents for suggestion item
     * @param {String} value string to be displayed as a value
     * @param {String} currentValue contents of the textbox
     * @param suggestion whole suggestion object with displaying value and other fields
     * @param {Object} [options] set of flags:
     *          `unformattableTokens` - array of search tokens, that are not to be highlighted
     *          `maxLength` - if set, `value` is limited by this length
     * @returns {String} HTML to be inserted in the list
     */
    highlightMatches: function(value, currentValue, suggestion, options) {
      var that = this,
        chunks = [],
        unformattableTokens = options && options.unformattableTokens,
        maxLength = options && options.maxLength,
        tokens,
        tokenMatchers,
        preferredTokens,
        rWords = utils.reWordExtractor(),
        match,
        word,
        i,
        chunk,
        formattedStr;

      if (!value) return '';

      tokens = utils.getTokens(currentValue, unformattableTokens);

      tokenMatchers = $.map(tokens, function(token) {
        return new RegExp(
          '^((.*)([' +
            WORD_PARTS_DELIMITERS +
            ']+))?' +
            '(' +
            utils.escapeRegExChars(token) +
            ')' +
            '([^' +
            WORD_PARTS_DELIMITERS +
            ']*[' +
            WORD_PARTS_DELIMITERS +
            ']*)',
          'i'
        );
      });

      // parse string by words
      while ((match = rWords.exec(value)) && match[0]) {
        word = match[1];
        chunks.push({
          text: word,

          // upper case means a word is a name and can be highlighted even if presents in unformattableTokens
          hasUpperCase: word.toLowerCase() !== word,
          formatted: utils.formatToken(word),
          matchable: true,
        });
        if (match[2]) {
          chunks.push({
            text: match[2],
          });
        }
      }

      // use simple loop because length can change
      for (i = 0; i < chunks.length; i++) {
        chunk = chunks[i];
        if (
          chunk.matchable &&
          !chunk.matched &&
          ($.inArray(chunk.formatted, unformattableTokens) === -1 || chunk.hasUpperCase)
        ) {
          $.each(tokenMatchers, function(j, matcher) {
            var tokenMatch = matcher.exec(chunk.formatted),
              length,
              nextIndex = i + 1;

            if (tokenMatch) {
              tokenMatch = {
                before: tokenMatch[1] || '',
                beforeText: tokenMatch[2] || '',
                beforeDelimiter: tokenMatch[3] || '',
                text: tokenMatch[4] || '',
                after: tokenMatch[5] || '',
              };

              if (tokenMatch.before) {
                // insert chunk before current
                chunks.splice(
                  i,
                  0,
                  {
                    text: chunk.text.substr(0, tokenMatch.beforeText.length),
                    formatted: tokenMatch.beforeText,
                    matchable: true,
                  },
                  {
                    text: tokenMatch.beforeDelimiter,
                  }
                );
                nextIndex += 2;

                length = tokenMatch.before.length;
                chunk.text = chunk.text.substr(length);
                chunk.formatted = chunk.formatted.substr(length);
                i--;
              }

              length = tokenMatch.text.length + tokenMatch.after.length;
              if (chunk.formatted.length > length) {
                chunks.splice(nextIndex, 0, {
                  text: chunk.text.substr(length),
                  formatted: chunk.formatted.substr(length),
                  matchable: true,
                });
                chunk.text = chunk.text.substr(0, length);
                chunk.formatted = chunk.formatted.substr(0, length);
              }

              if (tokenMatch.after) {
                length = tokenMatch.text.length;
                chunks.splice(nextIndex, 0, {
                  text: chunk.text.substr(length),
                  formatted: chunk.formatted.substr(length),
                });
                chunk.text = chunk.text.substr(0, length);
                chunk.formatted = chunk.formatted.substr(0, length);
              }
              chunk.matched = true;
              return false;
            }
          });
        }
      }

      if (maxLength) {
        for (i = 0; i < chunks.length && maxLength >= 0; i++) {
          chunk = chunks[i];
          maxLength -= chunk.text.length;
          if (maxLength < 0) {
            chunk.text = chunk.text.substr(0, chunk.text.length + maxLength) + '...';
          }
        }
        chunks.length = i;
      }

      formattedStr = highlightMatches(chunks);
      return nowrapLinkedParts(formattedStr, that.classes.nowrap);
    },

    makeSuggestionLabel: function(suggestions, suggestion) {
      var that = this,
        fieldNames = that.type.fieldNames,
        nameData = {},
        rWords = utils.reWordExtractor(),
        match,
        word,
        labels = [];

      if (fieldNames && hasAnotherSuggestion(suggestions, suggestion) && suggestion.data) {
        $.each(fieldNames, function(field) {
          var value = suggestion.data[field];
          if (value) {
            nameData[field] = utils.formatToken(value);
          }
        });

        if (!$.isEmptyObject(nameData)) {
          while ((match = rWords.exec(utils.formatToken(suggestion.value))) && (word = match[1])) {
            $.each(nameData, function(i, value) {
              if (value == word) {
                labels.push(fieldNames[i]);
                delete nameData[i];
                return false;
              }
            });
          }

          if (labels.length) {
            return labels.join(', ');
          }
        }
      }
    },

    hide: function() {
      var that = this;
      that.visible = false;
      that.selectedIndex = -1;
      that.$container.hide().empty();
    },

    activate: function(index) {
      var that = this,
        $activeItem,
        selected = that.classes.selected,
        $children;

      if (!that.dropdownDisabled) {
        $children = that.getSuggestionsItems();

        $children.removeClass(selected);

        that.selectedIndex = index;

        if (that.selectedIndex !== -1 && $children.length > that.selectedIndex) {
          $activeItem = $children.eq(that.selectedIndex);
          $activeItem.addClass(selected);
          return $activeItem;
        }
      }

      return null;
    },

    deactivate: function(restoreValue) {
      var that = this;

      if (!that.dropdownDisabled) {
        that.selectedIndex = -1;
        that.getSuggestionsItems().removeClass(that.classes.selected);
        if (restoreValue) {
          that.el.val(that.currentValue);
        }
      }
    },

    moveUp: function() {
      var that = this;

      if (that.dropdownDisabled) {
        return;
      }
      if (that.selectedIndex === -1) {
        if (that.suggestions.length) {
          that.adjustScroll(that.suggestions.length - 1);
        }
        return;
      }

      if (that.selectedIndex === 0) {
        that.deactivate(true);
        return;
      }

      that.adjustScroll(that.selectedIndex - 1);
    },

    moveDown: function() {
      var that = this;

      if (that.dropdownDisabled) {
        return;
      }
      if (that.selectedIndex === that.suggestions.length - 1) {
        that.deactivate(true);
        return;
      }

      that.adjustScroll(that.selectedIndex + 1);
    },

    adjustScroll: function(index) {
      var that = this,
        $activeItem = that.activate(index),
        itemTop,
        itemBottom,
        scrollTop = that.$container.scrollTop(),
        containerHeight;

      if (!$activeItem || !$activeItem.length) {
        return;
      }

      itemTop = $activeItem.position().top;
      if (itemTop < 0) {
        that.$container.scrollTop(scrollTop + itemTop);
      } else {
        itemBottom = itemTop + $activeItem.outerHeight();
        containerHeight = that.$container.innerHeight();
        if (itemBottom > containerHeight) {
          that.$container.scrollTop(scrollTop - containerHeight + itemBottom);
        }
      }

      that.el.val(that.suggestions[index].value);
    },
  };

  $.extend(DEFAULT_OPTIONS, optionsUsed);

  $.extend(Suggestions.prototype, methods$4);

  notificator
    .on('initialize', methods$4.createContainer)
    .on('dispose', methods$4.removeContainer)
    .on('setOptions', methods$4.setContainerOptions)
    .on('fixPosition', methods$4.setDropdownPosition)
    .on('fixPosition', methods$4.setItemsPositions)
    .on('assignSuggestions', methods$4.suggest);

  /**
   * Methods related to right-sided component
   */

  var QUEUE_NAME = 'addon';
  var BEFORE_SHOW_ADDON = 50;
  var BEFORE_RESTORE_PADDING = 1000;

  var optionsUsed$1 = {
    addon: null,
  };

  var ADDON_TYPES = {
    NONE: 'none',
    SPINNER: 'spinner',
    CLEAR: 'clear',
  };

  var Addon = function(owner) {
    var that = this,
      $el = $('<span class="suggestions-addon"/>');

    that.owner = owner;
    that.$el = $el;
    that.type = ADDON_TYPES.NONE;
    that.visible = false;
    that.initialPadding = null;

    $el.on('click', $.proxy(that, 'onClick'));
  };

  Addon.prototype = {
    checkType: function() {
      var that = this,
        type = that.owner.options.addon,
        isTypeCorrect = false;

      $.each(ADDON_TYPES, function(key, value) {
        isTypeCorrect = value == type;
        if (isTypeCorrect) {
          return false;
        }
      });

      if (!isTypeCorrect) {
        type = that.owner.isMobile ? ADDON_TYPES.CLEAR : ADDON_TYPES.SPINNER;
      }

      if (type != that.type) {
        that.type = type;
        that.$el.attr('data-addon-type', type);
        that.toggle(true);
      }
    },

    toggle: function(immediate) {
      var that = this,
        visible;

      switch (that.type) {
        case ADDON_TYPES.CLEAR:
          visible = !!that.owner.currentValue;
          break;
        case ADDON_TYPES.SPINNER:
          visible = !!that.owner.currentRequest;
          break;
        default:
          visible = false;
      }

      if (visible != that.visible) {
        that.visible = visible;
        if (visible) {
          that.show(immediate);
        } else {
          that.hide(immediate);
        }
      }
    },

    show: function(immediate) {
      var that = this,
        style = { opacity: 1 };

      if (immediate) {
        that.$el.show().css(style);
        that.showBackground(true);
      } else {
        that.$el
          .stop(true, true)
          .delay(BEFORE_SHOW_ADDON)
          .queue(function() {
            that.$el.show();
            that.showBackground();
            that.$el.dequeue();
          })
          .animate(style, 'fast');
      }
    },

    hide: function(immediate) {
      var that = this,
        style = { opacity: 0 };

      if (immediate) {
        that.$el.hide().css(style);
      }
      that.$el.stop(true).animate(style, {
        duration: 'fast',
        complete: function() {
          that.$el.hide();
          that.hideBackground();
        },
      });
    },

    fixPosition: function(origin, elLayout) {
      var that = this,
        addonSize = elLayout.innerHeight;

      that.checkType();
      that.$el.css({
        left: origin.left + elLayout.borderLeft + elLayout.innerWidth - addonSize + 'px',
        top: origin.top + elLayout.borderTop + 'px',
        height: addonSize,
        width: addonSize,
      });

      that.initialPadding = elLayout.paddingRight;
      that.width = addonSize;
      if (that.visible) {
        elLayout.componentsRight += addonSize;
      }
    },

    showBackground: function(immediate) {
      var that = this,
        $el = that.owner.el,
        style = { paddingRight: that.width };

      if (that.width > that.initialPadding) {
        that.stopBackground();
        if (immediate) {
          $el.css(style);
        } else {
          $el.animate(style, { duration: 'fast', queue: QUEUE_NAME }).dequeue(QUEUE_NAME);
        }
      }
    },

    hideBackground: function(immediate) {
      var that = this,
        $el = that.owner.el,
        style = { paddingRight: that.initialPadding };

      if (that.width > that.initialPadding) {
        that.stopBackground(true);
        if (immediate) {
          $el.css(style);
        } else {
          $el
            .delay(BEFORE_RESTORE_PADDING, QUEUE_NAME)
            .animate(style, { duration: 'fast', queue: QUEUE_NAME })
            .dequeue(QUEUE_NAME);
        }
      }
    },

    stopBackground: function(gotoEnd) {
      this.owner.el.stop(QUEUE_NAME, true, gotoEnd);
    },

    onClick: function(e) {
      var that = this;

      if (that.type == ADDON_TYPES.CLEAR) {
        that.owner.clear();
      }
    },
  };

  var methods$5 = {
    createAddon: function() {
      var that = this,
        addon = new Addon(that);

      that.$wrapper.append(addon.$el);
      that.addon = addon;
    },

    fixAddonPosition: function(origin, elLayout) {
      this.addon.fixPosition(origin, elLayout);
    },

    checkAddonType: function() {
      this.addon.checkType();
    },

    checkAddonVisibility: function() {
      this.addon.toggle();
    },

    stopBackground: function() {
      this.addon.stopBackground();
    },
  };

  $.extend(DEFAULT_OPTIONS, optionsUsed$1);

  notificator
    .on('initialize', methods$5.createAddon)
    .on('setOptions', methods$5.checkAddonType)
    .on('fixPosition', methods$5.fixAddonPosition)
    .on('clear', methods$5.checkAddonVisibility)
    .on('valueChange', methods$5.checkAddonVisibility)
    .on('request', methods$5.checkAddonVisibility)
    .on('resetPosition', methods$5.stopBackground);

  /**
   * Methods related to CONSTRAINTS component
   */
  var optionsUsed$2 = {
    constraints: null,
    restrict_value: false,
  };

  var fiasParamNames = [
    'region_fias_id',
    'area_fias_id',
    'city_fias_id',
    'city_district_fias_id',
    'settlement_fias_id',
    'street_fias_id',
  ];

  /**
   * Compares two suggestion objects
   * @param suggestion
   * @param instance other Suggestions instance
   */
  function belongsToArea(suggestion, instance) {
    var parentSuggestion = instance.selection,
      result = parentSuggestion && parentSuggestion.data && instance.bounds;

    if (result) {
      $.each(instance.bounds.all, function(i, bound) {
        return (result = parentSuggestion.data[bound] === suggestion.data[bound]);
      });
    }
    return result;
  }

  /**
   * @param {Object} data  fields
   * @param {Suggestions} instance
   * @constructor
   */
  var ConstraintLocation = function(data, instance) {
    var that = this,
      fieldNames,
      fiasFieldNames,
      fiasFields = {};

    that.instance = instance;
    that.fields = {};
    that.specificity = -1;

    if ($.isPlainObject(data) && instance.type.dataComponents) {
      $.each(instance.type.dataComponents, function(i, component) {
        var fieldName = component.id;

        if (component.forLocations && data[fieldName]) {
          that.fields[fieldName] = data[fieldName];
          that.specificity = i;
        }
      });
    }

    fieldNames = Object.keys(that.fields);
    fiasFieldNames = utils.arraysIntersection(fieldNames, fiasParamNames);
    if (fiasFieldNames.length) {
      $.each(fiasFieldNames, function(index, fieldName) {
        fiasFields[fieldName] = that.fields[fieldName];
      });
      that.fields = fiasFields;
      that.specificity = that.getFiasSpecificity(fiasFieldNames);
    } else if (that.fields.kladr_id) {
      that.fields = { kladr_id: that.fields.kladr_id };
      that.specificity = that.getKladrSpecificity(that.fields.kladr_id);
    }
  };

  $.extend(ConstraintLocation.prototype, {
    getLabel: function() {
      return this.instance.type.composeValue(this.fields, { saveCityDistrict: true });
    },

    getFields: function() {
      return this.fields;
    },

    isValid: function() {
      return !$.isEmptyObject(this.fields);
    },

    /**
     * Возвращает specificity для КЛАДР
     * Описание ниже, в getFiasSpecificity
     * @param kladr_id
     * @returns {number}
     */
    getKladrSpecificity: function(kladr_id) {
      var specificity = -1,
        significantLength;

      this.significantKladr = kladr_id.replace(/^(\d{2})(\d*?)(0+)$/g, '$1$2');
      significantLength = this.significantKladr.length;

      $.each(this.instance.type.dataComponents, function(i, component) {
        if (component.kladrFormat && significantLength === component.kladrFormat.digits) {
          specificity = i;
        }
      });

      return specificity;
    },

    /**
     * Возвращает особую величину specificity для ФИАС
     * Specificity это индекс для массива this.instance.type.dataComponents
     * до которого (включительно) обрежется этот массив при формировании строки адреса.
     * Этот параметр нужен для случаев, когда в настройках плагина restrict_value = true
     * Например, установлено ограничение (locations) по region_fias_id (Краснодарский край)
     * В выпадашке нажимаем на "г. Сочи"
     * Если restrict_value отключен, то выведется значение "Краснодарский край, г Сочи"
     * Если включен, то просто "г Сочи"
     *
     * @param fiasFieldNames
     * @returns {number}
     */
    getFiasSpecificity: function(fiasFieldNames) {
      var specificity = -1;

      $.each(this.instance.type.dataComponents, function(i, component) {
        if (component.fiasType && $.inArray(component.fiasType, fiasFieldNames) > -1 && specificity < i) {
          specificity = i;
        }
      });

      return specificity;
    },

    containsData: function(data) {
      var result = true;

      if (this.fields.kladr_id) {
        return !!data.kladr_id && data.kladr_id.indexOf(this.significantKladr) === 0;
      } else {
        $.each(this.fields, function(fieldName, value) {
          return (result = !!data[fieldName] && data[fieldName].toLowerCase() === value.toLowerCase());
        });

        return result;
      }
    },
  });

  Suggestions.ConstraintLocation = ConstraintLocation;

  /**
   * @param {Object} data
   * @param {Object|Array} data.locations
   * @param {string} [data.label]
   * @param {boolean} [data.deletable]
   * @param {Suggestions} [instance]
   * @constructor
   */
  var Constraint = function(data, instance) {
    this.id = utils.uniqueId('c');
    this.deletable = !!data.deletable;
    this.instance = instance;

    this.locations = $.map($.makeArray(data && (data.locations || data.restrictions)), function(data) {
      return new ConstraintLocation(data, instance);
    });

    this.locations = $.grep(this.locations, function(location) {
      return location.isValid();
    });

    this.label = data.label;
    if (this.label == null && instance.type.composeValue) {
      this.label = $.map(this.locations, function(location) {
        return location.getLabel();
      }).join(', ');
    }

    if (this.label && this.isValid()) {
      this.$el = $(document.createElement('li'))
        .append($(document.createElement('span')).text(this.label))
        .attr('data-constraint-id', this.id);

      if (this.deletable) {
        this.$el.append($(document.createElement('span')).addClass(instance.classes.removeConstraint));
      }
    }
  };

  $.extend(Constraint.prototype, {
    isValid: function() {
      return this.locations.length > 0;
    },
    getFields: function() {
      return $.map(this.locations, function(location) {
        return location.getFields();
      });
    },
  });

  var methods$6 = {
    createConstraints: function() {
      var that = this;

      that.constraints = {};

      that.$constraints = $('<ul class="suggestions-constraints"/>');
      that.$wrapper.append(that.$constraints);
      that.$constraints.on('click', '.' + that.classes.removeConstraint, $.proxy(that.onConstraintRemoveClick, that));
    },

    setConstraintsPosition: function(origin, elLayout) {
      var that = this;

      that.$constraints.css({
        left: origin.left + elLayout.borderLeft + elLayout.paddingLeft + 'px',
        top:
          origin.top + elLayout.borderTop + Math.round((elLayout.innerHeight - that.$constraints.height()) / 2) + 'px',
      });

      elLayout.componentsLeft += that.$constraints.outerWidth(true) + elLayout.paddingLeft;
    },

    onConstraintRemoveClick: function(e) {
      var that = this,
        $item = $(e.target).closest('li'),
        id = $item.attr('data-constraint-id');

      // Delete constraint data before animation to let correct requests to be sent while fading
      delete that.constraints[id];
      // Request for new suggestions
      that.update();

      $item.fadeOut('fast', function() {
        that.removeConstraint(id);
      });
    },

    setupConstraints: function() {
      var that = this,
        constraints = that.options.constraints,
        $parent;

      if (!constraints) {
        that.unbindFromParent();
        return;
      }

      if (constraints instanceof $ || typeof constraints === 'string' || typeof constraints.nodeType === 'number') {
        $parent = $(constraints);
        if (!$parent.is(that.constraints)) {
          that.unbindFromParent();
          if (!$parent.is(that.el)) {
            that.constraints = $parent;
            that.bindToParent();
          }
        }
      } else {
        that._constraintsUpdating = true;
        $.each(that.constraints, $.proxy(that.removeConstraint, that));
        $.each($.makeArray(constraints), function(i, constraint) {
          that.addConstraint(constraint);
        });
        that._constraintsUpdating = false;
        that.fixPosition();
      }
    },

    filteredLocation: function(data) {
      var locationComponents = [],
        location = {};

      $.each(this.type.dataComponents, function() {
        if (this.forLocations) locationComponents.push(this.id);
      });

      if ($.isPlainObject(data)) {
        // Copy to location only allowed fields
        $.each(data, function(key, value) {
          if (value && locationComponents.indexOf(key) >= 0) {
            location[key] = value;
          }
        });
      }

      if (!$.isEmptyObject(location)) {
        return location.kladr_id ? { kladr_id: location.kladr_id } : location;
      }
    },

    addConstraint: function(constraint) {
      var that = this;

      constraint = new Constraint(constraint, that);

      if (constraint.isValid()) {
        that.constraints[constraint.id] = constraint;

        if (constraint.$el) {
          that.$constraints.append(constraint.$el);
          if (!that._constraintsUpdating) {
            that.fixPosition();
          }
        }
      }
    },

    removeConstraint: function(id) {
      //var that = this;
      //delete that.constraints[id];
      //that.$constraints.children('[data-constraint-id="' + id + '"]').remove();
      //if (!that._constraintsUpdating) {
      //    that.fixPosition();
      //}
    },

    constructConstraintsParams: function() {
      var that = this,
        locations = [],
        constraints = that.constraints,
        parentInstance,
        parentData,
        params = {};

      while (
        constraints instanceof $ &&
        (parentInstance = constraints.suggestions()) &&
        !(parentData = utils.getDeepValue(parentInstance, 'selection.data'))
      ) {
        constraints = parentInstance.constraints;
      }

      if (constraints instanceof $) {
        parentData = new ConstraintLocation(parentData, parentInstance).getFields();

        if (parentData) {
          // if send city_fias_id for city request
          // then no cities will responded
          if (that.bounds.own.indexOf('city') > -1) {
            delete parentData.city_fias_id;
          }
          params.locations = [parentData];
          params.restrict_value = true;
        }
      } else {
        if (constraints) {
          $.each(constraints, function(id, constraint) {
            locations = locations.concat(constraint.getFields());
          });

          if (locations.length) {
            params.locations = locations;
            params.restrict_value = that.options.restrict_value;
          }
        }
      }

      return params;
    },

    /**
     * Returns label of the first constraint (if any), empty string otherwise
     * @returns {String}
     */
    getFirstConstraintLabel: function() {
      var that = this,
        constraints_id = $.isPlainObject(that.constraints) && Object.keys(that.constraints)[0];

      return constraints_id ? that.constraints[constraints_id].label : '';
    },

    bindToParent: function() {
      var that = this;

      that.constraints
        .on(
          [
            'suggestions-select.' + that.uniqueId,
            'suggestions-invalidateselection.' + that.uniqueId,
            'suggestions-clear.' + that.uniqueId,
          ].join(' '),
          $.proxy(that.onParentSelectionChanged, that)
        )
        .on('suggestions-dispose.' + that.uniqueId, $.proxy(that.onParentDispose, that));
    },

    unbindFromParent: function() {
      var that = this,
        $parent = that.constraints;

      if ($parent instanceof $) {
        $parent.off('.' + that.uniqueId);
      }
    },

    onParentSelectionChanged: function(e, suggestion, valueChanged) {
      // Don't clear if parent has been just enriched
      if (e.type !== 'suggestions-select' || valueChanged) {
        this.clear();
      }
    },

    onParentDispose: function(e) {
      this.unbindFromParent();
    },

    getParentInstance: function() {
      return this.constraints instanceof $ && this.constraints.suggestions();
    },

    shareWithParent: function(suggestion) {
      // that is the parent control's instance
      var that = this.getParentInstance();

      if (!that || that.type !== this.type || belongsToArea(suggestion, that)) {
        return;
      }

      that.shareWithParent(suggestion);
      that.setSuggestion(suggestion);
    },

    /**
     * Pick only fields that absent in restriction
     */
    getUnrestrictedData: function(data) {
      var that = this,
        restrictedKeys = [],
        unrestrictedData = {},
        maxSpecificity = -1;

      // Find most specific location that could restrict current data
      $.each(that.constraints, function(id, constraint) {
        $.each(constraint.locations, function(i, location) {
          if (location.containsData(data) && location.specificity > maxSpecificity) {
            maxSpecificity = location.specificity;
          }
        });
      });

      if (maxSpecificity >= 0) {
        // Для городов-регионов нужно также отсечь и город
        if (data.region_kladr_id && data.region_kladr_id === data.city_kladr_id) {
          restrictedKeys.push.apply(restrictedKeys, that.type.dataComponentsById['city'].fields);
        }

        // Collect all fieldnames from all restricted components
        $.each(that.type.dataComponents.slice(0, maxSpecificity + 1), function(i, component) {
          restrictedKeys.push.apply(restrictedKeys, component.fields);
        });

        // Copy skipping restricted fields
        $.each(data, function(key, value) {
          if (restrictedKeys.indexOf(key) === -1) {
            unrestrictedData[key] = value;
          }
        });
      } else {
        unrestrictedData = data;
      }

      return unrestrictedData;
    },
  };

  $.extend(DEFAULT_OPTIONS, optionsUsed$2);

  $.extend(Suggestions.prototype, methods$6);

  // Disable this feature when GET method used. See SUG-202
  if (utils.getDefaultType() != 'GET') {
    notificator
      .on('initialize', methods$6.createConstraints)
      .on('setOptions', methods$6.setupConstraints)
      .on('fixPosition', methods$6.setConstraintsPosition)
      .on('requestParams', methods$6.constructConstraintsParams)
      .on('dispose', methods$6.unbindFromParent);
  }

  /**
   * Methods for selecting a suggestion
   */

  var methods$7 = {
    proceedQuery: function(query) {
      var that = this;

      if (query.length >= that.options.minChars) {
        that.updateSuggestions(query);
      } else {
        that.hide();
      }
    },

    /**
     * Selects current or first matched suggestion, but firstly waits for data ready
     * @param selectionOptions
     * @returns {$.Deferred} promise, resolved with index of selected suggestion or rejected if nothing matched
     */
    selectCurrentValue: function(selectionOptions) {
      var that = this,
        result = jqapi.Deferred();

      // force onValueChange to be executed if it has been deferred
      that.inputPhase.resolve();

      that.fetchPhase
        .done(function() {
          var index;

          // When suggestion has already been selected and not modified
          if (that.selection && !that.visible) {
            result.reject();
          } else {
            index = that.findSuggestionIndex();

            that.select(index, selectionOptions);

            if (index === -1) {
              result.reject();
            } else {
              result.resolve(index);
            }
          }
        })
        .fail(function() {
          result.reject();
        });

      return result;
    },

    /**
     * Selects first when user interaction is not supposed
     */
    selectFoundSuggestion: function() {
      var that = this;

      if (!that.requestMode.userSelect) {
        that.select(0);
      }
    },

    /**
     * Selects current or first matched suggestion
     * @returns {number} index of found suggestion
     */
    findSuggestionIndex: function() {
      var that = this,
        index = that.selectedIndex,
        value;

      if (index === -1) {
        // matchers always operate with trimmed strings
        value = that.el.val().trim();
        if (value) {
          that.type.matchers.some(function(matcher) {
            index = matcher(value, that.suggestions);
            return index !== -1;
          });
        }
      }

      return index;
    },

    /**
     * Selects a suggestion at specified index
     * @param index index of suggestion to select. Can be -1
     * @param {Object} selectionOptions
     * @param {boolean} [selectionOptions.continueSelecting]  prevents hiding after selection
     * @param {boolean} [selectionOptions.noSpace]  prevents adding space at the end of current value
     */
    select: function(index, selectionOptions) {
      var that = this,
        suggestion = that.suggestions[index],
        continueSelecting = selectionOptions && selectionOptions.continueSelecting,
        currentValue = that.currentValue,
        hasSameValues;

      // Prevent recursive execution
      if (that.triggering['Select']) return;

      // if no suggestion to select
      if (!suggestion) {
        if (!continueSelecting && !that.selection) {
          that.triggerOnSelectNothing();
        }
        that.onSelectComplete(continueSelecting);
        return;
      }

      hasSameValues = that.hasSameValues(suggestion);

      that.enrichSuggestion(suggestion, selectionOptions).done(function(enrichedSuggestion, hasBeenEnriched) {
        var newSelectionOptions = jqapi.extend(
          {
            hasBeenEnriched: hasBeenEnriched,
            hasSameValues: hasSameValues,
          },
          selectionOptions
        );
        that.selectSuggestion(enrichedSuggestion, index, currentValue, newSelectionOptions);
      });
    },

    /**
     * Formats and selects final (enriched) suggestion
     * @param suggestion
     * @param index
     * @param lastValue
     * @param {Object} selectionOptions
     * @param {boolean} [selectionOptions.continueSelecting]  prevents hiding after selection
     * @param {boolean} [selectionOptions.noSpace]  prevents adding space at the end of current value
     * @param {boolean} selectionOptions.hasBeenEnriched
     * @param {boolean} selectionOptions.hasSameValues
     */
    selectSuggestion: function(suggestion, index, lastValue, selectionOptions) {
      var that = this,
        continueSelecting = selectionOptions.continueSelecting,
        assumeDataComplete = !that.type.isDataComplete || that.type.isDataComplete.call(that, suggestion),
        currentSelection = that.selection;

      // Prevent recursive execution
      if (that.triggering['Select']) return;

      if (that.type.alwaysContinueSelecting) {
        continueSelecting = true;
      }

      if (assumeDataComplete) {
        continueSelecting = false;
      }

      // `suggestions` cat be empty, e.g. during `fixData`
      if (selectionOptions.hasBeenEnriched && that.suggestions[index]) {
        that.suggestions[index].data = suggestion.data;
      }

      if (that.requestMode.updateValue) {
        that.checkValueBounds(suggestion);
        that.currentValue = that.getSuggestionValue(suggestion, selectionOptions);

        if (that.currentValue && !selectionOptions.noSpace && !assumeDataComplete) {
          that.currentValue += ' ';
        }
        that.el.val(that.currentValue);
      }

      if (that.currentValue) {
        that.selection = suggestion;
        if (!that.areSuggestionsSame(suggestion, currentSelection)) {
          that.trigger('Select', suggestion, that.currentValue != lastValue);
        }
        if (that.requestMode.userSelect) {
          that.onSelectComplete(continueSelecting);
        }
      } else {
        that.selection = null;
        that.triggerOnSelectNothing();
      }

      that.shareWithParent(suggestion);
    },

    onSelectComplete: function(continueSelecting) {
      var that = this;

      if (continueSelecting) {
        that.selectedIndex = -1;
        that.updateSuggestions(that.currentValue);
      } else {
        that.hide();
      }
    },

    triggerOnSelectNothing: function() {
      var that = this;

      if (!that.triggering['SelectNothing']) {
        that.trigger('SelectNothing', that.currentValue);
      }
    },

    trigger: function(event) {
      var that = this,
        args = utils.slice(arguments, 1),
        callback = that.options['on' + event];

      that.triggering[event] = true;
      if (utils.isFunction(callback)) {
        callback.apply(that.element, args);
      }
      that.el.trigger.call(that.el, 'suggestions-' + event.toLowerCase(), args);
      that.triggering[event] = false;
    },
  };

  jqapi.extend(Suggestions.prototype, methods$7);

  notificator.on('assignSuggestions', methods$7.selectFoundSuggestion);

  /**
   * features for connected instances
   */

  var optionsUsed$3 = {
    bounds: null,
  };

  var methods$8 = {
    setupBounds: function() {
      this.bounds = {
        from: null,
        to: null,
      };
    },

    setBoundsOptions: function() {
      var that = this,
        boundsAvailable = [],
        newBounds = $.trim(that.options.bounds).split('-'),
        boundFrom = newBounds[0],
        boundTo = newBounds[newBounds.length - 1],
        boundsOwn = [],
        boundIsOwn,
        boundsAll = [],
        indexTo;

      if (that.type.dataComponents) {
        $.each(that.type.dataComponents, function() {
          if (this.forBounds) {
            boundsAvailable.push(this.id);
          }
        });
      }

      if ($.inArray(boundFrom, boundsAvailable) === -1) {
        boundFrom = null;
      }

      indexTo = $.inArray(boundTo, boundsAvailable);
      if (indexTo === -1 || indexTo === boundsAvailable.length - 1) {
        boundTo = null;
      }

      if (boundFrom || boundTo) {
        boundIsOwn = !boundFrom;
        $.each(boundsAvailable, function(i, bound) {
          if (bound == boundFrom) {
            boundIsOwn = true;
          }
          boundsAll.push(bound);
          if (boundIsOwn) {
            boundsOwn.push(bound);
          }
          if (bound == boundTo) {
            return false;
          }
        });
      }

      that.bounds.from = boundFrom;
      that.bounds.to = boundTo;
      that.bounds.all = boundsAll;
      that.bounds.own = boundsOwn;
    },

    constructBoundsParams: function() {
      var that = this,
        params = {};

      if (that.bounds.from) {
        params['from_bound'] = { value: that.bounds.from };
      }
      if (that.bounds.to) {
        params['to_bound'] = { value: that.bounds.to };
      }

      return params;
    },

    /**
     * Подстраивает suggestion.value под that.bounds.own
     * Ничего не возвращает, меняет в самом suggestion
     * @param suggestion
     */
    checkValueBounds: function(suggestion) {
      var that = this,
        valueData;

      // If any bounds set up
      if (that.bounds.own.length && that.type.composeValue) {
        // делаем копию
        var bounds = that.bounds.own.slice(0);
        // если роль текущего инстанса плагина показывать только район города
        // то для корректного формировния нужен city_district_fias_id
        if (bounds.length === 1 && bounds[0] === 'city_district') {
          bounds.push('city_district_fias_id');
        }
        valueData = that.copyDataComponents(suggestion.data, bounds);
        suggestion.value = that.type.composeValue(valueData);
      }
    },

    copyDataComponents: function(data, components) {
      var result = {},
        dataComponentsById = this.type.dataComponentsById;

      if (dataComponentsById) {
        $.each(components, function(i, component) {
          $.each(dataComponentsById[component].fields, function(i, field) {
            if (data[field] != null) {
              result[field] = data[field];
            }
          });
        });
      }

      return result;
    },

    getBoundedKladrId: function(kladr_id, boundsRange) {
      var boundTo = boundsRange[boundsRange.length - 1],
        kladrFormat;

      $.each(this.type.dataComponents, function(i, component) {
        if (component.id === boundTo) {
          kladrFormat = component.kladrFormat;
          return false;
        }
      });

      return kladr_id.substr(0, kladrFormat.digits) + new Array((kladrFormat.zeros || 0) + 1).join('0');
    },
  };

  $.extend(DEFAULT_OPTIONS, optionsUsed$3);

  $.extend(Suggestions.prototype, methods$8);

  notificator
    .on('initialize', methods$8.setupBounds)
    .on('setOptions', methods$8.setBoundsOptions)
    .on('requestParams', methods$8.constructBoundsParams);

  /**
   * Утилиты для работы с DOM.
   */

  // Отключено, пока не будет механизма определения платный/бесплатный тариф
  // notificator
  // .on('assignSuggestions', show);

  Suggestions.defaultOptions = DEFAULT_OPTIONS;

  Suggestions.version = '18.3.1';

  $.Suggestions = Suggestions;

  // Create chainable jQuery plugin:
  $.fn.suggestions = function(options, args) {
    // If function invoked without argument return
    // instance of the first matched element:
    if (arguments.length === 0) {
      return this.first().data(DATA_ATTR_KEY);
    }

    return this.each(function() {
      var inputElement = $(this),
        instance = inputElement.data(DATA_ATTR_KEY);

      if (typeof options === 'string') {
        if (instance && typeof instance[options] === 'function') {
          instance[options](args);
        }
      } else {
        // If instance already exists, destroy it:
        if (instance && instance.dispose) {
          instance.dispose();
        }
        instance = new Suggestions(this, options);
        inputElement.data(DATA_ATTR_KEY, instance);
      }
    });
  };
});

/*!
 * jQuery UI Datepicker 1.10.3
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/datepicker/
 *
 * Depends:
 *	jquery.ui.core.js
 */
(function($, undefined) {
  $.extend($.ui, { datepicker: { version: '1.10.3' } });

  var PROP_NAME = 'datepicker',
    instActive;

  /* Date picker manager.
   Use the singleton instance of this class, $.datepicker, to interact with the date picker.
   Settings for (groups of) date pickers are maintained in an instance object,
   allowing multiple different settings on the same page. */

  function Datepicker() {
    this._curInst = null; // The current instance in use
    this._keyEvent = false; // If the last event was a key event
    this._disabledInputs = []; // List of date picker inputs that have been disabled
    this._datepickerShowing = false; // True if the popup picker is showing , false if not
    this._inDialog = false; // True if showing within a "dialog", false if not
    this._mainDivId = 'ui-datepicker-div'; // The ID of the main datepicker division
    this._inlineClass = 'ui-datepicker-inline'; // The name of the inline marker class
    this._appendClass = 'ui-datepicker-append'; // The name of the append marker class
    this._triggerClass = 'ui-datepicker-trigger'; // The name of the trigger marker class
    this._dialogClass = 'ui-datepicker-dialog'; // The name of the dialog marker class
    this._disableClass = 'ui-datepicker-disabled'; // The name of the disabled covering marker class
    this._unselectableClass = 'ui-datepicker-unselectable'; // The name of the unselectable cell marker class
    this._currentClass = 'ui-datepicker-current-day'; // The name of the current day marker class
    this._dayOverClass = 'ui-datepicker-days-cell-over'; // The name of the day hover marker class
    this.regional = []; // Available regional settings, indexed by language code
    this.regional[''] = {
      // Default regional settings
      closeText: 'Done', // Display text for close link
      prevText: 'Prev', // Display text for previous month link
      nextText: 'Next', // Display text for next month link
      currentText: 'Today', // Display text for current month link
      monthNames: [
        'January',
        'February',
        'March',
        'April',
        'May',
        'June',
        'July',
        'August',
        'September',
        'October',
        'November',
        'December',
      ], // Names of months for drop-down and formatting
      monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'], // For formatting
      dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'], // For formatting
      dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'], // For formatting
      dayNamesMin: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'], // Column headings for days starting at Sunday
      weekHeader: 'Wk', // Column header for week of the year
      dateFormat: 'mm/dd/yy', // See format options on parseDate
      firstDay: 0, // The first day of the week, Sun = 0, Mon = 1, ...
      isRTL: false, // True if right-to-left language, false if left-to-right
      showMonthAfterYear: false, // True if the year select precedes month, false for month then year
      yearSuffix: '', // Additional text to append to the year in the month headers
    };
    this._defaults = {
      // Global defaults for all the date picker instances
      showOn: 'focus', // "focus" for popup on focus,
      // "button" for trigger button, or "both" for either
      showAnim: 'fadeIn', // Name of jQuery animation for popup
      showOptions: {}, // Options for enhanced animations
      defaultDate: null, // Used when field is blank: actual date,
      // +/-number for offset from today, null for today
      appendText: '', // Display text following the input box, e.g. showing the format
      buttonText: '...', // Text for trigger button
      buttonImage: '', // URL for trigger button image
      buttonImageOnly: false, // True if the image appears alone, false if it appears on a button
      hideIfNoPrevNext: false, // True to hide next/previous month links
      // if not applicable, false to just disable them
      navigationAsDateFormat: false, // True if date formatting applied to prev/today/next links
      gotoCurrent: false, // True if today link goes back to current selection instead
      changeMonth: false, // True if month can be selected directly, false if only prev/next
      changeYear: false, // True if year can be selected directly, false if only prev/next
      yearRange: 'c-10:c+10', // Range of years to display in drop-down,
      // either relative to today's year (-nn:+nn), relative to currently displayed year
      // (c-nn:c+nn), absolute (nnnn:nnnn), or a combination of the above (nnnn:-n)
      showOtherMonths: false, // True to show dates in other months, false to leave blank
      selectOtherMonths: false, // True to allow selection of dates in other months, false for unselectable
      showWeek: false, // True to show week of the year, false to not show it
      calculateWeek: this.iso8601Week, // How to calculate the week of the year,
      // takes a Date and returns the number of the week for it
      shortYearCutoff: '+10', // Short year values < this are in the current century,
      // > this are in the previous century,
      // string value starting with "+" for current year + value
      minDate: null, // The earliest selectable date, or null for no limit
      maxDate: null, // The latest selectable date, or null for no limit
      duration: 'fast', // Duration of display/closure
      beforeShowDay: null, // Function that takes a date and returns an array with
      // [0] = true if selectable, false if not, [1] = custom CSS class name(s) or "",
      // [2] = cell title (optional), e.g. $.datepicker.noWeekends
      beforeShow: null, // Function that takes an input field and
      // returns a set of custom settings for the date picker
      onSelect: null, // Define a callback function when a date is selected
      onChangeMonthYear: null, // Define a callback function when the month or year is changed
      onClose: null, // Define a callback function when the datepicker is closed
      numberOfMonths: 1, // Number of months to show at a time
      showCurrentAtPos: 0, // The position in multipe months at which to show the current month (starting at 0)
      stepMonths: 1, // Number of months to step back/forward
      stepBigMonths: 12, // Number of months to step back/forward for the big links
      altField: '', // Selector for an alternate field to store selected dates into
      altFormat: '', // The date format to use for the alternate field
      constrainInput: true, // The input is constrained by the current date format
      showButtonPanel: false, // True to show button panel, false to not show it
      autoSize: false, // True to size the input for the date format, false to leave as is
      disabled: false, // The initial disabled state
    };
    $.extend(this._defaults, this.regional['']);
    this.dpDiv = bindHover(
      $(
        "<div id='" +
          this._mainDivId +
          "' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"
      )
    );
  }

  $.extend(Datepicker.prototype, {
    /* Class name added to elements to indicate already configured with a date picker. */
    markerClassName: 'hasDatepicker',

    //Keep track of the maximum number of rows displayed (see #7043)
    maxRows: 4,

    // TODO rename to "widget" when switching to widget factory
    _widgetDatepicker: function() {
      return this.dpDiv;
    },

    /* Override the default settings for all instances of the date picker.
     * @param  settings  object - the new settings to use as defaults (anonymous object)
     * @return the manager object
     */
    setDefaults: function(settings) {
      extendRemove(this._defaults, settings || {});
      return this;
    },

    /* Attach the date picker to a jQuery selection.
     * @param  target	element - the target input field or division or span
     * @param  settings  object - the new settings to use for this date picker instance (anonymous)
     */
    _attachDatepicker: function(target, settings) {
      var nodeName, inline, inst;
      nodeName = target.nodeName.toLowerCase();
      inline = nodeName === 'div' || nodeName === 'span';
      if (!target.id) {
        this.uuid += 1;
        target.id = 'dp' + this.uuid;
      }
      inst = this._newInst($(target), inline);
      inst.settings = $.extend({}, settings || {});
      if (nodeName === 'input') {
        this._connectDatepicker(target, inst);
      } else if (inline) {
        this._inlineDatepicker(target, inst);
      }
    },

    /* Create a new instance object. */
    _newInst: function(target, inline) {
      var id = target[0].id.replace(/([^A-Za-z0-9_\-])/g, '\\\\$1'); // escape jQuery meta chars
      return {
        id: id,
        input: target, // associated target
        selectedDay: 0,
        selectedMonth: 0,
        selectedYear: 0, // current selection
        drawMonth: 0,
        drawYear: 0, // month being drawn
        inline: inline, // is datepicker inline or not
        dpDiv: !inline
          ? this.dpDiv // presentation div
          : bindHover(
              $(
                "<div class='" +
                  this._inlineClass +
                  " ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"
              )
            ),
      };
    },

    /* Attach the date picker to an input field. */
    _connectDatepicker: function(target, inst) {
      var input = $(target);
      inst.append = $([]);
      inst.trigger = $([]);
      if (input.hasClass(this.markerClassName)) {
        return;
      }
      this._attachments(input, inst);
      input
        .addClass(this.markerClassName)
        .keydown(this._doKeyDown)
        .keypress(this._doKeyPress)
        .keyup(this._doKeyUp);
      this._autoSize(inst);
      $.data(target, PROP_NAME, inst);
      //If disabled option is true, disable the datepicker once it has been attached to the input (see ticket #5665)
      if (inst.settings.disabled) {
        this._disableDatepicker(target);
      }
    },

    /* Make attachments based on settings. */
    _attachments: function(input, inst) {
      var showOn,
        buttonText,
        buttonImage,
        appendText = this._get(inst, 'appendText'),
        isRTL = this._get(inst, 'isRTL');

      if (inst.append) {
        inst.append.remove();
      }
      if (appendText) {
        inst.append = $("<span class='" + this._appendClass + "'>" + appendText + '</span>');
        input[isRTL ? 'before' : 'after'](inst.append);
      }

      input.unbind('focus', this._showDatepicker);

      if (inst.trigger) {
        inst.trigger.remove();
      }

      showOn = this._get(inst, 'showOn');
      if (showOn === 'focus' || showOn === 'both') {
        // pop-up date picker when in the marked field
        input.focus(this._showDatepicker);
      }
      if (showOn === 'button' || showOn === 'both') {
        // pop-up date picker when button clicked
        buttonText = this._get(inst, 'buttonText');
        buttonImage = this._get(inst, 'buttonImage');
        inst.trigger = $(
          this._get(inst, 'buttonImageOnly')
            ? $('<img/>')
                .addClass(this._triggerClass)
                .attr({ src: buttonImage, alt: buttonText, title: buttonText })
            : $("<button type='button'></button>")
                .addClass(this._triggerClass)
                .html(
                  !buttonImage ? buttonText : $('<img/>').attr({ src: buttonImage, alt: buttonText, title: buttonText })
                )
        );
        input[isRTL ? 'before' : 'after'](inst.trigger);
        inst.trigger.click(function() {
          if ($.datepicker._datepickerShowing && $.datepicker._lastInput === input[0]) {
            $.datepicker._hideDatepicker();
          } else if ($.datepicker._datepickerShowing && $.datepicker._lastInput !== input[0]) {
            $.datepicker._hideDatepicker();
            $.datepicker._showDatepicker(input[0]);
          } else {
            $.datepicker._showDatepicker(input[0]);
          }
          return false;
        });
      }
    },

    /* Apply the maximum length for the date format. */
    _autoSize: function(inst) {
      if (this._get(inst, 'autoSize') && !inst.inline) {
        var findMax,
          max,
          maxI,
          i,
          date = new Date(2009, 12 - 1, 20), // Ensure double digits
          dateFormat = this._get(inst, 'dateFormat');

        if (dateFormat.match(/[DM]/)) {
          findMax = function(names) {
            max = 0;
            maxI = 0;
            for (i = 0; i < names.length; i++) {
              if (names[i].length > max) {
                max = names[i].length;
                maxI = i;
              }
            }
            return maxI;
          };
          date.setMonth(findMax(this._get(inst, dateFormat.match(/MM/) ? 'monthNames' : 'monthNamesShort')));
          date.setDate(
            findMax(this._get(inst, dateFormat.match(/DD/) ? 'dayNames' : 'dayNamesShort')) + 20 - date.getDay()
          );
        }
        inst.input.attr('size', this._formatDate(inst, date).length);
      }
    },

    /* Attach an inline date picker to a div. */
    _inlineDatepicker: function(target, inst) {
      var divSpan = $(target);
      if (divSpan.hasClass(this.markerClassName)) {
        return;
      }
      divSpan.addClass(this.markerClassName).append(inst.dpDiv);
      $.data(target, PROP_NAME, inst);
      this._setDate(inst, this._getDefaultDate(inst), true);
      this._updateDatepicker(inst);
      this._updateAlternate(inst);
      //If disabled option is true, disable the datepicker before showing it (see ticket #5665)
      if (inst.settings.disabled) {
        this._disableDatepicker(target);
      }
      // Set display:block in place of inst.dpDiv.show() which won't work on disconnected elements
      // http://bugs.jqueryui.com/ticket/7552 - A Datepicker created on a detached div has zero height
      inst.dpDiv.css('display', 'block');
    },

    /* Pop-up the date picker in a "dialog" box.
     * @param  input element - ignored
     * @param  date	string or Date - the initial date to display
     * @param  onSelect  function - the function to call when a date is selected
     * @param  settings  object - update the dialog date picker instance's settings (anonymous object)
     * @param  pos int[2] - coordinates for the dialog's position within the screen or
     *					event - with x/y coordinates or
     *					leave empty for default (screen centre)
     * @return the manager object
     */
    _dialogDatepicker: function(input, date, onSelect, settings, pos) {
      var id,
        browserWidth,
        browserHeight,
        scrollX,
        scrollY,
        inst = this._dialogInst; // internal instance

      if (!inst) {
        this.uuid += 1;
        id = 'dp' + this.uuid;
        this._dialogInput = $(
          "<input type='text' id='" + id + "' style='position: absolute; top: -100px; width: 0px;'/>"
        );
        this._dialogInput.keydown(this._doKeyDown);
        $('body').append(this._dialogInput);
        inst = this._dialogInst = this._newInst(this._dialogInput, false);
        inst.settings = {};
        $.data(this._dialogInput[0], PROP_NAME, inst);
      }
      extendRemove(inst.settings, settings || {});
      date = date && date.constructor === Date ? this._formatDate(inst, date) : date;
      this._dialogInput.val(date);

      this._pos = pos ? (pos.length ? pos : [pos.pageX, pos.pageY]) : null;
      if (!this._pos) {
        browserWidth = document.documentElement.clientWidth;
        browserHeight = document.documentElement.clientHeight;
        scrollX = document.documentElement.scrollLeft || document.body.scrollLeft;
        scrollY = document.documentElement.scrollTop || document.body.scrollTop;
        this._pos =
          // should use actual width/height below
          [browserWidth / 2 - 100 + scrollX, browserHeight / 2 - 150 + scrollY];
      }

      // move input on screen for focus, but hidden behind dialog
      this._dialogInput.css('left', this._pos[0] + 20 + 'px').css('top', this._pos[1] + 'px');
      inst.settings.onSelect = onSelect;
      this._inDialog = true;
      this.dpDiv.addClass(this._dialogClass);
      this._showDatepicker(this._dialogInput[0]);
      if ($.blockUI) {
        $.blockUI(this.dpDiv);
      }
      $.data(this._dialogInput[0], PROP_NAME, inst);
      return this;
    },

    /* Detach a datepicker from its control.
     * @param  target	element - the target input field or division or span
     */
    _destroyDatepicker: function(target) {
      var nodeName,
        $target = $(target),
        inst = $.data(target, PROP_NAME);

      if (!$target.hasClass(this.markerClassName)) {
        return;
      }

      nodeName = target.nodeName.toLowerCase();
      $.removeData(target, PROP_NAME);
      if (nodeName === 'input') {
        inst.append.remove();
        inst.trigger.remove();
        $target
          .removeClass(this.markerClassName)
          .unbind('focus', this._showDatepicker)
          .unbind('keydown', this._doKeyDown)
          .unbind('keypress', this._doKeyPress)
          .unbind('keyup', this._doKeyUp);
      } else if (nodeName === 'div' || nodeName === 'span') {
        $target.removeClass(this.markerClassName).empty();
      }
    },

    /* Enable the date picker to a jQuery selection.
     * @param  target	element - the target input field or division or span
     */
    _enableDatepicker: function(target) {
      var nodeName,
        inline,
        $target = $(target),
        inst = $.data(target, PROP_NAME);

      if (!$target.hasClass(this.markerClassName)) {
        return;
      }

      nodeName = target.nodeName.toLowerCase();
      if (nodeName === 'input') {
        target.disabled = false;
        inst.trigger
          .filter('button')
          .each(function() {
            this.disabled = false;
          })
          .end()
          .filter('img')
          .css({ opacity: '1.0', cursor: '' });
      } else if (nodeName === 'div' || nodeName === 'span') {
        inline = $target.children('.' + this._inlineClass);
        inline.children().removeClass('ui-state-disabled');
        inline.find('select.ui-datepicker-month, select.ui-datepicker-year').prop('disabled', false);
      }
      this._disabledInputs = $.map(this._disabledInputs, function(value) {
        return value === target ? null : value;
      }); // delete entry
    },

    /* Disable the date picker to a jQuery selection.
     * @param  target	element - the target input field or division or span
     */
    _disableDatepicker: function(target) {
      var nodeName,
        inline,
        $target = $(target),
        inst = $.data(target, PROP_NAME);

      if (!$target.hasClass(this.markerClassName)) {
        return;
      }

      nodeName = target.nodeName.toLowerCase();
      if (nodeName === 'input') {
        target.disabled = true;
        inst.trigger
          .filter('button')
          .each(function() {
            this.disabled = true;
          })
          .end()
          .filter('img')
          .css({ opacity: '0.5', cursor: 'default' });
      } else if (nodeName === 'div' || nodeName === 'span') {
        inline = $target.children('.' + this._inlineClass);
        inline.children().addClass('ui-state-disabled');
        inline.find('select.ui-datepicker-month, select.ui-datepicker-year').prop('disabled', true);
      }
      this._disabledInputs = $.map(this._disabledInputs, function(value) {
        return value === target ? null : value;
      }); // delete entry
      this._disabledInputs[this._disabledInputs.length] = target;
    },

    /* Is the first field in a jQuery collection disabled as a datepicker?
     * @param  target	element - the target input field or division or span
     * @return boolean - true if disabled, false if enabled
     */
    _isDisabledDatepicker: function(target) {
      if (!target) {
        return false;
      }
      for (var i = 0; i < this._disabledInputs.length; i++) {
        if (this._disabledInputs[i] === target) {
          return true;
        }
      }
      return false;
    },

    /* Retrieve the instance data for the target control.
     * @param  target  element - the target input field or division or span
     * @return  object - the associated instance data
     * @throws  error if a jQuery problem getting data
     */
    _getInst: function(target) {
      try {
        return $.data(target, PROP_NAME);
      } catch (err) {
        throw 'Missing instance data for this datepicker';
      }
    },

    /* Update or retrieve the settings for a date picker attached to an input field or division.
     * @param  target  element - the target input field or division or span
     * @param  name	object - the new settings to update or
     *				string - the name of the setting to change or retrieve,
     *				when retrieving also "all" for all instance settings or
     *				"defaults" for all global defaults
     * @param  value   any - the new value for the setting
     *				(omit if above is an object or to retrieve a value)
     */
    _optionDatepicker: function(target, name, value) {
      var settings,
        date,
        minDate,
        maxDate,
        inst = this._getInst(target);

      if (arguments.length === 2 && typeof name === 'string') {
        return name === 'defaults'
          ? $.extend({}, $.datepicker._defaults)
          : inst
          ? name === 'all'
            ? $.extend({}, inst.settings)
            : this._get(inst, name)
          : null;
      }

      settings = name || {};
      if (typeof name === 'string') {
        settings = {};
        settings[name] = value;
      }

      if (inst) {
        if (this._curInst === inst) {
          this._hideDatepicker();
        }

        date = this._getDateDatepicker(target, true);
        minDate = this._getMinMaxDate(inst, 'min');
        maxDate = this._getMinMaxDate(inst, 'max');
        extendRemove(inst.settings, settings);
        // reformat the old minDate/maxDate values if dateFormat changes and a new minDate/maxDate isn't provided
        if (minDate !== null && settings.dateFormat !== undefined && settings.minDate === undefined) {
          inst.settings.minDate = this._formatDate(inst, minDate);
        }
        if (maxDate !== null && settings.dateFormat !== undefined && settings.maxDate === undefined) {
          inst.settings.maxDate = this._formatDate(inst, maxDate);
        }
        if ('disabled' in settings) {
          if (settings.disabled) {
            this._disableDatepicker(target);
          } else {
            this._enableDatepicker(target);
          }
        }
        this._attachments($(target), inst);
        this._autoSize(inst);
        this._setDate(inst, date);
        this._updateAlternate(inst);
        this._updateDatepicker(inst);
      }
    },

    // change method deprecated
    _changeDatepicker: function(target, name, value) {
      this._optionDatepicker(target, name, value);
    },

    /* Redraw the date picker attached to an input field or division.
     * @param  target  element - the target input field or division or span
     */
    _refreshDatepicker: function(target) {
      var inst = this._getInst(target);
      if (inst) {
        this._updateDatepicker(inst);
      }
    },

    /* Set the dates for a jQuery selection.
     * @param  target element - the target input field or division or span
     * @param  date	Date - the new date
     */
    _setDateDatepicker: function(target, date) {
      var inst = this._getInst(target);
      if (inst) {
        this._setDate(inst, date);
        this._updateDatepicker(inst);
        this._updateAlternate(inst);
      }
    },

    /* Get the date(s) for the first entry in a jQuery selection.
     * @param  target element - the target input field or division or span
     * @param  noDefault boolean - true if no default date is to be used
     * @return Date - the current date
     */
    _getDateDatepicker: function(target, noDefault) {
      var inst = this._getInst(target);
      if (inst && !inst.inline) {
        this._setDateFromField(inst, noDefault);
      }
      return inst ? this._getDate(inst) : null;
    },

    /* Handle keystrokes. */
    _doKeyDown: function(event) {
      var onSelect,
        dateStr,
        sel,
        inst = $.datepicker._getInst(event.target),
        handled = true,
        isRTL = inst.dpDiv.is('.ui-datepicker-rtl');

      inst._keyEvent = true;
      if ($.datepicker._datepickerShowing) {
        switch (event.keyCode) {
          case 9:
            $.datepicker._hideDatepicker();
            handled = false;
            break; // hide on tab out
          case 13:
            sel = $('td.' + $.datepicker._dayOverClass + ':not(.' + $.datepicker._currentClass + ')', inst.dpDiv);
            if (sel[0]) {
              $.datepicker._selectDay(event.target, inst.selectedMonth, inst.selectedYear, sel[0]);
            }

            onSelect = $.datepicker._get(inst, 'onSelect');
            if (onSelect) {
              dateStr = $.datepicker._formatDate(inst);

              // trigger custom callback
              onSelect.apply(inst.input ? inst.input[0] : null, [dateStr, inst]);
            } else {
              $.datepicker._hideDatepicker();
            }

            return false; // don't submit the form
          case 27:
            $.datepicker._hideDatepicker();
            break; // hide on escape
          case 33:
            $.datepicker._adjustDate(
              event.target,
              event.ctrlKey ? -$.datepicker._get(inst, 'stepBigMonths') : -$.datepicker._get(inst, 'stepMonths'),
              'M'
            );
            break; // previous month/year on page up/+ ctrl
          case 34:
            $.datepicker._adjustDate(
              event.target,
              event.ctrlKey ? +$.datepicker._get(inst, 'stepBigMonths') : +$.datepicker._get(inst, 'stepMonths'),
              'M'
            );
            break; // next month/year on page down/+ ctrl
          case 35:
            if (event.ctrlKey || event.metaKey) {
              $.datepicker._clearDate(event.target);
            }
            handled = event.ctrlKey || event.metaKey;
            break; // clear on ctrl or command +end
          case 36:
            if (event.ctrlKey || event.metaKey) {
              $.datepicker._gotoToday(event.target);
            }
            handled = event.ctrlKey || event.metaKey;
            break; // current on ctrl or command +home
          case 37:
            if (event.ctrlKey || event.metaKey) {
              $.datepicker._adjustDate(event.target, isRTL ? +1 : -1, 'D');
            }
            handled = event.ctrlKey || event.metaKey;
            // -1 day on ctrl or command +left
            if (event.originalEvent.altKey) {
              $.datepicker._adjustDate(
                event.target,
                event.ctrlKey ? -$.datepicker._get(inst, 'stepBigMonths') : -$.datepicker._get(inst, 'stepMonths'),
                'M'
              );
            }
            // next month/year on alt +left on Mac
            break;
          case 38:
            if (event.ctrlKey || event.metaKey) {
              $.datepicker._adjustDate(event.target, -7, 'D');
            }
            handled = event.ctrlKey || event.metaKey;
            break; // -1 week on ctrl or command +up
          case 39:
            if (event.ctrlKey || event.metaKey) {
              $.datepicker._adjustDate(event.target, isRTL ? -1 : +1, 'D');
            }
            handled = event.ctrlKey || event.metaKey;
            // +1 day on ctrl or command +right
            if (event.originalEvent.altKey) {
              $.datepicker._adjustDate(
                event.target,
                event.ctrlKey ? +$.datepicker._get(inst, 'stepBigMonths') : +$.datepicker._get(inst, 'stepMonths'),
                'M'
              );
            }
            // next month/year on alt +right
            break;
          case 40:
            if (event.ctrlKey || event.metaKey) {
              $.datepicker._adjustDate(event.target, +7, 'D');
            }
            handled = event.ctrlKey || event.metaKey;
            break; // +1 week on ctrl or command +down
          default:
            handled = false;
        }
      } else if (event.keyCode === 36 && event.ctrlKey) {
        // display the date picker on ctrl+home
        $.datepicker._showDatepicker(this);
      } else {
        handled = false;
      }

      if (handled) {
        event.preventDefault();
        event.stopPropagation();
      }
    },

    /* Filter entered characters - based on date format. */
    _doKeyPress: function(event) {
      var chars,
        chr,
        inst = $.datepicker._getInst(event.target);

      if ($.datepicker._get(inst, 'constrainInput')) {
        chars = $.datepicker._possibleChars($.datepicker._get(inst, 'dateFormat'));
        chr = String.fromCharCode(event.charCode == null ? event.keyCode : event.charCode);
        return event.ctrlKey || event.metaKey || chr < ' ' || !chars || chars.indexOf(chr) > -1;
      }
    },

    /* Synchronise manual entry and field/alternate field. */
    _doKeyUp: function(event) {
      var date,
        inst = $.datepicker._getInst(event.target);

      if (inst.input.val() !== inst.lastVal) {
        try {
          date = $.datepicker.parseDate(
            $.datepicker._get(inst, 'dateFormat'),
            inst.input ? inst.input.val() : null,
            $.datepicker._getFormatConfig(inst)
          );

          if (date) {
            // only if valid
            $.datepicker._setDateFromField(inst);
            $.datepicker._updateAlternate(inst);
            $.datepicker._updateDatepicker(inst);
          }
        } catch (err) {}
      }
      return true;
    },

    /* Pop-up the date picker for a given input field.
     * If false returned from beforeShow event handler do not show.
     * @param  input  element - the input field attached to the date picker or
     *					event - if triggered by focus
     */
    _showDatepicker: function(input) {
      input = input.target || input;
      if (input.nodeName.toLowerCase() !== 'input') {
        // find from button/image trigger
        input = $('input', input.parentNode)[0];
      }

      if ($.datepicker._isDisabledDatepicker(input) || $.datepicker._lastInput === input) {
        // already here
        return;
      }

      var inst, beforeShow, beforeShowSettings, isFixed, offset, showAnim, duration;

      inst = $.datepicker._getInst(input);
      if ($.datepicker._curInst && $.datepicker._curInst !== inst) {
        $.datepicker._curInst.dpDiv.stop(true, true);
        if (inst && $.datepicker._datepickerShowing) {
          $.datepicker._hideDatepicker($.datepicker._curInst.input[0]);
        }
      }

      beforeShow = $.datepicker._get(inst, 'beforeShow');
      beforeShowSettings = beforeShow ? beforeShow.apply(input, [input, inst]) : {};
      if (beforeShowSettings === false) {
        return;
      }
      extendRemove(inst.settings, beforeShowSettings);

      inst.lastVal = null;
      $.datepicker._lastInput = input;
      $.datepicker._setDateFromField(inst);

      if ($.datepicker._inDialog) {
        // hide cursor
        input.value = '';
      }
      if (!$.datepicker._pos) {
        // position below input
        $.datepicker._pos = $.datepicker._findPos(input);
        $.datepicker._pos[1] += input.offsetHeight; // add the height
      }

      isFixed = false;
      $(input)
        .parents()
        .each(function() {
          isFixed |= $(this).css('position') === 'fixed';
          return !isFixed;
        });

      offset = { left: $.datepicker._pos[0], top: $.datepicker._pos[1] };
      $.datepicker._pos = null;
      //to avoid flashes on Firefox
      inst.dpDiv.empty();
      // determine sizing offscreen
      inst.dpDiv.css({ position: 'absolute', display: 'block', top: '-1000px' });
      $.datepicker._updateDatepicker(inst);
      // fix width for dynamic number of date pickers
      // and adjust position before showing
      offset = $.datepicker._checkOffset(inst, offset, isFixed);
      inst.dpDiv.css({
        position: $.datepicker._inDialog && $.blockUI ? 'static' : isFixed ? 'fixed' : 'absolute',
        display: 'none',
        left: offset.left + 'px',
        top: offset.top + 'px',
      });

      if (!inst.inline) {
        showAnim = $.datepicker._get(inst, 'showAnim');
        duration = $.datepicker._get(inst, 'duration');
        inst.dpDiv.zIndex($(input).zIndex() + 1);
        $.datepicker._datepickerShowing = true;

        if ($.effects && $.effects.effect[showAnim]) {
          inst.dpDiv.show(showAnim, $.datepicker._get(inst, 'showOptions'), duration);
        } else {
          inst.dpDiv[showAnim || 'show'](showAnim ? duration : null);
        }

        if ($.datepicker._shouldFocusInput(inst)) {
          inst.input.focus();
        }

        $.datepicker._curInst = inst;
      }
    },

    /* Generate the date picker content. */
    _updateDatepicker: function(inst) {
      this.maxRows = 4; //Reset the max number of rows being displayed (see #7043)
      instActive = inst; // for delegate hover events
      inst.dpDiv.empty().append(this._generateHTML(inst));
      this._attachHandlers(inst);
      inst.dpDiv.find('.' + this._dayOverClass + ' a').mouseover();

      var origyearshtml,
        numMonths = this._getNumberOfMonths(inst),
        cols = numMonths[1],
        width = 17;

      inst.dpDiv.removeClass('ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4').width('');
      if (cols > 1) {
        inst.dpDiv.addClass('ui-datepicker-multi-' + cols).css('width', width * cols + 'em');
      }
      inst.dpDiv[(numMonths[0] !== 1 || numMonths[1] !== 1 ? 'add' : 'remove') + 'Class']('ui-datepicker-multi');
      inst.dpDiv[(this._get(inst, 'isRTL') ? 'add' : 'remove') + 'Class']('ui-datepicker-rtl');

      if (inst === $.datepicker._curInst && $.datepicker._datepickerShowing && $.datepicker._shouldFocusInput(inst)) {
        inst.input.focus();
      }

      // deffered render of the years select (to avoid flashes on Firefox)
      if (inst.yearshtml) {
        origyearshtml = inst.yearshtml;
        setTimeout(function() {
          //assure that inst.yearshtml didn't change.
          if (origyearshtml === inst.yearshtml && inst.yearshtml) {
            inst.dpDiv.find('select.ui-datepicker-year:first').replaceWith(inst.yearshtml);
          }
          origyearshtml = inst.yearshtml = null;
        }, 0);
      }
    },

    // #6694 - don't focus the input if it's already focused
    // this breaks the change event in IE
    // Support: IE and jQuery <1.9
    _shouldFocusInput: function(inst) {
      return inst.input && inst.input.is(':visible') && !inst.input.is(':disabled') && !inst.input.is(':focus');
    },

    /* Check positioning to remain on screen. */
    _checkOffset: function(inst, offset, isFixed) {
      var dpWidth = inst.dpDiv.outerWidth(),
        dpHeight = inst.dpDiv.outerHeight(),
        inputWidth = inst.input ? inst.input.outerWidth() : 0,
        inputHeight = inst.input ? inst.input.outerHeight() : 0,
        viewWidth = document.documentElement.clientWidth + (isFixed ? 0 : $(document).scrollLeft()),
        viewHeight = document.documentElement.clientHeight + (isFixed ? 0 : $(document).scrollTop());

      offset.left -= this._get(inst, 'isRTL') ? dpWidth - inputWidth : 0;
      offset.left -= isFixed && offset.left === inst.input.offset().left ? $(document).scrollLeft() : 0;
      offset.top -= isFixed && offset.top === inst.input.offset().top + inputHeight ? $(document).scrollTop() : 0;

      // now check if datepicker is showing outside window viewport - move to a better place if so.
      offset.left -= Math.min(
        offset.left,
        offset.left + dpWidth > viewWidth && viewWidth > dpWidth ? Math.abs(offset.left + dpWidth - viewWidth) : 0
      );
      offset.top -= Math.min(
        offset.top,
        offset.top + dpHeight > viewHeight && viewHeight > dpHeight ? Math.abs(dpHeight + inputHeight) : 0
      );

      return offset;
    },

    /* Find an object's position on the screen. */
    _findPos: function(obj) {
      var position,
        inst = this._getInst(obj),
        isRTL = this._get(inst, 'isRTL');

      while (obj && (obj.type === 'hidden' || obj.nodeType !== 1 || $.expr.filters.hidden(obj))) {
        obj = obj[isRTL ? 'previousSibling' : 'nextSibling'];
      }

      position = $(obj).offset();
      return [position.left, position.top];
    },

    /* Hide the date picker from view.
     * @param  input  element - the input field attached to the date picker
     */
    _hideDatepicker: function(input) {
      var showAnim,
        duration,
        postProcess,
        onClose,
        inst = this._curInst;

      if (!inst || (input && inst !== $.data(input, PROP_NAME))) {
        return;
      }

      if (this._datepickerShowing) {
        showAnim = this._get(inst, 'showAnim');
        duration = this._get(inst, 'duration');
        postProcess = function() {
          $.datepicker._tidyDialog(inst);
        };

        // DEPRECATED: after BC for 1.8.x $.effects[ showAnim ] is not needed
        if ($.effects && ($.effects.effect[showAnim] || $.effects[showAnim])) {
          inst.dpDiv.hide(showAnim, $.datepicker._get(inst, 'showOptions'), duration, postProcess);
        } else {
          inst.dpDiv[showAnim === 'slideDown' ? 'slideUp' : showAnim === 'fadeIn' ? 'fadeOut' : 'hide'](
            showAnim ? duration : null,
            postProcess
          );
        }

        if (!showAnim) {
          postProcess();
        }
        this._datepickerShowing = false;

        onClose = this._get(inst, 'onClose');
        if (onClose) {
          onClose.apply(inst.input ? inst.input[0] : null, [inst.input ? inst.input.val() : '', inst]);
        }

        this._lastInput = null;
        if (this._inDialog) {
          this._dialogInput.css({ position: 'absolute', left: '0', top: '-100px' });
          if ($.blockUI) {
            $.unblockUI();
            $('body').append(this.dpDiv);
          }
        }
        this._inDialog = false;
      }
    },

    /* Tidy up after a dialog display. */
    _tidyDialog: function(inst) {
      inst.dpDiv.removeClass(this._dialogClass).unbind('.ui-datepicker-calendar');
    },

    /* Close date picker if clicked elsewhere. */
    _checkExternalClick: function(event) {
      if (!$.datepicker._curInst) {
        return;
      }

      var $target = $(event.target),
        inst = $.datepicker._getInst($target[0]);

      if (
        ($target[0].id !== $.datepicker._mainDivId &&
          $target.parents('#' + $.datepicker._mainDivId).length === 0 &&
          !$target.hasClass($.datepicker.markerClassName) &&
          !$target.closest('.' + $.datepicker._triggerClass).length &&
          $.datepicker._datepickerShowing &&
          !($.datepicker._inDialog && $.blockUI)) ||
        ($target.hasClass($.datepicker.markerClassName) && $.datepicker._curInst !== inst)
      ) {
        $.datepicker._hideDatepicker();
      }
    },

    /* Adjust one of the date sub-fields. */
    _adjustDate: function(id, offset, period) {
      var target = $(id),
        inst = this._getInst(target[0]);

      if (this._isDisabledDatepicker(target[0])) {
        return;
      }
      this._adjustInstDate(
        inst,
        offset + (period === 'M' ? this._get(inst, 'showCurrentAtPos') : 0), // undo positioning
        period
      );
      this._updateDatepicker(inst);
    },

    /* Action for current link. */
    _gotoToday: function(id) {
      var date,
        target = $(id),
        inst = this._getInst(target[0]);

      if (this._get(inst, 'gotoCurrent') && inst.currentDay) {
        inst.selectedDay = inst.currentDay;
        inst.drawMonth = inst.selectedMonth = inst.currentMonth;
        inst.drawYear = inst.selectedYear = inst.currentYear;
      } else {
        date = new Date();
        inst.selectedDay = date.getDate();
        inst.drawMonth = inst.selectedMonth = date.getMonth();
        inst.drawYear = inst.selectedYear = date.getFullYear();
      }
      this._notifyChange(inst);
      this._adjustDate(target);
    },

    /* Action for selecting a new month/year. */
    _selectMonthYear: function(id, select, period) {
      var target = $(id),
        inst = this._getInst(target[0]);

      inst['selected' + (period === 'M' ? 'Month' : 'Year')] = inst[
        'draw' + (period === 'M' ? 'Month' : 'Year')
      ] = parseInt(select.options[select.selectedIndex].value, 10);

      this._notifyChange(inst);
      this._adjustDate(target);
    },

    /* Action for selecting a day. */
    _selectDay: function(id, month, year, td) {
      var inst,
        target = $(id);

      if ($(td).hasClass(this._unselectableClass) || this._isDisabledDatepicker(target[0])) {
        return;
      }

      inst = this._getInst(target[0]);
      inst.selectedDay = inst.currentDay = $('a', td).html();
      inst.selectedMonth = inst.currentMonth = month;
      inst.selectedYear = inst.currentYear = year;
      this._selectDate(id, this._formatDate(inst, inst.currentDay, inst.currentMonth, inst.currentYear));
    },

    /* Erase the input field and hide the date picker. */
    _clearDate: function(id) {
      var target = $(id);
      this._selectDate(target, '');
    },

    /* Update the input field with the selected date. */
    _selectDate: function(id, dateStr) {
      var onSelect,
        target = $(id),
        inst = this._getInst(target[0]);

      dateStr = dateStr != null ? dateStr : this._formatDate(inst);
      if (inst.input) {
        inst.input.val(dateStr);
      }
      this._updateAlternate(inst);

      onSelect = this._get(inst, 'onSelect');
      if (onSelect) {
        onSelect.apply(inst.input ? inst.input[0] : null, [dateStr, inst]); // trigger custom callback
      } else if (inst.input) {
        inst.input.trigger('change'); // fire the change event
      }

      if (inst.inline) {
        this._updateDatepicker(inst);
      } else {
        this._hideDatepicker();
        this._lastInput = inst.input[0];
        if (typeof inst.input[0] !== 'object') {
          inst.input.focus(); // restore focus
        }
        this._lastInput = null;
      }
    },

    /* Update any alternate field to synchronise with the main field. */
    _updateAlternate: function(inst) {
      var altFormat,
        date,
        dateStr,
        altField = this._get(inst, 'altField');

      if (altField) {
        // update alternate field too
        altFormat = this._get(inst, 'altFormat') || this._get(inst, 'dateFormat');
        date = this._getDate(inst);
        dateStr = this.formatDate(altFormat, date, this._getFormatConfig(inst));
        $(altField).each(function() {
          $(this).val(dateStr);
        });
      }
    },

    /* Set as beforeShowDay function to prevent selection of weekends.
     * @param  date  Date - the date to customise
     * @return [boolean, string] - is this date selectable?, what is its CSS class?
     */
    noWeekends: function(date) {
      var day = date.getDay();
      return [day > 0 && day < 6, ''];
    },

    /* Set as calculateWeek to determine the week of the year based on the ISO 8601 definition.
     * @param  date  Date - the date to get the week for
     * @return  number - the number of the week within the year that contains this date
     */
    iso8601Week: function(date) {
      var time,
        checkDate = new Date(date.getTime());

      // Find Thursday of this week starting on Monday
      checkDate.setDate(checkDate.getDate() + 4 - (checkDate.getDay() || 7));

      time = checkDate.getTime();
      checkDate.setMonth(0); // Compare with Jan 1
      checkDate.setDate(1);
      return Math.floor(Math.round((time - checkDate) / 86400000) / 7) + 1;
    },

    /* Parse a string value into a date object.
     * See formatDate below for the possible formats.
     *
     * @param  format string - the expected format of the date
     * @param  value string - the date in the above format
     * @param  settings Object - attributes include:
     *					shortYearCutoff  number - the cutoff year for determining the century (optional)
     *					dayNamesShort	string[7] - abbreviated names of the days from Sunday (optional)
     *					dayNames		string[7] - names of the days from Sunday (optional)
     *					monthNamesShort string[12] - abbreviated names of the months (optional)
     *					monthNames		string[12] - names of the months (optional)
     * @return  Date - the extracted date value or null if value is blank
     */
    parseDate: function(format, value, settings) {
      if (format == null || value == null) {
        throw 'Invalid arguments';
      }

      value = typeof value === 'object' ? value.toString() : value + '';
      if (value === '') {
        return null;
      }

      var iFormat,
        dim,
        extra,
        iValue = 0,
        shortYearCutoffTemp = (settings ? settings.shortYearCutoff : null) || this._defaults.shortYearCutoff,
        shortYearCutoff =
          typeof shortYearCutoffTemp !== 'string'
            ? shortYearCutoffTemp
            : (new Date().getFullYear() % 100) + parseInt(shortYearCutoffTemp, 10),
        dayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort,
        dayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames,
        monthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort,
        monthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames,
        year = -1,
        month = -1,
        day = -1,
        doy = -1,
        literal = false,
        date,
        // Check whether a format character is doubled
        lookAhead = function(match) {
          var matches = iFormat + 1 < format.length && format.charAt(iFormat + 1) === match;
          if (matches) {
            iFormat++;
          }
          return matches;
        },
        // Extract a number from the string value
        getNumber = function(match) {
          var isDoubled = lookAhead(match),
            size = match === '@' ? 14 : match === '!' ? 20 : match === 'y' && isDoubled ? 4 : match === 'o' ? 3 : 2,
            digits = new RegExp('^\\d{1,' + size + '}'),
            num = value.substring(iValue).match(digits);
          if (!num) {
            throw 'Missing number at position ' + iValue;
          }
          iValue += num[0].length;
          return parseInt(num[0], 10);
        },
        // Extract a name from the string value and convert to an index
        getName = function(match, shortNames, longNames) {
          var index = -1,
            names = $.map(lookAhead(match) ? longNames : shortNames, function(v, k) {
              return [[k, v]];
            }).sort(function(a, b) {
              return -(a[1].length - b[1].length);
            });

          $.each(names, function(i, pair) {
            var name = pair[1];
            if (value.substr(iValue, name.length).toLowerCase() === name.toLowerCase()) {
              index = pair[0];
              iValue += name.length;
              return false;
            }
          });
          if (index !== -1) {
            return index + 1;
          } else {
            throw 'Unknown name at position ' + iValue;
          }
        },
        // Confirm that a literal character matches the string value
        checkLiteral = function() {
          if (value.charAt(iValue) !== format.charAt(iFormat)) {
            throw 'Unexpected literal at position ' + iValue;
          }
          iValue++;
        };

      for (iFormat = 0; iFormat < format.length; iFormat++) {
        if (literal) {
          if (format.charAt(iFormat) === "'" && !lookAhead("'")) {
            literal = false;
          } else {
            checkLiteral();
          }
        } else {
          switch (format.charAt(iFormat)) {
            case 'd':
              day = getNumber('d');
              break;
            case 'D':
              getName('D', dayNamesShort, dayNames);
              break;
            case 'o':
              doy = getNumber('o');
              break;
            case 'm':
              month = getNumber('m');
              break;
            case 'M':
              month = getName('M', monthNamesShort, monthNames);
              break;
            case 'y':
              year = getNumber('y');
              break;
            case '@':
              date = new Date(getNumber('@'));
              year = date.getFullYear();
              month = date.getMonth() + 1;
              day = date.getDate();
              break;
            case '!':
              date = new Date((getNumber('!') - this._ticksTo1970) / 10000);
              year = date.getFullYear();
              month = date.getMonth() + 1;
              day = date.getDate();
              break;
            case "'":
              if (lookAhead("'")) {
                checkLiteral();
              } else {
                literal = true;
              }
              break;
            default:
              checkLiteral();
          }
        }
      }

      if (iValue < value.length) {
        extra = value.substr(iValue);
        if (!/^\s+/.test(extra)) {
          throw 'Extra/unparsed characters found in date: ' + extra;
        }
      }

      if (year === -1) {
        year = new Date().getFullYear();
      } else if (year < 100) {
        year += new Date().getFullYear() - (new Date().getFullYear() % 100) + (year <= shortYearCutoff ? 0 : -100);
      }

      if (doy > -1) {
        month = 1;
        day = doy;
        do {
          dim = this._getDaysInMonth(year, month - 1);
          if (day <= dim) {
            break;
          }
          month++;
          day -= dim;
        } while (true);
      }

      date = this._daylightSavingAdjust(new Date(year, month - 1, day));
      if (date.getFullYear() !== year || date.getMonth() + 1 !== month || date.getDate() !== day) {
        throw 'Invalid date'; // E.g. 31/02/00
      }
      return date;
    },

    /* Standard date formats. */
    ATOM: 'yy-mm-dd', // RFC 3339 (ISO 8601)
    COOKIE: 'D, dd M yy',
    ISO_8601: 'yy-mm-dd',
    RFC_822: 'D, d M y',
    RFC_850: 'DD, dd-M-y',
    RFC_1036: 'D, d M y',
    RFC_1123: 'D, d M yy',
    RFC_2822: 'D, d M yy',
    RSS: 'D, d M y', // RFC 822
    TICKS: '!',
    TIMESTAMP: '@',
    W3C: 'yy-mm-dd', // ISO 8601

    _ticksTo1970:
      ((1970 - 1) * 365 + Math.floor(1970 / 4) - Math.floor(1970 / 100) + Math.floor(1970 / 400)) *
      24 *
      60 *
      60 *
      10000000,

    /* Format a date object into a string value.
     * The format can be combinations of the following:
     * d  - day of month (no leading zero)
     * dd - day of month (two digit)
     * o  - day of year (no leading zeros)
     * oo - day of year (three digit)
     * D  - day name short
     * DD - day name long
     * m  - month of year (no leading zero)
     * mm - month of year (two digit)
     * M  - month name short
     * MM - month name long
     * y  - year (two digit)
     * yy - year (four digit)
     * @ - Unix timestamp (ms since 01/01/1970)
     * ! - Windows ticks (100ns since 01/01/0001)
     * "..." - literal text
     * '' - single quote
     *
     * @param  format string - the desired format of the date
     * @param  date Date - the date value to format
     * @param  settings Object - attributes include:
     *					dayNamesShort	string[7] - abbreviated names of the days from Sunday (optional)
     *					dayNames		string[7] - names of the days from Sunday (optional)
     *					monthNamesShort string[12] - abbreviated names of the months (optional)
     *					monthNames		string[12] - names of the months (optional)
     * @return  string - the date in the above format
     */
    formatDate: function(format, date, settings) {
      if (!date) {
        return '';
      }

      var iFormat,
        dayNamesShort = (settings ? settings.dayNamesShort : null) || this._defaults.dayNamesShort,
        dayNames = (settings ? settings.dayNames : null) || this._defaults.dayNames,
        monthNamesShort = (settings ? settings.monthNamesShort : null) || this._defaults.monthNamesShort,
        monthNames = (settings ? settings.monthNames : null) || this._defaults.monthNames,
        // Check whether a format character is doubled
        lookAhead = function(match) {
          var matches = iFormat + 1 < format.length && format.charAt(iFormat + 1) === match;
          if (matches) {
            iFormat++;
          }
          return matches;
        },
        // Format a number, with leading zero if necessary
        formatNumber = function(match, value, len) {
          var num = '' + value;
          if (lookAhead(match)) {
            while (num.length < len) {
              num = '0' + num;
            }
          }
          return num;
        },
        // Format a name, short or long as requested
        formatName = function(match, value, shortNames, longNames) {
          return lookAhead(match) ? longNames[value] : shortNames[value];
        },
        output = '',
        literal = false;

      if (date) {
        for (iFormat = 0; iFormat < format.length; iFormat++) {
          if (literal) {
            if (format.charAt(iFormat) === "'" && !lookAhead("'")) {
              literal = false;
            } else {
              output += format.charAt(iFormat);
            }
          } else {
            switch (format.charAt(iFormat)) {
              case 'd':
                output += formatNumber('d', date.getDate(), 2);
                break;
              case 'D':
                output += formatName('D', date.getDay(), dayNamesShort, dayNames);
                break;
              case 'o':
                output += formatNumber(
                  'o',
                  Math.round(
                    (new Date(date.getFullYear(), date.getMonth(), date.getDate()).getTime() -
                      new Date(date.getFullYear(), 0, 0).getTime()) /
                      86400000
                  ),
                  3
                );
                break;
              case 'm':
                output += formatNumber('m', date.getMonth() + 1, 2);
                break;
              case 'M':
                output += formatName('M', date.getMonth(), monthNamesShort, monthNames);
                break;
              case 'y':
                output += lookAhead('y')
                  ? date.getFullYear()
                  : (date.getYear() % 100 < 10 ? '0' : '') + (date.getYear() % 100);
                break;
              case '@':
                output += date.getTime();
                break;
              case '!':
                output += date.getTime() * 10000 + this._ticksTo1970;
                break;
              case "'":
                if (lookAhead("'")) {
                  output += "'";
                } else {
                  literal = true;
                }
                break;
              default:
                output += format.charAt(iFormat);
            }
          }
        }
      }
      return output;
    },

    /* Extract all possible characters from the date format. */
    _possibleChars: function(format) {
      var iFormat,
        chars = '',
        literal = false,
        // Check whether a format character is doubled
        lookAhead = function(match) {
          var matches = iFormat + 1 < format.length && format.charAt(iFormat + 1) === match;
          if (matches) {
            iFormat++;
          }
          return matches;
        };

      for (iFormat = 0; iFormat < format.length; iFormat++) {
        if (literal) {
          if (format.charAt(iFormat) === "'" && !lookAhead("'")) {
            literal = false;
          } else {
            chars += format.charAt(iFormat);
          }
        } else {
          switch (format.charAt(iFormat)) {
            case 'd':
            case 'm':
            case 'y':
            case '@':
              chars += '0123456789';
              break;
            case 'D':
            case 'M':
              return null; // Accept anything
            case "'":
              if (lookAhead("'")) {
                chars += "'";
              } else {
                literal = true;
              }
              break;
            default:
              chars += format.charAt(iFormat);
          }
        }
      }
      return chars;
    },

    /* Get a setting value, defaulting if necessary. */
    _get: function(inst, name) {
      return inst.settings[name] !== undefined ? inst.settings[name] : this._defaults[name];
    },

    /* Parse existing date and initialise date picker. */
    _setDateFromField: function(inst, noDefault) {
      if (inst.input.val() === inst.lastVal) {
        return;
      }

      var dateFormat = this._get(inst, 'dateFormat'),
        dates = (inst.lastVal = inst.input ? inst.input.val() : null),
        defaultDate = this._getDefaultDate(inst),
        date = defaultDate,
        settings = this._getFormatConfig(inst);

      try {
        date = this.parseDate(dateFormat, dates, settings) || defaultDate;
      } catch (event) {
        dates = noDefault ? '' : dates;
      }
      inst.selectedDay = date.getDate();
      inst.drawMonth = inst.selectedMonth = date.getMonth();
      inst.drawYear = inst.selectedYear = date.getFullYear();
      inst.currentDay = dates ? date.getDate() : 0;
      inst.currentMonth = dates ? date.getMonth() : 0;
      inst.currentYear = dates ? date.getFullYear() : 0;
      this._adjustInstDate(inst);
    },

    /* Retrieve the default date shown on opening. */
    _getDefaultDate: function(inst) {
      return this._restrictMinMax(inst, this._determineDate(inst, this._get(inst, 'defaultDate'), new Date()));
    },

    /* A date may be specified as an exact value or a relative one. */
    _determineDate: function(inst, date, defaultDate) {
      var offsetNumeric = function(offset) {
          var date = new Date();
          date.setDate(date.getDate() + offset);
          return date;
        },
        offsetString = function(offset) {
          try {
            return $.datepicker.parseDate(
              $.datepicker._get(inst, 'dateFormat'),
              offset,
              $.datepicker._getFormatConfig(inst)
            );
          } catch (e) {
            // Ignore
          }

          var date = (offset.toLowerCase().match(/^c/) ? $.datepicker._getDate(inst) : null) || new Date(),
            year = date.getFullYear(),
            month = date.getMonth(),
            day = date.getDate(),
            pattern = /([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,
            matches = pattern.exec(offset);

          while (matches) {
            switch (matches[2] || 'd') {
              case 'd':
              case 'D':
                day += parseInt(matches[1], 10);
                break;
              case 'w':
              case 'W':
                day += parseInt(matches[1], 10) * 7;
                break;
              case 'm':
              case 'M':
                month += parseInt(matches[1], 10);
                day = Math.min(day, $.datepicker._getDaysInMonth(year, month));
                break;
              case 'y':
              case 'Y':
                year += parseInt(matches[1], 10);
                day = Math.min(day, $.datepicker._getDaysInMonth(year, month));
                break;
            }
            matches = pattern.exec(offset);
          }
          return new Date(year, month, day);
        },
        newDate =
          date == null || date === ''
            ? defaultDate
            : typeof date === 'string'
            ? offsetString(date)
            : typeof date === 'number'
            ? isNaN(date)
              ? defaultDate
              : offsetNumeric(date)
            : new Date(date.getTime());

      newDate = newDate && newDate.toString() === 'Invalid Date' ? defaultDate : newDate;
      if (newDate) {
        newDate.setHours(0);
        newDate.setMinutes(0);
        newDate.setSeconds(0);
        newDate.setMilliseconds(0);
      }
      return this._daylightSavingAdjust(newDate);
    },

    /* Handle switch to/from daylight saving.
     * Hours may be non-zero on daylight saving cut-over:
     * > 12 when midnight changeover, but then cannot generate
     * midnight datetime, so jump to 1AM, otherwise reset.
     * @param  date  (Date) the date to check
     * @return  (Date) the corrected date
     */
    _daylightSavingAdjust: function(date) {
      if (!date) {
        return null;
      }
      date.setHours(date.getHours() > 12 ? date.getHours() + 2 : 0);
      return date;
    },

    /* Set the date(s) directly. */
    _setDate: function(inst, date, noChange) {
      var clear = !date,
        origMonth = inst.selectedMonth,
        origYear = inst.selectedYear,
        newDate = this._restrictMinMax(inst, this._determineDate(inst, date, new Date()));

      inst.selectedDay = inst.currentDay = newDate.getDate();
      inst.drawMonth = inst.selectedMonth = inst.currentMonth = newDate.getMonth();
      inst.drawYear = inst.selectedYear = inst.currentYear = newDate.getFullYear();
      if ((origMonth !== inst.selectedMonth || origYear !== inst.selectedYear) && !noChange) {
        this._notifyChange(inst);
      }
      this._adjustInstDate(inst);
      if (inst.input) {
        inst.input.val(clear ? '' : this._formatDate(inst));
      }
    },

    /* Retrieve the date(s) directly. */
    _getDate: function(inst) {
      var startDate =
        !inst.currentYear || (inst.input && inst.input.val() === '')
          ? null
          : this._daylightSavingAdjust(new Date(inst.currentYear, inst.currentMonth, inst.currentDay));
      return startDate;
    },

    /* Attach the onxxx handlers.  These are declared statically so
     * they work with static code transformers like Caja.
     */
    _attachHandlers: function(inst) {
      var stepMonths = this._get(inst, 'stepMonths'),
        id = '#' + inst.id.replace(/\\\\/g, '\\');
      inst.dpDiv.find('[data-handler]').map(function() {
        var handler = {
          prev: function() {
            $.datepicker._adjustDate(id, -stepMonths, 'M');
          },
          next: function() {
            $.datepicker._adjustDate(id, +stepMonths, 'M');
          },
          hide: function() {
            $.datepicker._hideDatepicker();
          },
          today: function() {
            $.datepicker._gotoToday(id);
          },
          selectDay: function() {
            $.datepicker._selectDay(id, +this.getAttribute('data-month'), +this.getAttribute('data-year'), this);
            return false;
          },
          selectMonth: function() {
            $.datepicker._selectMonthYear(id, this, 'M');
            return false;
          },
          selectYear: function() {
            $.datepicker._selectMonthYear(id, this, 'Y');
            return false;
          },
        };
        $(this).bind(this.getAttribute('data-event'), handler[this.getAttribute('data-handler')]);
      });
    },

    /* Generate the HTML for the current state of the date picker. */
    _generateHTML: function(inst) {
      var maxDraw,
        prevText,
        prev,
        nextText,
        next,
        currentText,
        gotoDate,
        controls,
        buttonPanel,
        firstDay,
        showWeek,
        dayNames,
        dayNamesMin,
        monthNames,
        monthNamesShort,
        beforeShowDay,
        showOtherMonths,
        selectOtherMonths,
        defaultDate,
        html,
        dow,
        row,
        group,
        col,
        selectedDate,
        cornerClass,
        calender,
        thead,
        day,
        daysInMonth,
        leadDays,
        curRows,
        numRows,
        printDate,
        dRow,
        tbody,
        daySettings,
        otherMonth,
        unselectable,
        tempDate = new Date(),
        today = this._daylightSavingAdjust(new Date(tempDate.getFullYear(), tempDate.getMonth(), tempDate.getDate())), // clear time
        isRTL = this._get(inst, 'isRTL'),
        showButtonPanel = this._get(inst, 'showButtonPanel'),
        hideIfNoPrevNext = this._get(inst, 'hideIfNoPrevNext'),
        navigationAsDateFormat = this._get(inst, 'navigationAsDateFormat'),
        numMonths = this._getNumberOfMonths(inst),
        showCurrentAtPos = this._get(inst, 'showCurrentAtPos'),
        stepMonths = this._get(inst, 'stepMonths'),
        isMultiMonth = numMonths[0] !== 1 || numMonths[1] !== 1,
        currentDate = this._daylightSavingAdjust(
          !inst.currentDay ? new Date(9999, 9, 9) : new Date(inst.currentYear, inst.currentMonth, inst.currentDay)
        ),
        minDate = this._getMinMaxDate(inst, 'min'),
        maxDate = this._getMinMaxDate(inst, 'max'),
        drawMonth = inst.drawMonth - showCurrentAtPos,
        drawYear = inst.drawYear;

      if (drawMonth < 0) {
        drawMonth += 12;
        drawYear--;
      }
      if (maxDate) {
        maxDraw = this._daylightSavingAdjust(
          new Date(maxDate.getFullYear(), maxDate.getMonth() - numMonths[0] * numMonths[1] + 1, maxDate.getDate())
        );
        maxDraw = minDate && maxDraw < minDate ? minDate : maxDraw;
        while (this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1)) > maxDraw) {
          drawMonth--;
          if (drawMonth < 0) {
            drawMonth = 11;
            drawYear--;
          }
        }
      }
      inst.drawMonth = drawMonth;
      inst.drawYear = drawYear;

      prevText = this._get(inst, 'prevText');
      prevText = !navigationAsDateFormat
        ? prevText
        : this.formatDate(
            prevText,
            this._daylightSavingAdjust(new Date(drawYear, drawMonth - stepMonths, 1)),
            this._getFormatConfig(inst)
          );

      prev = this._canAdjustMonth(inst, -1, drawYear, drawMonth)
        ? "<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click'" +
          " title='" +
          prevText +
          "'><span class='ui-icon ui-icon-circle-triangle-" +
          (isRTL ? 'e' : 'w') +
          "'>" +
          prevText +
          '</span></a>'
        : hideIfNoPrevNext
        ? ''
        : "<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='" +
          prevText +
          "'><span class='ui-icon ui-icon-circle-triangle-" +
          (isRTL ? 'e' : 'w') +
          "'>" +
          prevText +
          '</span></a>';

      nextText = this._get(inst, 'nextText');
      nextText = !navigationAsDateFormat
        ? nextText
        : this.formatDate(
            nextText,
            this._daylightSavingAdjust(new Date(drawYear, drawMonth + stepMonths, 1)),
            this._getFormatConfig(inst)
          );

      next = this._canAdjustMonth(inst, +1, drawYear, drawMonth)
        ? "<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click'" +
          " title='" +
          nextText +
          "'><span class='ui-icon ui-icon-circle-triangle-" +
          (isRTL ? 'w' : 'e') +
          "'>" +
          nextText +
          '</span></a>'
        : hideIfNoPrevNext
        ? ''
        : "<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='" +
          nextText +
          "'><span class='ui-icon ui-icon-circle-triangle-" +
          (isRTL ? 'w' : 'e') +
          "'>" +
          nextText +
          '</span></a>';

      currentText = this._get(inst, 'currentText');
      gotoDate = this._get(inst, 'gotoCurrent') && inst.currentDay ? currentDate : today;
      currentText = !navigationAsDateFormat
        ? currentText
        : this.formatDate(currentText, gotoDate, this._getFormatConfig(inst));

      controls = !inst.inline
        ? "<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>" +
          this._get(inst, 'closeText') +
          '</button>'
        : '';

      buttonPanel = showButtonPanel
        ? "<div class='ui-datepicker-buttonpane ui-widget-content'>" +
          (isRTL ? controls : '') +
          (this._isInRange(inst, gotoDate)
            ? "<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'" +
              '>' +
              currentText +
              '</button>'
            : '') +
          (isRTL ? '' : controls) +
          '</div>'
        : '';

      firstDay = parseInt(this._get(inst, 'firstDay'), 10);
      firstDay = isNaN(firstDay) ? 0 : firstDay;

      showWeek = this._get(inst, 'showWeek');
      dayNames = this._get(inst, 'dayNames');
      dayNamesMin = this._get(inst, 'dayNamesMin');
      monthNames = this._get(inst, 'monthNames');
      monthNamesShort = this._get(inst, 'monthNamesShort');
      beforeShowDay = this._get(inst, 'beforeShowDay');
      showOtherMonths = this._get(inst, 'showOtherMonths');
      selectOtherMonths = this._get(inst, 'selectOtherMonths');
      defaultDate = this._getDefaultDate(inst);
      html = '';
      dow;
      for (row = 0; row < numMonths[0]; row++) {
        group = '';
        this.maxRows = 4;
        for (col = 0; col < numMonths[1]; col++) {
          selectedDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, inst.selectedDay));
          cornerClass = ' ui-corner-all';
          calender = '';
          if (isMultiMonth) {
            calender += "<div class='ui-datepicker-group";
            if (numMonths[1] > 1) {
              switch (col) {
                case 0:
                  calender += ' ui-datepicker-group-first';
                  cornerClass = ' ui-corner-' + (isRTL ? 'right' : 'left');
                  break;
                case numMonths[1] - 1:
                  calender += ' ui-datepicker-group-last';
                  cornerClass = ' ui-corner-' + (isRTL ? 'left' : 'right');
                  break;
                default:
                  calender += ' ui-datepicker-group-middle';
                  cornerClass = '';
                  break;
              }
            }
            calender += "'>";
          }
          calender +=
            "<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix" +
            cornerClass +
            "'>" +
            (/all|left/.test(cornerClass) && row === 0 ? (isRTL ? next : prev) : '') +
            (/all|right/.test(cornerClass) && row === 0 ? (isRTL ? prev : next) : '') +
            this._generateMonthYearHeader(
              inst,
              drawMonth,
              drawYear,
              minDate,
              maxDate,
              row > 0 || col > 0,
              monthNames,
              monthNamesShort
            ) + // draw month headers
            "</div><table class='ui-datepicker-calendar'><thead>" +
            '<tr>';
          thead = showWeek ? "<th class='ui-datepicker-week-col'>" + this._get(inst, 'weekHeader') + '</th>' : '';
          for (dow = 0; dow < 7; dow++) {
            // days of the week
            day = (dow + firstDay) % 7;
            thead +=
              '<th' +
              ((dow + firstDay + 6) % 7 >= 5 ? " class='ui-datepicker-week-end'" : '') +
              '>' +
              "<span title='" +
              dayNames[day] +
              "'>" +
              dayNamesMin[day] +
              '</span></th>';
          }
          calender += thead + '</tr></thead><tbody>';
          daysInMonth = this._getDaysInMonth(drawYear, drawMonth);
          if (drawYear === inst.selectedYear && drawMonth === inst.selectedMonth) {
            inst.selectedDay = Math.min(inst.selectedDay, daysInMonth);
          }
          leadDays = (this._getFirstDayOfMonth(drawYear, drawMonth) - firstDay + 7) % 7;
          curRows = Math.ceil((leadDays + daysInMonth) / 7); // calculate the number of rows to generate
          numRows = isMultiMonth ? (this.maxRows > curRows ? this.maxRows : curRows) : curRows; //If multiple months, use the higher number of rows (see #7043)
          this.maxRows = numRows;
          printDate = this._daylightSavingAdjust(new Date(drawYear, drawMonth, 1 - leadDays));
          for (dRow = 0; dRow < numRows; dRow++) {
            // create date picker rows
            calender += '<tr>';
            tbody = !showWeek
              ? ''
              : "<td class='ui-datepicker-week-col'>" + this._get(inst, 'calculateWeek')(printDate) + '</td>';
            for (dow = 0; dow < 7; dow++) {
              // create date picker days
              daySettings = beforeShowDay
                ? beforeShowDay.apply(inst.input ? inst.input[0] : null, [printDate])
                : [true, ''];
              otherMonth = printDate.getMonth() !== drawMonth;
              unselectable =
                (otherMonth && !selectOtherMonths) ||
                !daySettings[0] ||
                (minDate && printDate < minDate) ||
                (maxDate && printDate > maxDate);
              tbody +=
                "<td class='" +
                ((dow + firstDay + 6) % 7 >= 5 ? ' ui-datepicker-week-end' : '') + // highlight weekends
                (otherMonth ? ' ui-datepicker-other-month' : '') + // highlight days from other months
                ((printDate.getTime() === selectedDate.getTime() &&
                  drawMonth === inst.selectedMonth &&
                  inst._keyEvent) || // user pressed key
                (defaultDate.getTime() === printDate.getTime() && defaultDate.getTime() === selectedDate.getTime())
                  ? // or defaultDate is current printedDate and defaultDate is selectedDate
                    ' ' + this._dayOverClass
                  : '') + // highlight selected day
                (unselectable ? ' ' + this._unselectableClass + ' ui-state-disabled' : '') + // highlight unselectable days
                (otherMonth && !showOtherMonths
                  ? ''
                  : ' ' +
                    daySettings[1] + // highlight custom dates
                    (printDate.getTime() === currentDate.getTime() ? ' ' + this._currentClass : '') + // highlight selected day
                    (printDate.getTime() === today.getTime() ? ' ui-datepicker-today' : '')) +
                "'" + // highlight today (if different)
                ((!otherMonth || showOtherMonths) && daySettings[2]
                  ? " title='" + daySettings[2].replace(/'/g, '&#39;') + "'"
                  : '') + // cell title
                (unselectable
                  ? ''
                  : " data-handler='selectDay' data-event='click' data-month='" +
                    printDate.getMonth() +
                    "' data-year='" +
                    printDate.getFullYear() +
                    "'") +
                '>' + // actions
                (otherMonth && !showOtherMonths
                  ? '&#xa0;' // display for other months
                  : unselectable
                  ? "<span class='ui-state-default'>" + printDate.getDate() + '</span>'
                  : "<a class='ui-state-default" +
                    (printDate.getTime() === today.getTime() ? ' ui-state-highlight' : '') +
                    (printDate.getTime() === currentDate.getTime() ? ' ui-state-active' : '') + // highlight selected day
                    (otherMonth ? ' ui-priority-secondary' : '') + // distinguish dates from other months
                    "' href='#'>" +
                    printDate.getDate() +
                    '</a>') +
                '</td>'; // display selectable date
              printDate.setDate(printDate.getDate() + 1);
              printDate = this._daylightSavingAdjust(printDate);
            }
            calender += tbody + '</tr>';
          }
          drawMonth++;
          if (drawMonth > 11) {
            drawMonth = 0;
            drawYear++;
          }
          calender +=
            '</tbody></table>' +
            (isMultiMonth
              ? '</div>' +
                (numMonths[0] > 0 && col === numMonths[1] - 1 ? "<div class='ui-datepicker-row-break'></div>" : '')
              : '');
          group += calender;
        }
        html += group;
      }
      html += buttonPanel;
      inst._keyEvent = false;
      return html;
    },

    /* Generate the month and year header. */
    _generateMonthYearHeader: function(
      inst,
      drawMonth,
      drawYear,
      minDate,
      maxDate,
      secondary,
      monthNames,
      monthNamesShort
    ) {
      var inMinYear,
        inMaxYear,
        month,
        years,
        thisYear,
        determineYear,
        year,
        endYear,
        changeMonth = this._get(inst, 'changeMonth'),
        changeYear = this._get(inst, 'changeYear'),
        showMonthAfterYear = this._get(inst, 'showMonthAfterYear'),
        html = "<div class='ui-datepicker-title'>",
        monthHtml = '';

      // month selection
      if (secondary || !changeMonth) {
        monthHtml += "<span class='ui-datepicker-month'>" + monthNames[drawMonth] + '</span>';
      } else {
        inMinYear = minDate && minDate.getFullYear() === drawYear;
        inMaxYear = maxDate && maxDate.getFullYear() === drawYear;
        monthHtml += "<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";
        for (month = 0; month < 12; month++) {
          if ((!inMinYear || month >= minDate.getMonth()) && (!inMaxYear || month <= maxDate.getMonth())) {
            monthHtml +=
              "<option value='" +
              month +
              "'" +
              (month === drawMonth ? " selected='selected'" : '') +
              '>' +
              monthNamesShort[month] +
              '</option>';
          }
        }
        monthHtml += '</select>';
      }

      if (!showMonthAfterYear) {
        html += monthHtml + (secondary || !(changeMonth && changeYear) ? '&#xa0;' : '');
      }

      // year selection
      if (!inst.yearshtml) {
        inst.yearshtml = '';
        if (secondary || !changeYear) {
          html += "<span class='ui-datepicker-year'>" + drawYear + '</span>';
        } else {
          // determine range of years to display
          years = this._get(inst, 'yearRange').split(':');
          thisYear = new Date().getFullYear();
          determineYear = function(value) {
            var year = value.match(/c[+\-].*/)
              ? drawYear + parseInt(value.substring(1), 10)
              : value.match(/[+\-].*/)
              ? thisYear + parseInt(value, 10)
              : parseInt(value, 10);
            return isNaN(year) ? thisYear : year;
          };
          year = determineYear(years[0]);
          endYear = Math.max(year, determineYear(years[1] || ''));
          year = minDate ? Math.max(year, minDate.getFullYear()) : year;
          endYear = maxDate ? Math.min(endYear, maxDate.getFullYear()) : endYear;
          inst.yearshtml += "<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";
          for (; year <= endYear; year++) {
            inst.yearshtml +=
              "<option value='" +
              year +
              "'" +
              (year === drawYear ? " selected='selected'" : '') +
              '>' +
              year +
              '</option>';
          }
          inst.yearshtml += '</select>';

          html += inst.yearshtml;
          inst.yearshtml = null;
        }
      }

      html += this._get(inst, 'yearSuffix');
      if (showMonthAfterYear) {
        html += (secondary || !(changeMonth && changeYear) ? '&#xa0;' : '') + monthHtml;
      }
      html += '</div>'; // Close datepicker_header
      return html;
    },

    /* Adjust one of the date sub-fields. */
    _adjustInstDate: function(inst, offset, period) {
      var year = inst.drawYear + (period === 'Y' ? offset : 0),
        month = inst.drawMonth + (period === 'M' ? offset : 0),
        day = Math.min(inst.selectedDay, this._getDaysInMonth(year, month)) + (period === 'D' ? offset : 0),
        date = this._restrictMinMax(inst, this._daylightSavingAdjust(new Date(year, month, day)));

      inst.selectedDay = date.getDate();
      inst.drawMonth = inst.selectedMonth = date.getMonth();
      inst.drawYear = inst.selectedYear = date.getFullYear();
      if (period === 'M' || period === 'Y') {
        this._notifyChange(inst);
      }
    },

    /* Ensure a date is within any min/max bounds. */
    _restrictMinMax: function(inst, date) {
      var minDate = this._getMinMaxDate(inst, 'min'),
        maxDate = this._getMinMaxDate(inst, 'max'),
        newDate = minDate && date < minDate ? minDate : date;
      return maxDate && newDate > maxDate ? maxDate : newDate;
    },

    /* Notify change of month/year. */
    _notifyChange: function(inst) {
      var onChange = this._get(inst, 'onChangeMonthYear');
      if (onChange) {
        onChange.apply(inst.input ? inst.input[0] : null, [inst.selectedYear, inst.selectedMonth + 1, inst]);
      }
    },

    /* Determine the number of months to show. */
    _getNumberOfMonths: function(inst) {
      var numMonths = this._get(inst, 'numberOfMonths');
      return numMonths == null ? [1, 1] : typeof numMonths === 'number' ? [1, numMonths] : numMonths;
    },

    /* Determine the current maximum date - ensure no time components are set. */
    _getMinMaxDate: function(inst, minMax) {
      return this._determineDate(inst, this._get(inst, minMax + 'Date'), null);
    },

    /* Find the number of days in a given month. */
    _getDaysInMonth: function(year, month) {
      return 32 - this._daylightSavingAdjust(new Date(year, month, 32)).getDate();
    },

    /* Find the day of the week of the first of a month. */
    _getFirstDayOfMonth: function(year, month) {
      return new Date(year, month, 1).getDay();
    },

    /* Determines if we should allow a "next/prev" month display change. */
    _canAdjustMonth: function(inst, offset, curYear, curMonth) {
      var numMonths = this._getNumberOfMonths(inst),
        date = this._daylightSavingAdjust(
          new Date(curYear, curMonth + (offset < 0 ? offset : numMonths[0] * numMonths[1]), 1)
        );

      if (offset < 0) {
        date.setDate(this._getDaysInMonth(date.getFullYear(), date.getMonth()));
      }
      return this._isInRange(inst, date);
    },

    /* Is the given date in the accepted range? */
    _isInRange: function(inst, date) {
      var yearSplit,
        currentYear,
        minDate = this._getMinMaxDate(inst, 'min'),
        maxDate = this._getMinMaxDate(inst, 'max'),
        minYear = null,
        maxYear = null,
        years = this._get(inst, 'yearRange');
      if (years) {
        yearSplit = years.split(':');
        currentYear = new Date().getFullYear();
        minYear = parseInt(yearSplit[0], 10);
        maxYear = parseInt(yearSplit[1], 10);
        if (yearSplit[0].match(/[+\-].*/)) {
          minYear += currentYear;
        }
        if (yearSplit[1].match(/[+\-].*/)) {
          maxYear += currentYear;
        }
      }

      return (
        (!minDate || date.getTime() >= minDate.getTime()) &&
        (!maxDate || date.getTime() <= maxDate.getTime()) &&
        (!minYear || date.getFullYear() >= minYear) &&
        (!maxYear || date.getFullYear() <= maxYear)
      );
    },

    /* Provide the configuration settings for formatting/parsing. */
    _getFormatConfig: function(inst) {
      var shortYearCutoff = this._get(inst, 'shortYearCutoff');
      shortYearCutoff =
        typeof shortYearCutoff !== 'string'
          ? shortYearCutoff
          : (new Date().getFullYear() % 100) + parseInt(shortYearCutoff, 10);
      return {
        shortYearCutoff: shortYearCutoff,
        dayNamesShort: this._get(inst, 'dayNamesShort'),
        dayNames: this._get(inst, 'dayNames'),
        monthNamesShort: this._get(inst, 'monthNamesShort'),
        monthNames: this._get(inst, 'monthNames'),
      };
    },

    /* Format the given date for display. */
    _formatDate: function(inst, day, month, year) {
      if (!day) {
        inst.currentDay = inst.selectedDay;
        inst.currentMonth = inst.selectedMonth;
        inst.currentYear = inst.selectedYear;
      }
      var date = day
        ? typeof day === 'object'
          ? day
          : this._daylightSavingAdjust(new Date(year, month, day))
        : this._daylightSavingAdjust(new Date(inst.currentYear, inst.currentMonth, inst.currentDay));
      return this.formatDate(this._get(inst, 'dateFormat'), date, this._getFormatConfig(inst));
    },
  });

  /*
   * Bind hover events for datepicker elements.
   * Done via delegate so the binding only occurs once in the lifetime of the parent div.
   * Global instActive, set by _updateDatepicker allows the handlers to find their way back to the active picker.
   */
  function bindHover(dpDiv) {
    var selector = 'button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a';
    return dpDiv
      .delegate(selector, 'mouseout', function() {
        $(this).removeClass('ui-state-hover');
        if (this.className.indexOf('ui-datepicker-prev') !== -1) {
          $(this).removeClass('ui-datepicker-prev-hover');
        }
        if (this.className.indexOf('ui-datepicker-next') !== -1) {
          $(this).removeClass('ui-datepicker-next-hover');
        }
      })
      .delegate(selector, 'mouseover', function() {
        if (!$.datepicker._isDisabledDatepicker(instActive.inline ? dpDiv.parent()[0] : instActive.input[0])) {
          $(this)
            .parents('.ui-datepicker-calendar')
            .find('a')
            .removeClass('ui-state-hover');
          $(this).addClass('ui-state-hover');
          if (this.className.indexOf('ui-datepicker-prev') !== -1) {
            $(this).addClass('ui-datepicker-prev-hover');
          }
          if (this.className.indexOf('ui-datepicker-next') !== -1) {
            $(this).addClass('ui-datepicker-next-hover');
          }
        }
      });
  }

  /* jQuery extend now ignores nulls! */
  function extendRemove(target, props) {
    $.extend(target, props);
    for (var name in props) {
      if (props[name] == null) {
        target[name] = props[name];
      }
    }
    return target;
  }

  /* Invoke the datepicker functionality.
   @param  options  string - a command, optionally followed by additional parameters or
					Object - settings for attaching new datepicker functionality
   @return  jQuery object */
  $.fn.datepicker = function(options) {
    /* Verify an empty collection wasn't passed - Fixes #6976 */
    if (!this.length) {
      return this;
    }

    /* Initialise the date picker. */
    if (!$.datepicker.initialized) {
      $(document).mousedown($.datepicker._checkExternalClick);
      $.datepicker.initialized = true;
    }

    /* Append datepicker main container to body if not exist. */
    if ($('#' + $.datepicker._mainDivId).length === 0) {
      $('body').append($.datepicker.dpDiv);
    }

    var otherArgs = Array.prototype.slice.call(arguments, 1);
    if (typeof options === 'string' && (options === 'isDisabled' || options === 'getDate' || options === 'widget')) {
      return $.datepicker['_' + options + 'Datepicker'].apply($.datepicker, [this[0]].concat(otherArgs));
    }
    if (options === 'option' && arguments.length === 2 && typeof arguments[1] === 'string') {
      return $.datepicker['_' + options + 'Datepicker'].apply($.datepicker, [this[0]].concat(otherArgs));
    }
    return this.each(function() {
      typeof options === 'string'
        ? $.datepicker['_' + options + 'Datepicker'].apply($.datepicker, [this].concat(otherArgs))
        : $.datepicker._attachDatepicker(this, options);
    });
  };

  $.datepicker = new Datepicker(); // singleton instance
  $.datepicker.initialized = false;
  $.datepicker.uuid = new Date().getTime();
  $.datepicker.version = '1.10.3';
})(jQuery);

(function(e, t) {
  'use strict';
  function n(e) {
    var t = Array.prototype.slice.call(arguments, 1);
    return e.prop ? e.prop.apply(e, t) : e.attr.apply(e, t);
  }
  function s(e, t, n) {
    var s, a;
    for (s in n) n.hasOwnProperty(s) && ((a = s.replace(/ |$/g, t.eventNamespace)), e.bind(a, n[s]));
  }
  function a(e, t, n) {
    s(e, n, {
      focus: function() {
        t.addClass(n.focusClass);
      },
      blur: function() {
        t.removeClass(n.focusClass), t.removeClass(n.activeClass);
      },
      mouseenter: function() {
        t.addClass(n.hoverClass);
      },
      mouseleave: function() {
        t.removeClass(n.hoverClass), t.removeClass(n.activeClass);
      },
      'mousedown touchbegin': function() {
        e.is(':disabled') || t.addClass(n.activeClass);
      },
      'mouseup touchend': function() {
        t.removeClass(n.activeClass);
      },
    });
  }
  function i(e, t) {
    e.removeClass(t.hoverClass + ' ' + t.focusClass + ' ' + t.activeClass);
  }
  function r(e, t, n) {
    n ? e.addClass(t) : e.removeClass(t);
  }
  function l(e, t, n) {
    var s = 'checked',
      a = t.is(':' + s);
    t.prop ? t.prop(s, a) : a ? t.attr(s, s) : t.removeAttr(s), r(e, n.checkedClass, a);
  }
  function u(e, t, n) {
    r(e, n.disabledClass, t.is(':disabled'));
  }
  function o(e, t, n) {
    switch (n) {
      case 'after':
        return e.after(t), e.next();
      case 'before':
        return e.before(t), e.prev();
      case 'wrap':
        return e.wrap(t), e.parent();
    }
    return null;
  }
  function c(t, s, a) {
    var i, r, l;
    return (
      a || (a = {}),
      (a = e.extend(
        { bind: {}, divClass: null, divWrap: 'wrap', spanClass: null, spanHtml: null, spanWrap: 'wrap' },
        a
      )),
      (i = e('<div />')),
      (r = e('<span />')),
      s.autoHide && t.is(':hidden') && 'none' === t.css('display') && i.hide(),
      a.divClass && i.addClass(a.divClass),
      s.wrapperClass && i.addClass(s.wrapperClass),
      a.spanClass && r.addClass(a.spanClass),
      (l = n(t, 'id')),
      s.useID && l && n(i, 'id', s.idPrefix + '-' + l),
      a.spanHtml && r.html(a.spanHtml),
      (i = o(t, i, a.divWrap)),
      (r = o(t, r, a.spanWrap)),
      u(i, t, s),
      { div: i, span: r }
    );
  }
  function d(t, n) {
    var s;
    return n.wrapperClass ? ((s = e('<span />').addClass(n.wrapperClass)), (s = o(t, s, 'wrap'))) : null;
  }
  function f() {
    var t, n, s, a;
    return (
      (a = 'rgb(120,2,153)'),
      (n = e('<div style="width:0;height:0;color:' + a + '">')),
      e('body').append(n),
      (s = n.get(0)),
      (t = window.getComputedStyle ? window.getComputedStyle(s, '').color : (s.currentStyle || s.style || {}).color),
      n.remove(),
      t.replace(/ /g, '') !== a
    );
  }
  function p(t) {
    return t
      ? e('<span />')
          .text(t)
          .html()
      : '';
  }
  function m() {
    return navigator.cpuClass && !navigator.product;
  }
  function v() {
    return window.XMLHttpRequest !== void 0 ? !0 : !1;
  }
  function h(e) {
    var t;
    return e[0].multiple ? !0 : ((t = n(e, 'size')), !t || 1 >= t ? !1 : !0);
  }
  function C() {
    return !1;
  }
  function w(e, t) {
    var n = 'none';
    s(e, t, { 'selectstart dragstart mousedown': C }),
      e.css({ MozUserSelect: n, msUserSelect: n, webkitUserSelect: n, userSelect: n });
  }
  function b(e, t, n) {
    var s = e.val();
    '' === s ? (s = n.fileDefaultHtml) : ((s = s.split(/[\/\\]+/)), (s = s[s.length - 1])), t.text(s);
  }
  function y(e, t, n) {
    var s, a;
    for (
      s = [],
        e.each(function() {
          var e;
          for (e in t)
            Object.prototype.hasOwnProperty.call(t, e) &&
              (s.push({ el: this, name: e, old: this.style[e] }), (this.style[e] = t[e]));
        }),
        n();
      s.length;

    )
      (a = s.pop()), (a.el.style[a.name] = a.old);
  }
  function g(e, t) {
    var n;
    (n = e.parents()),
      n.push(e[0]),
      (n = n.not(':visible')),
      y(n, { visibility: 'hidden', display: 'block', position: 'absolute' }, t);
  }
  function k(e, t) {
    return function() {
      e.unwrap()
        .unwrap()
        .unbind(t.eventNamespace);
    };
  }
  var H = !0,
    x = !1,
    A = [
      {
        match: function(e) {
          return e.is("a, button, :submit, :reset, input[type='button']");
        },
        apply: function(e, t) {
          var r, l, o, d, f;
          return (
            (l = t.submitDefaultHtml),
            e.is(':reset') && (l = t.resetDefaultHtml),
            (d = e.is('a, button')
              ? function() {
                  return e.html() || l;
                }
              : function() {
                  return p(n(e, 'value')) || l;
                }),
            (o = c(e, t, { divClass: t.buttonClass, spanHtml: d() })),
            (r = o.div),
            a(e, r, t),
            (f = !1),
            s(r, t, {
              'click touchend': function() {
                var t, s, a, i;
                f ||
                  e.is(':disabled') ||
                  ((f = !0),
                  e[0].dispatchEvent
                    ? ((t = document.createEvent('MouseEvents')),
                      t.initEvent('click', !0, !0),
                      (s = e[0].dispatchEvent(t)),
                      e.is('a') &&
                        s &&
                        ((a = n(e, 'target')),
                        (i = n(e, 'href')),
                        a && '_self' !== a ? window.open(i, a) : (document.location.href = i)))
                    : e.click(),
                  (f = !1));
              },
            }),
            w(r, t),
            {
              remove: function() {
                return r.after(e), r.remove(), e.unbind(t.eventNamespace), e;
              },
              update: function() {
                i(r, t), u(r, e, t), e.detach(), o.span.html(d()).append(e);
              },
            }
          );
        },
      },
      {
        match: function(e) {
          return e.is(':checkbox');
        },
        apply: function(e, t) {
          var n, r, o;
          return (
            (n = c(e, t, { divClass: t.checkboxClass })),
            (r = n.div),
            (o = n.span),
            a(e, r, t),
            s(e, t, {
              'click touchend': function() {
                l(o, e, t);
              },
            }),
            l(o, e, t),
            {
              remove: k(e, t),
              update: function() {
                i(r, t), o.removeClass(t.checkedClass), l(o, e, t), u(r, e, t);
              },
            }
          );
        },
      },
      {
        match: function(e) {
          return e.is(':file');
        },
        apply: function(t, r) {
          function l() {
            b(t, p, r);
          }
          var d, f, p, v;
          return (
            (d = c(t, r, {
              divClass: r.fileClass,
              spanClass: r.fileButtonClass,
              spanHtml: r.fileButtonHtml,
              spanWrap: 'after',
            })),
            (f = d.div),
            (v = d.span),
            (p = e('<span />').html(r.fileDefaultHtml)),
            p.addClass(r.filenameClass),
            (p = o(t, p, 'after')),
            n(t, 'size') || n(t, 'size', f.width() / 10),
            a(t, f, r),
            l(),
            m()
              ? s(t, r, {
                  click: function() {
                    t.trigger('change'), setTimeout(l, 0);
                  },
                })
              : s(t, r, { change: l }),
            w(p, r),
            w(v, r),
            {
              remove: function() {
                return p.remove(), v.remove(), t.unwrap().unbind(r.eventNamespace);
              },
              update: function() {
                i(f, r), b(t, p, r), u(f, t, r);
              },
            }
          );
        },
      },
      {
        match: function(e) {
          if (e.is('input')) {
            var t = (' ' + n(e, 'type') + ' ').toLowerCase(),
              s = ' color date datetime datetime-local email month number password search tel text time url week ';
            return s.indexOf(t) >= 0;
          }
          return !1;
        },
        apply: function(e, t) {
          var s, i;
          return (
            (s = n(e, 'type')),
            e.addClass(t.inputClass),
            (i = d(e, t)),
            a(e, e, t),
            t.inputAddTypeAsClass && e.addClass(s),
            {
              remove: function() {
                e.removeClass(t.inputClass), t.inputAddTypeAsClass && e.removeClass(s), i && e.unwrap();
              },
              update: C,
            }
          );
        },
      },
      {
        match: function(e) {
          return e.is(':radio');
        },
        apply: function(t, r) {
          var o, d, f;
          return (
            (o = c(t, r, { divClass: r.radioClass })),
            (d = o.div),
            (f = o.span),
            a(t, d, r),
            s(t, r, {
              'click touchend': function() {
                e.uniform.update(e(':radio[name="' + n(t, 'name') + '"]'));
              },
            }),
            l(f, t, r),
            {
              remove: k(t, r),
              update: function() {
                i(d, r), l(f, t, r), u(d, t, r);
              },
            }
          );
        },
      },
      {
        match: function(e) {
          return e.is('select') && !h(e) ? !0 : !1;
        },
        apply: function(t, n) {
          var r, l, o, d;
          return (
            n.selectAutoWidth &&
              g(t, function() {
                d = t.width();
              }),
            (r = c(t, n, {
              divClass: n.selectClass,
              spanHtml: (t.find(':selected:first') || t.find('option:first')).html(),
              spanWrap: 'before',
            })),
            (l = r.div),
            (o = r.span),
            n.selectAutoWidth
              ? g(t, function() {
                  y(e([o[0], l[0]]), { display: 'block' }, function() {
                    var e;
                    (e = o.outerWidth() - o.width()), l.width(d + e), o.width(d);
                  });
                })
              : l.addClass('fixedWidth'),
            a(t, l, n),
            s(t, n, {
              change: function() {
                o.html(t.find(':selected').html()), l.removeClass(n.activeClass);
              },
              'click touchend': function() {
                var e = t.find(':selected').html();
                o.html() !== e && t.trigger('change');
              },
              keyup: function() {
                o.html(t.find(':selected').html());
              },
            }),
            w(o, n),
            {
              remove: function() {
                return o.remove(), t.unwrap().unbind(n.eventNamespace), t;
              },
              update: function() {
                n.selectAutoWidth
                  ? (e.uniform.restore(t), t.uniform(n))
                  : (i(l, n), o.html(t.find(':selected').html()), u(l, t, n));
              },
            }
          );
        },
      },
      {
        match: function(e) {
          return e.is('select') && h(e) ? !0 : !1;
        },
        apply: function(e, t) {
          var n;
          return (
            e.addClass(t.selectMultiClass),
            (n = d(e, t)),
            a(e, e, t),
            {
              remove: function() {
                e.removeClass(t.selectMultiClass), n && e.unwrap();
              },
              update: C,
            }
          );
        },
      },
      {
        match: function(e) {
          return e.is('textarea');
        },
        apply: function(e, t) {
          var n;
          return (
            e.addClass(t.textareaClass),
            (n = d(e, t)),
            a(e, e, t),
            {
              remove: function() {
                e.removeClass(t.textareaClass), n && e.unwrap();
              },
              update: C,
            }
          );
        },
      },
    ];
  m() && !v() && (H = !1),
    (e.uniform = {
      defaults: {
        activeClass: 'active',
        autoHide: !0,
        buttonClass: 'button',
        checkboxClass: 'checker',
        checkedClass: 'checked',
        disabledClass: 'disabled',
        eventNamespace: '.uniform',
        fileButtonClass: 'action',
        fileButtonHtml: 'Choose File',
        fileClass: 'uploader',
        fileDefaultHtml: 'No file selected',
        filenameClass: 'filename',
        focusClass: 'focus',
        hoverClass: 'hover',
        idPrefix: 'uniform',
        inputAddTypeAsClass: !0,
        inputClass: 'uniform-input',
        radioClass: 'radio',
        resetDefaultHtml: 'Reset',
        resetSelector: !1,
        selectAutoWidth: !0,
        selectClass: 'selector',
        selectMultiClass: 'uniform-multiselect',
        submitDefaultHtml: 'Submit',
        textareaClass: 'uniform',
        useID: !0,
        wrapperClass: null,
      },
      elements: [],
    }),
    (e.fn.uniform = function(t) {
      var n = this;
      return (
        (t = e.extend({}, e.uniform.defaults, t)),
        x || ((x = !0), f() && (H = !1)),
        H
          ? (t.resetSelector &&
              e(t.resetSelector).mouseup(function() {
                window.setTimeout(function() {
                  e.uniform.update(n);
                }, 10);
              }),
            this.each(function() {
              var n,
                s,
                a,
                i = e(this);
              if (i.data('uniformed')) return e.uniform.update(i), void 0;
              for (n = 0; A.length > n; n += 1)
                if (((s = A[n]), s.match(i, t)))
                  return (a = s.apply(i, t)), i.data('uniformed', a), e.uniform.elements.push(i.get(0)), void 0;
            }))
          : this
      );
    }),
    (e.uniform.restore = e.fn.uniform.restore = function(n) {
      n === t && (n = e.uniform.elements),
        e(n).each(function() {
          var t,
            n,
            s = e(this);
          (n = s.data('uniformed')),
            n &&
              (n.remove(),
              (t = e.inArray(this, e.uniform.elements)),
              t >= 0 && e.uniform.elements.splice(t, 1),
              s.removeData('uniformed'));
        });
    }),
    (e.uniform.update = e.fn.uniform.update = function(n) {
      n === t && (n = e.uniform.elements),
        e(n).each(function() {
          var t,
            n = e(this);
          (t = n.data('uniformed')), t && t.update(n, t.options);
        });
    });
})(jQuery);

!(function(a) {
  'use strict';
  (a.Zebra_DatePicker = function(b, c) {
    var d,
      e,
      f,
      g,
      h,
      i,
      j,
      k,
      l,
      m,
      n,
      o,
      p,
      q,
      r,
      s,
      t,
      u,
      v,
      w,
      x,
      y,
      z,
      A,
      B,
      C,
      D,
      E,
      F,
      G,
      H,
      I,
      J,
      K,
      L,
      M,
      N = {
        always_visible: !1,
        days: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
        days_abbr: !1,
        direction: 0,
        disabled_dates: !1,
        enabled_dates: !1,
        first_day_of_week: 1,
        format: 'Y-m-d',
        header_captions: { days: 'F, Y', months: 'Y', years: 'Y1 - Y2' },
        header_navigation: ['&#171;', '&#187;'],
        inside: !0,
        lang_clear_date: 'Clear date',
        months: [
          'January',
          'February',
          'March',
          'April',
          'May',
          'June',
          'July',
          'August',
          'September',
          'October',
          'November',
          'December',
        ],
        months_abbr: !1,
        offset: [5, -5],
        pair: !1,
        readonly_element: !0,
        select_other_months: !1,
        show_clear_date: 0,
        show_icon: !0,
        show_other_months: !0,
        show_select_today: 'Today',
        show_week_number: !1,
        start_date: !1,
        strict: !1,
        view: 'days',
        weekend_days: [0, 6],
        zero_pad: !1,
        onChange: null,
        onClear: null,
        onOpen: null,
        onSelect: null,
      },
      O = this;
    O.settings = {};
    var P = a(b),
      Q = function(b) {
        if (!b) {
          O.settings = a.extend({}, N, c);
          for (var y in P.data())
            0 === y.indexOf('zdp_') &&
              ((y = y.replace(/^zdp\_/, '')),
              void 0 !== N[y] && (O.settings[y] = 'pair' == y ? a(P.data('zdp_' + y)) : P.data('zdp_' + y)));
        }
        O.settings.readonly_element && P.attr('readonly', 'readonly');
        var E = { days: ['d', 'j', 'D'], months: ['F', 'm', 'M', 'n', 't'], years: ['o', 'Y', 'y'] },
          F = !1,
          G = !1,
          Q = !1,
          T = null;
        for (T in E)
          a.each(E[T], function(a, b) {
            O.settings.format.indexOf(b) > -1 &&
              ('days' == T ? (F = !0) : 'months' == T ? (G = !0) : 'years' == T && (Q = !0));
          });
        (H =
          F && G && Q
            ? ['years', 'months', 'days']
            : !F && G && Q
            ? ['years', 'months']
            : F && G && !Q
            ? ['months', 'days']
            : F || G || !Q
            ? F || !G || Q
              ? ['years', 'months', 'days']
              : ['months']
            : ['years']),
          -1 == a.inArray(O.settings.view, H) && (O.settings.view = H[H.length - 1]),
          (x = []),
          (w = []);
        for (var U, V = 0; 2 > V; V++)
          (U = 0 === V ? O.settings.disabled_dates : O.settings.enabled_dates),
            a.isArray(U) &&
              U.length > 0 &&
              a.each(U, function() {
                for (var b = this.split(' '), c = 0; 4 > c; c++) {
                  b[c] || (b[c] = '*'), (b[c] = b[c].indexOf(',') > -1 ? b[c].split(',') : new Array(b[c]));
                  for (var d = 0; d < b[c].length; d++)
                    if (b[c][d].indexOf('-') > -1) {
                      var e = b[c][d].match(/^([0-9]+)\-([0-9]+)/);
                      if (null !== e) {
                        for (var f = eb(e[1]); f <= eb(e[2]); f++) -1 == a.inArray(f, b[c]) && b[c].push(f + '');
                        b[c].splice(d, 1);
                      }
                    }
                  for (d = 0; d < b[c].length; d++) b[c][d] = isNaN(eb(b[c][d])) ? b[c][d] : eb(b[c][d]);
                }
                0 === V ? x.push(b) : w.push(b);
              });
        var W,
          X,
          Y = new Date(),
          _ = O.settings.reference_date
            ? O.settings.reference_date
            : P.data('zdp_reference_date') && void 0 !== P.data('zdp_reference_date')
            ? P.data('zdp_reference_date')
            : Y;
        if (
          ((z = void 0),
          (A = void 0),
          (o = _.getMonth()),
          (l = Y.getMonth()),
          (p = _.getFullYear()),
          (m = Y.getFullYear()),
          (q = _.getDate()),
          (n = Y.getDate()),
          O.settings.direction === !0)
        )
          z = _;
        else if (O.settings.direction === !1) (A = _), (D = A.getMonth()), (C = A.getFullYear()), (B = A.getDate());
        else if (
          (!a.isArray(O.settings.direction) && $(O.settings.direction) && eb(O.settings.direction) > 0) ||
          (a.isArray(O.settings.direction) &&
            ((W = R(O.settings.direction[0])) ||
              O.settings.direction[0] === !0 ||
              ($(O.settings.direction[0]) && O.settings.direction[0] > 0)) &&
            ((X = R(O.settings.direction[1])) ||
              O.settings.direction[1] === !1 ||
              ($(O.settings.direction[1]) && O.settings.direction[1] >= 0)))
        )
          (z = W
            ? W
            : new Date(
                p,
                o,
                q +
                  (a.isArray(O.settings.direction)
                    ? eb(O.settings.direction[0] === !0 ? 0 : O.settings.direction[0])
                    : eb(O.settings.direction))
              )),
            (o = z.getMonth()),
            (p = z.getFullYear()),
            (q = z.getDate()),
            X && +X >= +z
              ? (A = X)
              : !X &&
                O.settings.direction[1] !== !1 &&
                a.isArray(O.settings.direction) &&
                (A = new Date(p, o, q + eb(O.settings.direction[1]))),
            A && ((D = A.getMonth()), (C = A.getFullYear()), (B = A.getDate()));
        else if (
          (!a.isArray(O.settings.direction) && $(O.settings.direction) && eb(O.settings.direction) < 0) ||
          (a.isArray(O.settings.direction) &&
            (O.settings.direction[0] === !1 || ($(O.settings.direction[0]) && O.settings.direction[0] < 0)) &&
            ((W = R(O.settings.direction[1])) || ($(O.settings.direction[1]) && O.settings.direction[1] >= 0)))
        )
          (A = new Date(
            p,
            o,
            q +
              (a.isArray(O.settings.direction)
                ? eb(O.settings.direction[0] === !1 ? 0 : O.settings.direction[0])
                : eb(O.settings.direction))
          )),
            (D = A.getMonth()),
            (C = A.getFullYear()),
            (B = A.getDate()),
            W && +A > +W
              ? (z = W)
              : !W && a.isArray(O.settings.direction) && (z = new Date(C, D, B - eb(O.settings.direction[1]))),
            z && ((o = z.getMonth()), (p = z.getFullYear()), (q = z.getDate()));
        else if (a.isArray(O.settings.disabled_dates) && O.settings.disabled_dates.length > 0)
          for (var cb in x)
            if ('*' == x[cb][0] && '*' == x[cb][1] && '*' == x[cb][2] && '*' == x[cb][3]) {
              var gb = [];
              if (
                (a.each(w, function() {
                  var a = this;
                  '*' != a[2][0] &&
                    gb.push(
                      parseInt(
                        a[2][0] +
                          ('*' == a[1][0] ? '12' : db(a[1][0], 2)) +
                          ('*' == a[0][0]
                            ? '*' == a[1][0]
                              ? '31'
                              : new Date(a[2][0], a[1][0], 0).getDate()
                            : db(a[0][0], 2)),
                        10
                      )
                    );
                }),
                gb.sort(),
                gb.length > 0)
              ) {
                var ib = (gb[0] + '').match(/([0-9]{4})([0-9]{2})([0-9]{2})/);
                (p = parseInt(ib[1], 10)), (o = parseInt(ib[2], 10) - 1), (q = parseInt(ib[3], 10));
              }
              break;
            }
        if (Z(p, o, q)) {
          for (; Z(p); ) z ? (p++, (o = 0)) : (p--, (o = 11));
          for (; Z(p, o); )
            z ? (o++, (q = 1)) : (o--, (q = new Date(p, o + 1, 0).getDate())),
              o > 11 ? (p++, (o = 0), (q = 1)) : 0 > o && (p--, (o = 11), (q = new Date(p, o + 1, 0).getDate()));
          for (; Z(p, o, q); )
            z ? q++ : q--, (Y = new Date(p, o, q)), (p = Y.getFullYear()), (o = Y.getMonth()), (q = Y.getDate());
          (Y = new Date(p, o, q)), (p = Y.getFullYear()), (o = Y.getMonth()), (q = Y.getDate());
        }
        var jb = R(P.val() || (O.settings.start_date ? O.settings.start_date : ''));
        if (
          (jb && O.settings.strict && Z(jb.getFullYear(), jb.getMonth(), jb.getDate()) && P.val(''),
          b || fb(z),
          !O.settings.always_visible)
        ) {
          if (!b) {
            if (O.settings.show_icon) {
              'firefox' == hb.name &&
                P.is('input[type="text"]') &&
                'inline' == P.css('display') &&
                P.css('display', 'inline-block');
              var kb = a('<span class="Zebra_DatePicker_Icon_Wrapper"></span>').css({
                display: P.css('display'),
                position: 'static' == P.css('position') ? 'relative' : P.css('position'),
                float: P.css('float'),
                top: P.css('top'),
                right: P.css('right'),
                bottom: P.css('bottom'),
                left: P.css('left'),
              });
              P.wrap(kb).css({ position: 'relative', top: 'auto', right: 'auto', bottom: 'auto', left: 'auto' }),
                (f = a(
                  '<button type="button" class="Zebra_DatePicker_Icon' +
                    ('disabled' == P.attr('disabled') ? ' Zebra_DatePicker_Icon_Disabled' : '') +
                    '">Pick a date</button>'
                )),
                (O.icon = f),
                (I = f.add(P));
            } else I = P;
            I.bind('click', function(a) {
              a.preventDefault(), P.attr('disabled') || ('none' != e.css('display') ? O.hide() : O.show());
            }),
              void 0 !== f && f.insertAfter(P);
          }
          if (void 0 !== f) {
            f.attr('style', ''), O.settings.inside && f.addClass('Zebra_DatePicker_Icon_Inside');
            var lb = P.outerWidth(),
              mb = P.outerHeight(),
              nb = parseInt(P.css('marginLeft'), 10) || 0,
              ob = parseInt(P.css('marginTop'), 10) || 0,
              pb = f.outerWidth(),
              qb = f.outerHeight(),
              rb = parseInt(f.css('marginLeft'), 10) || 0,
              sb = parseInt(f.css('marginRight'), 10) || 0;
            O.settings.inside
              ? f.css({ top: ob + (mb - qb) / 2, left: nb + (lb - pb - sb) })
              : f.css({ top: ob + (mb - qb) / 2, left: nb + lb + rb });
          }
        }
        if (
          ((L =
            O.settings.show_select_today !== !1 && a.inArray('days', H) > -1 && !Z(m, l, n)
              ? O.settings.show_select_today
              : !1),
          !b)
        ) {
          a(window).bind('resize.Zebra_DatePicker', function() {
            O.hide(),
              void 0 !== f &&
                (clearTimeout(M),
                (M = setTimeout(function() {
                  O.update();
                }, 100)));
          });
          var tb =
            '<div class="Zebra_DatePicker"><table class="dp_header"><tr><td class="dp_previous">' +
            O.settings.header_navigation[0] +
            '</td><td class="dp_caption">&#032;</td><td class="dp_next">' +
            O.settings.header_navigation[1] +
            '</td></tr></table><table class="dp_daypicker"></table><table class="dp_monthpicker"></table><table class="dp_yearpicker"></table><table class="dp_footer"><tr><td class="dp_today"' +
            (O.settings.show_clear_date !== !1 ? ' style="width:50%"' : '') +
            '>' +
            L +
            '</td><td class="dp_clear"' +
            (L !== !1 ? ' style="width:50%"' : '') +
            '>' +
            O.settings.lang_clear_date +
            '</td></tr></table></div>';
          (e = a(tb)),
            (O.datepicker = e),
            (g = a('table.dp_header', e)),
            (h = a('table.dp_daypicker', e)),
            (i = a('table.dp_monthpicker', e)),
            (j = a('table.dp_yearpicker', e)),
            (K = a('table.dp_footer', e)),
            (J = a('td.dp_today', K)),
            (k = a('td.dp_clear', K)),
            O.settings.always_visible
              ? P.attr('disabled') || (O.settings.always_visible.append(e), O.show())
              : a('body').append(e),
            e
              .delegate(
                'td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_week_number)',
                'mouseover',
                function() {
                  a(this).addClass('dp_hover');
                }
              )
              .delegate(
                'td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_week_number)',
                'mouseout',
                function() {
                  a(this).removeClass('dp_hover');
                }
              ),
            S(a('td', g)),
            a('.dp_previous', g).bind('click', function() {
              'months' == d ? s-- : 'years' == d ? (s -= 12) : --r < 0 && ((r = 11), s--), ab();
            }),
            a('.dp_caption', g).bind('click', function() {
              (d =
                'days' == d
                  ? a.inArray('months', H) > -1
                    ? 'months'
                    : a.inArray('years', H) > -1
                    ? 'years'
                    : 'days'
                  : 'months' == d
                  ? a.inArray('years', H) > -1
                    ? 'years'
                    : a.inArray('days', H) > -1
                    ? 'days'
                    : 'months'
                  : a.inArray('days', H) > -1
                  ? 'days'
                  : a.inArray('months', H) > -1
                  ? 'months'
                  : 'years'),
                ab();
            }),
            a('.dp_next', g).bind('click', function() {
              'months' == d ? s++ : 'years' == d ? (s += 12) : 12 == ++r && ((r = 0), s++), ab();
            }),
            h.delegate(
              'td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_week_number)',
              'click',
              function() {
                O.settings.select_other_months &&
                null !==
                  (ib = a(this)
                    .attr('class')
                    .match(/date\_([0-9]{4})(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])/))
                  ? bb(ib[1], ib[2] - 1, ib[3], 'days', a(this))
                  : bb(s, r, eb(a(this).html()), 'days', a(this));
              }
            ),
            i.delegate('td:not(.dp_disabled)', 'click', function() {
              var b = a(this)
                .attr('class')
                .match(/dp\_month\_([0-9]+)/);
              (r = eb(b[1])),
                -1 == a.inArray('days', H)
                  ? bb(s, r, 1, 'months', a(this))
                  : ((d = 'days'), O.settings.always_visible && P.val(''), ab());
            }),
            j.delegate('td:not(.dp_disabled)', 'click', function() {
              (s = eb(a(this).html())),
                -1 == a.inArray('months', H)
                  ? bb(s, 1, 1, 'years', a(this))
                  : ((d = 'months'), O.settings.always_visible && P.val(''), ab());
            }),
            a(J).bind('click', function(b) {
              b.preventDefault(),
                bb(m, l, n, 'days', a('.dp_current', h)),
                O.settings.always_visible && O.show(),
                O.hide();
            }),
            a(k).bind('click', function(b) {
              b.preventDefault(),
                P.val(''),
                O.settings.always_visible
                  ? ((t = null), (u = null), (v = null), a('td.dp_selected', e).removeClass('dp_selected'))
                  : ((t = null), (u = null), (v = null), (r = null), (s = null)),
                O.hide(),
                O.settings.onClear && 'function' == typeof O.settings.onClear && O.settings.onClear.call(P, P);
            }),
            O.settings.always_visible ||
              a(document).bind({
                'mousedown.Zebra_DatePicker': function(b) {
                  if ('block' == e.css('display')) {
                    if (O.settings.show_icon && a(b.target).get(0) === f.get(0)) return !0;
                    0 ===
                      a(b.target)
                        .parents()
                        .filter('.Zebra_DatePicker').length && O.hide();
                  }
                },
                'keyup.Zebra_DatePicker': function(a) {
                  'block' == e.css('display') && 27 == a.which && O.hide();
                },
              }),
            ab();
        }
      };
    (O.destroy = function() {
      void 0 !== O.icon && O.icon.remove(),
        O.datepicker.remove(),
        a(document).unbind('keyup.Zebra_DatePicker'),
        a(document).unbind('mousedown.Zebra_DatePicker'),
        a(window).unbind('resize.Zebra_DatePicker'),
        P.removeData('Zebra_DatePicker');
    }),
      (O.hide = function() {
        O.settings.always_visible || (Y('hide'), e.hide());
      }),
      (O.show = function() {
        d = O.settings.view;
        var b = R(P.val() || (O.settings.start_date ? O.settings.start_date : ''));
        if (
          (b
            ? ((u = b.getMonth()),
              (r = b.getMonth()),
              (v = b.getFullYear()),
              (s = b.getFullYear()),
              (t = b.getDate()),
              Z(v, u, t) && (O.settings.strict && P.val(''), (r = o), (s = p)))
            : ((r = o), (s = p)),
          ab(),
          O.settings.always_visible)
        )
          e.show();
        else {
          var c = e.outerWidth(),
            g = e.outerHeight(),
            h =
              (void 0 !== f ? f.offset().left + f.outerWidth(!0) : P.offset().left + P.outerWidth(!0)) +
              O.settings.offset[0],
            i = (void 0 !== f ? f.offset().top : P.offset().top) - g + O.settings.offset[1],
            j = a(window).width(),
            k = a(window).height(),
            l = a(window).scrollTop(),
            m = a(window).scrollLeft();
          h + c > m + j && (h = m + j - c),
            m > h && (h = m),
            i + g > l + k && (i = l + k - g),
            l > i && (i = l),
            e.css({ left: h, top: i }),
            e.fadeIn('explorer' == hb.name && hb.version < 9 ? 0 : 150, 'linear'),
            Y();
        }
        O.settings.onOpen && 'function' == typeof O.settings.onOpen && O.settings.onOpen.call(P, P);
      }),
      (O.update = function(b) {
        O.original_direction && (O.original_direction = O.direction), (O.settings = a.extend(O.settings, b)), Q(!0);
      });
    var R = function(b) {
        if (((b += ''), '' !== a.trim(b))) {
          for (
            var c = T(O.settings.format),
              d = ['d', 'D', 'j', 'l', 'N', 'S', 'w', 'F', 'm', 'M', 'n', 'Y', 'y'],
              e = [],
              f = [],
              g = null,
              h = null,
              i = 0;
            i < d.length;
            i++
          )
            (g = c.indexOf(d[i])) > -1 && e.push({ character: d[i], position: g });
          if (
            (e.sort(function(a, b) {
              return a.position - b.position;
            }),
            a.each(e, function(a, b) {
              switch (b.character) {
                case 'd':
                  f.push('0[1-9]|[12][0-9]|3[01]');
                  break;
                case 'D':
                  f.push('[a-z]{3}');
                  break;
                case 'j':
                  f.push('[1-9]|[12][0-9]|3[01]');
                  break;
                case 'l':
                  f.push('[a-z]+');
                  break;
                case 'N':
                  f.push('[1-7]');
                  break;
                case 'S':
                  f.push('st|nd|rd|th');
                  break;
                case 'w':
                  f.push('[0-6]');
                  break;
                case 'F':
                  f.push('[a-z]+');
                  break;
                case 'm':
                  f.push('0[1-9]|1[012]+');
                  break;
                case 'M':
                  f.push('[a-z]{3}');
                  break;
                case 'n':
                  f.push('[1-9]|1[012]');
                  break;
                case 'Y':
                  f.push('[0-9]{4}');
                  break;
                case 'y':
                  f.push('[0-9]{2}');
              }
            }),
            f.length &&
              (e.reverse(),
              a.each(e, function(a, b) {
                c = c.replace(b.character, '(' + f[f.length - a - 1] + ')');
              }),
              (f = new RegExp('^' + c + '$', 'ig')),
              (h = f.exec(b))))
          ) {
            var j,
              k = new Date(),
              l = k.getDate(),
              m = k.getMonth() + 1,
              n = k.getFullYear(),
              o = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
              p = [
                'January',
                'February',
                'March',
                'April',
                'May',
                'June',
                'July',
                'August',
                'September',
                'October',
                'November',
                'December',
              ],
              q = !0;
            if (
              (e.reverse(),
              a.each(e, function(b, c) {
                if (!q) return !0;
                switch (c.character) {
                  case 'm':
                  case 'n':
                    m = eb(h[b + 1]);
                    break;
                  case 'd':
                  case 'j':
                    l = eb(h[b + 1]);
                    break;
                  case 'D':
                  case 'l':
                  case 'F':
                  case 'M':
                    (j = 'D' == c.character || 'l' == c.character ? O.settings.days : O.settings.months),
                      (q = !1),
                      a.each(j, function(a, d) {
                        if (q) return !0;
                        if (
                          h[b + 1].toLowerCase() ==
                          d.substring(0, 'D' == c.character || 'M' == c.character ? 3 : d.length).toLowerCase()
                        ) {
                          switch (c.character) {
                            case 'D':
                              h[b + 1] = o[a].substring(0, 3);
                              break;
                            case 'l':
                              h[b + 1] = o[a];
                              break;
                            case 'F':
                              (h[b + 1] = p[a]), (m = a + 1);
                              break;
                            case 'M':
                              (h[b + 1] = p[a].substring(0, 3)), (m = a + 1);
                          }
                          q = !0;
                        }
                      });
                    break;
                  case 'Y':
                    n = eb(h[b + 1]);
                    break;
                  case 'y':
                    n = '19' + eb(h[b + 1]);
                }
              }),
              q)
            ) {
              var r = new Date(n, (m || 1) - 1, l || 1);
              if (r.getFullYear() == n && r.getDate() == (l || 1) && r.getMonth() == (m || 1) - 1) return r;
            }
          }
          return !1;
        }
      },
      S = function(a) {
        'firefox' == hb.name
          ? a.css('MozUserSelect', 'none')
          : 'explorer' == hb.name
          ? a.bind('selectstart', function() {
              return !1;
            })
          : a.mousedown(function() {
              return !1;
            });
      },
      T = function(a) {
        return a.replace(/([-.,*+?^${}()|[\]\/\\])/g, '\\$1');
      },
      U = function(b) {
        for (
          var c = '',
            d = b.getDate(),
            e = b.getDay(),
            f = O.settings.days[e],
            g = b.getMonth() + 1,
            h = O.settings.months[g - 1],
            i = b.getFullYear() + '',
            j = 0;
          j < O.settings.format.length;
          j++
        ) {
          var k = O.settings.format.charAt(j);
          switch (k) {
            case 'y':
              i = i.substr(2);
            case 'Y':
              c += i;
              break;
            case 'm':
              g = db(g, 2);
            case 'n':
              c += g;
              break;
            case 'M':
              h =
                a.isArray(O.settings.months_abbr) && void 0 !== O.settings.months_abbr[g - 1]
                  ? O.settings.months_abbr[g - 1]
                  : O.settings.months[g - 1].substr(0, 3);
            case 'F':
              c += h;
              break;
            case 'd':
              d = db(d, 2);
            case 'j':
              c += d;
              break;
            case 'D':
              f =
                a.isArray(O.settings.days_abbr) && void 0 !== O.settings.days_abbr[e]
                  ? O.settings.days_abbr[e]
                  : O.settings.days[e].substr(0, 3);
            case 'l':
              c += f;
              break;
            case 'N':
              e++;
            case 'w':
              c += e;
              break;
            case 'S':
              c +=
                d % 10 == 1 && '11' != d
                  ? 'st'
                  : d % 10 == 2 && '12' != d
                  ? 'nd'
                  : d % 10 == 3 && '13' != d
                  ? 'rd'
                  : 'th';
              break;
            default:
              c += k;
          }
        }
        return c;
      },
      V = function() {
        var b = new Date(s, r + 1, 0).getDate(),
          c = new Date(s, r, 1).getDay(),
          d = new Date(s, r, 0).getDate(),
          e = c - O.settings.first_day_of_week;
        (e = 0 > e ? 7 + e : e), _(O.settings.header_captions.days);
        var f = '<tr>';
        O.settings.show_week_number && (f += '<th>' + O.settings.show_week_number + '</th>');
        for (var g = 0; 7 > g; g++)
          f +=
            '<th>' +
            (a.isArray(O.settings.days_abbr) && void 0 !== O.settings.days_abbr[(O.settings.first_day_of_week + g) % 7]
              ? O.settings.days_abbr[(O.settings.first_day_of_week + g) % 7]
              : O.settings.days[(O.settings.first_day_of_week + g) % 7].substr(0, 2)) +
            '</th>';
        for (f += '</tr><tr>', g = 0; 42 > g; g++) {
          g > 0 && g % 7 === 0 && (f += '</tr><tr>'),
            g % 7 === 0 &&
              O.settings.show_week_number &&
              (f += '<td class="dp_week_number">' + gb(new Date(s, r, g - e + 1)) + '</td>');
          var i = g - e + 1;
          if (O.settings.select_other_months && (e > g || i > b)) {
            var j = new Date(s, r, i),
              k = j.getFullYear(),
              o = j.getMonth(),
              p = j.getDate();
            j = k + db(o + 1, 2) + db(p, 2);
          }
          if (e > g)
            f +=
              '<td class="' +
              (O.settings.select_other_months && !Z(k, o, p)
                ? 'dp_not_in_month_selectable date_' + j
                : 'dp_not_in_month') +
              '">' +
              (O.settings.select_other_months || O.settings.show_other_months
                ? db(d - e + g + 1, O.settings.zero_pad ? 2 : 0)
                : '&nbsp;') +
              '</td>';
          else if (i > b)
            f +=
              '<td class="' +
              (O.settings.select_other_months && !Z(k, o, p)
                ? 'dp_not_in_month_selectable date_' + j
                : 'dp_not_in_month') +
              '">' +
              (O.settings.select_other_months || O.settings.show_other_months
                ? db(i - b, O.settings.zero_pad ? 2 : 0)
                : '&nbsp;') +
              '</td>';
          else {
            var q = (O.settings.first_day_of_week + g) % 7,
              w = '';
            Z(s, r, i)
              ? (a.inArray(q, O.settings.weekend_days) > -1 ? (w = 'dp_weekend_disabled') : (w += ' dp_disabled'),
                r == l && s == m && n == i && (w += ' dp_disabled_current'))
              : (a.inArray(q, O.settings.weekend_days) > -1 && (w = 'dp_weekend'),
                r == u && s == v && t == i && (w += ' dp_selected'),
                r == l && s == m && n == i && (w += ' dp_current')),
              (f +=
                '<td' +
                ('' !== w ? ' class="' + a.trim(w) + '"' : '') +
                '>' +
                (O.settings.zero_pad ? db(i, 2) : i) +
                '</td>');
          }
        }
        (f += '</tr>'),
          h.html(a(f)),
          O.settings.always_visible &&
            (E = a('td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month, .dp_week_number)', h)),
          h.show();
      },
      W = function() {
        _(O.settings.header_captions.months);
        for (var b = '<tr>', c = 0; 12 > c; c++) {
          c > 0 && c % 3 === 0 && (b += '</tr><tr>');
          var d = 'dp_month_' + c;
          Z(s, c)
            ? (d += ' dp_disabled')
            : u !== !1 && u == c && s == v
            ? (d += ' dp_selected')
            : l == c && m == s && (d += ' dp_current'),
            (b +=
              '<td class="' +
              a.trim(d) +
              '">' +
              (a.isArray(O.settings.months_abbr) && void 0 !== O.settings.months_abbr[c]
                ? O.settings.months_abbr[c]
                : O.settings.months[c].substr(0, 3)) +
              '</td>');
        }
        (b += '</tr>'), i.html(a(b)), O.settings.always_visible && (F = a('td:not(.dp_disabled)', i)), i.show();
      },
      X = function() {
        _(O.settings.header_captions.years);
        for (var b = '<tr>', c = 0; 12 > c; c++) {
          c > 0 && c % 3 === 0 && (b += '</tr><tr>');
          var d = '';
          Z(s - 7 + c)
            ? (d += ' dp_disabled')
            : v && v == s - 7 + c
            ? (d += ' dp_selected')
            : m == s - 7 + c && (d += ' dp_current'),
            (b += '<td' + ('' !== a.trim(d) ? ' class="' + a.trim(d) + '"' : '') + '>' + (s - 7 + c) + '</td>');
        }
        (b += '</tr>'), j.html(a(b)), O.settings.always_visible && (G = a('td:not(.dp_disabled)', j)), j.show();
      },
      Y = function(b) {
        if ('explorer' == hb.name && 6 == hb.version) {
          if (!y) {
            var c = eb(e.css('zIndex')) - 1;
            (y = a('<iframe>', {
              src: 'javascript:document.write("")',
              scrolling: 'no',
              frameborder: 0,
              css: {
                zIndex: c,
                position: 'absolute',
                top: -1e3,
                left: -1e3,
                width: e.outerWidth(),
                height: e.outerHeight(),
                filter: 'progid:DXImageTransform.Microsoft.Alpha(opacity=0)',
                display: 'none',
              },
            })),
              a('body').append(y);
          }
          switch (b) {
            case 'hide':
              y.hide();
              break;
            default:
              var d = e.offset();
              y.css({ top: d.top, left: d.left, display: 'block' });
          }
        }
      },
      Z = function(b, c, d) {
        if ((void 0 === b || isNaN(b)) && (void 0 === c || isNaN(c)) && (void 0 === d || isNaN(d))) return !1;
        if (a.isArray(O.settings.direction) || 0 !== eb(O.settings.direction)) {
          var e = eb(cb(b, 'undefined' != typeof c ? db(c, 2) : '', 'undefined' != typeof d ? db(d, 2) : '')),
            f = (e + '').length;
          if (
            8 == f &&
            (('undefined' != typeof z && e < eb(cb(p, db(o, 2), db(q, 2)))) ||
              ('undefined' != typeof A && e > eb(cb(C, db(D, 2), db(B, 2)))))
          )
            return !0;
          if (
            6 == f &&
            (('undefined' != typeof z && e < eb(cb(p, db(o, 2)))) ||
              ('undefined' != typeof A && e > eb(cb(C, db(D, 2)))))
          )
            return !0;
          if (4 == f && (('undefined' != typeof z && p > e) || ('undefined' != typeof A && e > C))) return !0;
        }
        'undefined' != typeof c && (c += 1);
        var g = !1,
          h = !1;
        return (
          x &&
            a.each(x, function() {
              if (!g) {
                var e = this;
                if (
                  (a.inArray(b, e[2]) > -1 || a.inArray('*', e[2]) > -1) &&
                  (('undefined' != typeof c && a.inArray(c, e[1]) > -1) || a.inArray('*', e[1]) > -1) &&
                  (('undefined' != typeof d && a.inArray(d, e[0]) > -1) || a.inArray('*', e[0]) > -1)
                ) {
                  if ('*' == e[3]) return (g = !0);
                  var f = new Date(b, c - 1, d).getDay();
                  if (a.inArray(f, e[3]) > -1) return (g = !0);
                }
              }
            }),
          w &&
            a.each(w, function() {
              if (!h) {
                var e = this;
                if ((a.inArray(b, e[2]) > -1 || a.inArray('*', e[2]) > -1) && ((h = !0), 'undefined' != typeof c))
                  if (((h = !0), a.inArray(c, e[1]) > -1 || a.inArray('*', e[1]) > -1)) {
                    if ('undefined' != typeof d)
                      if (((h = !0), a.inArray(d, e[0]) > -1 || a.inArray('*', e[0]) > -1)) {
                        if ('*' == e[3]) return (h = !0);
                        var f = new Date(b, c - 1, d).getDay();
                        if (a.inArray(f, e[3]) > -1) return (h = !0);
                        h = !1;
                      } else h = !1;
                  } else h = !1;
              }
            }),
          w && h ? !1 : x && g ? !0 : !1
        );
      },
      $ = function(a) {
        return (a + '').match(/^\-?[0-9]+$/) ? !0 : !1;
      },
      _ = function(b) {
        !isNaN(parseFloat(r)) &&
          isFinite(r) &&
          (b = b.replace(/\bm\b|\bn\b|\bF\b|\bM\b/, function(b) {
            switch (b) {
              case 'm':
                return db(r + 1, 2);
              case 'n':
                return r + 1;
              case 'F':
                return O.settings.months[r];
              case 'M':
                return a.isArray(O.settings.months_abbr) && void 0 !== O.settings.months_abbr[r]
                  ? O.settings.months_abbr[r]
                  : O.settings.months[r].substr(0, 3);
              default:
                return b;
            }
          })),
          !isNaN(parseFloat(s)) &&
            isFinite(s) &&
            (b = b
              .replace(/\bY\b/, s)
              .replace(/\by\b/, (s + '').substr(2))
              .replace(/\bY1\b/i, s - 7)
              .replace(/\bY2\b/i, s + 4)),
          a('.dp_caption', g).html(b);
      },
      ab = function() {
        if ('' === h.text() || 'days' == d) {
          if ('' === h.text()) {
            O.settings.always_visible || e.css('left', -1e3), e.show(), V();
            var b = h.outerWidth(),
              c = h.outerHeight();
            i.css({ width: b, height: c }),
              j.css({ width: b, height: c }),
              g.css('width', b),
              K.css('width', b),
              e.hide();
          } else V();
          i.hide(), j.hide();
        } else 'months' == d ? (W(), h.hide(), j.hide()) : 'years' == d && (X(), h.hide(), i.hide());
        if (O.settings.onChange && 'function' == typeof O.settings.onChange && void 0 !== d) {
          var f =
            'days' == d
              ? h.find('td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month)')
              : 'months' == d
              ? i.find('td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month)')
              : j.find('td:not(.dp_disabled, .dp_weekend_disabled, .dp_not_in_month)');
          f.each(function() {
            if ('days' == d)
              if (a(this).hasClass('dp_not_in_month_selectable')) {
                var b = a(this)
                  .attr('class')
                  .match(/date\_([0-9]{4})(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])/);
                a(this).data('date', b[1] + '-' + b[2] + '-' + b[3]);
              } else a(this).data('date', s + '-' + db(r + 1, 2) + '-' + db(eb(a(this).text()), 2));
            else if ('months' == d) {
              var b = a(this)
                .attr('class')
                .match(/dp\_month\_([0-9]+)/);
              a(this).data('date', s + '-' + db(eb(b[1]) + 1, 2));
            } else a(this).data('date', eb(a(this).text()));
          }),
            O.settings.onChange.call(P, d, f, P);
        }
        K.show(),
          O.settings.show_clear_date === !0 ||
          (0 === O.settings.show_clear_date && '' !== P.val()) ||
          (O.settings.always_visible && O.settings.show_clear_date !== !1)
            ? (k.show(), L ? (J.css('width', '50%'), k.css('width', '50%')) : (J.hide(), k.css('width', '100%')))
            : (k.hide(), L ? J.show().css('width', '100%') : K.hide());
      },
      bb = function(a, b, c, d, e) {
        var f = new Date(a, b, c, 12, 0, 0),
          g = 'days' == d ? E : 'months' == d ? F : G,
          h = U(f);
        P.val(h),
          O.settings.always_visible &&
            ((u = f.getMonth()),
            (r = f.getMonth()),
            (v = f.getFullYear()),
            (s = f.getFullYear()),
            (t = f.getDate()),
            g.removeClass('dp_selected'),
            e.addClass('dp_selected'),
            'days' == d && e.hasClass('dp_not_in_month_selectable') && O.show()),
          O.hide(),
          fb(f),
          O.settings.onSelect &&
            'function' == typeof O.settings.onSelect &&
            O.settings.onSelect.call(P, h, a + '-' + db(b + 1, 2) + '-' + db(c, 2), f, P, gb(f)),
          P.focus();
      },
      cb = function() {
        for (var a = '', b = 0; b < arguments.length; b++) a += arguments[b] + '';
        return a;
      },
      db = function(a, b) {
        for (a += ''; a.length < b; ) a = '0' + a;
        return a;
      },
      eb = function(a) {
        return parseInt(a, 10);
      },
      fb = function(b) {
        O.settings.pair &&
          a.each(O.settings.pair, function() {
            var c = a(this);
            if (c.data && c.data('Zebra_DatePicker')) {
              var d = c.data('Zebra_DatePicker');
              d.update({ reference_date: b, direction: 0 === d.settings.direction ? 1 : d.settings.direction }),
                d.settings.always_visible && d.show();
            } else c.data('zdp_reference_date', b);
          });
      },
      gb = function(a) {
        var b,
          c,
          d,
          e,
          f,
          g,
          h,
          i,
          j,
          k = a.getFullYear(),
          l = a.getMonth() + 1,
          m = a.getDate();
        return (
          3 > l
            ? ((b = k - 1),
              (c = ((b / 4) | 0) - ((b / 100) | 0) + ((b / 400) | 0)),
              (d = (((b - 1) / 4) | 0) - (((b - 1) / 100) | 0) + (((b - 1) / 400) | 0)),
              (e = c - d),
              (f = 0),
              (g = m - 1 + 31 * (l - 1)))
            : ((b = k),
              (c = ((b / 4) | 0) - ((b / 100) | 0) + ((b / 400) | 0)),
              (d = (((b - 1) / 4) | 0) - (((b - 1) / 100) | 0) + (((b - 1) / 400) | 0)),
              (e = c - d),
              (f = e + 1),
              (g = m + (((153 * (l - 3) + 2) / 5) | 0) + 58 + e)),
          (h = (b + c) % 7),
          (m = (g + h - f) % 7),
          (i = g + 3 - m),
          (j = 0 > i ? 53 - (((h - e) / 5) | 0) : i > 364 + e ? 1 : ((i / 7) | 0) + 1)
        );
      },
      hb = {
        init: function() {
          (this.name = this.searchString(this.dataBrowser) || ''),
            (this.version = this.searchVersion(navigator.userAgent) || this.searchVersion(navigator.appVersion) || '');
        },
        searchString: function(a) {
          for (var b = 0; b < a.length; b++) {
            var c = a[b].string,
              d = a[b].prop;
            if (((this.versionSearchString = a[b].versionSearch || a[b].identity), c)) {
              if (-1 != c.indexOf(a[b].subString)) return a[b].identity;
            } else if (d) return a[b].identity;
          }
        },
        searchVersion: function(a) {
          var b = a.indexOf(this.versionSearchString);
          if (-1 != b) return parseFloat(a.substring(b + this.versionSearchString.length + 1));
        },
        dataBrowser: [
          { string: navigator.userAgent, subString: 'Firefox', identity: 'firefox' },
          { string: navigator.userAgent, subString: 'MSIE', identity: 'explorer', versionSearch: 'MSIE' },
        ],
      };
    hb.init(), Q();
  }),
    (a.fn.Zebra_DatePicker = function(b) {
      return this.each(function() {
        void 0 !== a(this).data('Zebra_DatePicker') &&
          a(this)
            .data('Zebra_DatePicker')
            .destroy();
        var c = new a.Zebra_DatePicker(this, b);
        a(this).data('Zebra_DatePicker', c);
      });
    });
})(jQuery);
